-- Databricks notebook source
INSERT OVERWRITE legacy.inv_physical
SELECT POSTING_DT
       , lpad(DOC_NBR, 10, '0') as DOC_NBR
       , LOCATION_ID
       , PRODUCT_ID
       , CLIENT
       , FISCAL_YR
       , SITE_NBR
       , SKU_NBR
       , BOOK_QTY
       , PHYSICAL_QTY
       , DIFF_QTY
       , OVERSTOCK_QTY
       , DIFF_AMT
       , TRANS_TYPE
       , STORAGE_LOC
       , SPECIAL_STOCK_IND
       , DOC_DT
       , PLANNED_DT
       , LAST_COUNT_DT
       , FISCAL_PERIOD
       , CHANGED_BY
       , POSTING_BLOCK
       , COUNT_STATUS
       , ADJ_POSTING_STATUS
       , PHYS_INV_REF_NBR
       , DELETE_FLAG_STATUS
       , BOOK_INV_FREEZE
       , GROUP_CRIT_TYPE
       , GROUP_CRIT_PI
       , PHYS_INV_TYPE_DESC
       , PHYS_INV_DOC_DESC
       , PHYS_INV_TYPE_ID
       , INV_BALANCE_STATUS
       , LN_NBR
       , BATCH_NBR
       , PHYS_INV_STOCK_TYPE_ID
       , SALES_ORDER_NBR
       , ITEM_NBR
       , DELIVERY_SCHED
       , VENDOR_NBR
       , ACCT_CUST_NBR
       , DISTRIBUTION_DIFF
       , CHANGED_DT
       , COUNTED_BY
       , ADJ_POSTING_BY
       , ITEM_COUNTED_FLAG
       , DIFFERENCE_POSTED
       , ITEM_RECOUNTED_FLAG
       , ITEM_DELETED_FLAG
       , ALT_UOM_FLAG
       , ZERO_COUNT_FLAG
       , BASE_UOM
       , QTY_UOM
       , PHYS_INV_UOM
       , NBR_ARTICLE_DOC
       , ARTICLE_DOC_YR
       , ITEM_ARTICLE_DOC
       , NBR_RECOUNT_DOC
       , CURRENCY_CD
       , EXCH_RATE_PCT
       , PHYS_INV_CYCLE_COUNT_IND
       , WBS_ELEMENT
       , SALES_PRICE_TAX_INC
       , EXT_SALES_VALUE_LOCAL
       , BOOK_VALUE_SP
       , INV_FLAG
       , SALES_PRICE_TAX_EXC
       , SALES_INV_DIFF_VAT
       , SALES_INV_DIFF_NOVAT
       , PHYS_INV_COUNT_VALUE
       , BOOK_QTY_VALUE
       , INV_DIFF
       , ARTCILE_CATEGORY
       , INV_DIFF_REASON
       , XSITE_CONF_ARTICLE
       , PHYS_INV_DIST_DIFF
       , DATE_COUNT_OT
       , TIME_COUNT_OT
       , FREEZE_DT_INV_BALANCE
       , FREEZE_TIME_INV_BALANCE
       , BOOK_QTY_CHANGED
       , RETAIL_VALUE
       , BOOK_INV
       , PHYS_INV_ENTRY_DATE
       , PHYS_INV_ENTRY_TIME
       , PHYS_INV_DIFF_ADJ_TYPE_ID
       , UPDATE_DT
       , LOAD_DT

  FROM refine.INV_PHYSICAL_HISTORY
