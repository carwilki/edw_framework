

--*****  Creating table:  "WFA_TIME_SHEET_PUNCH_PRE" , ***** Creating table: "WFA_TIME_SHEET_PUNCH_PRE"


use raw;
CREATE TABLE  
    WFA_TIME_SHEET_PUNCH_PRE(
        DAY_DT        TIMESTAMP                             not null
        , TIME_SHEET_ITEM_ID                                BIGINT                         not null
        , STRT_DTM      TIMESTAMP 
        , END_DTM       TIMESTAMP 
        , STORE_NBR INT
        , EMPLOYEE_ID BIGINT
        , WFA_BUSN_AREA_DESC                                STRING 
        , WFA_DEPT_DESC                                     STRING 
        , WFA_TASK_DESC                                     STRING 
        , LOAD_DT       TIMESTAMP 
        )
        USING delta 
        LOCATION 'gs://petm-bdpl-prod-raw-p1-gcs-gbl/labor_mgmt/wfa_time_sheet_punch_pre' 
        ;
--DISTRIBUTE ON (DAY_DT)



--*****  Creating table:  "WFA_TIME_SHEET_PUNCH" , ***** Creating table: "WFA_TIME_SHEET_PUNCH"
use legacy;

CREATE TABLE  
    WFA_TIME_SHEET_PUNCH(
        DAY_DT        TIMESTAMP                             not null
        ,WEEK_DT       TIMESTAMP 
        , TIME_SHEET_ITEM_ID                                BIGINT                         not null
        , STRT_DTM      TIMESTAMP 
        , END_DTM       TIMESTAMP 
        , LOCATION_ID INT
        , EMPLOYEE_ID BIGINT
        , WFA_BUSN_AREA_ID SMALLINT
        , WFA_BUSN_AREA_DESC                                STRING 
        , WFA_DEPT_ID SMALLINT
        , WFA_DEPT_DESC                                     STRING 
        , WFA_TASK_ID SMALLINT
        , WFA_TASK_DESC                                     STRING 
        , UPDATE_DT     TIMESTAMP 
        , LOAD_DT       TIMESTAMP 
        )
        USING delta 
        LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/labor_mgmt/wfa_time_sheet_punch' 
        ;
--DISTRIBUTE ON (DAY_DT)



--*****  Creating table:  "WFA_DEPARTMENT" , ***** Creating table: "WFA_DEPARTMENT"
use legacy;

CREATE TABLE  
    WFA_DEPARTMENT(
    WFA_DEPT_ID BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 10000),
    , WFA_DEPT_DESC STRING 
    , UPDATE_DT     TIMESTAMP 
    , LOAD_DT       TIMESTAMP 
    )
    USING delta 
    LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/labor_mgmt/wfa_department' 
    ;
--DISTRIBUTE ON (WFA_DEPT_ID)


--*****  Creating table:  "WFA_BUSINESS_AREA" , ***** Creating table: "WFA_BUSINESS_AREA"
use legacy;

CREATE TABLE  
    WFA_BUSINESS_AREA(
        WFA_BUSN_AREA_ID BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 10000),
        , WFA_BUSN_AREA_DESC  STRING 
        , UPDATE_DT     TIMESTAMP 
        , LOAD_DT       TIMESTAMP 
        )
        USING delta 
        LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/labor_mgmt/wfa_business_area' 
        ;

--DISTRIBUTE ON (WFA_BUSN_AREA_ID)




--*****  Creating table:  "WFA_TASK" , ***** Creating table: "WFA_TASK"


use legacy;
CREATE TABLE 
    WFA_TASK(
        WFA_TASK_ID BIGINT NOT NULL GENERATED BY DEFAULT AS IDENTITY (START WITH 10000),
        , WFA_TASK_DESC STRING 
        , UPDATE_DT     TIMESTAMP 
        , LOAD_DT       TIMESTAMP 
        )
        USING delta 
        LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/labor_mgmt/wfa_task' 
        ;
        
--DISTRIBUTE ON (WFA_TASK_ID)

--*****  Creating table:  "DAYS" , ***** Creating table: "DAYS"

use enterprise;

CREATE TABLE 
    days(   
        DAY_DT TIMESTAMP NOT NULL,  
        BUSINESS_DAY_FLAG STRING,  
        HOLIDAY_FLAG STRING,
        DAY_OF_WK_NAME STRING, 
        DAY_OF_WK_NAME_ABBR STRING,  
        DAY_OF_WK_NBR INT, 
        CAL_DAY_OF_MO_NBR INT,
        CAL_DAY_OF_YR_NBR INT,   
        CAL_WK INT,   
        CAL_WK_NBR INT,   
        CAL_MO INT,   
        CAL_MO_NBR INT,   
        CAL_MO_NAME STRING,   
        CAL_MO_NAME_ABBR STRING,  
        CAL_QTR INT,   
        CAL_QTR_NBR INT,   
        CAL_HALF INT,   
        CAL_YR INT,   
        FISCAL_DAY_OF_MO_NBR INT,   
        FISCAL_DAY_OF_YR_NBR INT,   
        FISCAL_WK STRING,   
        FISCAL_WK_NBR INT,   
        FISCAL_MO INT,   
        FISCAL_MO_NBR INT,  
        FISCAL_MO_NAME STRING,  
        FISCAL_MO_NAME_ABBR STRING,   
        FISCAL_QTR STRING,   
        FISCAL_QTR_NBR INT,   
        FISCAL_HALF STRING,   
        FISCAL_YR INT,  
        LYR_WEEK_DT TIMESTAMP NOT NULL,   
        LWK_WEEK_DT TIMESTAMP NOT NULL,   
        WEEK_DT TIMESTAMP NOT NULL,   
        EST_TIME_CONV_AMT DECIMAL(7,6) NOT NULL,   
        EST_TIME_CONV_HRS DECIMAL(1,0) NOT NULL,   
        ES0_TIME_CONV_AMT DECIMAL(7,6) NOT NULL,   
        ES0_TIME_CONV_HRS DECIMAL(1,0) NOT NULL,   
        CST_TIME_CONV_AMT DECIMAL(7,6) NOT NULL,   
        CST_TIME_CONV_HRS DECIMAL(1,0) NOT NULL,  
        CS0_TIME_CONV_AMT DECIMAL(7,6) NOT NULL,   
        CS0_TIME_CONV_HRS DECIMAL(1,0) NOT NULL,   
        MST_TIME_CONV_AMT DECIMAL(7,6) NOT NULL,   
        MST_TIME_CONV_HRS DECIMAL(1,0) NOT NULL,   
        MS0_TIME_CONV_AMT DECIMAL(7,6) NOT NULL,   
        MS0_TIME_CONV_HRS DECIMAL(1,0) NOT NULL,   
        PST_TIME_CONV_AMT DECIMAL(7,6) NOT NULL,   
        PST_TIME_CONV_HRS DECIMAL(1,0) NOT NULL,   
        BD_UPDATE_DT_TM TIMESTAMP,   
        BD_CREATE_DT_TM TIMESTAMP) 
        USING delta LOCATION 'gs://petm-bdpl-prod-enterprise-p1-gcs-gbl/calendar/days' 
        ;


--*****  Creating table:  "site_profile_rpt" , ***** Creating table: "site_profile_rpt"
use legacy;

CREATE TABLE 
    site_profile_rpt (

        location_id INT,

        location_type_id INT,

        location_type_desc STRING,

        store_nbr INT,

        store_name STRING,

        store_type_id STRING,

        store_type_desc STRING,

        parent_location_id INT,

        location_nbr STRING,

        company_id INT,

        company_desc STRING,

        super_region_id BIGINT,

        super_region_desc STRING,

        region_id BIGINT,

        region_desc STRING,

        district_id BIGINT,

        district_desc STRING,

        site_address STRING,

        site_city STRING,

        site_county STRING,

        state_cd STRING,

        state_name STRING,

        postal_cd STRING,

        country_cd STRING,

        country_name STRING,

        geo_latitude_nbr DECIMAL(12,6),

        geo_longitude_nbr DECIMAL(12,6),

        petsmart_dma_cd STRING,

        petsmart_dma_desc STRING,

        site_main_tele_no STRING,

        site_groom_tele_no STRING,

        site_fax_no STRING,

        site_email_address STRING,

        store_open_close_flag STRING,

        sft_open_dt TIMESTAMP,

        open_dt TIMESTAMP,

        gr_open_dt TIMESTAMP,

        close_dt TIMESTAMP,

        site_sales_flag STRING,

        sales_curr_flag INT,

        site_open_yrs_amt DECIMAL(5,2),

        first_sale_dt TIMESTAMP,

        first_measured_sale_dt TIMESTAMP,

        last_sale_dt TIMESTAMP,

        comp_curr_flag INT,

        comp_eff_dt TIMESTAMP,

        comp_end_dt TIMESTAMP,

        tp_loc_flag STRING,

        tp_active_cnt INT,

        tp_start_dt TIMESTAMP,

        hotel_flag INT,

        hotel_open_dt TIMESTAMP,

        daycamp_flag INT,

        vet_flag INT,

        time_zone_id STRING,

        time_zone STRING,

        sq_feet_retail DOUBLE,

        sq_feet_total DOUBLE,

        trade_area STRING,

        delv_service_class_id STRING,

        pick_service_class_id STRING,

        repl_dc_nbr INT,

        repl_fish_dc_nbr INT,

        repl_fwd_dc_nbr INT,

        promo_label_cd STRING,

        price_zone_id STRING,

        price_zone_desc STRING,

        price_ad_zone_id STRING,

        price_ad_zone_desc STRING,

        equine_merch_id INT,

        equine_merch_desc STRING,

        equine_site_id INT,

        equine_site_desc STRING,

        equine_site_open_dt TIMESTAMP,

        loyalty_pgm_type_id INT,

        loyalty_pgm_type_desc STRING,

        loyalty_pgm_status_id INT,

        loyalty_pgm_status_desc STRING,

        loyalty_pgm_start_dt TIMESTAMP,

        loyalty_pgm_change_dt TIMESTAMP,

        bp_company_nbr INT,

        bp_gl_acct INT,

        site_login_id STRING,

        site_manager_id INT,

        site_manager_name STRING,

        mgr_id INT,

        mgr_desc STRING,

        dvl_id INT,

        dvl_desc STRING,

        purch_group_id DOUBLE,

        purch_group_name STRING,

        total_sales_ranking_cd STRING,

        merch_sales_ranking_cd STRING,

        services_sales_ranking_cd STRING,

        salon_sales_ranking_cd STRING,

        training_sales_ranking_cd STRING,

        hotel_ddc_sales_ranking_cd STRING,

        consumables_sales_ranking_cd STRING,

        hardgoods_sales_ranking_cd STRING,

        specialty_sales_ranking_cd STRING,

        dist_mgr_name STRING,

        dm_email_address STRING,

        dc_area_director_name STRING,

        dc_area_director_email STRING,

        dist_svc_mgr_name STRING,

        dsm_email_address STRING,

        region_vp_name STRING,

        rvp_email_address STRING,

        region_trainer_name STRING,

        asset_protect_name STRING,

        asset_protect_email STRING,

        lp_safety_director_name STRING,

        lp_safety_director_email STRING,

        sr_lp_safety_mgr_name STRING,

        sr_lp_safety_mgr_email STRING,

        regional_lp_safety_mgr_name STRING,

        regional_lp_safety_mgr_email STRING,

        retail_manager_safety_name STRING,

        retail_manager_safety_email STRING,

        dc_general_manager_name STRING,

        dc_general_manager_email STRING,

        asst_dc_general_manager_name1 STRING,

        asst_dc_general_manager_email1 STRING,

        asst_dc_general_manager_name2 STRING,

        asst_dc_general_manager_email2 STRING,

        hr_manager_name STRING,

        hr_manager_email STRING,

        hr_supervisor_name1 STRING,

        hr_supervisor_email1 STRING,

        hr_supervisor_name2 STRING,

        hr_supervisor_email2 STRING,

        learn_solution_mgr_name STRING,

        learn_solution_mgr_email STRING,

        add_dt TIMESTAMP,

        delete_dt TIMESTAMP,

        update_dt TIMESTAMP,

        load_dt TIMESTAMP)

        USING delta

        LOCATION 'gs://petm-bdpl-prod-nzlegacy-p1-gcs-gbl/legacy/site_profile_rpt'
        ;


