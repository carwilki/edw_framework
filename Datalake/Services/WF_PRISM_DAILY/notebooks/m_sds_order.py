#Code converted on 2023-07-24 08:23:47
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from Datalake.utils.logger import *
# COMMAND ----------

parser = argparse.ArgumentParser()
spark = SparkSession.getActiveSession()
parser.add_argument('env', type=str, help='Env Variable')
args = parser.parse_args()
env = args.env

if env is None or env == '':
    raise ValueError('env is not set')

refine = getEnvPrefix(env) + 'refine'
raw = getEnvPrefix(env) + 'raw'
legacy = getEnvPrefix(env) + 'legacy'


# COMMAND ----------
# Processing node SQ_Shortcut_to_SDS_ORDER_PRE, type SOURCE 
# COLUMN COUNT: 70

SQ_Shortcut_to_SDS_ORDER_PRE = spark.sql(f"""SELECT
ID,
OWNER_ID,
CONTRACT_ID,
ACCOUNT_ID,
PRICEBOOK2_ID,
ORIGINAL_ORDER_ID,
OPPORTUNITY_ID,
QUOTE_ID,
EFFECTIVE_DATE,
END_DATE,
IS_REDUCTION_ORDER,
STATUS,
DESCRIPTION,
CUSTOMER_AUTHORIZED_BY_ID,
CUSTOMER_AUTHORIZED_DATE,
COMPANY_AUTHORIZED_BY_ID,
COMPANY_AUTHORIZED_DATE,
TYPE,
BILLING_STREET,
BILLING_CITY,
BILLING_STATE,
BILLING_POSTAL_CODE,
BILLING_COUNTRY,
BILLING_LATITUDE,
BILLING_LONGITUDE,
BILLING_GEOCODE_ACCURACY,
SHIPPING_STREET,
SHIPPING_CITY,
SHIPPING_STATE,
SHIPPING_POSTAL_CODE,
SHIPPING_COUNTRY,
SHIPPING_LATITUDE,
SHIPPING_LONGITUDE,
SHIPPING_GEOCODE_ACCURACY,
NAME,
PO_DATE,
PO_NUMBER,
ORDER_REFERENCE_NUMBER,
BILL_TO_CONTACT_ID,
SHIP_TO_CONTACT_ID,
ACTIVATED_DATE,
ACTIVATED_BY_ID,
STATUS_CODE,
CURRENCY_ISO_CODE,
ORDER_NUMBER,
TOTAL_AMOUNT,
CREATED_DATE,
CREATED_BY_ID,
LAST_MODIFIED_DATE,
LAST_MODIFIED_BY_ID,
IS_DELETED,
SYSTEM_MOD_STAMP,
LAST_VIEWED_DATE,
LAST_REFERENCED_DATE,
PSVC_PAYMENT_METHOD_C,
PSVC_STORE_NUMBER_C,
PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C,
PSVC_USER_WHO_VOIDED_C,
PSVC_VOID_REASON_C,
PSVC_INVOICE_C,
PSVC_AVAILABLE_FOR_VOID_C,
PSVC_ORDER_SMS_ID_C,
PSVC_VOID_DATE_TIME_C,
PSVC_ORDERNUMBER_C,
PSVC_NEW_GROOMING_CUSTOMER_C,
PSVC_TOTAL_AMOUNT_FOR_POS_C,
PSVC_IS_DUMMY_APPOINTMENT_C,
CREATION_CHANNEL_C,
TOTAL_TAX_C,
RECORD_TYPE_ID
FROM {raw}.SDS_ORDER_PRE""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_SDS_ORDER, type SOURCE 
# COLUMN COUNT: 5

SQ_Shortcut_to_SDS_ORDER = spark.sql(f"""SELECT
SDS_ORDER_ID,
SDS_SYSTEM_MODIFIED_TSTMP,
SDS_LAST_MODIFIED_TSTMP,
SDS_CREATED_TSTMP,
LOAD_TSTMP
FROM {legacy}.SDS_ORDER""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node JNR_SDS_ORDER, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 75

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_SDS_ORDER_PRE_temp = SQ_Shortcut_to_SDS_ORDER_PRE.toDF(*["SQ_Shortcut_to_SDS_ORDER_PRE___" + col for col in SQ_Shortcut_to_SDS_ORDER_PRE.columns])
SQ_Shortcut_to_SDS_ORDER_temp = SQ_Shortcut_to_SDS_ORDER.toDF(*["SQ_Shortcut_to_SDS_ORDER___" + col for col in SQ_Shortcut_to_SDS_ORDER.columns])

JNR_SDS_ORDER = SQ_Shortcut_to_SDS_ORDER_temp_PRE_temp.join(SQ_Shortcut_to_SDS_ORDER_temp,[SQ_Shortcut_to_SDS_ORDER_PRE_temp.SQ_Shortcut_to_SDS_ORDER_PRE___ID == SQ_Shortcut_to_SDS_ORDER_temp.SQ_Shortcut_to_SDS_ORDER___SDS_ORDER_ID],'left_outer').selectExpr(
	"SQ_Shortcut_to_SDS_ORDER___SDS_ORDER_ID as i_SDS_ORDER_ID",
	"SQ_Shortcut_to_SDS_ORDER___SDS_SYSTEM_MODIFIED_TSTMP as i_SDS_SYSTEM_MODIFIED_TSTMP",
	"SQ_Shortcut_to_SDS_ORDER___SDS_LAST_MODIFIED_TSTMP as i_SDS_LAST_MODIFIED_TSTMP",
	"SQ_Shortcut_to_SDS_ORDER___SDS_CREATED_TSTMP as i_SDS_CREATED_TSTMP",
	"SQ_Shortcut_to_SDS_ORDER___LOAD_TSTMP as i_LOAD_TSTMP",
	"SQ_Shortcut_to_SDS_ORDER_PRE___ID as ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___OWNER_ID as OWNER_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___CONTRACT_ID as CONTRACT_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___ACCOUNT_ID as ACCOUNT_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PRICEBOOK2_ID as PRICEBOOK2_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___ORIGINAL_ORDER_ID as ORIGINAL_ORDER_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___OPPORTUNITY_ID as OPPORTUNITY_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___QUOTE_ID as QUOTE_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___EFFECTIVE_DATE as EFFECTIVE_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___END_DATE as END_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___IS_REDUCTION_ORDER as IS_REDUCTION_ORDER",
	"SQ_Shortcut_to_SDS_ORDER_PRE___STATUS as STATUS",
	"SQ_Shortcut_to_SDS_ORDER_PRE___DESCRIPTION as DESCRIPTION",
	"SQ_Shortcut_to_SDS_ORDER_PRE___CUSTOMER_AUTHORIZED_BY_ID as CUSTOMER_AUTHORIZED_BY_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___CUSTOMER_AUTHORIZED_DATE as CUSTOMER_AUTHORIZED_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___COMPANY_AUTHORIZED_BY_ID as COMPANY_AUTHORIZED_BY_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___COMPANY_AUTHORIZED_DATE as COMPANY_AUTHORIZED_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___TYPE as TYPE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_STREET as BILLING_STREET",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_CITY as BILLING_CITY",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_STATE as BILLING_STATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_POSTAL_CODE as BILLING_POSTAL_CODE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_COUNTRY as BILLING_COUNTRY",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_LATITUDE as BILLING_LATITUDE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_LONGITUDE as BILLING_LONGITUDE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILLING_GEOCODE_ACCURACY as BILLING_GEOCODE_ACCURACY",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_STREET as SHIPPING_STREET",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_CITY as SHIPPING_CITY",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_STATE as SHIPPING_STATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_POSTAL_CODE as SHIPPING_POSTAL_CODE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_COUNTRY as SHIPPING_COUNTRY",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_LATITUDE as SHIPPING_LATITUDE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_LONGITUDE as SHIPPING_LONGITUDE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIPPING_GEOCODE_ACCURACY as SHIPPING_GEOCODE_ACCURACY",
	"SQ_Shortcut_to_SDS_ORDER_PRE___NAME as NAME",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PO_DATE as PO_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PO_NUMBER as PO_NUMBER",
	"SQ_Shortcut_to_SDS_ORDER_PRE___ORDER_REFERENCE_NUMBER as ORDER_REFERENCE_NUMBER",
	"SQ_Shortcut_to_SDS_ORDER_PRE___BILL_TO_CONTACT_ID as BILL_TO_CONTACT_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SHIP_TO_CONTACT_ID as SHIP_TO_CONTACT_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___ACTIVATED_DATE as ACTIVATED_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___ACTIVATED_BY_ID as ACTIVATED_BY_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___STATUS_CODE as STATUS_CODE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___CURRENCY_ISO_CODE as CURRENCY_ISO_CODE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___ORDER_NUMBER as ORDER_NUMBER",
	"SQ_Shortcut_to_SDS_ORDER_PRE___TOTAL_AMOUNT as TOTAL_AMOUNT",
	"SQ_Shortcut_to_SDS_ORDER_PRE___CREATED_DATE as CREATED_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___CREATED_BY_ID as CREATED_BY_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___LAST_MODIFIED_DATE as LAST_MODIFIED_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___LAST_MODIFIED_BY_ID as LAST_MODIFIED_BY_ID",
	"SQ_Shortcut_to_SDS_ORDER_PRE___IS_DELETED as IS_DELETED",
	"SQ_Shortcut_to_SDS_ORDER_PRE___SYSTEM_MOD_STAMP as SYSTEM_MOD_STAMP",
	"SQ_Shortcut_to_SDS_ORDER_PRE___LAST_VIEWED_DATE as LAST_VIEWED_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___LAST_REFERENCED_DATE as LAST_REFERENCED_DATE",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_PAYMENT_METHOD_C as PSVC_PAYMENT_METHOD_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_STORE_NUMBER_C as PSVC_STORE_NUMBER_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C as PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_USER_WHO_VOIDED_C as PSVC_USER_WHO_VOIDED_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_VOID_REASON_C as PSVC_VOID_REASON_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_INVOICE_C as PSVC_INVOICE_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_AVAILABLE_FOR_VOID_C as PSVC_AVAILABLE_FOR_VOID_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_ORDER_SMS_ID_C as PSVC_ORDER_SMS_ID_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_VOID_DATE_TIME_C as PSVC_VOID_DATE_TIME_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_ORDERNUMBER_C as PSVC_ORDERNUMBER_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_NEW_GROOMING_CUSTOMER_C as PSVC_NEW_GROOMING_CUSTOMER_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_TOTAL_AMOUNT_FOR_POS_C as PSVC_TOTAL_AMOUNT_FOR_POS_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___PSVC_IS_DUMMY_APPOINTMENT_C as PSVC_IS_DUMMY_APPOINTMENT_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___CREATION_CHANNEL_C as CREATION_CHANNEL_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___TOTAL_TAX_C as TOTAL_TAX_C",
	"SQ_Shortcut_to_SDS_ORDER_PRE___RECORD_TYPE_ID as RECORD_TYPE_ID")

# COMMAND ----------
# Processing node FIL_SDS_ORDER, type FILTER 
# COLUMN COUNT: 75

# for each involved DataFrame, append the dataframe name to each column
JNR_SDS_ORDER_temp = JNR_SDS_ORDER.toDF(*["JNR_SDS_ORDER___" + col for col in JNR_SDS_ORDER.columns])

FIL_SDS_ORDER = JNR_SDS_ORDER_temp.selectExpr(
	"JNR_SDS_ORDER___i_SDS_ORDER_ID as i_SDS_ORDER_ID",
	"JNR_SDS_ORDER___i_SDS_SYSTEM_MODIFIED_TSTMP as i_SDS_SYSTEM_MODIFIED_TSTMP",
	"JNR_SDS_ORDER___i_SDS_LAST_MODIFIED_TSTMP as i_SDS_LAST_MODIFIED_TSTMP",
	"JNR_SDS_ORDER___i_SDS_CREATED_TSTMP as i_SDS_CREATED_TSTMP",
	"JNR_SDS_ORDER___i_LOAD_TSTMP as i_LOAD_TSTMP",
	"JNR_SDS_ORDER___ID as ID",
	"JNR_SDS_ORDER___OWNER_ID as OWNER_ID",
	"JNR_SDS_ORDER___CONTRACT_ID as CONTRACT_ID",
	"JNR_SDS_ORDER___ACCOUNT_ID as ACCOUNT_ID",
	"JNR_SDS_ORDER___PRICEBOOK2_ID as PRICEBOOK2_ID",
	"JNR_SDS_ORDER___ORIGINAL_ORDER_ID as ORIGINAL_ORDER_ID",
	"JNR_SDS_ORDER___OPPORTUNITY_ID as OPPORTUNITY_ID",
	"JNR_SDS_ORDER___QUOTE_ID as QUOTE_ID",
	"JNR_SDS_ORDER___EFFECTIVE_DATE as EFFECTIVE_DATE",
	"JNR_SDS_ORDER___END_DATE as END_DATE",
	"JNR_SDS_ORDER___IS_REDUCTION_ORDER as IS_REDUCTION_ORDER",
	"JNR_SDS_ORDER___STATUS as STATUS",
	"JNR_SDS_ORDER___DESCRIPTION as DESCRIPTION",
	"JNR_SDS_ORDER___CUSTOMER_AUTHORIZED_BY_ID as CUSTOMER_AUTHORIZED_BY_ID",
	"JNR_SDS_ORDER___CUSTOMER_AUTHORIZED_DATE as CUSTOMER_AUTHORIZED_DATE",
	"JNR_SDS_ORDER___COMPANY_AUTHORIZED_BY_ID as COMPANY_AUTHORIZED_BY_ID",
	"JNR_SDS_ORDER___COMPANY_AUTHORIZED_DATE as COMPANY_AUTHORIZED_DATE",
	"JNR_SDS_ORDER___TYPE as TYPE",
	"JNR_SDS_ORDER___BILLING_STREET as BILLING_STREET",
	"JNR_SDS_ORDER___BILLING_CITY as BILLING_CITY",
	"JNR_SDS_ORDER___BILLING_STATE as BILLING_STATE",
	"JNR_SDS_ORDER___BILLING_POSTAL_CODE as BILLING_POSTAL_CODE",
	"JNR_SDS_ORDER___BILLING_COUNTRY as BILLING_COUNTRY",
	"JNR_SDS_ORDER___BILLING_LATITUDE as BILLING_LATITUDE",
	"JNR_SDS_ORDER___BILLING_LONGITUDE as BILLING_LONGITUDE",
	"JNR_SDS_ORDER___BILLING_GEOCODE_ACCURACY as BILLING_GEOCODE_ACCURACY",
	"JNR_SDS_ORDER___SHIPPING_STREET as SHIPPING_STREET",
	"JNR_SDS_ORDER___SHIPPING_CITY as SHIPPING_CITY",
	"JNR_SDS_ORDER___SHIPPING_STATE as SHIPPING_STATE",
	"JNR_SDS_ORDER___SHIPPING_POSTAL_CODE as SHIPPING_POSTAL_CODE",
	"JNR_SDS_ORDER___SHIPPING_COUNTRY as SHIPPING_COUNTRY",
	"JNR_SDS_ORDER___SHIPPING_LATITUDE as SHIPPING_LATITUDE",
	"JNR_SDS_ORDER___SHIPPING_LONGITUDE as SHIPPING_LONGITUDE",
	"JNR_SDS_ORDER___SHIPPING_GEOCODE_ACCURACY as SHIPPING_GEOCODE_ACCURACY",
	"JNR_SDS_ORDER___NAME as NAME",
	"JNR_SDS_ORDER___PO_DATE as PO_DATE",
	"JNR_SDS_ORDER___PO_NUMBER as PO_NUMBER",
	"JNR_SDS_ORDER___ORDER_REFERENCE_NUMBER as ORDER_REFERENCE_NUMBER",
	"JNR_SDS_ORDER___BILL_TO_CONTACT_ID as BILL_TO_CONTACT_ID",
	"JNR_SDS_ORDER___SHIP_TO_CONTACT_ID as SHIP_TO_CONTACT_ID",
	"JNR_SDS_ORDER___ACTIVATED_DATE as ACTIVATED_DATE",
	"JNR_SDS_ORDER___ACTIVATED_BY_ID as ACTIVATED_BY_ID",
	"JNR_SDS_ORDER___STATUS_CODE as STATUS_CODE",
	"JNR_SDS_ORDER___CURRENCY_ISO_CODE as CURRENCY_ISO_CODE",
	"JNR_SDS_ORDER___ORDER_NUMBER as ORDER_NUMBER",
	"JNR_SDS_ORDER___TOTAL_AMOUNT as TOTAL_AMOUNT",
	"JNR_SDS_ORDER___CREATED_DATE as CREATED_DATE",
	"JNR_SDS_ORDER___CREATED_BY_ID as CREATED_BY_ID",
	"JNR_SDS_ORDER___LAST_MODIFIED_DATE as LAST_MODIFIED_DATE",
	"JNR_SDS_ORDER___LAST_MODIFIED_BY_ID as LAST_MODIFIED_BY_ID",
	"JNR_SDS_ORDER___IS_DELETED as IS_DELETED",
	"JNR_SDS_ORDER___SYSTEM_MOD_STAMP as SYSTEM_MOD_STAMP",
	"JNR_SDS_ORDER___LAST_VIEWED_DATE as LAST_VIEWED_DATE",
	"JNR_SDS_ORDER___LAST_REFERENCED_DATE as LAST_REFERENCED_DATE",
	"JNR_SDS_ORDER___PSVC_PAYMENT_METHOD_C as PSVC_PAYMENT_METHOD_C",
	"JNR_SDS_ORDER___PSVC_STORE_NUMBER_C as PSVC_STORE_NUMBER_C",
	"JNR_SDS_ORDER___PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C as PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C",
	"JNR_SDS_ORDER___PSVC_USER_WHO_VOIDED_C as PSVC_USER_WHO_VOIDED_C",
	"JNR_SDS_ORDER___PSVC_VOID_REASON_C as PSVC_VOID_REASON_C",
	"JNR_SDS_ORDER___PSVC_INVOICE_C as PSVC_INVOICE_C",
	"JNR_SDS_ORDER___PSVC_AVAILABLE_FOR_VOID_C as PSVC_AVAILABLE_FOR_VOID_C",
	"JNR_SDS_ORDER___PSVC_ORDER_SMS_ID_C as PSVC_ORDER_SMS_ID_C",
	"JNR_SDS_ORDER___PSVC_VOID_DATE_TIME_C as PSVC_VOID_DATE_TIME_C",
	"JNR_SDS_ORDER___PSVC_ORDERNUMBER_C as PSVC_ORDERNUMBER_C",
	"JNR_SDS_ORDER___PSVC_NEW_GROOMING_CUSTOMER_C as PSVC_NEW_GROOMING_CUSTOMER_C",
	"JNR_SDS_ORDER___PSVC_TOTAL_AMOUNT_FOR_POS_C as PSVC_TOTAL_AMOUNT_FOR_POS_C",
	"JNR_SDS_ORDER___PSVC_IS_DUMMY_APPOINTMENT_C as PSVC_IS_DUMMY_APPOINTMENT_C",
	"JNR_SDS_ORDER___CREATION_CHANNEL_C as CREATION_CHANNEL_C",
	"JNR_SDS_ORDER___TOTAL_TAX_C as TOTAL_TAX_C",
	"JNR_SDS_ORDER___RECORD_TYPE_ID as RECORD_TYPE_ID").filter("i_SDS_ORDER_ID IS NULL OR ( i_SDS_ORDER_ID IS NOT NULL AND ( i_SDS_SYSTEM_MODIFIED_TSTMP != SYSTEM_MOD_STAMP OR i_SDS_CREATED_TSTMP != CREATED_DATE OR i_SDS_LAST_MODIFIED_TSTMP != LAST_MODIFIED_DATE ) )").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_SDS_ORDER, type EXPRESSION 
# COLUMN COUNT: 73

# for each involved DataFrame, append the dataframe name to each column
FIL_SDS_ORDER_temp = FIL_SDS_ORDER.toDF(*["FIL_SDS_ORDER___" + col for col in FIL_SDS_ORDER.columns])

EXP_SDS_ORDER = FIL_SDS_ORDER_temp.selectExpr(
	"FIL_SDS_ORDER___sys_row_id as sys_row_id",
	"FIL_SDS_ORDER___ID as ID",
	"FIL_SDS_ORDER___OWNER_ID as OWNER_ID",
	"FIL_SDS_ORDER___CONTRACT_ID as CONTRACT_ID",
	"FIL_SDS_ORDER___ACCOUNT_ID as ACCOUNT_ID",
	"FIL_SDS_ORDER___PRICEBOOK2_ID as PRICEBOOK2_ID",
	"FIL_SDS_ORDER___ORIGINAL_ORDER_ID as ORIGINAL_ORDER_ID",
	"FIL_SDS_ORDER___OPPORTUNITY_ID as OPPORTUNITY_ID",
	"FIL_SDS_ORDER___QUOTE_ID as QUOTE_ID",
	"FIL_SDS_ORDER___EFFECTIVE_DATE as EFFECTIVE_DATE",
	"FIL_SDS_ORDER___END_DATE as END_DATE",
	"FIL_SDS_ORDER___IS_REDUCTION_ORDER as IS_REDUCTION_ORDER",
	"FIL_SDS_ORDER___STATUS as STATUS",
	"FIL_SDS_ORDER___DESCRIPTION as DESCRIPTION",
	"FIL_SDS_ORDER___CUSTOMER_AUTHORIZED_BY_ID as CUSTOMER_AUTHORIZED_BY_ID",
	"FIL_SDS_ORDER___CUSTOMER_AUTHORIZED_DATE as CUSTOMER_AUTHORIZED_DATE",
	"FIL_SDS_ORDER___COMPANY_AUTHORIZED_BY_ID as COMPANY_AUTHORIZED_BY_ID",
	"FIL_SDS_ORDER___COMPANY_AUTHORIZED_DATE as COMPANY_AUTHORIZED_DATE",
	"FIL_SDS_ORDER___TYPE as TYPE",
	"FIL_SDS_ORDER___BILLING_STREET as BILLING_STREET",
	"FIL_SDS_ORDER___BILLING_CITY as BILLING_CITY",
	"FIL_SDS_ORDER___BILLING_STATE as BILLING_STATE",
	"FIL_SDS_ORDER___BILLING_POSTAL_CODE as BILLING_POSTAL_CODE",
	"FIL_SDS_ORDER___BILLING_COUNTRY as BILLING_COUNTRY",
	"FIL_SDS_ORDER___BILLING_LATITUDE as BILLING_LATITUDE",
	"FIL_SDS_ORDER___BILLING_LONGITUDE as BILLING_LONGITUDE",
	"FIL_SDS_ORDER___BILLING_GEOCODE_ACCURACY as BILLING_GEOCODE_ACCURACY",
	"FIL_SDS_ORDER___SHIPPING_STREET as SHIPPING_STREET",
	"FIL_SDS_ORDER___SHIPPING_CITY as SHIPPING_CITY",
	"FIL_SDS_ORDER___SHIPPING_STATE as SHIPPING_STATE",
	"FIL_SDS_ORDER___SHIPPING_POSTAL_CODE as SHIPPING_POSTAL_CODE",
	"FIL_SDS_ORDER___SHIPPING_COUNTRY as SHIPPING_COUNTRY",
	"FIL_SDS_ORDER___SHIPPING_LATITUDE as SHIPPING_LATITUDE",
	"FIL_SDS_ORDER___SHIPPING_LONGITUDE as SHIPPING_LONGITUDE",
	"FIL_SDS_ORDER___SHIPPING_GEOCODE_ACCURACY as SHIPPING_GEOCODE_ACCURACY",
	"FIL_SDS_ORDER___NAME as NAME",
	"FIL_SDS_ORDER___PO_DATE as PO_DATE",
	"FIL_SDS_ORDER___PO_NUMBER as PO_NUMBER",
	"FIL_SDS_ORDER___ORDER_REFERENCE_NUMBER as ORDER_REFERENCE_NUMBER",
	"FIL_SDS_ORDER___BILL_TO_CONTACT_ID as BILL_TO_CONTACT_ID",
	"FIL_SDS_ORDER___SHIP_TO_CONTACT_ID as SHIP_TO_CONTACT_ID",
	"FIL_SDS_ORDER___ACTIVATED_DATE as ACTIVATED_DATE",
	"FIL_SDS_ORDER___ACTIVATED_BY_ID as ACTIVATED_BY_ID",
	"FIL_SDS_ORDER___STATUS_CODE as STATUS_CODE",
	"FIL_SDS_ORDER___CURRENCY_ISO_CODE as CURRENCY_ISO_CODE",
	"FIL_SDS_ORDER___ORDER_NUMBER as ORDER_NUMBER",
	"FIL_SDS_ORDER___TOTAL_AMOUNT as TOTAL_AMOUNT",
	"FIL_SDS_ORDER___CREATED_DATE as CREATED_DATE",
	"FIL_SDS_ORDER___CREATED_BY_ID as CREATED_BY_ID",
	"FIL_SDS_ORDER___LAST_MODIFIED_DATE as LAST_MODIFIED_DATE",
	"FIL_SDS_ORDER___LAST_MODIFIED_BY_ID as LAST_MODIFIED_BY_ID",
	"FIL_SDS_ORDER___IS_DELETED as IS_DELETED",
	"FIL_SDS_ORDER___SYSTEM_MOD_STAMP as SYSTEM_MOD_STAMP",
	"FIL_SDS_ORDER___LAST_VIEWED_DATE as LAST_VIEWED_DATE",
	"FIL_SDS_ORDER___LAST_REFERENCED_DATE as LAST_REFERENCED_DATE",
	"FIL_SDS_ORDER___PSVC_PAYMENT_METHOD_C as PSVC_PAYMENT_METHOD_C",
	"FIL_SDS_ORDER___PSVC_STORE_NUMBER_C as PSVC_STORE_NUMBER_C",
	"FIL_SDS_ORDER___PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C as PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C",
	"FIL_SDS_ORDER___PSVC_USER_WHO_VOIDED_C as PSVC_USER_WHO_VOIDED_C",
	"FIL_SDS_ORDER___PSVC_VOID_REASON_C as PSVC_VOID_REASON_C",
	"FIL_SDS_ORDER___PSVC_INVOICE_C as PSVC_INVOICE_C",
	"FIL_SDS_ORDER___PSVC_AVAILABLE_FOR_VOID_C as PSVC_AVAILABLE_FOR_VOID_C",
	"FIL_SDS_ORDER___PSVC_ORDER_SMS_ID_C as PSVC_ORDER_SMS_ID_C",
	"FIL_SDS_ORDER___PSVC_VOID_DATE_TIME_C as PSVC_VOID_DATE_TIME_C",
	"FIL_SDS_ORDER___PSVC_ORDERNUMBER_C as PSVC_ORDERNUMBER_C",
	"FIL_SDS_ORDER___PSVC_NEW_GROOMING_CUSTOMER_C as PSVC_NEW_GROOMING_CUSTOMER_C",
	"FIL_SDS_ORDER___PSVC_TOTAL_AMOUNT_FOR_POS_C as PSVC_TOTAL_AMOUNT_FOR_POS_C",
	"FIL_SDS_ORDER___PSVC_IS_DUMMY_APPOINTMENT_C as PSVC_IS_DUMMY_APPOINTMENT_C",
	"FIL_SDS_ORDER___CREATION_CHANNEL_C as CREATION_CHANNEL_C",
	"FIL_SDS_ORDER___TOTAL_TAX_C as TOTAL_TAX_C",
	"FIL_SDS_ORDER___RECORD_TYPE_ID as RECORD_TYPE_ID",
	"CURRENT_TIMESTAMP as UPDATE_TSTMP",
	"IF (FIL_SDS_ORDER___i_LOAD_TSTMP IS NULL, CURRENT_TIMESTAMP, FIL_SDS_ORDER___i_LOAD_TSTMP) as LOAD_TSTMP",
	"IF (FIL_SDS_ORDER___i_SDS_ORDER_ID IS NULL, 1, 2) as o_UPDATE_VALIDATOR"
)

# COMMAND ----------
# Processing node UPD_SDS_ORDER, type UPDATE_STRATEGY 
# COLUMN COUNT: 73

# for each involved DataFrame, append the dataframe name to each column
EXP_SDS_ORDER_temp = EXP_SDS_ORDER.toDF(*["EXP_SDS_ORDER___" + col for col in EXP_SDS_ORDER.columns])

UPD_SDS_ORDER = EXP_SDS_ORDER_temp.selectExpr(
	"EXP_SDS_ORDER___ID as ID",
	"EXP_SDS_ORDER___OWNER_ID as OWNER_ID",
	"EXP_SDS_ORDER___CONTRACT_ID as CONTRACT_ID",
	"EXP_SDS_ORDER___ACCOUNT_ID as ACCOUNT_ID",
	"EXP_SDS_ORDER___PRICEBOOK2_ID as PRICEBOOK2_ID",
	"EXP_SDS_ORDER___ORIGINAL_ORDER_ID as ORIGINAL_ORDER_ID",
	"EXP_SDS_ORDER___OPPORTUNITY_ID as OPPORTUNITY_ID",
	"EXP_SDS_ORDER___QUOTE_ID as QUOTE_ID",
	"EXP_SDS_ORDER___EFFECTIVE_DATE as EFFECTIVE_DATE",
	"EXP_SDS_ORDER___END_DATE as END_DATE",
	"EXP_SDS_ORDER___IS_REDUCTION_ORDER as IS_REDUCTION_ORDER",
	"EXP_SDS_ORDER___STATUS as STATUS",
	"EXP_SDS_ORDER___DESCRIPTION as DESCRIPTION",
	"EXP_SDS_ORDER___CUSTOMER_AUTHORIZED_BY_ID as CUSTOMER_AUTHORIZED_BY_ID",
	"EXP_SDS_ORDER___CUSTOMER_AUTHORIZED_DATE as CUSTOMER_AUTHORIZED_DATE",
	"EXP_SDS_ORDER___COMPANY_AUTHORIZED_BY_ID as COMPANY_AUTHORIZED_BY_ID",
	"EXP_SDS_ORDER___COMPANY_AUTHORIZED_DATE as COMPANY_AUTHORIZED_DATE",
	"EXP_SDS_ORDER___TYPE as TYPE",
	"EXP_SDS_ORDER___BILLING_STREET as BILLING_STREET",
	"EXP_SDS_ORDER___BILLING_CITY as BILLING_CITY",
	"EXP_SDS_ORDER___BILLING_STATE as BILLING_STATE",
	"EXP_SDS_ORDER___BILLING_POSTAL_CODE as BILLING_POSTAL_CODE",
	"EXP_SDS_ORDER___BILLING_COUNTRY as BILLING_COUNTRY",
	"EXP_SDS_ORDER___BILLING_LATITUDE as BILLING_LATITUDE",
	"EXP_SDS_ORDER___BILLING_LONGITUDE as BILLING_LONGITUDE",
	"EXP_SDS_ORDER___BILLING_GEOCODE_ACCURACY as BILLING_GEOCODE_ACCURACY",
	"EXP_SDS_ORDER___SHIPPING_STREET as SHIPPING_STREET",
	"EXP_SDS_ORDER___SHIPPING_CITY as SHIPPING_CITY",
	"EXP_SDS_ORDER___SHIPPING_STATE as SHIPPING_STATE",
	"EXP_SDS_ORDER___SHIPPING_POSTAL_CODE as SHIPPING_POSTAL_CODE",
	"EXP_SDS_ORDER___SHIPPING_COUNTRY as SHIPPING_COUNTRY",
	"EXP_SDS_ORDER___SHIPPING_LATITUDE as SHIPPING_LATITUDE",
	"EXP_SDS_ORDER___SHIPPING_LONGITUDE as SHIPPING_LONGITUDE",
	"EXP_SDS_ORDER___SHIPPING_GEOCODE_ACCURACY as SHIPPING_GEOCODE_ACCURACY",
	"EXP_SDS_ORDER___NAME as NAME",
	"EXP_SDS_ORDER___PO_DATE as PO_DATE",
	"EXP_SDS_ORDER___PO_NUMBER as PO_NUMBER",
	"EXP_SDS_ORDER___ORDER_REFERENCE_NUMBER as ORDER_REFERENCE_NUMBER",
	"EXP_SDS_ORDER___BILL_TO_CONTACT_ID as BILL_TO_CONTACT_ID",
	"EXP_SDS_ORDER___SHIP_TO_CONTACT_ID as SHIP_TO_CONTACT_ID",
	"EXP_SDS_ORDER___ACTIVATED_DATE as ACTIVATED_DATE",
	"EXP_SDS_ORDER___ACTIVATED_BY_ID as ACTIVATED_BY_ID",
	"EXP_SDS_ORDER___STATUS_CODE as STATUS_CODE",
	"EXP_SDS_ORDER___CURRENCY_ISO_CODE as CURRENCY_ISO_CODE",
	"EXP_SDS_ORDER___ORDER_NUMBER as ORDER_NUMBER",
	"EXP_SDS_ORDER___TOTAL_AMOUNT as TOTAL_AMOUNT",
	"EXP_SDS_ORDER___CREATED_DATE as CREATED_DATE",
	"EXP_SDS_ORDER___CREATED_BY_ID as CREATED_BY_ID",
	"EXP_SDS_ORDER___LAST_MODIFIED_DATE as LAST_MODIFIED_DATE",
	"EXP_SDS_ORDER___LAST_MODIFIED_BY_ID as LAST_MODIFIED_BY_ID",
	"EXP_SDS_ORDER___IS_DELETED as IS_DELETED",
	"EXP_SDS_ORDER___SYSTEM_MOD_STAMP as SYSTEM_MOD_STAMP",
	"EXP_SDS_ORDER___LAST_VIEWED_DATE as LAST_VIEWED_DATE",
	"EXP_SDS_ORDER___LAST_REFERENCED_DATE as LAST_REFERENCED_DATE",
	"EXP_SDS_ORDER___PSVC_PAYMENT_METHOD_C as PSVC_PAYMENT_METHOD_C",
	"EXP_SDS_ORDER___PSVC_STORE_NUMBER_C as PSVC_STORE_NUMBER_C",
	"EXP_SDS_ORDER___PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C as PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C",
	"EXP_SDS_ORDER___PSVC_USER_WHO_VOIDED_C as PSVC_USER_WHO_VOIDED_C",
	"EXP_SDS_ORDER___PSVC_VOID_REASON_C as PSVC_VOID_REASON_C",
	"EXP_SDS_ORDER___PSVC_INVOICE_C as PSVC_INVOICE_C",
	"EXP_SDS_ORDER___PSVC_AVAILABLE_FOR_VOID_C as PSVC_AVAILABLE_FOR_VOID_C",
	"EXP_SDS_ORDER___PSVC_ORDER_SMS_ID_C as PSVC_ORDER_SMS_ID_C",
	"EXP_SDS_ORDER___PSVC_VOID_DATE_TIME_C as PSVC_VOID_DATE_TIME_C",
	"EXP_SDS_ORDER___PSVC_ORDERNUMBER_C as PSVC_ORDERNUMBER_C",
	"EXP_SDS_ORDER___PSVC_NEW_GROOMING_CUSTOMER_C as PSVC_NEW_GROOMING_CUSTOMER_C",
	"EXP_SDS_ORDER___PSVC_TOTAL_AMOUNT_FOR_POS_C as PSVC_TOTAL_AMOUNT_FOR_POS_C",
	"EXP_SDS_ORDER___PSVC_IS_DUMMY_APPOINTMENT_C as PSVC_IS_DUMMY_APPOINTMENT_C",
	"EXP_SDS_ORDER___CREATION_CHANNEL_C as CREATION_CHANNEL_C",
	"EXP_SDS_ORDER___TOTAL_TAX_C as TOTAL_TAX_C",
	"EXP_SDS_ORDER___RECORD_TYPE_ID as RECORD_TYPE_ID",
	"EXP_SDS_ORDER___UPDATE_TSTMP as UPDATE_TSTMP",
	"EXP_SDS_ORDER___LOAD_TSTMP as LOAD_TSTMP",
	"EXP_SDS_ORDER___o_UPDATE_VALIDATOR as o_UPDATE_VALIDATOR")\
	.withColumn('pyspark_data_action', when(col('o_UPDATE_VALIDATOR') ==(lit(1)) , lit(0)) .when(col('o_UPDATE_VALIDATOR') ==(lit(2)) , lit(1)))

# COMMAND ----------
# Processing node Shortcut_to_SDS_ORDER_1, type TARGET 
# COLUMN COUNT: 72


Shortcut_to_SDS_ORDER_1 = UPD_SDS_ORDER.selectExpr(
	"CAST(ID AS STRING) as SDS_ORDER_ID",
	"CAST(NAME AS STRING) as SDS_ORDER_NAME",
	"CAST(DESCRIPTION AS STRING) as SDS_ORDER_DESC",
	"CAST(ORDER_NUMBER AS STRING) as SDS_ORDER_NBR",
	"CAST(PSVC_ORDERNUMBER_C AS STRING) as SDS_WEB_SERVICE_ORDER_NBR",
	"CAST(ORDER_REFERENCE_NUMBER AS STRING) as SDS_ORDER_REF_NBR",
	"CAST(ORIGINAL_ORDER_ID AS STRING) as SDS_ORIG_ORDER_ID",
	"CAST(TYPE AS STRING) as SDS_ORDER_TYPE",
	"CAST(RECORD_TYPE_ID AS STRING) as SDS_ORDER_RECORD_TYPE_ID",
	"CAST(CREATION_CHANNEL_C AS STRING) as SDS_ORDER_CREATION_CHANNEL",
	"CAST(PSVC_INVOICE_C AS STRING) as SDS_INVOICE_ID",
	"CAST(ACCOUNT_ID AS STRING) as SDS_ACCOUNT_ID",
	"CAST(CONTRACT_ID AS STRING) as SDS_CONTRACT_ID",
	"CAST(OPPORTUNITY_ID AS STRING) as SDS_OPPORTUNITY_ID",
	"CAST(QUOTE_ID AS STRING) as SDS_QUOTE_ID",
	"CAST(PSVC_STORE_NUMBER_C AS STRING) as STORE_NBR",
	"CAST(PSVC_IS_DUMMY_APPOINTMENT_C AS TINYINT) as DUMMY_APPOINTMENT_FLAG",
	"CAST(STATUS_CODE AS STRING) as SDS_ORDER_STATUS_CD",
	"CAST(STATUS AS STRING) as SDS_ORDER_STATUS",
	"CAST(PRICEBOOK2_ID AS STRING) as SDS_PRICEBOOK_ID",
	"CAST(IS_REDUCTION_ORDER AS TINYINT) as REDUCTION_ORDER_FLAG",
	"CAST(PSVC_AVAILABLE_FOR_VOID_C AS TINYINT) as AVAILABLE_FOR_VOID_FLAG",
	"CAST(PSVC_NEW_GROOMING_CUSTOMER_C AS TINYINT) as GROOMING_NEW_FLAG",
	"CAST(PSVC_VOID_REASON_C AS STRING) as ORDER_VOID_REASON",
	"CAST(PSVC_USER_WHO_VOIDED_C AS STRING) as USER_WHO_VOIDED",
	"CAST(PSVC_VOID_DATE_TIME_C AS TIMESTAMP) as VOID_TSTMP",
	"CAST(EFFECTIVE_DATE AS TIMESTAMP) as EFF_TSTMP",
	"CAST(END_DATE AS TIMESTAMP) as END_TSTMP",
	"CAST(TOTAL_AMOUNT AS DECIMAL(18,2)) as TOTAL_AMT",
	"CAST(PSVC_TOTAL_AMOUNT_FOR_POS_C AS DECIMAL(18,2)) as POS_TOTAL_AMT",
	"CAST(TOTAL_TAX_C AS DECIMAL(18,5)) as TOTAL_TAX_AMT",
	"CAST(PSVC_MANUAL_ADJUSTMENT_UPDATED_PRICE_C AS DECIMAL(18,2)) as MANUAL_ADJ_UPDATED_PRICE",
	"CAST(PSVC_PAYMENT_METHOD_C AS STRING) as PAYMENT_METHOD",
	"CAST(BILL_TO_CONTACT_ID AS STRING) as BILL_TO_SDS_CONTACT_ID",
	"CAST(BILLING_STREET AS STRING) as BILLING_STREET",
	"CAST(BILLING_CITY AS STRING) as BILLING_CITY",
	"CAST(BILLING_STATE AS STRING) as BILLING_STATE",
	"CAST(BILLING_POSTAL_CODE AS STRING) as BILLING_POSTAL_CD",
	"CAST(BILLING_COUNTRY AS STRING) as BILLING_COUNTRY",
	"CAST(BILLING_LATITUDE AS DECIMAL(18,15)) as BILLING_LATITUDE",
	"CAST(BILLING_LONGITUDE AS DECIMAL(18,15)) as BILLING_LONGITUDE",
	"CAST(BILLING_GEOCODE_ACCURACY AS STRING) as BILLING_GEOCODE_ACCURACY",
	"CAST(SHIP_TO_CONTACT_ID AS STRING) as SHIP_TO_SDS_CONTACT_ID",
	"CAST(SHIPPING_STREET AS STRING) as SHIPPING_STREET",
	"CAST(SHIPPING_CITY AS STRING) as SHIPPING_CITY",
	"CAST(SHIPPING_STATE AS STRING) as SHIPPING_STATE",
	"CAST(SHIPPING_POSTAL_CODE AS STRING) as SHIPPING_POSTAL_CD",
	"CAST(SHIPPING_COUNTRY AS STRING) as SHIPPING_COUNTRY",
	"CAST(SHIPPING_LATITUDE AS DECIMAL(18,15)) as SHIPPING_LATITUDE",
	"CAST(SHIPPING_LONGITUDE AS DECIMAL(18,15)) as SHIPPING_LONGITUDE",
	"CAST(SHIPPING_GEOCODE_ACCURACY AS STRING) as SHIPPING_GEOCODE_ACCURACY",
	"CAST(PO_NUMBER AS STRING) as SDS_PO_NBR",
	"CAST(PO_DATE AS TIMESTAMP) as PO_TSTMP",
	"CAST(ACTIVATED_DATE AS TIMESTAMP) as ORDER_ACTIVATED_TSTMP",
	"CAST(ACTIVATED_BY_ID AS STRING) as ORDER_ACTIVATED_BY_ID",
	"CAST(CUSTOMER_AUTHORIZED_BY_ID AS STRING) as CUSTOMER_AUTHORIZED_BY_ID",
	"CAST(CUSTOMER_AUTHORIZED_DATE AS TIMESTAMP) as CUSTOMER_AUTHORIZED_DATE",
	"CAST(COMPANY_AUTHORIZED_BY_ID AS STRING) as COMPANY_AUTHORIZED_BY_ID",
	"CAST(COMPANY_AUTHORIZED_DATE AS TIMESTAMP) as COMPANY_AUTHORIZED_DATE",
	"CAST(OWNER_ID AS STRING) as SDS_OWNER_ID",
	"CAST(PSVC_ORDER_SMS_ID_C AS STRING) as SMS_ORDER_ID",
	"CAST(CURRENCY_ISO_CODE AS STRING) as CURRENCY_ISO_CD",
	"CAST(IS_DELETED AS TINYINT) as DELETED_FLAG",
	"CAST(LAST_VIEWED_DATE AS TIMESTAMP) as SDS_LAST_VIEWED_TSTMP",
	"CAST(LAST_REFERENCED_DATE AS TIMESTAMP) as SDS_LAST_REFERENCED_TSTMP",
	"CAST(SYSTEM_MOD_STAMP AS TIMESTAMP) as SDS_SYSTEM_MODIFIED_TSTMP",
	"CAST(LAST_MODIFIED_DATE AS TIMESTAMP) as SDS_LAST_MODIFIED_TSTMP",
	"CAST(LAST_MODIFIED_BY_ID AS STRING) as SDS_LAST_MODIFIED_BY_ID",
	"CAST(CREATED_DATE AS TIMESTAMP) as SDS_CREATED_TSTMP",
	"CAST(CREATED_BY_ID AS STRING) as SDS_CREATED_BY_ID",
	"CAST(UPDATE_TSTMP AS TIMESTAMP) as UPDATE_TSTMP",
	"CAST(LOAD_TSTMP AS TIMESTAMP) as LOAD_TSTMP",
	"UPD_SDS_ORDER.pyspark_data_action as pyspark_data_action"
)

try:
  primary_key = """source.SDS_ORDER_ID = target.SDS_ORDER_ID"""
  refined_perf_table = f"{legacy}.SDS_ORDER"
  executeMerge(Shortcut_to_SDS_ORDER_1, refined_perf_table, primary_key)
  logger.info(f"Merge with {refined_perf_table} completed]")
  logPrevRunDt("SDS_ORDER", "SDS_ORDER", "Completed", "N/A", f"{raw}.log_run_details")
except Exception as e:
  logPrevRunDt("SDS_ORDER", "SDS_ORDER","Failed",str(e), f"{raw}.log_run_details", )
  raise e
	