#Code converted on 2023-06-24 13:33:30
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from pyspark.dbutils import DBUtils
from utils.genericUtilities import *
from utils.configs import *
from utils.mergeUtils import *
from utils.logger import *
# COMMAND ----------

parser = argparse.ArgumentParser()
spark = SparkSession.getActiveSession()
dbutils = DBUtils(spark)

parser.add_argument('env', type=str, help='Env Variable')
args = parser.parse_args()
env = args.env

if env is None or env == '':
    raise ValueError('env is not set')

refine = getEnvPrefix(env) + 'refine'
raw = getEnvPrefix(env) + 'raw'
legacy = getEnvPrefix(env) + 'legacy'

# Set global variables
starttime = datetime.now() #start timestamp of the script

# Read in relation source variables
# (username, password, connection_string) = getConfig(DC_NBR, env)

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_STOP_PRE, type SOURCE 
# COLUMN COUNT: 124

SQ_Shortcut_to_WM_STOP_PRE = spark.sql(f"""SELECT
WM_STOP_PRE.DC_NBR,
WM_STOP_PRE.SHIPMENT_ID,
WM_STOP_PRE.STOP_SEQ,
WM_STOP_PRE.TC_COMPANY_ID,
WM_STOP_PRE.WAVE_ID,
WM_STOP_PRE.WAVE_OPTION_ID,
WM_STOP_PRE.WAVE_OPTION_LIST_ID,
WM_STOP_PRE.ARRIVAL_LATE_REASON_ID,
WM_STOP_PRE.DEPARTURE_LATE_REASON_ID,
WM_STOP_PRE.SIZE_UOM_ID,
WM_STOP_PRE.DOCK_DISPATCH_CAP_ID,
WM_STOP_PRE.IS_APPT_REQD,
WM_STOP_PRE.POS_ARR_START_DTTM,
WM_STOP_PRE.POS_ARR_END_DTTM,
WM_STOP_PRE.POS_DEPART_START_DTTM,
WM_STOP_PRE.POS_DEPART_END_DTTM,
WM_STOP_PRE.ARRIVAL_START_DTTM,
WM_STOP_PRE.ARRIVAL_END_DTTM,
WM_STOP_PRE.EST_ARRIVAL_DTTM,
WM_STOP_PRE.ARRIVAL_COMMIT_DTTM,
WM_STOP_PRE.ACTUAL_ARRIVAL_DTTM,
WM_STOP_PRE.APPT_DTTM,
WM_STOP_PRE.DEPARTURE_START_DTTM,
WM_STOP_PRE.DEPARTURE_END_DTTM,
WM_STOP_PRE.EST_DEPARTURE_DTTM,
WM_STOP_PRE.ACTUAL_DEPARTURE_DTTM,
WM_STOP_PRE.START_SHIPMENT_DTTM,
WM_STOP_PRE.END_SHIPMENT_DTTM,
WM_STOP_PRE.PAPERWORK_START_DTTM,
WM_STOP_PRE.PICKUP_START_DTTM,
WM_STOP_PRE.EST_DISPATCH_DTTM,
WM_STOP_PRE.SHIPMENT_START_DTTM,
WM_STOP_PRE.SHIPMENT_END_DTTM,
WM_STOP_PRE.CHECKIN_TIME,
WM_STOP_PRE.CHECKOUT_TIME,
WM_STOP_PRE.ARRIVAL_NET_DTTM,
WM_STOP_PRE.ARRIVAL_NLT_DTTM,
WM_STOP_PRE.DEPARTURE_NET_DTTM,
WM_STOP_PRE.DEPARTURE_NLT_DTTM,
WM_STOP_PRE.REC_ARRIVAL_DTTM,
WM_STOP_PRE.REC_DEPARTURE_DTTM,
WM_STOP_PRE.BREAK_TIME,
WM_STOP_PRE.WAITING_TIME,
WM_STOP_PRE.STOP_LOCATION_NAME,
WM_STOP_PRE.CONTACT_FIRST_NAME,
WM_STOP_PRE.CONTACT_SURNAME,
WM_STOP_PRE.CONTACT_PHONE_NUMBER,
WM_STOP_PRE.FACILITY_ALIAS_ID,
WM_STOP_PRE.FACILITY_ID,
WM_STOP_PRE.ADDRESS_1,
WM_STOP_PRE.ADDRESS_2,
WM_STOP_PRE.CITY,
WM_STOP_PRE.STATE_PROV,
WM_STOP_PRE.POSTAL_CODE,
WM_STOP_PRE.COUNTY,
WM_STOP_PRE.COUNTRY_CODE,
WM_STOP_PRE.HANDLER,
WM_STOP_PRE.DISTANCE,
WM_STOP_PRE.DISTANCE_UOM,
WM_STOP_PRE.STOP_TZ,
WM_STOP_PRE.BILL_OF_LADING_NUMBER,
WM_STOP_PRE.DROP_HOOK_INDICATOR,
WM_STOP_PRE.HANDLING_TIME,
WM_STOP_PRE.REPORTED_HANDLER,
WM_STOP_PRE.SEGMENT_ID,
WM_STOP_PRE.SEGMENT_STOP_SEQ,
WM_STOP_PRE.CAPACITY,
WM_STOP_PRE.HAS_NOTES,
WM_STOP_PRE.IS_ADDR_OVERRIDE,
WM_STOP_PRE.IS_RECONSIGNED,
WM_STOP_PRE.IS_EST_ARR_USER_DEFINED,
WM_STOP_PRE.IS_EST_DEP_USER_DEFINED,
WM_STOP_PRE.IS_WAVE_MAN_CHANGED,
WM_STOP_PRE.DELAY_TYPE,
WM_STOP_PRE.STOP_STATUS,
WM_STOP_PRE.SEAL_NUMBER,
WM_STOP_PRE.APPOINTMENT_DURATION,
WM_STOP_PRE.BOL_TYPE,
WM_STOP_PRE.PRO_NBR,
WM_STOP_PRE.AUTH_NBR,
WM_STOP_PRE.MANIF_TYPE,
WM_STOP_PRE.CURR_PLT_ID,
WM_STOP_PRE.CONS_LOCN_ID,
WM_STOP_PRE.RTE_ID,
WM_STOP_PRE.AES_ITN,
WM_STOP_PRE.BOL_BREAK_ATTR,
WM_STOP_PRE.FREIGHT_TERMS,
WM_STOP_PRE.ADDRESS_3,
WM_STOP_PRE.DOCK_DOOR_LOCN_ID,
WM_STOP_PRE.FLOOR_SHIPMENT,
WM_STOP_PRE.HIBERNATE_VERSION,
WM_STOP_PRE.HITCH_TIME,
WM_STOP_PRE.LOAD_CLOSED_INDICATOR,
WM_STOP_PRE.STOP_TIME_MODIFIED,
WM_STOP_PRE.DRIVE_TIME,
WM_STOP_PRE.REF_FIELD_1,
WM_STOP_PRE.REF_FIELD_2,
WM_STOP_PRE.REF_FIELD_3,
WM_STOP_PRE.REF_FIELD_4,
WM_STOP_PRE.REF_FIELD_5,
WM_STOP_PRE.REF_FIELD_6,
WM_STOP_PRE.REF_FIELD_7,
WM_STOP_PRE.REF_FIELD_8,
WM_STOP_PRE.REF_FIELD_9,
WM_STOP_PRE.REF_FIELD_10,
WM_STOP_PRE.ORDER_WINDOW_VIOLATION,
WM_STOP_PRE.DOCK_VIOLATION,
WM_STOP_PRE.WAVE_OPTION_VIOLATION,
WM_STOP_PRE.STAGING_LOCN_ID,
WM_STOP_PRE.CALC_EST_ARRIVAL_DTTM,
WM_STOP_PRE.DEGREE_LATE_EARLY,
WM_STOP_PRE.ON_STATIC_ROUTE,
WM_STOP_PRE.AUTO_APPOINTMENT,
WM_STOP_PRE.STOP_REVENUE,
WM_STOP_PRE.STOP_REVENUE_CURRENCY_CODE,
WM_STOP_PRE.STOP_MARGIN,
WM_STOP_PRE.STOP_MARGIN_CURRENCY_CODE,
WM_STOP_PRE.STOP_COST,
WM_STOP_PRE.STOP_COST_CURRENCY_CODE,
WM_STOP_PRE.STOP_LINEHAUL_REVENUE,
WM_STOP_PRE.ACCESSORIAL_REVENUE,
WM_STOP_PRE.STOPOFF_REVENUE,
WM_STOP_PRE.CM_DISCOUNT_REVENUE,
WM_STOP_PRE.LOAD_TSTMP
FROM WM_STOP_PRE""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_STOP, type SOURCE 
# COLUMN COUNT: 124

SQ_Shortcut_to_WM_STOP = spark.sql(f"""SELECT
WM_STOP.LOCATION_ID,
WM_STOP.WM_SHIPMENT_ID,
WM_STOP.WM_STOP_SEQ,
WM_STOP.WM_TC_COMPANY_ID,
WM_STOP.STOP_LOCATION_NAME,
WM_STOP.WM_FACILITY_ID,
WM_STOP.WM_FACILITY_ALIAS_ID,
WM_STOP.WM_CONS_LOCN_ID,
WM_STOP.WM_STAGING_LOCN_ID,
WM_STOP.WM_DOCK_DOOR_LOCN_ID,
WM_STOP.WM_WAVE_ID,
WM_STOP.WM_WAVE_OPTION_ID,
WM_STOP.WM_WAVE_OPTION_LIST_ID,
WM_STOP.WM_DOCK_DISPATCH_CAP_ID,
WM_STOP.WM_SEGMENT_ID,
WM_STOP.SEGMENT_STOP_SEQ,
WM_STOP.HANDLER,
WM_STOP.REPORTED_HANDLER,
WM_STOP.DELAY_TYPE,
WM_STOP.STOP_STATUS,
WM_STOP.WM_SEAL_NBR,
WM_STOP.BILL_OF_LADING_NBR,
WM_STOP.BOL_TYPE,
WM_STOP.WM_PRO_NBR,
WM_STOP.WM_AUTH_NBR,
WM_STOP.WM_MANIF_TYPE,
WM_STOP.WM_CURR_PLT_ID,
WM_STOP.WM_RTE_ID,
WM_STOP.WM_AES_ITN,
WM_STOP.BOL_BREAK_ATTR,
WM_STOP.FREIGHT_TERMS,
WM_STOP.FLOOR_SHIPMENT,
WM_STOP.ORDER_WINDOW_VIOLATION,
WM_STOP.DOCK_VIOLATION,
WM_STOP.WAVE_OPTION_VIOLATION,
WM_STOP.AUTO_APPOINTMENT_FLAG,
WM_STOP.APPT_REQD_FLAG,
WM_STOP.ADDR_OVERRIDE_FLAG,
WM_STOP.LOAD_CLOSED_FLAG,
WM_STOP.WAVE_MAN_CHANGED_FLAG,
WM_STOP.ON_STATIC_ROUTE_FLAG,
WM_STOP.HAS_NOTES_FLAG,
WM_STOP.RECONSIGNED_FLAG,
WM_STOP.EST_ARR_USER_DEFINED_FLAG,
WM_STOP.EST_DEP_USER_DEFINED_FLAG,
WM_STOP.DROP_HOOK_FLAG,
WM_STOP.CONTACT_FIRST_NAME,
WM_STOP.CONTACT_SURNAME,
WM_STOP.ADDR_1,
WM_STOP.ADDR_2,
WM_STOP.ADDR_3,
WM_STOP.CITY,
WM_STOP.STATE_PROV,
WM_STOP.POSTAL_CD,
WM_STOP.COUNTY,
WM_STOP.COUNTRY_CD,
WM_STOP.CONTACT_PHONE_NBR,
WM_STOP.APPT_TSTMP,
WM_STOP.APPOINTMENT_DURATION,
WM_STOP.PAPERWORK_START_TSTMP,
WM_STOP.PICKUP_START_TSTMP,
WM_STOP.HANDLING_TIME,
WM_STOP.BREAK_TIME,
WM_STOP.WAITING_TIME,
WM_STOP.HITCH_TIME,
WM_STOP.DRIVE_TIME,
WM_STOP.STOP_TIME_MODIFIED,
WM_STOP.DISTANCE,
WM_STOP.DISTANCE_UOM,
WM_STOP.EST_DISPATCH_TSTMP,
WM_STOP.POS_ARR_START_TSTMP,
WM_STOP.POS_ARR_END_TSTMP,
WM_STOP.POS_DEPART_START_TSTMP,
WM_STOP.POS_DEPART_END_TSTMP,
WM_STOP.ARRIVAL_START_TSTMP,
WM_STOP.ARRIVAL_END_TSTMP,
WM_STOP.EST_ARRIVAL_TSTMP,
WM_STOP.CALC_EST_ARRIVAL_TSTMP,
WM_STOP.ARRIVAL_COMMIT_TSTMP,
WM_STOP.ACTUAL_ARRIVAL_TSTMP,
WM_STOP.DEPARTURE_START_TSTMP,
WM_STOP.DEPARTURE_END_TSTMP,
WM_STOP.EST_DEPARTURE_TSTMP,
WM_STOP.ACTUAL_DEPARTURE_TSTMP,
WM_STOP.START_SHIPMENT_TSTMP,
WM_STOP.END_SHIPMENT_TSTMP,
WM_STOP.SHIPMENT_START_TSTMP,
WM_STOP.SHIPMENT_END_TSTMP,
WM_STOP.CHECK_IN_TSTMP,
WM_STOP.CHECK_OUT_TSTMP,
WM_STOP.ARRIVAL_NET_TSTMP,
WM_STOP.ARRIVAL_NLT_TSTMP,
WM_STOP.DEPARTURE_NET_TSTMP,
WM_STOP.DEPARTURE_NLT_TSTMP,
WM_STOP.REC_ARRIVAL_TSTMP,
WM_STOP.REC_DEPARTURE_TSTMP,
WM_STOP.WM_STOP_TZ,
WM_STOP.DEGREE_LATE_EARLY,
WM_STOP.WM_ARRIVAL_LATE_REASON_ID,
WM_STOP.WM_DEPARTURE_LATE_REASON_ID,
WM_STOP.STOP_REVENUE,
WM_STOP.STOP_REVENUE_CURRENCY_CD,
WM_STOP.STOP_MARGIN,
WM_STOP.STOP_MARGIN_CURRENCY_CD,
WM_STOP.STOP_COST,
WM_STOP.STOP_COST_CURRENCY_CD,
WM_STOP.STOP_LINEHAUL_REVENUE,
WM_STOP.ACCESSORIAL_REVENUE,
WM_STOP.STOP_OFF_REVENUE,
WM_STOP.CM_DISCOUNT_REVENUE,
WM_STOP.CAPACITY,
WM_STOP.WM_SIZE_UOM_ID,
WM_STOP.REF_FIELD_1,
WM_STOP.REF_FIELD_2,
WM_STOP.REF_FIELD_3,
WM_STOP.REF_FIELD_4,
WM_STOP.REF_FIELD_5,
WM_STOP.REF_FIELD_6,
WM_STOP.REF_FIELD_7,
WM_STOP.REF_FIELD_8,
WM_STOP.REF_FIELD_9,
WM_STOP.REF_FIELD_10,
WM_STOP.WM_HIBERNATE_VERSION,
WM_STOP.LOAD_TSTMP
FROM WM_STOP
WHERE WM_SHIPMENT_ID IN (SELECT SHIPMENT_ID FROM WM_STOP_PRE)""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_SITE_PROFILE, type SOURCE 
# COLUMN COUNT: 2

SQ_Shortcut_to_SITE_PROFILE = spark.sql(f"""SELECT
SITE_PROFILE.LOCATION_ID,
SITE_PROFILE.STORE_NBR
FROM SITE_PROFILE""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_TRANS, type EXPRESSION 
# COLUMN COUNT: 125

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_STOP_PRE_temp = SQ_Shortcut_to_WM_STOP_PRE.toDF(*["SQ_Shortcut_to_WM_STOP_PRE___" + col for col in SQ_Shortcut_to_WM_STOP_PRE.columns])

EXP_TRANS = SQ_Shortcut_to_WM_STOP_PRE_temp.selectExpr( 
	"SQ_Shortcut_to_WM_STOP_PRE___sys_row_id as sys_row_id", 
	"SQ_Shortcut_to_WM_STOP_PRE___DC_NBR as DC_NBR", 
	"cast(SQ_Shortcut_to_WM_STOP_PRE___DC_NBR as int) as o_DC_NBR", 
	"SQ_Shortcut_to_WM_STOP_PRE___SHIPMENT_ID as SHIPMENT_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_SEQ as STOP_SEQ", 
	"SQ_Shortcut_to_WM_STOP_PRE___TC_COMPANY_ID as TC_COMPANY_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___WAVE_ID as WAVE_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___WAVE_OPTION_ID as WAVE_OPTION_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___WAVE_OPTION_LIST_ID as WAVE_OPTION_LIST_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___ARRIVAL_LATE_REASON_ID as ARRIVAL_LATE_REASON_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___DEPARTURE_LATE_REASON_ID as DEPARTURE_LATE_REASON_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___SIZE_UOM_ID as SIZE_UOM_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___DOCK_DISPATCH_CAP_ID as DOCK_DISPATCH_CAP_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___IS_APPT_REQD as IS_APPT_REQD", 
	"SQ_Shortcut_to_WM_STOP_PRE___POS_ARR_START_DTTM as POS_ARR_START_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___POS_ARR_END_DTTM as POS_ARR_END_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___POS_DEPART_START_DTTM as POS_DEPART_START_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___POS_DEPART_END_DTTM as POS_DEPART_END_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___ARRIVAL_START_DTTM as ARRIVAL_START_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___ARRIVAL_END_DTTM as ARRIVAL_END_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___EST_ARRIVAL_DTTM as EST_ARRIVAL_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___ARRIVAL_COMMIT_DTTM as ARRIVAL_COMMIT_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___APPT_DTTM as APPT_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___DEPARTURE_START_DTTM as DEPARTURE_START_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___DEPARTURE_END_DTTM as DEPARTURE_END_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___EST_DEPARTURE_DTTM as EST_DEPARTURE_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___START_SHIPMENT_DTTM as START_SHIPMENT_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___END_SHIPMENT_DTTM as END_SHIPMENT_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___PAPERWORK_START_DTTM as PAPERWORK_START_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___PICKUP_START_DTTM as PICKUP_START_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___EST_DISPATCH_DTTM as EST_DISPATCH_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___SHIPMENT_START_DTTM as SHIPMENT_START_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___SHIPMENT_END_DTTM as SHIPMENT_END_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___CHECKIN_TIME as CHECKIN_TIME", 
	"SQ_Shortcut_to_WM_STOP_PRE___CHECKOUT_TIME as CHECKOUT_TIME", 
	"SQ_Shortcut_to_WM_STOP_PRE___ARRIVAL_NET_DTTM as ARRIVAL_NET_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___ARRIVAL_NLT_DTTM as ARRIVAL_NLT_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___DEPARTURE_NET_DTTM as DEPARTURE_NET_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___DEPARTURE_NLT_DTTM as DEPARTURE_NLT_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___REC_ARRIVAL_DTTM as REC_ARRIVAL_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___REC_DEPARTURE_DTTM as REC_DEPARTURE_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___BREAK_TIME as BREAK_TIME", 
	"SQ_Shortcut_to_WM_STOP_PRE___WAITING_TIME as WAITING_TIME", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_LOCATION_NAME as STOP_LOCATION_NAME", 
	"SQ_Shortcut_to_WM_STOP_PRE___CONTACT_FIRST_NAME as CONTACT_FIRST_NAME", 
	"SQ_Shortcut_to_WM_STOP_PRE___CONTACT_SURNAME as CONTACT_SURNAME", 
	"SQ_Shortcut_to_WM_STOP_PRE___CONTACT_PHONE_NUMBER as CONTACT_PHONE_NUMBER", 
	"SQ_Shortcut_to_WM_STOP_PRE___FACILITY_ALIAS_ID as FACILITY_ALIAS_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___FACILITY_ID as FACILITY_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___ADDRESS_1 as ADDRESS_1", 
	"SQ_Shortcut_to_WM_STOP_PRE___ADDRESS_2 as ADDRESS_2", 
	"SQ_Shortcut_to_WM_STOP_PRE___CITY as CITY", 
	"SQ_Shortcut_to_WM_STOP_PRE___STATE_PROV as STATE_PROV", 
	"SQ_Shortcut_to_WM_STOP_PRE___POSTAL_CODE as POSTAL_CODE", 
	"SQ_Shortcut_to_WM_STOP_PRE___COUNTY as COUNTY", 
	"SQ_Shortcut_to_WM_STOP_PRE___COUNTRY_CODE as COUNTRY_CODE", 
	"SQ_Shortcut_to_WM_STOP_PRE___HANDLER as HANDLER", 
	"SQ_Shortcut_to_WM_STOP_PRE___DISTANCE as DISTANCE", 
	"SQ_Shortcut_to_WM_STOP_PRE___DISTANCE_UOM as DISTANCE_UOM", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_TZ as STOP_TZ", 
	"SQ_Shortcut_to_WM_STOP_PRE___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", 
	"SQ_Shortcut_to_WM_STOP_PRE___DROP_HOOK_INDICATOR as DROP_HOOK_INDICATOR", 
	"SQ_Shortcut_to_WM_STOP_PRE___HANDLING_TIME as HANDLING_TIME", 
	"SQ_Shortcut_to_WM_STOP_PRE___REPORTED_HANDLER as REPORTED_HANDLER", 
	"SQ_Shortcut_to_WM_STOP_PRE___SEGMENT_ID as SEGMENT_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___SEGMENT_STOP_SEQ as SEGMENT_STOP_SEQ", 
	"SQ_Shortcut_to_WM_STOP_PRE___CAPACITY as CAPACITY", 
	"SQ_Shortcut_to_WM_STOP_PRE___HAS_NOTES as HAS_NOTES", 
	"SQ_Shortcut_to_WM_STOP_PRE___IS_ADDR_OVERRIDE as IS_ADDR_OVERRIDE", 
	"SQ_Shortcut_to_WM_STOP_PRE___IS_RECONSIGNED as IS_RECONSIGNED", 
	"SQ_Shortcut_to_WM_STOP_PRE___IS_EST_ARR_USER_DEFINED as IS_EST_ARR_USER_DEFINED", 
	"SQ_Shortcut_to_WM_STOP_PRE___IS_EST_DEP_USER_DEFINED as IS_EST_DEP_USER_DEFINED", 
	"SQ_Shortcut_to_WM_STOP_PRE___IS_WAVE_MAN_CHANGED as IS_WAVE_MAN_CHANGED", 
	"SQ_Shortcut_to_WM_STOP_PRE___DELAY_TYPE as DELAY_TYPE", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_STATUS as STOP_STATUS", 
	"SQ_Shortcut_to_WM_STOP_PRE___SEAL_NUMBER as SEAL_NUMBER", 
	"SQ_Shortcut_to_WM_STOP_PRE___APPOINTMENT_DURATION as APPOINTMENT_DURATION", 
	"SQ_Shortcut_to_WM_STOP_PRE___BOL_TYPE as BOL_TYPE", 
	"SQ_Shortcut_to_WM_STOP_PRE___PRO_NBR as PRO_NBR", 
	"SQ_Shortcut_to_WM_STOP_PRE___AUTH_NBR as AUTH_NBR", 
	"SQ_Shortcut_to_WM_STOP_PRE___MANIF_TYPE as MANIF_TYPE", 
	"SQ_Shortcut_to_WM_STOP_PRE___CURR_PLT_ID as CURR_PLT_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___CONS_LOCN_ID as CONS_LOCN_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___RTE_ID as RTE_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___AES_ITN as AES_ITN", 
	"SQ_Shortcut_to_WM_STOP_PRE___BOL_BREAK_ATTR as BOL_BREAK_ATTR", 
	"SQ_Shortcut_to_WM_STOP_PRE___FREIGHT_TERMS as FREIGHT_TERMS", 
	"SQ_Shortcut_to_WM_STOP_PRE___ADDRESS_3 as ADDRESS_3", 
	"SQ_Shortcut_to_WM_STOP_PRE___DOCK_DOOR_LOCN_ID as DOCK_DOOR_LOCN_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___FLOOR_SHIPMENT as FLOOR_SHIPMENT", 
	"SQ_Shortcut_to_WM_STOP_PRE___HIBERNATE_VERSION as HIBERNATE_VERSION", 
	"SQ_Shortcut_to_WM_STOP_PRE___HITCH_TIME as HITCH_TIME", 
	"SQ_Shortcut_to_WM_STOP_PRE___LOAD_CLOSED_INDICATOR as LOAD_CLOSED_INDICATOR", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_TIME_MODIFIED as STOP_TIME_MODIFIED", 
	"SQ_Shortcut_to_WM_STOP_PRE___DRIVE_TIME as DRIVE_TIME", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_1 as REF_FIELD_1", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_2 as REF_FIELD_2", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_3 as REF_FIELD_3", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_4 as REF_FIELD_4", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_5 as REF_FIELD_5", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_6 as REF_FIELD_6", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_7 as REF_FIELD_7", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_8 as REF_FIELD_8", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_9 as REF_FIELD_9", 
	"SQ_Shortcut_to_WM_STOP_PRE___REF_FIELD_10 as REF_FIELD_10", 
	"SQ_Shortcut_to_WM_STOP_PRE___ORDER_WINDOW_VIOLATION as ORDER_WINDOW_VIOLATION", 
	"SQ_Shortcut_to_WM_STOP_PRE___DOCK_VIOLATION as DOCK_VIOLATION", 
	"SQ_Shortcut_to_WM_STOP_PRE___WAVE_OPTION_VIOLATION as WAVE_OPTION_VIOLATION", 
	"SQ_Shortcut_to_WM_STOP_PRE___STAGING_LOCN_ID as STAGING_LOCN_ID", 
	"SQ_Shortcut_to_WM_STOP_PRE___CALC_EST_ARRIVAL_DTTM as CALC_EST_ARRIVAL_DTTM", 
	"SQ_Shortcut_to_WM_STOP_PRE___DEGREE_LATE_EARLY as DEGREE_LATE_EARLY", 
	"SQ_Shortcut_to_WM_STOP_PRE___ON_STATIC_ROUTE as ON_STATIC_ROUTE", 
	"SQ_Shortcut_to_WM_STOP_PRE___AUTO_APPOINTMENT as AUTO_APPOINTMENT", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_REVENUE as STOP_REVENUE", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_REVENUE_CURRENCY_CODE as STOP_REVENUE_CURRENCY_CODE", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_MARGIN as STOP_MARGIN", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_MARGIN_CURRENCY_CODE as STOP_MARGIN_CURRENCY_CODE", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_COST as STOP_COST", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_COST_CURRENCY_CODE as STOP_COST_CURRENCY_CODE", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOP_LINEHAUL_REVENUE as STOP_LINEHAUL_REVENUE", 
	"SQ_Shortcut_to_WM_STOP_PRE___ACCESSORIAL_REVENUE as ACCESSORIAL_REVENUE", 
	"SQ_Shortcut_to_WM_STOP_PRE___STOPOFF_REVENUE as STOPOFF_REVENUE", 
	"SQ_Shortcut_to_WM_STOP_PRE___CM_DISCOUNT_REVENUE as CM_DISCOUNT_REVENUE", 
	"SQ_Shortcut_to_WM_STOP_PRE___LOAD_TSTMP as LOAD_TSTMP" 
)

# COMMAND ----------
# Processing node JNR_SITE_PROFILE, type JOINER 
# COLUMN COUNT: 125

JNR_SITE_PROFILE = SQ_Shortcut_to_SITE_PROFILE.join(EXP_TRANS,[SQ_Shortcut_to_SITE_PROFILE.STORE_NBR == EXP_TRANS.o_DC_NBR],'inner')

# COMMAND ----------
# Processing node JNR_WM_STOP, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 247

# for each involved DataFrame, append the dataframe name to each column
JNR_SITE_PROFILE_temp = JNR_SITE_PROFILE.toDF(*["JNR_SITE_PROFILE___" + col for col in JNR_SITE_PROFILE.columns])
SQ_Shortcut_to_WM_STOP_temp = SQ_Shortcut_to_WM_STOP.toDF(*["SQ_Shortcut_to_WM_STOP___" + col for col in SQ_Shortcut_to_WM_STOP.columns])

JNR_WM_STOP = SQ_Shortcut_to_WM_STOP_temp.join(JNR_SITE_PROFILE_temp,[SQ_Shortcut_to_WM_STOP_temp.SQ_Shortcut_to_WM_STOP___LOCATION_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___LOCATION_ID, SQ_Shortcut_to_WM_STOP_temp.SQ_Shortcut_to_WM_STOP___WM_SHIPMENT_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___SHIPMENT_ID, SQ_Shortcut_to_WM_STOP_temp.SQ_Shortcut_to_WM_STOP___WM_STOP_SEQ == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___STOP_SEQ],'right_outer').selectExpr( 
	"JNR_SITE_PROFILE___LOCATION_ID as LOCATION_ID", 
	"JNR_SITE_PROFILE___SHIPMENT_ID as SHIPMENT_ID", 
	"JNR_SITE_PROFILE___STOP_SEQ as STOP_SEQ", 
	"JNR_SITE_PROFILE___TC_COMPANY_ID as TC_COMPANY_ID", 
	"JNR_SITE_PROFILE___WAVE_ID as WAVE_ID", 
	"JNR_SITE_PROFILE___WAVE_OPTION_ID as WAVE_OPTION_ID", 
	"JNR_SITE_PROFILE___WAVE_OPTION_LIST_ID as WAVE_OPTION_LIST_ID", 
	"JNR_SITE_PROFILE___ARRIVAL_LATE_REASON_ID as ARRIVAL_LATE_REASON_ID", 
	"JNR_SITE_PROFILE___DEPARTURE_LATE_REASON_ID as DEPARTURE_LATE_REASON_ID", 
	"JNR_SITE_PROFILE___SIZE_UOM_ID as SIZE_UOM_ID", 
	"JNR_SITE_PROFILE___DOCK_DISPATCH_CAP_ID as DOCK_DISPATCH_CAP_ID", 
	"JNR_SITE_PROFILE___IS_APPT_REQD as IS_APPT_REQD", 
	"JNR_SITE_PROFILE___POS_ARR_START_DTTM as POS_ARR_START_DTTM", 
	"JNR_SITE_PROFILE___POS_ARR_END_DTTM as POS_ARR_END_DTTM", 
	"JNR_SITE_PROFILE___POS_DEPART_START_DTTM as POS_DEPART_START_DTTM", 
	"JNR_SITE_PROFILE___POS_DEPART_END_DTTM as POS_DEPART_END_DTTM", 
	"JNR_SITE_PROFILE___ARRIVAL_START_DTTM as ARRIVAL_START_DTTM", 
	"JNR_SITE_PROFILE___ARRIVAL_END_DTTM as ARRIVAL_END_DTTM", 
	"JNR_SITE_PROFILE___EST_ARRIVAL_DTTM as EST_ARRIVAL_DTTM", 
	"JNR_SITE_PROFILE___ARRIVAL_COMMIT_DTTM as ARRIVAL_COMMIT_DTTM", 
	"JNR_SITE_PROFILE___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", 
	"JNR_SITE_PROFILE___APPT_DTTM as APPT_DTTM", 
	"JNR_SITE_PROFILE___DEPARTURE_START_DTTM as DEPARTURE_START_DTTM", 
	"JNR_SITE_PROFILE___DEPARTURE_END_DTTM as DEPARTURE_END_DTTM", 
	"JNR_SITE_PROFILE___EST_DEPARTURE_DTTM as EST_DEPARTURE_DTTM", 
	"JNR_SITE_PROFILE___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", 
	"JNR_SITE_PROFILE___START_SHIPMENT_DTTM as START_SHIPMENT_DTTM", 
	"JNR_SITE_PROFILE___END_SHIPMENT_DTTM as END_SHIPMENT_DTTM", 
	"JNR_SITE_PROFILE___PAPERWORK_START_DTTM as PAPERWORK_START_DTTM", 
	"JNR_SITE_PROFILE___PICKUP_START_DTTM as PICKUP_START_DTTM", 
	"JNR_SITE_PROFILE___EST_DISPATCH_DTTM as EST_DISPATCH_DTTM", 
	"JNR_SITE_PROFILE___SHIPMENT_START_DTTM as SHIPMENT_START_DTTM", 
	"JNR_SITE_PROFILE___SHIPMENT_END_DTTM as SHIPMENT_END_DTTM", 
	"JNR_SITE_PROFILE___CHECKIN_TIME as CHECKIN_TIME", 
	"JNR_SITE_PROFILE___CHECKOUT_TIME as CHECKOUT_TIME", 
	"JNR_SITE_PROFILE___ARRIVAL_NET_DTTM as ARRIVAL_NET_DTTM", 
	"JNR_SITE_PROFILE___ARRIVAL_NLT_DTTM as ARRIVAL_NLT_DTTM", 
	"JNR_SITE_PROFILE___DEPARTURE_NET_DTTM as DEPARTURE_NET_DTTM", 
	"JNR_SITE_PROFILE___DEPARTURE_NLT_DTTM as DEPARTURE_NLT_DTTM", 
	"JNR_SITE_PROFILE___REC_ARRIVAL_DTTM as REC_ARRIVAL_DTTM", 
	"JNR_SITE_PROFILE___REC_DEPARTURE_DTTM as REC_DEPARTURE_DTTM", 
	"JNR_SITE_PROFILE___BREAK_TIME as BREAK_TIME", 
	"JNR_SITE_PROFILE___WAITING_TIME as WAITING_TIME", 
	"JNR_SITE_PROFILE___STOP_LOCATION_NAME as STOP_LOCATION_NAME", 
	"JNR_SITE_PROFILE___CONTACT_FIRST_NAME as CONTACT_FIRST_NAME", 
	"JNR_SITE_PROFILE___CONTACT_SURNAME as CONTACT_SURNAME", 
	"JNR_SITE_PROFILE___CONTACT_PHONE_NUMBER as CONTACT_PHONE_NUMBER", 
	"JNR_SITE_PROFILE___FACILITY_ALIAS_ID as FACILITY_ALIAS_ID", 
	"JNR_SITE_PROFILE___FACILITY_ID as FACILITY_ID", 
	"JNR_SITE_PROFILE___ADDRESS_1 as ADDRESS_1", 
	"JNR_SITE_PROFILE___ADDRESS_2 as ADDRESS_2", 
	"JNR_SITE_PROFILE___CITY as CITY", 
	"JNR_SITE_PROFILE___STATE_PROV as STATE_PROV", 
	"JNR_SITE_PROFILE___POSTAL_CODE as POSTAL_CODE", 
	"JNR_SITE_PROFILE___COUNTY as COUNTY", 
	"JNR_SITE_PROFILE___COUNTRY_CODE as COUNTRY_CODE", 
	"JNR_SITE_PROFILE___HANDLER as HANDLER", 
	"JNR_SITE_PROFILE___DISTANCE as DISTANCE", 
	"JNR_SITE_PROFILE___DISTANCE_UOM as DISTANCE_UOM", 
	"JNR_SITE_PROFILE___STOP_TZ as STOP_TZ", 
	"JNR_SITE_PROFILE___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", 
	"JNR_SITE_PROFILE___DROP_HOOK_INDICATOR as DROP_HOOK_INDICATOR", 
	"JNR_SITE_PROFILE___HANDLING_TIME as HANDLING_TIME", 
	"JNR_SITE_PROFILE___REPORTED_HANDLER as REPORTED_HANDLER", 
	"JNR_SITE_PROFILE___SEGMENT_ID as SEGMENT_ID", 
	"JNR_SITE_PROFILE___SEGMENT_STOP_SEQ as SEGMENT_STOP_SEQ", 
	"JNR_SITE_PROFILE___CAPACITY as CAPACITY", 
	"JNR_SITE_PROFILE___HAS_NOTES as HAS_NOTES", 
	"JNR_SITE_PROFILE___IS_ADDR_OVERRIDE as IS_ADDR_OVERRIDE", 
	"JNR_SITE_PROFILE___IS_RECONSIGNED as IS_RECONSIGNED", 
	"JNR_SITE_PROFILE___IS_EST_ARR_USER_DEFINED as IS_EST_ARR_USER_DEFINED", 
	"JNR_SITE_PROFILE___IS_EST_DEP_USER_DEFINED as IS_EST_DEP_USER_DEFINED", 
	"JNR_SITE_PROFILE___IS_WAVE_MAN_CHANGED as IS_WAVE_MAN_CHANGED", 
	"JNR_SITE_PROFILE___DELAY_TYPE as DELAY_TYPE", 
	"JNR_SITE_PROFILE___STOP_STATUS as STOP_STATUS", 
	"JNR_SITE_PROFILE___SEAL_NUMBER as SEAL_NUMBER", 
	"JNR_SITE_PROFILE___APPOINTMENT_DURATION as APPOINTMENT_DURATION", 
	"JNR_SITE_PROFILE___BOL_TYPE as BOL_TYPE", 
	"JNR_SITE_PROFILE___PRO_NBR as PRO_NBR", 
	"JNR_SITE_PROFILE___AUTH_NBR as AUTH_NBR", 
	"JNR_SITE_PROFILE___MANIF_TYPE as MANIF_TYPE", 
	"JNR_SITE_PROFILE___CURR_PLT_ID as CURR_PLT_ID", 
	"JNR_SITE_PROFILE___CONS_LOCN_ID as CONS_LOCN_ID", 
	"JNR_SITE_PROFILE___RTE_ID as RTE_ID", 
	"JNR_SITE_PROFILE___AES_ITN as AES_ITN", 
	"JNR_SITE_PROFILE___BOL_BREAK_ATTR as BOL_BREAK_ATTR", 
	"JNR_SITE_PROFILE___FREIGHT_TERMS as FREIGHT_TERMS", 
	"JNR_SITE_PROFILE___ADDRESS_3 as ADDRESS_3", 
	"JNR_SITE_PROFILE___DOCK_DOOR_LOCN_ID as DOCK_DOOR_LOCN_ID", 
	"JNR_SITE_PROFILE___FLOOR_SHIPMENT as FLOOR_SHIPMENT", 
	"JNR_SITE_PROFILE___HIBERNATE_VERSION as HIBERNATE_VERSION", 
	"JNR_SITE_PROFILE___HITCH_TIME as HITCH_TIME", 
	"JNR_SITE_PROFILE___LOAD_CLOSED_INDICATOR as LOAD_CLOSED_INDICATOR", 
	"JNR_SITE_PROFILE___STOP_TIME_MODIFIED as STOP_TIME_MODIFIED", 
	"JNR_SITE_PROFILE___DRIVE_TIME as DRIVE_TIME", 
	"JNR_SITE_PROFILE___REF_FIELD_1 as REF_FIELD_1", 
	"JNR_SITE_PROFILE___REF_FIELD_2 as REF_FIELD_2", 
	"JNR_SITE_PROFILE___REF_FIELD_3 as REF_FIELD_3", 
	"JNR_SITE_PROFILE___REF_FIELD_4 as REF_FIELD_4", 
	"JNR_SITE_PROFILE___REF_FIELD_5 as REF_FIELD_5", 
	"JNR_SITE_PROFILE___REF_FIELD_6 as REF_FIELD_6", 
	"JNR_SITE_PROFILE___REF_FIELD_7 as REF_FIELD_7", 
	"JNR_SITE_PROFILE___REF_FIELD_8 as REF_FIELD_8", 
	"JNR_SITE_PROFILE___REF_FIELD_9 as REF_FIELD_9", 
	"JNR_SITE_PROFILE___REF_FIELD_10 as REF_FIELD_10", 
	"JNR_SITE_PROFILE___ORDER_WINDOW_VIOLATION as ORDER_WINDOW_VIOLATION", 
	"JNR_SITE_PROFILE___DOCK_VIOLATION as DOCK_VIOLATION", 
	"JNR_SITE_PROFILE___WAVE_OPTION_VIOLATION as WAVE_OPTION_VIOLATION", 
	"JNR_SITE_PROFILE___STAGING_LOCN_ID as STAGING_LOCN_ID", 
	"JNR_SITE_PROFILE___CALC_EST_ARRIVAL_DTTM as CALC_EST_ARRIVAL_DTTM", 
	"JNR_SITE_PROFILE___DEGREE_LATE_EARLY as DEGREE_LATE_EARLY", 
	"JNR_SITE_PROFILE___ON_STATIC_ROUTE as ON_STATIC_ROUTE", 
	"JNR_SITE_PROFILE___AUTO_APPOINTMENT as AUTO_APPOINTMENT", 
	"JNR_SITE_PROFILE___STOP_REVENUE as STOP_REVENUE", 
	"JNR_SITE_PROFILE___STOP_REVENUE_CURRENCY_CODE as STOP_REVENUE_CURRENCY_CODE", 
	"JNR_SITE_PROFILE___STOP_MARGIN as STOP_MARGIN", 
	"JNR_SITE_PROFILE___STOP_MARGIN_CURRENCY_CODE as STOP_MARGIN_CURRENCY_CODE", 
	"JNR_SITE_PROFILE___STOP_COST as STOP_COST", 
	"JNR_SITE_PROFILE___STOP_COST_CURRENCY_CODE as STOP_COST_CURRENCY_CODE", 
	"JNR_SITE_PROFILE___STOP_LINEHAUL_REVENUE as STOP_LINEHAUL_REVENUE", 
	"JNR_SITE_PROFILE___ACCESSORIAL_REVENUE as ACCESSORIAL_REVENUE", 
	"JNR_SITE_PROFILE___STOPOFF_REVENUE as STOPOFF_REVENUE", 
	"JNR_SITE_PROFILE___CM_DISCOUNT_REVENUE as CM_DISCOUNT_REVENUE", 
	"SQ_Shortcut_to_WM_STOP___LOCATION_ID as i_LOCATION_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_SHIPMENT_ID as i_WM_SHIPMENT_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_STOP_SEQ as i_WM_STOP_SEQ", 
	"SQ_Shortcut_to_WM_STOP___LOAD_TSTMP as i_LOAD_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___WM_TC_COMPANY_ID as i_WM_TC_COMPANY_ID", 
	"SQ_Shortcut_to_WM_STOP___STOP_LOCATION_NAME as i_STOP_LOCATION_NAME", 
	"SQ_Shortcut_to_WM_STOP___WM_FACILITY_ID as i_WM_FACILITY_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_FACILITY_ALIAS_ID as i_WM_FACILITY_ALIAS_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_CONS_LOCN_ID as i_WM_CONS_LOCN_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_STAGING_LOCN_ID as i_WM_STAGING_LOCN_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_DOCK_DOOR_LOCN_ID as i_WM_DOCK_DOOR_LOCN_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_WAVE_ID as i_WM_WAVE_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_WAVE_OPTION_ID as i_WM_WAVE_OPTION_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_WAVE_OPTION_LIST_ID as i_WM_WAVE_OPTION_LIST_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_DOCK_DISPATCH_CAP_ID as i_WM_DOCK_DISPATCH_CAP_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_SEGMENT_ID as i_WM_SEGMENT_ID", 
	"SQ_Shortcut_to_WM_STOP___SEGMENT_STOP_SEQ as i_SEGMENT_STOP_SEQ", 
	"SQ_Shortcut_to_WM_STOP___HANDLER as i_HANDLER", 
	"SQ_Shortcut_to_WM_STOP___REPORTED_HANDLER as i_REPORTED_HANDLER", 
	"SQ_Shortcut_to_WM_STOP___DELAY_TYPE as i_DELAY_TYPE", 
	"SQ_Shortcut_to_WM_STOP___STOP_STATUS as i_STOP_STATUS", 
	"SQ_Shortcut_to_WM_STOP___WM_SEAL_NBR as i_WM_SEAL_NBR", 
	"SQ_Shortcut_to_WM_STOP___BILL_OF_LADING_NBR as i_BILL_OF_LADING_NBR", 
	"SQ_Shortcut_to_WM_STOP___BOL_TYPE as i_BOL_TYPE", 
	"SQ_Shortcut_to_WM_STOP___WM_PRO_NBR as i_WM_PRO_NBR", 
	"SQ_Shortcut_to_WM_STOP___WM_AUTH_NBR as i_WM_AUTH_NBR", 
	"SQ_Shortcut_to_WM_STOP___WM_MANIF_TYPE as i_WM_MANIF_TYPE", 
	"SQ_Shortcut_to_WM_STOP___WM_CURR_PLT_ID as i_WM_CURR_PLT_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_RTE_ID as i_WM_RTE_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_AES_ITN as i_WM_AES_ITN", 
	"SQ_Shortcut_to_WM_STOP___BOL_BREAK_ATTR as i_BOL_BREAK_ATTR", 
	"SQ_Shortcut_to_WM_STOP___FREIGHT_TERMS as i_FREIGHT_TERMS", 
	"SQ_Shortcut_to_WM_STOP___FLOOR_SHIPMENT as i_FLOOR_SHIPMENT", 
	"SQ_Shortcut_to_WM_STOP___ORDER_WINDOW_VIOLATION as i_ORDER_WINDOW_VIOLATION", 
	"SQ_Shortcut_to_WM_STOP___DOCK_VIOLATION as i_DOCK_VIOLATION", 
	"SQ_Shortcut_to_WM_STOP___WAVE_OPTION_VIOLATION as i_WAVE_OPTION_VIOLATION", 
	"SQ_Shortcut_to_WM_STOP___AUTO_APPOINTMENT_FLAG as AUTO_APPOINTMENT_FLAG", 
	"SQ_Shortcut_to_WM_STOP___APPT_REQD_FLAG as APPT_REQD_FLAG", 
	"SQ_Shortcut_to_WM_STOP___ADDR_OVERRIDE_FLAG as ADDR_OVERRIDE_FLAG", 
	"SQ_Shortcut_to_WM_STOP___LOAD_CLOSED_FLAG as LOAD_CLOSED_FLAG", 
	"SQ_Shortcut_to_WM_STOP___WAVE_MAN_CHANGED_FLAG as WAVE_MAN_CHANGED_FLAG", 
	"SQ_Shortcut_to_WM_STOP___ON_STATIC_ROUTE_FLAG as ON_STATIC_ROUTE_FLAG", 
	"SQ_Shortcut_to_WM_STOP___HAS_NOTES_FLAG as HAS_NOTES_FLAG", 
	"SQ_Shortcut_to_WM_STOP___RECONSIGNED_FLAG as RECONSIGNED_FLAG", 
	"SQ_Shortcut_to_WM_STOP___EST_ARR_USER_DEFINED_FLAG as EST_ARR_USER_DEFINED_FLAG", 
	"SQ_Shortcut_to_WM_STOP___EST_DEP_USER_DEFINED_FLAG as EST_DEP_USER_DEFINED_FLAG", 
	"SQ_Shortcut_to_WM_STOP___DROP_HOOK_FLAG as DROP_HOOK_FLAG", 
	"SQ_Shortcut_to_WM_STOP___CONTACT_FIRST_NAME as i_CONTACT_FIRST_NAME", 
	"SQ_Shortcut_to_WM_STOP___CONTACT_SURNAME as i_CONTACT_SURNAME", 
	"SQ_Shortcut_to_WM_STOP___ADDR_1 as i_ADDR_1", 
	"SQ_Shortcut_to_WM_STOP___ADDR_2 as i_ADDR_2", 
	"SQ_Shortcut_to_WM_STOP___ADDR_3 as i_ADDR_3", 
	"SQ_Shortcut_to_WM_STOP___CITY as i_CITY", 
	"SQ_Shortcut_to_WM_STOP___STATE_PROV as i_STATE_PROV", 
	"SQ_Shortcut_to_WM_STOP___POSTAL_CD as i_POSTAL_CD", 
	"SQ_Shortcut_to_WM_STOP___COUNTY as i_COUNTY", 
	"SQ_Shortcut_to_WM_STOP___COUNTRY_CD as i_COUNTRY_CD", 
	"SQ_Shortcut_to_WM_STOP___CONTACT_PHONE_NBR as i_CONTACT_PHONE_NBR", 
	"SQ_Shortcut_to_WM_STOP___APPT_TSTMP as i_APPT_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___APPOINTMENT_DURATION as i_APPOINTMENT_DURATION", 
	"SQ_Shortcut_to_WM_STOP___PAPERWORK_START_TSTMP as i_PAPERWORK_START_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___PICKUP_START_TSTMP as i_PICKUP_START_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___HANDLING_TIME as i_HANDLING_TIME", 
	"SQ_Shortcut_to_WM_STOP___BREAK_TIME as i_BREAK_TIME", 
	"SQ_Shortcut_to_WM_STOP___WAITING_TIME as i_WAITING_TIME", 
	"SQ_Shortcut_to_WM_STOP___HITCH_TIME as i_HITCH_TIME", 
	"SQ_Shortcut_to_WM_STOP___DRIVE_TIME as i_DRIVE_TIME", 
	"SQ_Shortcut_to_WM_STOP___STOP_TIME_MODIFIED as i_STOP_TIME_MODIFIED", 
	"SQ_Shortcut_to_WM_STOP___DISTANCE as i_DISTANCE", 
	"SQ_Shortcut_to_WM_STOP___DISTANCE_UOM as i_DISTANCE_UOM", 
	"SQ_Shortcut_to_WM_STOP___EST_DISPATCH_TSTMP as i_EST_DISPATCH_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___POS_ARR_START_TSTMP as i_POS_ARR_START_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___POS_ARR_END_TSTMP as i_POS_ARR_END_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___POS_DEPART_START_TSTMP as i_POS_DEPART_START_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___POS_DEPART_END_TSTMP as i_POS_DEPART_END_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___ARRIVAL_START_TSTMP as i_ARRIVAL_START_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___ARRIVAL_END_TSTMP as i_ARRIVAL_END_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___EST_ARRIVAL_TSTMP as i_EST_ARRIVAL_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___CALC_EST_ARRIVAL_TSTMP as i_CALC_EST_ARRIVAL_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___ARRIVAL_COMMIT_TSTMP as i_ARRIVAL_COMMIT_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___ACTUAL_ARRIVAL_TSTMP as i_ACTUAL_ARRIVAL_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___DEPARTURE_START_TSTMP as i_DEPARTURE_START_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___DEPARTURE_END_TSTMP as i_DEPARTURE_END_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___EST_DEPARTURE_TSTMP as i_EST_DEPARTURE_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___ACTUAL_DEPARTURE_TSTMP as i_ACTUAL_DEPARTURE_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___START_SHIPMENT_TSTMP as i_START_SHIPMENT_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___END_SHIPMENT_TSTMP as i_END_SHIPMENT_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___SHIPMENT_START_TSTMP as i_SHIPMENT_START_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___SHIPMENT_END_TSTMP as i_SHIPMENT_END_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___CHECK_IN_TSTMP as i_CHECK_IN_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___CHECK_OUT_TSTMP as i_CHECK_OUT_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___ARRIVAL_NET_TSTMP as i_ARRIVAL_NET_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___ARRIVAL_NLT_TSTMP as i_ARRIVAL_NLT_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___DEPARTURE_NET_TSTMP as i_DEPARTURE_NET_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___DEPARTURE_NLT_TSTMP as i_DEPARTURE_NLT_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___REC_ARRIVAL_TSTMP as i_REC_ARRIVAL_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___REC_DEPARTURE_TSTMP as i_REC_DEPARTURE_TSTMP", 
	"SQ_Shortcut_to_WM_STOP___WM_STOP_TZ as i_WM_STOP_TZ", 
	"SQ_Shortcut_to_WM_STOP___DEGREE_LATE_EARLY as i_DEGREE_LATE_EARLY", 
	"SQ_Shortcut_to_WM_STOP___WM_ARRIVAL_LATE_REASON_ID as i_WM_ARRIVAL_LATE_REASON_ID", 
	"SQ_Shortcut_to_WM_STOP___WM_DEPARTURE_LATE_REASON_ID as i_WM_DEPARTURE_LATE_REASON_ID", 
	"SQ_Shortcut_to_WM_STOP___STOP_REVENUE as i_STOP_REVENUE", 
	"SQ_Shortcut_to_WM_STOP___STOP_REVENUE_CURRENCY_CD as i_STOP_REVENUE_CURRENCY_CD", 
	"SQ_Shortcut_to_WM_STOP___STOP_MARGIN as i_STOP_MARGIN", 
	"SQ_Shortcut_to_WM_STOP___STOP_MARGIN_CURRENCY_CD as i_STOP_MARGIN_CURRENCY_CD", 
	"SQ_Shortcut_to_WM_STOP___STOP_COST as i_STOP_COST", 
	"SQ_Shortcut_to_WM_STOP___STOP_COST_CURRENCY_CD as i_STOP_COST_CURRENCY_CD", 
	"SQ_Shortcut_to_WM_STOP___STOP_LINEHAUL_REVENUE as i_STOP_LINEHAUL_REVENUE", 
	"SQ_Shortcut_to_WM_STOP___ACCESSORIAL_REVENUE as i_ACCESSORIAL_REVENUE", 
	"SQ_Shortcut_to_WM_STOP___STOP_OFF_REVENUE as i_STOP_OFF_REVENUE", 
	"SQ_Shortcut_to_WM_STOP___CM_DISCOUNT_REVENUE as i_CM_DISCOUNT_REVENUE", 
	"SQ_Shortcut_to_WM_STOP___CAPACITY as i_CAPACITY", 
	"SQ_Shortcut_to_WM_STOP___WM_SIZE_UOM_ID as i_WM_SIZE_UOM_ID", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_1 as i_REF_FIELD_1", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_2 as i_REF_FIELD_2", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_3 as i_REF_FIELD_3", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_4 as i_REF_FIELD_4", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_5 as i_REF_FIELD_5", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_6 as i_REF_FIELD_6", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_7 as i_REF_FIELD_7", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_8 as i_REF_FIELD_8", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_9 as i_REF_FIELD_9", 
	"SQ_Shortcut_to_WM_STOP___REF_FIELD_10 as i_REF_FIELD_10", 
	"SQ_Shortcut_to_WM_STOP___WM_HIBERNATE_VERSION as i_WM_HIBERNATE_VERSION")

# COMMAND ----------
# Processing node FIL_UNCHANGED_RECORDS, type FILTER 
# COLUMN COUNT: 247

# for each involved DataFrame, append the dataframe name to each column
JNR_WM_STOP_temp = JNR_WM_STOP.toDF(*["JNR_WM_STOP___" + col for col in JNR_WM_STOP.columns])

_filter = """
i_WM_SHIPMENT_ID IS NULL OR i_WM_STOP_SEQ IS NULL OR
(
   IF ( TC_COMPANY_ID IS NULL, 0 , TC_COMPANY_ID ) != IF ( i_WM_TC_COMPANY_ID IS NULL, 0 , i_WM_TC_COMPANY_ID )
OR IF ( STOP_LOCATION_NAME IS NULL, '' , STOP_LOCATION_NAME ) != IF ( i_STOP_LOCATION_NAME IS NULL, '' , i_STOP_LOCATION_NAME )
OR IF ( FACILITY_ID IS NULL, 0 , FACILITY_ID ) != IF ( i_WM_FACILITY_ID IS NULL, 0 , i_WM_FACILITY_ID )
OR IF ( FACILITY_ALIAS_ID IS NULL, '' , FACILITY_ALIAS_ID ) != IF ( i_WM_FACILITY_ALIAS_ID IS NULL, '' , i_WM_FACILITY_ALIAS_ID )
OR IF ( CONS_LOCN_ID IS NULL, '' , CONS_LOCN_ID ) != IF ( i_WM_CONS_LOCN_ID IS NULL, '' , i_WM_CONS_LOCN_ID )
OR IF ( STAGING_LOCN_ID IS NULL, '' , STAGING_LOCN_ID ) != IF ( i_WM_STAGING_LOCN_ID IS NULL, '' , i_WM_STAGING_LOCN_ID )
OR IF ( DOCK_DOOR_LOCN_ID IS NULL, '' , DOCK_DOOR_LOCN_ID ) != IF ( i_WM_DOCK_DOOR_LOCN_ID IS NULL, '' , i_WM_DOCK_DOOR_LOCN_ID )
OR IF ( WAVE_ID IS NULL, 0 , WAVE_ID ) != IF ( i_WM_WAVE_ID IS NULL, 0 , i_WM_WAVE_ID )
OR IF ( WAVE_OPTION_ID IS NULL, 0 , WAVE_OPTION_ID ) != IF ( i_WM_WAVE_OPTION_ID IS NULL, 0 , i_WM_WAVE_OPTION_ID )
OR IF ( WAVE_OPTION_LIST_ID IS NULL, 0 , WAVE_OPTION_LIST_ID ) != IF ( i_WM_WAVE_OPTION_LIST_ID IS NULL, 0 , i_WM_WAVE_OPTION_LIST_ID )
OR IF ( DOCK_DISPATCH_CAP_ID IS NULL, 0 , DOCK_DISPATCH_CAP_ID ) != IF ( i_WM_DOCK_DISPATCH_CAP_ID IS NULL, 0 , i_WM_DOCK_DISPATCH_CAP_ID )
OR IF ( SEGMENT_ID IS NULL, 0 , SEGMENT_ID ) != IF ( i_WM_SEGMENT_ID IS NULL, 0 , i_WM_SEGMENT_ID )
OR IF ( SEGMENT_STOP_SEQ IS NULL, 0 , SEGMENT_STOP_SEQ ) != IF ( i_SEGMENT_STOP_SEQ IS NULL, 0 , i_SEGMENT_STOP_SEQ )
OR IF ( HANDLER IS NULL, 0 , HANDLER ) != IF ( i_HANDLER IS NULL, 0 , i_HANDLER )
OR IF ( REPORTED_HANDLER IS NULL, 0 , REPORTED_HANDLER ) != IF ( i_REPORTED_HANDLER IS NULL, 0 , i_REPORTED_HANDLER )
OR IF ( DELAY_TYPE IS NULL, 0 , DELAY_TYPE ) != IF ( i_DELAY_TYPE IS NULL, 0 , i_DELAY_TYPE )
OR IF ( STOP_STATUS IS NULL, 0 , STOP_STATUS ) != IF ( i_STOP_STATUS IS NULL, 0 , i_STOP_STATUS )
OR IF ( SEAL_NUMBER IS NULL, '' , SEAL_NUMBER ) != IF ( i_WM_SEAL_NBR IS NULL, '' , i_WM_SEAL_NBR )
OR IF ( BILL_OF_LADING_NUMBER IS NULL, '' , BILL_OF_LADING_NUMBER ) != IF ( i_BILL_OF_LADING_NBR IS NULL, '' , i_BILL_OF_LADING_NBR )
OR IF ( BOL_TYPE IS NULL, 0 , BOL_TYPE ) != IF ( i_BOL_TYPE IS NULL, 0 , i_BOL_TYPE )
OR IF ( PRO_NBR IS NULL, '' , PRO_NBR ) != IF ( i_WM_PRO_NBR IS NULL, '' , i_WM_PRO_NBR )
OR IF ( AUTH_NBR IS NULL, '' , AUTH_NBR ) != IF ( i_WM_AUTH_NBR IS NULL, '' , i_WM_AUTH_NBR )
OR IF ( MANIF_TYPE IS NULL, '' , MANIF_TYPE ) != IF ( i_WM_MANIF_TYPE IS NULL, '' , i_WM_MANIF_TYPE )
OR IF ( CURR_PLT_ID IS NULL, '' , CURR_PLT_ID ) != IF ( i_WM_CURR_PLT_ID IS NULL, '' , i_WM_CURR_PLT_ID )
OR IF ( RTE_ID IS NULL, '' , RTE_ID ) != IF ( i_WM_RTE_ID IS NULL, '' , i_WM_RTE_ID )
OR IF ( AES_ITN IS NULL, '' , AES_ITN ) != IF ( i_WM_AES_ITN IS NULL, '' , i_WM_AES_ITN )
OR IF ( BOL_BREAK_ATTR IS NULL, '' , BOL_BREAK_ATTR ) != IF ( i_BOL_BREAK_ATTR IS NULL, '' , i_BOL_BREAK_ATTR )
OR IF ( FREIGHT_TERMS IS NULL, '' , FREIGHT_TERMS ) != IF ( i_FREIGHT_TERMS IS NULL, '' , i_FREIGHT_TERMS )
OR IF ( FLOOR_SHIPMENT IS NULL, '' , FLOOR_SHIPMENT ) != IF ( i_FLOOR_SHIPMENT IS NULL, '' , i_FLOOR_SHIPMENT )
OR IF ( ORDER_WINDOW_VIOLATION IS NULL, 0 , ORDER_WINDOW_VIOLATION ) != IF ( i_ORDER_WINDOW_VIOLATION IS NULL, 0 , i_ORDER_WINDOW_VIOLATION )
OR IF ( DOCK_VIOLATION IS NULL, 0 , DOCK_VIOLATION ) != IF ( i_DOCK_VIOLATION IS NULL, 0 , i_DOCK_VIOLATION )
OR IF ( WAVE_OPTION_VIOLATION IS NULL, 0 , WAVE_OPTION_VIOLATION ) != IF ( i_WAVE_OPTION_VIOLATION IS NULL, 0 , i_WAVE_OPTION_VIOLATION )
OR IF ( AUTO_APPOINTMENT IS NULL, 0 , AUTO_APPOINTMENT ) != IF ( AUTO_APPOINTMENT_FLAG IS NULL, 0 , AUTO_APPOINTMENT_FLAG )
OR IF ( IS_APPT_REQD IS NULL, 0 , IS_APPT_REQD ) != IF ( APPT_REQD_FLAG IS NULL, 0 , APPT_REQD_FLAG )
OR IF ( IS_ADDR_OVERRIDE IS NULL, 0 , IS_ADDR_OVERRIDE ) != IF ( ADDR_OVERRIDE_FLAG IS NULL, 0 , ADDR_OVERRIDE_FLAG )
OR IF ( LOAD_CLOSED_INDICATOR IS NULL, 0 , LOAD_CLOSED_INDICATOR ) != IF ( LOAD_CLOSED_FLAG IS NULL, 0 , LOAD_CLOSED_FLAG )
OR IF ( IS_WAVE_MAN_CHANGED IS NULL, 0 , IS_WAVE_MAN_CHANGED ) != IF ( WAVE_MAN_CHANGED_FLAG IS NULL, 0 , WAVE_MAN_CHANGED_FLAG )
OR IF ( ON_STATIC_ROUTE IS NULL, 0 , ON_STATIC_ROUTE ) != IF ( ON_STATIC_ROUTE_FLAG IS NULL, 0 , ON_STATIC_ROUTE_FLAG )
OR IF ( HAS_NOTES IS NULL, 0 , HAS_NOTES ) != IF ( HAS_NOTES_FLAG IS NULL, 0 , HAS_NOTES_FLAG )
OR IF ( IS_RECONSIGNED IS NULL, 0 , IS_RECONSIGNED ) != IF ( RECONSIGNED_FLAG IS NULL, 0 , RECONSIGNED_FLAG )
OR IF ( IS_EST_ARR_USER_DEFINED IS NULL, 0 , IS_EST_ARR_USER_DEFINED ) != IF ( EST_ARR_USER_DEFINED_FLAG IS NULL, 0 , EST_ARR_USER_DEFINED_FLAG )
OR IF ( IS_EST_DEP_USER_DEFINED IS NULL, 0 , IS_EST_DEP_USER_DEFINED ) != IF ( EST_DEP_USER_DEFINED_FLAG IS NULL, 0 , EST_DEP_USER_DEFINED_FLAG )
OR IF ( DROP_HOOK_INDICATOR IS NULL, 0 , DROP_HOOK_INDICATOR ) != IF ( DROP_HOOK_FLAG IS NULL, 0 , DROP_HOOK_FLAG )
OR IF ( CONTACT_FIRST_NAME IS NULL, '' , CONTACT_FIRST_NAME ) != IF ( i_CONTACT_FIRST_NAME IS NULL, '' , i_CONTACT_FIRST_NAME )
OR IF ( CONTACT_SURNAME IS NULL, '' , CONTACT_SURNAME ) != IF ( i_CONTACT_SURNAME IS NULL, '' , i_CONTACT_SURNAME )
OR IF ( ADDRESS_1 IS NULL, '' , ADDRESS_1 ) != IF ( i_ADDR_1 IS NULL, '' , i_ADDR_1 )
OR IF ( ADDRESS_2 IS NULL, '' , ADDRESS_2 ) != IF ( i_ADDR_2 IS NULL, '' , i_ADDR_2 )
OR IF ( ADDRESS_3 IS NULL, '' , ADDRESS_3 ) != IF ( i_ADDR_3 IS NULL, '' , i_ADDR_3 )
OR IF ( CITY IS NULL, '' , CITY ) != IF ( i_CITY IS NULL, '' , i_CITY )
OR IF ( STATE_PROV IS NULL, '' , STATE_PROV ) != IF ( i_STATE_PROV IS NULL, '' , i_STATE_PROV )
OR IF ( POSTAL_CODE IS NULL, '' , POSTAL_CODE ) != IF ( i_POSTAL_CD IS NULL, '' , i_POSTAL_CD )
OR IF ( COUNTY IS NULL, '' , COUNTY ) != IF ( i_COUNTY IS NULL, '' , i_COUNTY )
OR IF ( COUNTRY_CODE IS NULL, '' , COUNTRY_CODE ) != IF ( i_COUNTRY_CD IS NULL, '' , i_COUNTRY_CD )
OR IF ( CONTACT_PHONE_NUMBER IS NULL, '' , CONTACT_PHONE_NUMBER ) != IF ( i_CONTACT_PHONE_NBR IS NULL, '' , i_CONTACT_PHONE_NBR )
OR IF ( APPT_DTTM IS NULL, date'1900-01-01', APPT_DTTM ) != IF ( i_APPT_TSTMP IS NULL, date'1900-01-01', i_APPT_TSTMP )
OR IF ( APPOINTMENT_DURATION IS NULL, 0 , APPOINTMENT_DURATION ) != IF ( i_APPOINTMENT_DURATION IS NULL, 0 , i_APPOINTMENT_DURATION )
OR IF ( PAPERWORK_START_DTTM IS NULL, date'1900-01-01', PAPERWORK_START_DTTM ) != IF ( i_PAPERWORK_START_TSTMP IS NULL, date'1900-01-01', i_PAPERWORK_START_TSTMP )
OR IF ( PICKUP_START_DTTM IS NULL, date'1900-01-01', PICKUP_START_DTTM ) != IF ( i_PICKUP_START_TSTMP IS NULL, date'1900-01-01', i_PICKUP_START_TSTMP )
OR IF ( HANDLING_TIME IS NULL, 0 , HANDLING_TIME ) != IF ( i_HANDLING_TIME IS NULL, 0 , i_HANDLING_TIME )
OR IF ( BREAK_TIME IS NULL, 0 , BREAK_TIME ) != IF ( i_BREAK_TIME IS NULL, 0 , i_BREAK_TIME )
OR IF ( WAITING_TIME IS NULL, 0 , WAITING_TIME ) != IF ( i_WAITING_TIME IS NULL, 0 , i_WAITING_TIME )
OR IF ( HITCH_TIME IS NULL, 0 , HITCH_TIME ) != IF ( i_HITCH_TIME IS NULL, 0 , i_HITCH_TIME )
OR IF ( DRIVE_TIME IS NULL, 0 , DRIVE_TIME ) != IF ( i_DRIVE_TIME IS NULL, 0 , i_DRIVE_TIME )
OR IF ( STOP_TIME_MODIFIED IS NULL, 0 , STOP_TIME_MODIFIED ) != IF ( i_STOP_TIME_MODIFIED IS NULL, 0 , i_STOP_TIME_MODIFIED )
OR IF ( DISTANCE IS NULL, 0 , DISTANCE ) != IF ( i_DISTANCE IS NULL, 0 , i_DISTANCE )
OR IF ( DISTANCE_UOM IS NULL, '' , DISTANCE_UOM ) != IF ( i_DISTANCE_UOM IS NULL, '' , i_DISTANCE_UOM )
OR IF ( EST_DISPATCH_DTTM IS NULL, date'1900-01-01', EST_DISPATCH_DTTM ) != IF ( i_EST_DISPATCH_TSTMP IS NULL, date'1900-01-01', i_EST_DISPATCH_TSTMP )
OR IF ( POS_ARR_START_DTTM IS NULL, date'1900-01-01', POS_ARR_START_DTTM ) != IF ( i_POS_ARR_START_TSTMP IS NULL, date'1900-01-01', i_POS_ARR_START_TSTMP )
OR IF ( POS_ARR_END_DTTM IS NULL, date'1900-01-01', POS_ARR_END_DTTM ) != IF ( i_POS_ARR_END_TSTMP IS NULL, date'1900-01-01', i_POS_ARR_END_TSTMP )
OR IF ( POS_DEPART_START_DTTM IS NULL, date'1900-01-01', POS_DEPART_START_DTTM ) != IF ( i_POS_DEPART_START_TSTMP IS NULL, date'1900-01-01', i_POS_DEPART_START_TSTMP )
OR IF ( POS_DEPART_END_DTTM IS NULL, date'1900-01-01', POS_DEPART_END_DTTM ) != IF ( i_POS_DEPART_END_TSTMP IS NULL, date'1900-01-01', i_POS_DEPART_END_TSTMP )
OR IF ( ARRIVAL_START_DTTM IS NULL, date'1900-01-01', ARRIVAL_START_DTTM ) != IF ( i_ARRIVAL_START_TSTMP IS NULL, date'1900-01-01', i_ARRIVAL_START_TSTMP )
OR IF ( ARRIVAL_END_DTTM IS NULL, date'1900-01-01', ARRIVAL_END_DTTM ) != IF ( i_ARRIVAL_END_TSTMP IS NULL, date'1900-01-01', i_ARRIVAL_END_TSTMP )
OR IF ( EST_ARRIVAL_DTTM IS NULL, date'1900-01-01', EST_ARRIVAL_DTTM ) != IF ( i_EST_ARRIVAL_TSTMP IS NULL, date'1900-01-01', i_EST_ARRIVAL_TSTMP )
OR IF ( CALC_EST_ARRIVAL_DTTM IS NULL, date'1900-01-01', CALC_EST_ARRIVAL_DTTM ) != IF ( i_CALC_EST_ARRIVAL_TSTMP IS NULL, date'1900-01-01', i_CALC_EST_ARRIVAL_TSTMP )
OR IF ( ARRIVAL_COMMIT_DTTM IS NULL, date'1900-01-01', ARRIVAL_COMMIT_DTTM ) != IF ( i_ARRIVAL_COMMIT_TSTMP IS NULL, date'1900-01-01', i_ARRIVAL_COMMIT_TSTMP )
OR IF ( ACTUAL_ARRIVAL_DTTM IS NULL, date'1900-01-01', ACTUAL_ARRIVAL_DTTM ) != IF ( i_ACTUAL_ARRIVAL_TSTMP IS NULL, date'1900-01-01', i_ACTUAL_ARRIVAL_TSTMP )
OR IF ( DEPARTURE_START_DTTM IS NULL, date'1900-01-01', DEPARTURE_START_DTTM ) != IF ( i_DEPARTURE_START_TSTMP IS NULL, date'1900-01-01', i_DEPARTURE_START_TSTMP )
OR IF ( DEPARTURE_END_DTTM IS NULL, date'1900-01-01', DEPARTURE_END_DTTM ) != IF ( i_DEPARTURE_END_TSTMP IS NULL, date'1900-01-01', i_DEPARTURE_END_TSTMP )
OR IF ( EST_DEPARTURE_DTTM IS NULL, date'1900-01-01', EST_DEPARTURE_DTTM ) != IF ( i_EST_DEPARTURE_TSTMP IS NULL, date'1900-01-01', i_EST_DEPARTURE_TSTMP )
OR IF ( ACTUAL_DEPARTURE_DTTM IS NULL, date'1900-01-01', ACTUAL_DEPARTURE_DTTM ) != IF ( i_ACTUAL_DEPARTURE_TSTMP IS NULL, date'1900-01-01', i_ACTUAL_DEPARTURE_TSTMP )
OR IF ( START_SHIPMENT_DTTM IS NULL, date'1900-01-01', START_SHIPMENT_DTTM ) != IF ( i_START_SHIPMENT_TSTMP IS NULL, date'1900-01-01', i_START_SHIPMENT_TSTMP )
OR IF ( END_SHIPMENT_DTTM IS NULL, date'1900-01-01', END_SHIPMENT_DTTM ) != IF ( i_END_SHIPMENT_TSTMP IS NULL, date'1900-01-01', i_END_SHIPMENT_TSTMP )
OR IF ( SHIPMENT_START_DTTM IS NULL, date'1900-01-01', SHIPMENT_START_DTTM ) != IF ( i_SHIPMENT_START_TSTMP IS NULL, date'1900-01-01', i_SHIPMENT_START_TSTMP )
OR IF ( SHIPMENT_END_DTTM IS NULL, date'1900-01-01', SHIPMENT_END_DTTM ) != IF ( i_SHIPMENT_END_TSTMP IS NULL, date'1900-01-01', i_SHIPMENT_END_TSTMP )
OR IF ( CHECKIN_TIME IS NULL, date'1900-01-01', CHECKIN_TIME ) != IF ( i_CHECK_IN_TSTMP IS NULL, date'1900-01-01', i_CHECK_IN_TSTMP )
OR IF ( CHECKOUT_TIME IS NULL, date'1900-01-01', CHECKOUT_TIME ) != IF ( i_CHECK_OUT_TSTMP IS NULL, date'1900-01-01', i_CHECK_OUT_TSTMP )
OR IF ( ARRIVAL_NET_DTTM IS NULL, date'1900-01-01', ARRIVAL_NET_DTTM ) != IF ( i_ARRIVAL_NET_TSTMP IS NULL, date'1900-01-01', i_ARRIVAL_NET_TSTMP )
OR IF ( ARRIVAL_NLT_DTTM IS NULL, date'1900-01-01', ARRIVAL_NLT_DTTM ) != IF ( i_ARRIVAL_NLT_TSTMP IS NULL, date'1900-01-01', i_ARRIVAL_NLT_TSTMP )
OR IF ( DEPARTURE_NET_DTTM IS NULL, date'1900-01-01', DEPARTURE_NET_DTTM ) != IF ( i_DEPARTURE_NET_TSTMP IS NULL, date'1900-01-01', i_DEPARTURE_NET_TSTMP )
OR IF ( DEPARTURE_NLT_DTTM IS NULL, date'1900-01-01', DEPARTURE_NLT_DTTM ) != IF ( i_DEPARTURE_NLT_TSTMP IS NULL, date'1900-01-01', i_DEPARTURE_NLT_TSTMP )
OR IF ( REC_ARRIVAL_DTTM IS NULL, date'1900-01-01', REC_ARRIVAL_DTTM ) != IF ( i_REC_ARRIVAL_TSTMP IS NULL, date'1900-01-01', i_REC_ARRIVAL_TSTMP )
OR IF ( REC_DEPARTURE_DTTM IS NULL, date'1900-01-01', REC_DEPARTURE_DTTM ) != IF ( i_REC_DEPARTURE_TSTMP IS NULL, date'1900-01-01', i_REC_DEPARTURE_TSTMP )
OR IF ( STOP_TZ IS NULL, 0 , STOP_TZ ) != IF ( i_WM_STOP_TZ IS NULL, 0 , i_WM_STOP_TZ )
OR IF ( DEGREE_LATE_EARLY IS NULL, 0 , DEGREE_LATE_EARLY ) != IF ( i_DEGREE_LATE_EARLY IS NULL, 0 , i_DEGREE_LATE_EARLY )
OR IF ( ARRIVAL_LATE_REASON_ID IS NULL, 0 , ARRIVAL_LATE_REASON_ID ) != IF ( i_WM_ARRIVAL_LATE_REASON_ID IS NULL, 0 , i_WM_ARRIVAL_LATE_REASON_ID )
OR IF ( DEPARTURE_LATE_REASON_ID IS NULL, 0 , DEPARTURE_LATE_REASON_ID ) != IF ( i_WM_DEPARTURE_LATE_REASON_ID IS NULL, 0 , i_WM_DEPARTURE_LATE_REASON_ID )
OR IF ( STOP_REVENUE IS NULL, 0 , STOP_REVENUE ) != IF ( i_STOP_REVENUE IS NULL, 0 , i_STOP_REVENUE )
OR IF ( STOP_REVENUE_CURRENCY_CODE IS NULL, '' , STOP_REVENUE_CURRENCY_CODE ) != IF ( i_STOP_REVENUE_CURRENCY_CD IS NULL, '' , i_STOP_REVENUE_CURRENCY_CD )
OR IF ( STOP_MARGIN IS NULL, 0 , STOP_MARGIN ) != IF ( i_STOP_MARGIN IS NULL, 0 , i_STOP_MARGIN )
OR IF ( STOP_MARGIN_CURRENCY_CODE IS NULL, '' , STOP_MARGIN_CURRENCY_CODE ) != IF ( i_STOP_MARGIN_CURRENCY_CD IS NULL, '' , i_STOP_MARGIN_CURRENCY_CD )
OR IF ( STOP_COST IS NULL, 0 , STOP_COST ) != IF ( i_STOP_COST IS NULL, 0 , i_STOP_COST )
OR IF ( STOP_COST_CURRENCY_CODE IS NULL, '' , STOP_COST_CURRENCY_CODE ) != IF ( i_STOP_COST_CURRENCY_CD IS NULL, '' , i_STOP_COST_CURRENCY_CD )
OR IF ( STOP_LINEHAUL_REVENUE IS NULL, 0 , STOP_LINEHAUL_REVENUE ) != IF ( i_STOP_LINEHAUL_REVENUE IS NULL, 0 , i_STOP_LINEHAUL_REVENUE )
OR IF ( ACCESSORIAL_REVENUE IS NULL, 0 , ACCESSORIAL_REVENUE ) != IF ( i_ACCESSORIAL_REVENUE IS NULL, 0 , i_ACCESSORIAL_REVENUE )
OR IF ( STOPOFF_REVENUE IS NULL, 0 , STOPOFF_REVENUE ) != IF ( i_STOP_OFF_REVENUE IS NULL, 0 , i_STOP_OFF_REVENUE )
OR IF ( CM_DISCOUNT_REVENUE IS NULL, 0 , CM_DISCOUNT_REVENUE ) != IF ( i_CM_DISCOUNT_REVENUE IS NULL, 0 , i_CM_DISCOUNT_REVENUE )
OR IF ( CAPACITY IS NULL, 0 , CAPACITY ) != IF ( i_CAPACITY IS NULL, 0 , i_CAPACITY )
OR IF ( SIZE_UOM_ID IS NULL, 0 , SIZE_UOM_ID ) != IF ( i_WM_SIZE_UOM_ID IS NULL, 0 , i_WM_SIZE_UOM_ID )
OR IF ( REF_FIELD_1 IS NULL, '' , REF_FIELD_1 ) != IF ( i_REF_FIELD_1 IS NULL, '' , i_REF_FIELD_1 )
OR IF ( REF_FIELD_2 IS NULL, '' , REF_FIELD_2 ) != IF ( i_REF_FIELD_2 IS NULL, '' , i_REF_FIELD_2 )
OR IF ( REF_FIELD_3 IS NULL, '' , REF_FIELD_3 ) != IF ( i_REF_FIELD_3 IS NULL, '' , i_REF_FIELD_3 )
OR IF ( REF_FIELD_4 IS NULL, '' , REF_FIELD_4 ) != IF ( i_REF_FIELD_4 IS NULL, '' , i_REF_FIELD_4 )
OR IF ( REF_FIELD_5 IS NULL, '' , REF_FIELD_5 ) != IF ( i_REF_FIELD_5 IS NULL, '' , i_REF_FIELD_5 )
OR IF ( REF_FIELD_6 IS NULL, '' , REF_FIELD_6 ) != IF ( i_REF_FIELD_6 IS NULL, '' , i_REF_FIELD_6 )
OR IF ( REF_FIELD_7 IS NULL, '' , REF_FIELD_7 ) != IF ( i_REF_FIELD_7 IS NULL, '' , i_REF_FIELD_7 )
OR IF ( REF_FIELD_8 IS NULL, '' , REF_FIELD_8 ) != IF ( i_REF_FIELD_8 IS NULL, '' , i_REF_FIELD_8 )
OR IF ( REF_FIELD_9 IS NULL, '' , REF_FIELD_9 ) != IF ( i_REF_FIELD_9 IS NULL, '' , i_REF_FIELD_9 )
OR IF ( REF_FIELD_10 IS NULL, '' , REF_FIELD_10 ) != IF ( i_REF_FIELD_10 IS NULL, '' , i_REF_FIELD_10 )
OR IF ( HIBERNATE_VERSION IS NULL, 0 , HIBERNATE_VERSION ) != IF ( i_WM_HIBERNATE_VERSION IS NULL, 0 , i_WM_HIBERNATE_VERSION ) 
)
"""

FIL_UNCHANGED_RECORDS = JNR_WM_STOP_temp.selectExpr( 
	"JNR_WM_STOP___LOCATION_ID as LOCATION_ID", 
	"JNR_WM_STOP___SHIPMENT_ID as SHIPMENT_ID", 
	"JNR_WM_STOP___STOP_SEQ as STOP_SEQ", 
	"JNR_WM_STOP___TC_COMPANY_ID as TC_COMPANY_ID", 
	"JNR_WM_STOP___WAVE_ID as WAVE_ID", 
	"JNR_WM_STOP___WAVE_OPTION_ID as WAVE_OPTION_ID", 
	"JNR_WM_STOP___WAVE_OPTION_LIST_ID as WAVE_OPTION_LIST_ID", 
	"JNR_WM_STOP___ARRIVAL_LATE_REASON_ID as ARRIVAL_LATE_REASON_ID", 
	"JNR_WM_STOP___DEPARTURE_LATE_REASON_ID as DEPARTURE_LATE_REASON_ID", 
	"JNR_WM_STOP___SIZE_UOM_ID as SIZE_UOM_ID", 
	"JNR_WM_STOP___DOCK_DISPATCH_CAP_ID as DOCK_DISPATCH_CAP_ID", 
	"JNR_WM_STOP___IS_APPT_REQD as IS_APPT_REQD", 
	"JNR_WM_STOP___POS_ARR_START_DTTM as POS_ARR_START_DTTM", 
	"JNR_WM_STOP___POS_ARR_END_DTTM as POS_ARR_END_DTTM", 
	"JNR_WM_STOP___POS_DEPART_START_DTTM as POS_DEPART_START_DTTM", 
	"JNR_WM_STOP___POS_DEPART_END_DTTM as POS_DEPART_END_DTTM", 
	"JNR_WM_STOP___ARRIVAL_START_DTTM as ARRIVAL_START_DTTM", 
	"JNR_WM_STOP___ARRIVAL_END_DTTM as ARRIVAL_END_DTTM", 
	"JNR_WM_STOP___EST_ARRIVAL_DTTM as EST_ARRIVAL_DTTM", 
	"JNR_WM_STOP___ARRIVAL_COMMIT_DTTM as ARRIVAL_COMMIT_DTTM", 
	"JNR_WM_STOP___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", 
	"JNR_WM_STOP___APPT_DTTM as APPT_DTTM", 
	"JNR_WM_STOP___DEPARTURE_START_DTTM as DEPARTURE_START_DTTM", 
	"JNR_WM_STOP___DEPARTURE_END_DTTM as DEPARTURE_END_DTTM", 
	"JNR_WM_STOP___EST_DEPARTURE_DTTM as EST_DEPARTURE_DTTM", 
	"JNR_WM_STOP___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", 
	"JNR_WM_STOP___START_SHIPMENT_DTTM as START_SHIPMENT_DTTM", 
	"JNR_WM_STOP___END_SHIPMENT_DTTM as END_SHIPMENT_DTTM", 
	"JNR_WM_STOP___PAPERWORK_START_DTTM as PAPERWORK_START_DTTM", 
	"JNR_WM_STOP___PICKUP_START_DTTM as PICKUP_START_DTTM", 
	"JNR_WM_STOP___EST_DISPATCH_DTTM as EST_DISPATCH_DTTM", 
	"JNR_WM_STOP___SHIPMENT_START_DTTM as SHIPMENT_START_DTTM", 
	"JNR_WM_STOP___SHIPMENT_END_DTTM as SHIPMENT_END_DTTM", 
	"JNR_WM_STOP___CHECKIN_TIME as CHECKIN_TIME", 
	"JNR_WM_STOP___CHECKOUT_TIME as CHECKOUT_TIME", 
	"JNR_WM_STOP___ARRIVAL_NET_DTTM as ARRIVAL_NET_DTTM", 
	"JNR_WM_STOP___ARRIVAL_NLT_DTTM as ARRIVAL_NLT_DTTM", 
	"JNR_WM_STOP___DEPARTURE_NET_DTTM as DEPARTURE_NET_DTTM", 
	"JNR_WM_STOP___DEPARTURE_NLT_DTTM as DEPARTURE_NLT_DTTM", 
	"JNR_WM_STOP___REC_ARRIVAL_DTTM as REC_ARRIVAL_DTTM", 
	"JNR_WM_STOP___REC_DEPARTURE_DTTM as REC_DEPARTURE_DTTM", 
	"JNR_WM_STOP___BREAK_TIME as BREAK_TIME", 
	"JNR_WM_STOP___WAITING_TIME as WAITING_TIME", 
	"JNR_WM_STOP___STOP_LOCATION_NAME as STOP_LOCATION_NAME", 
	"JNR_WM_STOP___CONTACT_FIRST_NAME as CONTACT_FIRST_NAME", 
	"JNR_WM_STOP___CONTACT_SURNAME as CONTACT_SURNAME", 
	"JNR_WM_STOP___CONTACT_PHONE_NUMBER as CONTACT_PHONE_NUMBER", 
	"JNR_WM_STOP___FACILITY_ALIAS_ID as FACILITY_ALIAS_ID", 
	"JNR_WM_STOP___FACILITY_ID as FACILITY_ID", 
	"JNR_WM_STOP___ADDRESS_1 as ADDRESS_1", 
	"JNR_WM_STOP___ADDRESS_2 as ADDRESS_2", 
	"JNR_WM_STOP___CITY as CITY", 
	"JNR_WM_STOP___STATE_PROV as STATE_PROV", 
	"JNR_WM_STOP___POSTAL_CODE as POSTAL_CODE", 
	"JNR_WM_STOP___COUNTY as COUNTY", 
	"JNR_WM_STOP___COUNTRY_CODE as COUNTRY_CODE", 
	"JNR_WM_STOP___HANDLER as HANDLER", 
	"JNR_WM_STOP___DISTANCE as DISTANCE", 
	"JNR_WM_STOP___DISTANCE_UOM as DISTANCE_UOM", 
	"JNR_WM_STOP___STOP_TZ as STOP_TZ", 
	"JNR_WM_STOP___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", 
	"JNR_WM_STOP___DROP_HOOK_INDICATOR as DROP_HOOK_INDICATOR", 
	"JNR_WM_STOP___HANDLING_TIME as HANDLING_TIME", 
	"JNR_WM_STOP___REPORTED_HANDLER as REPORTED_HANDLER", 
	"JNR_WM_STOP___SEGMENT_ID as SEGMENT_ID", 
	"JNR_WM_STOP___SEGMENT_STOP_SEQ as SEGMENT_STOP_SEQ", 
	"JNR_WM_STOP___CAPACITY as CAPACITY", 
	"JNR_WM_STOP___HAS_NOTES as HAS_NOTES", 
	"JNR_WM_STOP___IS_ADDR_OVERRIDE as IS_ADDR_OVERRIDE", 
	"JNR_WM_STOP___IS_RECONSIGNED as IS_RECONSIGNED", 
	"JNR_WM_STOP___IS_EST_ARR_USER_DEFINED as IS_EST_ARR_USER_DEFINED", 
	"JNR_WM_STOP___IS_EST_DEP_USER_DEFINED as IS_EST_DEP_USER_DEFINED", 
	"JNR_WM_STOP___IS_WAVE_MAN_CHANGED as IS_WAVE_MAN_CHANGED", 
	"JNR_WM_STOP___DELAY_TYPE as DELAY_TYPE", 
	"JNR_WM_STOP___STOP_STATUS as STOP_STATUS", 
	"JNR_WM_STOP___SEAL_NUMBER as SEAL_NUMBER", 
	"JNR_WM_STOP___APPOINTMENT_DURATION as APPOINTMENT_DURATION", 
	"JNR_WM_STOP___BOL_TYPE as BOL_TYPE", 
	"JNR_WM_STOP___PRO_NBR as PRO_NBR", 
	"JNR_WM_STOP___AUTH_NBR as AUTH_NBR", 
	"JNR_WM_STOP___MANIF_TYPE as MANIF_TYPE", 
	"JNR_WM_STOP___CURR_PLT_ID as CURR_PLT_ID", 
	"JNR_WM_STOP___CONS_LOCN_ID as CONS_LOCN_ID", 
	"JNR_WM_STOP___RTE_ID as RTE_ID", 
	"JNR_WM_STOP___AES_ITN as AES_ITN", 
	"JNR_WM_STOP___BOL_BREAK_ATTR as BOL_BREAK_ATTR", 
	"JNR_WM_STOP___FREIGHT_TERMS as FREIGHT_TERMS", 
	"JNR_WM_STOP___ADDRESS_3 as ADDRESS_3", 
	"JNR_WM_STOP___DOCK_DOOR_LOCN_ID as DOCK_DOOR_LOCN_ID", 
	"JNR_WM_STOP___FLOOR_SHIPMENT as FLOOR_SHIPMENT", 
	"JNR_WM_STOP___HIBERNATE_VERSION as HIBERNATE_VERSION", 
	"JNR_WM_STOP___HITCH_TIME as HITCH_TIME", 
	"JNR_WM_STOP___LOAD_CLOSED_INDICATOR as LOAD_CLOSED_INDICATOR", 
	"JNR_WM_STOP___STOP_TIME_MODIFIED as STOP_TIME_MODIFIED", 
	"JNR_WM_STOP___DRIVE_TIME as DRIVE_TIME", 
	"JNR_WM_STOP___REF_FIELD_1 as REF_FIELD_1", 
	"JNR_WM_STOP___REF_FIELD_2 as REF_FIELD_2", 
	"JNR_WM_STOP___REF_FIELD_3 as REF_FIELD_3", 
	"JNR_WM_STOP___REF_FIELD_4 as REF_FIELD_4", 
	"JNR_WM_STOP___REF_FIELD_5 as REF_FIELD_5", 
	"JNR_WM_STOP___REF_FIELD_6 as REF_FIELD_6", 
	"JNR_WM_STOP___REF_FIELD_7 as REF_FIELD_7", 
	"JNR_WM_STOP___REF_FIELD_8 as REF_FIELD_8", 
	"JNR_WM_STOP___REF_FIELD_9 as REF_FIELD_9", 
	"JNR_WM_STOP___REF_FIELD_10 as REF_FIELD_10", 
	"JNR_WM_STOP___ORDER_WINDOW_VIOLATION as ORDER_WINDOW_VIOLATION", 
	"JNR_WM_STOP___DOCK_VIOLATION as DOCK_VIOLATION", 
	"JNR_WM_STOP___WAVE_OPTION_VIOLATION as WAVE_OPTION_VIOLATION", 
	"JNR_WM_STOP___STAGING_LOCN_ID as STAGING_LOCN_ID", 
	"JNR_WM_STOP___CALC_EST_ARRIVAL_DTTM as CALC_EST_ARRIVAL_DTTM", 
	"JNR_WM_STOP___DEGREE_LATE_EARLY as DEGREE_LATE_EARLY", 
	"JNR_WM_STOP___ON_STATIC_ROUTE as ON_STATIC_ROUTE", 
	"JNR_WM_STOP___AUTO_APPOINTMENT as AUTO_APPOINTMENT", 
	"JNR_WM_STOP___STOP_REVENUE as STOP_REVENUE", 
	"JNR_WM_STOP___STOP_REVENUE_CURRENCY_CODE as STOP_REVENUE_CURRENCY_CODE", 
	"JNR_WM_STOP___STOP_MARGIN as STOP_MARGIN", 
	"JNR_WM_STOP___STOP_MARGIN_CURRENCY_CODE as STOP_MARGIN_CURRENCY_CODE", 
	"JNR_WM_STOP___STOP_COST as STOP_COST", 
	"JNR_WM_STOP___STOP_COST_CURRENCY_CODE as STOP_COST_CURRENCY_CODE", 
	"JNR_WM_STOP___STOP_LINEHAUL_REVENUE as STOP_LINEHAUL_REVENUE", 
	"JNR_WM_STOP___ACCESSORIAL_REVENUE as ACCESSORIAL_REVENUE", 
	"JNR_WM_STOP___STOPOFF_REVENUE as STOPOFF_REVENUE", 
	"JNR_WM_STOP___CM_DISCOUNT_REVENUE as CM_DISCOUNT_REVENUE", 
	"JNR_WM_STOP___i_LOCATION_ID as i_LOCATION_ID", 
	"JNR_WM_STOP___i_WM_SHIPMENT_ID as i_WM_SHIPMENT_ID", 
	"JNR_WM_STOP___i_WM_STOP_SEQ as i_WM_STOP_SEQ", 
	"JNR_WM_STOP___i_LOAD_TSTMP as i_LOAD_TSTMP", 
	"JNR_WM_STOP___i_WM_TC_COMPANY_ID as i_WM_TC_COMPANY_ID", 
	"JNR_WM_STOP___i_STOP_LOCATION_NAME as i_STOP_LOCATION_NAME", 
	"JNR_WM_STOP___i_WM_FACILITY_ID as i_WM_FACILITY_ID", 
	"JNR_WM_STOP___i_WM_FACILITY_ALIAS_ID as i_WM_FACILITY_ALIAS_ID", 
	"JNR_WM_STOP___i_WM_CONS_LOCN_ID as i_WM_CONS_LOCN_ID", 
	"JNR_WM_STOP___i_WM_STAGING_LOCN_ID as i_WM_STAGING_LOCN_ID", 
	"JNR_WM_STOP___i_WM_DOCK_DOOR_LOCN_ID as i_WM_DOCK_DOOR_LOCN_ID", 
	"JNR_WM_STOP___i_WM_WAVE_ID as i_WM_WAVE_ID", 
	"JNR_WM_STOP___i_WM_WAVE_OPTION_ID as i_WM_WAVE_OPTION_ID", 
	"JNR_WM_STOP___i_WM_WAVE_OPTION_LIST_ID as i_WM_WAVE_OPTION_LIST_ID", 
	"JNR_WM_STOP___i_WM_DOCK_DISPATCH_CAP_ID as i_WM_DOCK_DISPATCH_CAP_ID", 
	"JNR_WM_STOP___i_WM_SEGMENT_ID as i_WM_SEGMENT_ID", 
	"JNR_WM_STOP___i_SEGMENT_STOP_SEQ as i_SEGMENT_STOP_SEQ", 
	"JNR_WM_STOP___i_HANDLER as i_HANDLER", 
	"JNR_WM_STOP___i_REPORTED_HANDLER as i_REPORTED_HANDLER", 
	"JNR_WM_STOP___i_DELAY_TYPE as i_DELAY_TYPE", 
	"JNR_WM_STOP___i_STOP_STATUS as i_STOP_STATUS", 
	"JNR_WM_STOP___i_WM_SEAL_NBR as i_WM_SEAL_NBR", 
	"JNR_WM_STOP___i_BILL_OF_LADING_NBR as i_BILL_OF_LADING_NBR", 
	"JNR_WM_STOP___i_BOL_TYPE as i_BOL_TYPE", 
	"JNR_WM_STOP___i_WM_PRO_NBR as i_WM_PRO_NBR", 
	"JNR_WM_STOP___i_WM_AUTH_NBR as i_WM_AUTH_NBR", 
	"JNR_WM_STOP___i_WM_MANIF_TYPE as i_WM_MANIF_TYPE", 
	"JNR_WM_STOP___i_WM_CURR_PLT_ID as i_WM_CURR_PLT_ID", 
	"JNR_WM_STOP___i_WM_RTE_ID as i_WM_RTE_ID", 
	"JNR_WM_STOP___i_WM_AES_ITN as i_WM_AES_ITN", 
	"JNR_WM_STOP___i_BOL_BREAK_ATTR as i_BOL_BREAK_ATTR", 
	"JNR_WM_STOP___i_FREIGHT_TERMS as i_FREIGHT_TERMS", 
	"JNR_WM_STOP___i_FLOOR_SHIPMENT as i_FLOOR_SHIPMENT", 
	"JNR_WM_STOP___i_ORDER_WINDOW_VIOLATION as i_ORDER_WINDOW_VIOLATION", 
	"JNR_WM_STOP___i_DOCK_VIOLATION as i_DOCK_VIOLATION", 
	"JNR_WM_STOP___i_WAVE_OPTION_VIOLATION as i_WAVE_OPTION_VIOLATION", 
	"JNR_WM_STOP___AUTO_APPOINTMENT_FLAG as AUTO_APPOINTMENT_FLAG", 
	"JNR_WM_STOP___APPT_REQD_FLAG as APPT_REQD_FLAG", 
	"JNR_WM_STOP___ADDR_OVERRIDE_FLAG as ADDR_OVERRIDE_FLAG", 
	"JNR_WM_STOP___LOAD_CLOSED_FLAG as LOAD_CLOSED_FLAG", 
	"JNR_WM_STOP___WAVE_MAN_CHANGED_FLAG as WAVE_MAN_CHANGED_FLAG", 
	"JNR_WM_STOP___ON_STATIC_ROUTE_FLAG as ON_STATIC_ROUTE_FLAG", 
	"JNR_WM_STOP___HAS_NOTES_FLAG as HAS_NOTES_FLAG", 
	"JNR_WM_STOP___RECONSIGNED_FLAG as RECONSIGNED_FLAG", 
	"JNR_WM_STOP___EST_ARR_USER_DEFINED_FLAG as EST_ARR_USER_DEFINED_FLAG", 
	"JNR_WM_STOP___EST_DEP_USER_DEFINED_FLAG as EST_DEP_USER_DEFINED_FLAG", 
	"JNR_WM_STOP___DROP_HOOK_FLAG as DROP_HOOK_FLAG", 
	"JNR_WM_STOP___i_CONTACT_FIRST_NAME as i_CONTACT_FIRST_NAME", 
	"JNR_WM_STOP___i_CONTACT_SURNAME as i_CONTACT_SURNAME", 
	"JNR_WM_STOP___i_ADDR_1 as i_ADDR_1", 
	"JNR_WM_STOP___i_ADDR_2 as i_ADDR_2", 
	"JNR_WM_STOP___i_ADDR_3 as i_ADDR_3", 
	"JNR_WM_STOP___i_CITY as i_CITY", 
	"JNR_WM_STOP___i_STATE_PROV as i_STATE_PROV", 
	"JNR_WM_STOP___i_POSTAL_CD as i_POSTAL_CD", 
	"JNR_WM_STOP___i_COUNTY as i_COUNTY", 
	"JNR_WM_STOP___i_COUNTRY_CD as i_COUNTRY_CD", 
	"JNR_WM_STOP___i_CONTACT_PHONE_NBR as i_CONTACT_PHONE_NBR", 
	"JNR_WM_STOP___i_APPT_TSTMP as i_APPT_TSTMP", 
	"JNR_WM_STOP___i_APPOINTMENT_DURATION as i_APPOINTMENT_DURATION", 
	"JNR_WM_STOP___i_PAPERWORK_START_TSTMP as i_PAPERWORK_START_TSTMP", 
	"JNR_WM_STOP___i_PICKUP_START_TSTMP as i_PICKUP_START_TSTMP", 
	"JNR_WM_STOP___i_HANDLING_TIME as i_HANDLING_TIME", 
	"JNR_WM_STOP___i_BREAK_TIME as i_BREAK_TIME", 
	"JNR_WM_STOP___i_WAITING_TIME as i_WAITING_TIME", 
	"JNR_WM_STOP___i_HITCH_TIME as i_HITCH_TIME", 
	"JNR_WM_STOP___i_DRIVE_TIME as i_DRIVE_TIME", 
	"JNR_WM_STOP___i_STOP_TIME_MODIFIED as i_STOP_TIME_MODIFIED", 
	"JNR_WM_STOP___i_DISTANCE as i_DISTANCE", 
	"JNR_WM_STOP___i_DISTANCE_UOM as i_DISTANCE_UOM", 
	"JNR_WM_STOP___i_EST_DISPATCH_TSTMP as i_EST_DISPATCH_TSTMP", 
	"JNR_WM_STOP___i_POS_ARR_START_TSTMP as i_POS_ARR_START_TSTMP", 
	"JNR_WM_STOP___i_POS_ARR_END_TSTMP as i_POS_ARR_END_TSTMP", 
	"JNR_WM_STOP___i_POS_DEPART_START_TSTMP as i_POS_DEPART_START_TSTMP", 
	"JNR_WM_STOP___i_POS_DEPART_END_TSTMP as i_POS_DEPART_END_TSTMP", 
	"JNR_WM_STOP___i_ARRIVAL_START_TSTMP as i_ARRIVAL_START_TSTMP", 
	"JNR_WM_STOP___i_ARRIVAL_END_TSTMP as i_ARRIVAL_END_TSTMP", 
	"JNR_WM_STOP___i_EST_ARRIVAL_TSTMP as i_EST_ARRIVAL_TSTMP", 
	"JNR_WM_STOP___i_CALC_EST_ARRIVAL_TSTMP as i_CALC_EST_ARRIVAL_TSTMP", 
	"JNR_WM_STOP___i_ARRIVAL_COMMIT_TSTMP as i_ARRIVAL_COMMIT_TSTMP", 
	"JNR_WM_STOP___i_ACTUAL_ARRIVAL_TSTMP as i_ACTUAL_ARRIVAL_TSTMP", 
	"JNR_WM_STOP___i_DEPARTURE_START_TSTMP as i_DEPARTURE_START_TSTMP", 
	"JNR_WM_STOP___i_DEPARTURE_END_TSTMP as i_DEPARTURE_END_TSTMP", 
	"JNR_WM_STOP___i_EST_DEPARTURE_TSTMP as i_EST_DEPARTURE_TSTMP", 
	"JNR_WM_STOP___i_ACTUAL_DEPARTURE_TSTMP as i_ACTUAL_DEPARTURE_TSTMP", 
	"JNR_WM_STOP___i_START_SHIPMENT_TSTMP as i_START_SHIPMENT_TSTMP", 
	"JNR_WM_STOP___i_END_SHIPMENT_TSTMP as i_END_SHIPMENT_TSTMP", 
	"JNR_WM_STOP___i_SHIPMENT_START_TSTMP as i_SHIPMENT_START_TSTMP", 
	"JNR_WM_STOP___i_SHIPMENT_END_TSTMP as i_SHIPMENT_END_TSTMP", 
	"JNR_WM_STOP___i_CHECK_IN_TSTMP as i_CHECK_IN_TSTMP", 
	"JNR_WM_STOP___i_CHECK_OUT_TSTMP as i_CHECK_OUT_TSTMP", 
	"JNR_WM_STOP___i_ARRIVAL_NET_TSTMP as i_ARRIVAL_NET_TSTMP", 
	"JNR_WM_STOP___i_ARRIVAL_NLT_TSTMP as i_ARRIVAL_NLT_TSTMP", 
	"JNR_WM_STOP___i_DEPARTURE_NET_TSTMP as i_DEPARTURE_NET_TSTMP", 
	"JNR_WM_STOP___i_DEPARTURE_NLT_TSTMP as i_DEPARTURE_NLT_TSTMP", 
	"JNR_WM_STOP___i_REC_ARRIVAL_TSTMP as i_REC_ARRIVAL_TSTMP", 
	"JNR_WM_STOP___i_REC_DEPARTURE_TSTMP as i_REC_DEPARTURE_TSTMP", 
	"JNR_WM_STOP___i_WM_STOP_TZ as i_WM_STOP_TZ", 
	"JNR_WM_STOP___i_DEGREE_LATE_EARLY as i_DEGREE_LATE_EARLY", 
	"JNR_WM_STOP___i_WM_ARRIVAL_LATE_REASON_ID as i_WM_ARRIVAL_LATE_REASON_ID", 
	"JNR_WM_STOP___i_WM_DEPARTURE_LATE_REASON_ID as i_WM_DEPARTURE_LATE_REASON_ID", 
	"JNR_WM_STOP___i_STOP_REVENUE as i_STOP_REVENUE", 
	"JNR_WM_STOP___i_STOP_REVENUE_CURRENCY_CD as i_STOP_REVENUE_CURRENCY_CD", 
	"JNR_WM_STOP___i_STOP_MARGIN as i_STOP_MARGIN", 
	"JNR_WM_STOP___i_STOP_MARGIN_CURRENCY_CD as i_STOP_MARGIN_CURRENCY_CD", 
	"JNR_WM_STOP___i_STOP_COST as i_STOP_COST", 
	"JNR_WM_STOP___i_STOP_COST_CURRENCY_CD as i_STOP_COST_CURRENCY_CD", 
	"JNR_WM_STOP___i_STOP_LINEHAUL_REVENUE as i_STOP_LINEHAUL_REVENUE", 
	"JNR_WM_STOP___i_ACCESSORIAL_REVENUE as i_ACCESSORIAL_REVENUE", 
	"JNR_WM_STOP___i_STOP_OFF_REVENUE as i_STOP_OFF_REVENUE", 
	"JNR_WM_STOP___i_CM_DISCOUNT_REVENUE as i_CM_DISCOUNT_REVENUE", 
	"JNR_WM_STOP___i_CAPACITY as i_CAPACITY", 
	"JNR_WM_STOP___i_WM_SIZE_UOM_ID as i_WM_SIZE_UOM_ID", 
	"JNR_WM_STOP___i_REF_FIELD_1 as i_REF_FIELD_1", 
	"JNR_WM_STOP___i_REF_FIELD_2 as i_REF_FIELD_2", 
	"JNR_WM_STOP___i_REF_FIELD_3 as i_REF_FIELD_3", 
	"JNR_WM_STOP___i_REF_FIELD_4 as i_REF_FIELD_4", 
	"JNR_WM_STOP___i_REF_FIELD_5 as i_REF_FIELD_5", 
	"JNR_WM_STOP___i_REF_FIELD_6 as i_REF_FIELD_6", 
	"JNR_WM_STOP___i_REF_FIELD_7 as i_REF_FIELD_7", 
	"JNR_WM_STOP___i_REF_FIELD_8 as i_REF_FIELD_8", 
	"JNR_WM_STOP___i_REF_FIELD_9 as i_REF_FIELD_9", 
	"JNR_WM_STOP___i_REF_FIELD_10 as i_REF_FIELD_10", 
	"JNR_WM_STOP___i_WM_HIBERNATE_VERSION as i_WM_HIBERNATE_VERSION").filter(expr(_filter)).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_UPDATE_VALIDATOR, type EXPRESSION 
# COLUMN COUNT: 130

# for each involved DataFrame, append the dataframe name to each column
FIL_UNCHANGED_RECORDS_temp = FIL_UNCHANGED_RECORDS.toDF(*["FIL_UNCHANGED_RECORDS___" + col for col in FIL_UNCHANGED_RECORDS.columns])

EXP_UPDATE_VALIDATOR = FIL_UNCHANGED_RECORDS_temp.selectExpr( 
	"FIL_UNCHANGED_RECORDS___sys_row_id as sys_row_id", 
	"FIL_UNCHANGED_RECORDS___LOCATION_ID as LOCATION_ID", 
	"FIL_UNCHANGED_RECORDS___SHIPMENT_ID as SHIPMENT_ID", 
	"FIL_UNCHANGED_RECORDS___STOP_SEQ as STOP_SEQ", 
	"FIL_UNCHANGED_RECORDS___TC_COMPANY_ID as TC_COMPANY_ID", 
	"FIL_UNCHANGED_RECORDS___WAVE_ID as WAVE_ID", 
	"FIL_UNCHANGED_RECORDS___WAVE_OPTION_ID as WAVE_OPTION_ID", 
	"FIL_UNCHANGED_RECORDS___WAVE_OPTION_LIST_ID as WAVE_OPTION_LIST_ID", 
	"FIL_UNCHANGED_RECORDS___ARRIVAL_LATE_REASON_ID as ARRIVAL_LATE_REASON_ID", 
	"FIL_UNCHANGED_RECORDS___DEPARTURE_LATE_REASON_ID as DEPARTURE_LATE_REASON_ID", 
	"FIL_UNCHANGED_RECORDS___SIZE_UOM_ID as SIZE_UOM_ID", 
	"FIL_UNCHANGED_RECORDS___DOCK_DISPATCH_CAP_ID as DOCK_DISPATCH_CAP_ID", 
	"FIL_UNCHANGED_RECORDS___IS_APPT_REQD as IS_APPT_REQD", 
	"FIL_UNCHANGED_RECORDS___POS_ARR_START_DTTM as POS_ARR_START_DTTM", 
	"FIL_UNCHANGED_RECORDS___POS_ARR_END_DTTM as POS_ARR_END_DTTM", 
	"FIL_UNCHANGED_RECORDS___POS_DEPART_START_DTTM as POS_DEPART_START_DTTM", 
	"FIL_UNCHANGED_RECORDS___POS_DEPART_END_DTTM as POS_DEPART_END_DTTM", 
	"FIL_UNCHANGED_RECORDS___ARRIVAL_START_DTTM as ARRIVAL_START_DTTM", 
	"FIL_UNCHANGED_RECORDS___ARRIVAL_END_DTTM as ARRIVAL_END_DTTM", 
	"FIL_UNCHANGED_RECORDS___EST_ARRIVAL_DTTM as EST_ARRIVAL_DTTM", 
	"FIL_UNCHANGED_RECORDS___ARRIVAL_COMMIT_DTTM as ARRIVAL_COMMIT_DTTM", 
	"FIL_UNCHANGED_RECORDS___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", 
	"FIL_UNCHANGED_RECORDS___APPT_DTTM as APPT_DTTM", 
	"FIL_UNCHANGED_RECORDS___DEPARTURE_START_DTTM as DEPARTURE_START_DTTM", 
	"FIL_UNCHANGED_RECORDS___DEPARTURE_END_DTTM as DEPARTURE_END_DTTM", 
	"FIL_UNCHANGED_RECORDS___EST_DEPARTURE_DTTM as EST_DEPARTURE_DTTM", 
	"FIL_UNCHANGED_RECORDS___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", 
	"FIL_UNCHANGED_RECORDS___START_SHIPMENT_DTTM as START_SHIPMENT_DTTM", 
	"FIL_UNCHANGED_RECORDS___END_SHIPMENT_DTTM as END_SHIPMENT_DTTM", 
	"FIL_UNCHANGED_RECORDS___PAPERWORK_START_DTTM as PAPERWORK_START_DTTM", 
	"FIL_UNCHANGED_RECORDS___PICKUP_START_DTTM as PICKUP_START_DTTM", 
	"FIL_UNCHANGED_RECORDS___EST_DISPATCH_DTTM as EST_DISPATCH_DTTM", 
	"FIL_UNCHANGED_RECORDS___SHIPMENT_START_DTTM as SHIPMENT_START_DTTM", 
	"FIL_UNCHANGED_RECORDS___SHIPMENT_END_DTTM as SHIPMENT_END_DTTM", 
	"FIL_UNCHANGED_RECORDS___CHECKIN_TIME as CHECKIN_TIME", 
	"FIL_UNCHANGED_RECORDS___CHECKOUT_TIME as CHECKOUT_TIME", 
	"FIL_UNCHANGED_RECORDS___ARRIVAL_NET_DTTM as ARRIVAL_NET_DTTM", 
	"FIL_UNCHANGED_RECORDS___ARRIVAL_NLT_DTTM as ARRIVAL_NLT_DTTM", 
	"FIL_UNCHANGED_RECORDS___DEPARTURE_NET_DTTM as DEPARTURE_NET_DTTM", 
	"FIL_UNCHANGED_RECORDS___DEPARTURE_NLT_DTTM as DEPARTURE_NLT_DTTM", 
	"FIL_UNCHANGED_RECORDS___REC_ARRIVAL_DTTM as REC_ARRIVAL_DTTM", 
	"FIL_UNCHANGED_RECORDS___REC_DEPARTURE_DTTM as REC_DEPARTURE_DTTM", 
	"FIL_UNCHANGED_RECORDS___BREAK_TIME as BREAK_TIME", 
	"FIL_UNCHANGED_RECORDS___WAITING_TIME as WAITING_TIME", 
	"FIL_UNCHANGED_RECORDS___STOP_LOCATION_NAME as STOP_LOCATION_NAME", 
	"FIL_UNCHANGED_RECORDS___CONTACT_FIRST_NAME as CONTACT_FIRST_NAME", 
	"FIL_UNCHANGED_RECORDS___CONTACT_SURNAME as CONTACT_SURNAME", 
	"FIL_UNCHANGED_RECORDS___CONTACT_PHONE_NUMBER as CONTACT_PHONE_NUMBER", 
	"FIL_UNCHANGED_RECORDS___FACILITY_ALIAS_ID as FACILITY_ALIAS_ID", 
	"FIL_UNCHANGED_RECORDS___FACILITY_ID as FACILITY_ID", 
	"FIL_UNCHANGED_RECORDS___ADDRESS_1 as ADDRESS_1", 
	"FIL_UNCHANGED_RECORDS___ADDRESS_2 as ADDRESS_2", 
	"FIL_UNCHANGED_RECORDS___CITY as CITY", 
	"FIL_UNCHANGED_RECORDS___STATE_PROV as STATE_PROV", 
	"FIL_UNCHANGED_RECORDS___POSTAL_CODE as POSTAL_CODE", 
	"FIL_UNCHANGED_RECORDS___COUNTY as COUNTY", 
	"FIL_UNCHANGED_RECORDS___COUNTRY_CODE as COUNTRY_CODE", 
	"FIL_UNCHANGED_RECORDS___HANDLER as HANDLER", 
	"FIL_UNCHANGED_RECORDS___DISTANCE as DISTANCE", 
	"FIL_UNCHANGED_RECORDS___DISTANCE_UOM as DISTANCE_UOM", 
	"FIL_UNCHANGED_RECORDS___STOP_TZ as STOP_TZ", 
	"FIL_UNCHANGED_RECORDS___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", 
	"FIL_UNCHANGED_RECORDS___DROP_HOOK_INDICATOR as DROP_HOOK_INDICATOR", 
	"FIL_UNCHANGED_RECORDS___HANDLING_TIME as HANDLING_TIME", 
	"FIL_UNCHANGED_RECORDS___REPORTED_HANDLER as REPORTED_HANDLER", 
	"FIL_UNCHANGED_RECORDS___SEGMENT_ID as SEGMENT_ID", 
	"FIL_UNCHANGED_RECORDS___SEGMENT_STOP_SEQ as SEGMENT_STOP_SEQ", 
	"FIL_UNCHANGED_RECORDS___CAPACITY as CAPACITY", 
	"FIL_UNCHANGED_RECORDS___HAS_NOTES as HAS_NOTES_EXP", 
	"FIL_UNCHANGED_RECORDS___IS_ADDR_OVERRIDE as IS_ADDR_OVERRIDE", 
	"FIL_UNCHANGED_RECORDS___IS_RECONSIGNED as IS_RECONSIGNED", 
	"FIL_UNCHANGED_RECORDS___IS_EST_ARR_USER_DEFINED as IS_EST_ARR_USER_DEFINED", 
	"FIL_UNCHANGED_RECORDS___IS_EST_DEP_USER_DEFINED as IS_EST_DEP_USER_DEFINED", 
	"FIL_UNCHANGED_RECORDS___IS_WAVE_MAN_CHANGED as IS_WAVE_MAN_CHANGED", 
	"FIL_UNCHANGED_RECORDS___DELAY_TYPE as DELAY_TYPE", 
	"FIL_UNCHANGED_RECORDS___STOP_STATUS as STOP_STATUS", 
	"FIL_UNCHANGED_RECORDS___SEAL_NUMBER as SEAL_NUMBER", 
	"FIL_UNCHANGED_RECORDS___APPOINTMENT_DURATION as APPOINTMENT_DURATION", 
	"FIL_UNCHANGED_RECORDS___BOL_TYPE as BOL_TYPE", 
	"FIL_UNCHANGED_RECORDS___PRO_NBR as PRO_NBR", 
	"FIL_UNCHANGED_RECORDS___AUTH_NBR as AUTH_NBR", 
	"FIL_UNCHANGED_RECORDS___MANIF_TYPE as MANIF_TYPE", 
	"FIL_UNCHANGED_RECORDS___CURR_PLT_ID as CURR_PLT_ID", 
	"FIL_UNCHANGED_RECORDS___CONS_LOCN_ID as CONS_LOCN_ID", 
	"FIL_UNCHANGED_RECORDS___RTE_ID as RTE_ID", 
	"FIL_UNCHANGED_RECORDS___AES_ITN as AES_ITN", 
	"FIL_UNCHANGED_RECORDS___BOL_BREAK_ATTR as BOL_BREAK_ATTR", 
	"FIL_UNCHANGED_RECORDS___FREIGHT_TERMS as FREIGHT_TERMS", 
	"FIL_UNCHANGED_RECORDS___ADDRESS_3 as ADDRESS_3", 
	"FIL_UNCHANGED_RECORDS___DOCK_DOOR_LOCN_ID as DOCK_DOOR_LOCN_ID", 
	"FIL_UNCHANGED_RECORDS___FLOOR_SHIPMENT as FLOOR_SHIPMENT", 
	"FIL_UNCHANGED_RECORDS___HIBERNATE_VERSION as HIBERNATE_VERSION", 
	"FIL_UNCHANGED_RECORDS___HITCH_TIME as HITCH_TIME", 
	"FIL_UNCHANGED_RECORDS___LOAD_CLOSED_INDICATOR as LOAD_CLOSED_INDICATOR", 
	"FIL_UNCHANGED_RECORDS___STOP_TIME_MODIFIED as STOP_TIME_MODIFIED", 
	"FIL_UNCHANGED_RECORDS___DRIVE_TIME as DRIVE_TIME", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_1 as REF_FIELD_1", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_2 as REF_FIELD_2", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_3 as REF_FIELD_3", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_4 as REF_FIELD_4", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_5 as REF_FIELD_5", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_6 as REF_FIELD_6", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_7 as REF_FIELD_7", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_8 as REF_FIELD_8", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_9 as REF_FIELD_9", 
	"FIL_UNCHANGED_RECORDS___REF_FIELD_10 as REF_FIELD_10", 
	"FIL_UNCHANGED_RECORDS___ORDER_WINDOW_VIOLATION as ORDER_WINDOW_VIOLATION", 
	"FIL_UNCHANGED_RECORDS___DOCK_VIOLATION as DOCK_VIOLATION", 
	"FIL_UNCHANGED_RECORDS___WAVE_OPTION_VIOLATION as WAVE_OPTION_VIOLATION", 
	"FIL_UNCHANGED_RECORDS___STAGING_LOCN_ID as STAGING_LOCN_ID", 
	"FIL_UNCHANGED_RECORDS___CALC_EST_ARRIVAL_DTTM as CALC_EST_ARRIVAL_DTTM", 
	"FIL_UNCHANGED_RECORDS___DEGREE_LATE_EARLY as DEGREE_LATE_EARLY", 
	"FIL_UNCHANGED_RECORDS___ON_STATIC_ROUTE as ON_STATIC_ROUTE", 
	"FIL_UNCHANGED_RECORDS___AUTO_APPOINTMENT as AUTO_APPOINTMENT", 
	"FIL_UNCHANGED_RECORDS___STOP_REVENUE as STOP_REVENUE", 
	"FIL_UNCHANGED_RECORDS___STOP_REVENUE_CURRENCY_CODE as STOP_REVENUE_CURRENCY_CODE", 
	"FIL_UNCHANGED_RECORDS___STOP_MARGIN as STOP_MARGIN", 
	"FIL_UNCHANGED_RECORDS___STOP_MARGIN_CURRENCY_CODE as STOP_MARGIN_CURRENCY_CODE", 
	"FIL_UNCHANGED_RECORDS___STOP_COST as STOP_COST", 
	"FIL_UNCHANGED_RECORDS___STOP_COST_CURRENCY_CODE as STOP_COST_CURRENCY_CODE", 
	"FIL_UNCHANGED_RECORDS___STOP_LINEHAUL_REVENUE as STOP_LINEHAUL_REVENUE", 
	"FIL_UNCHANGED_RECORDS___ACCESSORIAL_REVENUE as ACCESSORIAL_REVENUE", 
	"FIL_UNCHANGED_RECORDS___STOPOFF_REVENUE as STOPOFF_REVENUE", 
	"FIL_UNCHANGED_RECORDS___CM_DISCOUNT_REVENUE as CM_DISCOUNT_REVENUE", 
	"FIL_UNCHANGED_RECORDS___i_LOCATION_ID as i_LOCATION_ID", 
	"FIL_UNCHANGED_RECORDS___i_WM_SHIPMENT_ID as i_WM_SHIPMENT_ID", 
	"FIL_UNCHANGED_RECORDS___i_WM_STOP_SEQ as i_WM_STOP_SEQ", 
	"FIL_UNCHANGED_RECORDS___i_LOAD_TSTMP as i_LOAD_TSTMP", 
	"CURRENT_TIMESTAMP as UPDATE_TSTMP", 
	"IF (FIL_UNCHANGED_RECORDS___i_LOAD_TSTMP IS NULL, CURRENT_TIMESTAMP, FIL_UNCHANGED_RECORDS___i_LOAD_TSTMP) as LOAD_TSTMP", 
	"IF (FIL_UNCHANGED_RECORDS___i_WM_SHIPMENT_ID IS NULL, 1, 2) as o_UPDATE_VALIDATOR" 
)

# COMMAND ----------
# Processing node UPD_INS_UPD, type UPDATE_STRATEGY . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 130

# for each involved DataFrame, append the dataframe name to each column
EXP_UPDATE_VALIDATOR_temp = EXP_UPDATE_VALIDATOR.toDF(*["EXP_UPDATE_VALIDATOR___" + col for col in EXP_UPDATE_VALIDATOR.columns])

UPD_INS_UPD = EXP_UPDATE_VALIDATOR_temp.selectExpr( 
	"EXP_UPDATE_VALIDATOR___LOCATION_ID as LOCATION_ID", 
	"EXP_UPDATE_VALIDATOR___SHIPMENT_ID as SHIPMENT_ID", 
	"EXP_UPDATE_VALIDATOR___STOP_SEQ as STOP_SEQ", 
	"EXP_UPDATE_VALIDATOR___TC_COMPANY_ID as TC_COMPANY_ID", 
	"EXP_UPDATE_VALIDATOR___WAVE_ID as WAVE_ID", 
	"EXP_UPDATE_VALIDATOR___WAVE_OPTION_ID as WAVE_OPTION_ID", 
	"EXP_UPDATE_VALIDATOR___WAVE_OPTION_LIST_ID as WAVE_OPTION_LIST_ID", 
	"EXP_UPDATE_VALIDATOR___ARRIVAL_LATE_REASON_ID as ARRIVAL_LATE_REASON_ID", 
	"EXP_UPDATE_VALIDATOR___DEPARTURE_LATE_REASON_ID as DEPARTURE_LATE_REASON_ID", 
	"EXP_UPDATE_VALIDATOR___SIZE_UOM_ID as SIZE_UOM_ID", 
	"EXP_UPDATE_VALIDATOR___DOCK_DISPATCH_CAP_ID as DOCK_DISPATCH_CAP_ID", 
	"EXP_UPDATE_VALIDATOR___IS_APPT_REQD as IS_APPT_REQD", 
	"EXP_UPDATE_VALIDATOR___POS_ARR_START_DTTM as POS_ARR_START_DTTM", 
	"EXP_UPDATE_VALIDATOR___POS_ARR_END_DTTM as POS_ARR_END_DTTM", 
	"EXP_UPDATE_VALIDATOR___POS_DEPART_START_DTTM as POS_DEPART_START_DTTM", 
	"EXP_UPDATE_VALIDATOR___POS_DEPART_END_DTTM as POS_DEPART_END_DTTM", 
	"EXP_UPDATE_VALIDATOR___ARRIVAL_START_DTTM as ARRIVAL_START_DTTM", 
	"EXP_UPDATE_VALIDATOR___ARRIVAL_END_DTTM as ARRIVAL_END_DTTM", 
	"EXP_UPDATE_VALIDATOR___EST_ARRIVAL_DTTM as EST_ARRIVAL_DTTM", 
	"EXP_UPDATE_VALIDATOR___ARRIVAL_COMMIT_DTTM as ARRIVAL_COMMIT_DTTM", 
	"EXP_UPDATE_VALIDATOR___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", 
	"EXP_UPDATE_VALIDATOR___APPT_DTTM as APPT_DTTM", 
	"EXP_UPDATE_VALIDATOR___DEPARTURE_START_DTTM as DEPARTURE_START_DTTM", 
	"EXP_UPDATE_VALIDATOR___DEPARTURE_END_DTTM as DEPARTURE_END_DTTM", 
	"EXP_UPDATE_VALIDATOR___EST_DEPARTURE_DTTM as EST_DEPARTURE_DTTM", 
	"EXP_UPDATE_VALIDATOR___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", 
	"EXP_UPDATE_VALIDATOR___START_SHIPMENT_DTTM as START_SHIPMENT_DTTM", 
	"EXP_UPDATE_VALIDATOR___END_SHIPMENT_DTTM as END_SHIPMENT_DTTM", 
	"EXP_UPDATE_VALIDATOR___PAPERWORK_START_DTTM as PAPERWORK_START_DTTM", 
	"EXP_UPDATE_VALIDATOR___PICKUP_START_DTTM as PICKUP_START_DTTM", 
	"EXP_UPDATE_VALIDATOR___EST_DISPATCH_DTTM as EST_DISPATCH_DTTM", 
	"EXP_UPDATE_VALIDATOR___SHIPMENT_START_DTTM as SHIPMENT_START_DTTM", 
	"EXP_UPDATE_VALIDATOR___SHIPMENT_END_DTTM as SHIPMENT_END_DTTM", 
	"EXP_UPDATE_VALIDATOR___CHECKIN_TIME as CHECKIN_TIME", 
	"EXP_UPDATE_VALIDATOR___CHECKOUT_TIME as CHECKOUT_TIME", 
	"EXP_UPDATE_VALIDATOR___ARRIVAL_NET_DTTM as ARRIVAL_NET_DTTM", 
	"EXP_UPDATE_VALIDATOR___ARRIVAL_NLT_DTTM as ARRIVAL_NLT_DTTM", 
	"EXP_UPDATE_VALIDATOR___DEPARTURE_NET_DTTM as DEPARTURE_NET_DTTM", 
	"EXP_UPDATE_VALIDATOR___DEPARTURE_NLT_DTTM as DEPARTURE_NLT_DTTM", 
	"EXP_UPDATE_VALIDATOR___REC_ARRIVAL_DTTM as REC_ARRIVAL_DTTM", 
	"EXP_UPDATE_VALIDATOR___REC_DEPARTURE_DTTM as REC_DEPARTURE_DTTM", 
	"EXP_UPDATE_VALIDATOR___BREAK_TIME as BREAK_TIME", 
	"EXP_UPDATE_VALIDATOR___WAITING_TIME as WAITING_TIME", 
	"EXP_UPDATE_VALIDATOR___STOP_LOCATION_NAME as STOP_LOCATION_NAME", 
	"EXP_UPDATE_VALIDATOR___CONTACT_FIRST_NAME as CONTACT_FIRST_NAME", 
	"EXP_UPDATE_VALIDATOR___CONTACT_SURNAME as CONTACT_SURNAME", 
	"EXP_UPDATE_VALIDATOR___CONTACT_PHONE_NUMBER as CONTACT_PHONE_NUMBER", 
	"EXP_UPDATE_VALIDATOR___FACILITY_ALIAS_ID as FACILITY_ALIAS_ID", 
	"EXP_UPDATE_VALIDATOR___FACILITY_ID as FACILITY_ID", 
	"EXP_UPDATE_VALIDATOR___ADDRESS_1 as ADDRESS_1", 
	"EXP_UPDATE_VALIDATOR___ADDRESS_2 as ADDRESS_2", 
	"EXP_UPDATE_VALIDATOR___CITY as CITY", 
	"EXP_UPDATE_VALIDATOR___STATE_PROV as STATE_PROV", 
	"EXP_UPDATE_VALIDATOR___POSTAL_CODE as POSTAL_CODE", 
	"EXP_UPDATE_VALIDATOR___COUNTY as COUNTY", 
	"EXP_UPDATE_VALIDATOR___COUNTRY_CODE as COUNTRY_CODE", 
	"EXP_UPDATE_VALIDATOR___HANDLER as HANDLER", 
	"EXP_UPDATE_VALIDATOR___DISTANCE as DISTANCE", 
	"EXP_UPDATE_VALIDATOR___DISTANCE_UOM as DISTANCE_UOM", 
	"EXP_UPDATE_VALIDATOR___STOP_TZ as STOP_TZ", 
	"EXP_UPDATE_VALIDATOR___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", 
	"EXP_UPDATE_VALIDATOR___DROP_HOOK_INDICATOR as DROP_HOOK_INDICATOR", 
	"EXP_UPDATE_VALIDATOR___HANDLING_TIME as HANDLING_TIME", 
	"EXP_UPDATE_VALIDATOR___REPORTED_HANDLER as REPORTED_HANDLER", 
	"EXP_UPDATE_VALIDATOR___SEGMENT_ID as SEGMENT_ID", 
	"EXP_UPDATE_VALIDATOR___SEGMENT_STOP_SEQ as SEGMENT_STOP_SEQ", 
	"EXP_UPDATE_VALIDATOR___CAPACITY as CAPACITY", 
	"EXP_UPDATE_VALIDATOR___HAS_NOTES_EXP as HAS_NOTES", 
	"EXP_UPDATE_VALIDATOR___IS_ADDR_OVERRIDE as IS_ADDR_OVERRIDE", 
	"EXP_UPDATE_VALIDATOR___IS_RECONSIGNED as IS_RECONSIGNED", 
	"EXP_UPDATE_VALIDATOR___IS_EST_ARR_USER_DEFINED as IS_EST_ARR_USER_DEFINED", 
	"EXP_UPDATE_VALIDATOR___IS_EST_DEP_USER_DEFINED as IS_EST_DEP_USER_DEFINED", 
	"EXP_UPDATE_VALIDATOR___IS_WAVE_MAN_CHANGED as IS_WAVE_MAN_CHANGED", 
	"EXP_UPDATE_VALIDATOR___DELAY_TYPE as DELAY_TYPE", 
	"EXP_UPDATE_VALIDATOR___STOP_STATUS as STOP_STATUS", 
	"EXP_UPDATE_VALIDATOR___SEAL_NUMBER as SEAL_NUMBER", 
	"EXP_UPDATE_VALIDATOR___APPOINTMENT_DURATION as APPOINTMENT_DURATION", 
	"EXP_UPDATE_VALIDATOR___BOL_TYPE as BOL_TYPE", 
	"EXP_UPDATE_VALIDATOR___PRO_NBR as PRO_NBR", 
	"EXP_UPDATE_VALIDATOR___AUTH_NBR as AUTH_NBR", 
	"EXP_UPDATE_VALIDATOR___MANIF_TYPE as MANIF_TYPE", 
	"EXP_UPDATE_VALIDATOR___CURR_PLT_ID as CURR_PLT_ID", 
	"EXP_UPDATE_VALIDATOR___CONS_LOCN_ID as CONS_LOCN_ID", 
	"EXP_UPDATE_VALIDATOR___RTE_ID as RTE_ID", 
	"EXP_UPDATE_VALIDATOR___AES_ITN as AES_ITN", 
	"EXP_UPDATE_VALIDATOR___BOL_BREAK_ATTR as BOL_BREAK_ATTR", 
	"EXP_UPDATE_VALIDATOR___FREIGHT_TERMS as FREIGHT_TERMS", 
	"EXP_UPDATE_VALIDATOR___ADDRESS_3 as ADDRESS_3", 
	"EXP_UPDATE_VALIDATOR___DOCK_DOOR_LOCN_ID as DOCK_DOOR_LOCN_ID", 
	"EXP_UPDATE_VALIDATOR___FLOOR_SHIPMENT as FLOOR_SHIPMENT", 
	"EXP_UPDATE_VALIDATOR___HIBERNATE_VERSION as HIBERNATE_VERSION", 
	"EXP_UPDATE_VALIDATOR___HITCH_TIME as HITCH_TIME", 
	"EXP_UPDATE_VALIDATOR___LOAD_CLOSED_INDICATOR as LOAD_CLOSED_INDICATOR", 
	"EXP_UPDATE_VALIDATOR___STOP_TIME_MODIFIED as STOP_TIME_MODIFIED", 
	"EXP_UPDATE_VALIDATOR___DRIVE_TIME as DRIVE_TIME", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_1 as REF_FIELD_1", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_2 as REF_FIELD_2", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_3 as REF_FIELD_3", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_4 as REF_FIELD_4", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_5 as REF_FIELD_5", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_6 as REF_FIELD_6", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_7 as REF_FIELD_7", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_8 as REF_FIELD_8", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_9 as REF_FIELD_9", 
	"EXP_UPDATE_VALIDATOR___REF_FIELD_10 as REF_FIELD_10", 
	"EXP_UPDATE_VALIDATOR___ORDER_WINDOW_VIOLATION as ORDER_WINDOW_VIOLATION", 
	"EXP_UPDATE_VALIDATOR___DOCK_VIOLATION as DOCK_VIOLATION", 
	"EXP_UPDATE_VALIDATOR___WAVE_OPTION_VIOLATION as WAVE_OPTION_VIOLATION", 
	"EXP_UPDATE_VALIDATOR___STAGING_LOCN_ID as STAGING_LOCN_ID", 
	"EXP_UPDATE_VALIDATOR___CALC_EST_ARRIVAL_DTTM as CALC_EST_ARRIVAL_DTTM", 
	"EXP_UPDATE_VALIDATOR___DEGREE_LATE_EARLY as DEGREE_LATE_EARLY", 
	"EXP_UPDATE_VALIDATOR___ON_STATIC_ROUTE as ON_STATIC_ROUTE", 
	"EXP_UPDATE_VALIDATOR___AUTO_APPOINTMENT as AUTO_APPOINTMENT", 
	"EXP_UPDATE_VALIDATOR___STOP_REVENUE as STOP_REVENUE", 
	"EXP_UPDATE_VALIDATOR___STOP_REVENUE_CURRENCY_CODE as STOP_REVENUE_CURRENCY_CODE", 
	"EXP_UPDATE_VALIDATOR___STOP_MARGIN as STOP_MARGIN", 
	"EXP_UPDATE_VALIDATOR___STOP_MARGIN_CURRENCY_CODE as STOP_MARGIN_CURRENCY_CODE", 
	"EXP_UPDATE_VALIDATOR___STOP_COST as STOP_COST", 
	"EXP_UPDATE_VALIDATOR___STOP_COST_CURRENCY_CODE as STOP_COST_CURRENCY_CODE", 
	"EXP_UPDATE_VALIDATOR___STOP_LINEHAUL_REVENUE as STOP_LINEHAUL_REVENUE", 
	"EXP_UPDATE_VALIDATOR___ACCESSORIAL_REVENUE as ACCESSORIAL_REVENUE", 
	"EXP_UPDATE_VALIDATOR___STOPOFF_REVENUE as STOPOFF_REVENUE", 
	"EXP_UPDATE_VALIDATOR___CM_DISCOUNT_REVENUE as CM_DISCOUNT_REVENUE", 
	"EXP_UPDATE_VALIDATOR___i_LOCATION_ID as i_LOCATION_ID", 
	"EXP_UPDATE_VALIDATOR___i_WM_SHIPMENT_ID as i_WM_SHIPMENT_ID", 
	"EXP_UPDATE_VALIDATOR___i_WM_STOP_SEQ as i_WM_STOP_SEQ", 
	"EXP_UPDATE_VALIDATOR___i_LOAD_TSTMP as i_LOAD_TSTMP", 
	"EXP_UPDATE_VALIDATOR___UPDATE_TSTMP as UPDATE_TSTMP", 
	"EXP_UPDATE_VALIDATOR___LOAD_TSTMP as LOAD_TSTMP", 
	"EXP_UPDATE_VALIDATOR___o_UPDATE_VALIDATOR as o_UPDATE_VALIDATOR"
).withColumn('pyspark_data_action', when(EXP_UPDATE_VALIDATOR.o_UPDATE_VALIDATOR ==(lit(1)) , lit(0)).when(EXP_UPDATE_VALIDATOR.o_UPDATE_VALIDATOR ==(lit(2)) , lit(1)))

# COMMAND ----------
# Processing node Shortcut_to_WM_STOP1, type TARGET 
# COLUMN COUNT: 125

try:
  primary_key = """source.LOCATION_ID = target.LOCATION_ID AND source.WM_SHIPMENT_ID = target.WM_SHIPMENT_ID AND source.WM_STOP_SEQ = target.WM_STOP_SEQ"""
  refined_perf_table = "WM_STOP"
  executeMerge(UPD_INS_UPD, refined_perf_table, primary_key)
  logger.info(f"Merge with {refined_perf_table} completed]")
  logPrevRunDt("WM_STOP", "WM_STOP", "Completed", "N/A", f"{raw}.log_run_details")
except Exception as e:
  logPrevRunDt("WM_STOP", "WM_STOP","Failed",str(e), f"{raw}.log_run_details", )
  raise e
	