#Code converted on 2023-06-24 13:33:12
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from pyspark.dbutils import DBUtils
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from Datalake.utils.logger import *



def m_WM_Stop_PRE(dcnbr, env):
    from logging import getLogger, INFO

    logger = getLogger()
    spark: SparkSession = SparkSession.getActiveSession()
    logger.info("inside m_WM_Stop_PRE")
    
    if dcnbr is None or dcnbr == "":
        raise ValueError("DC_NBR is not set")
    if env is None or env == "":
        raise ValueError("env is not set")
    
    refine = getEnvPrefix(env) + "refine"
    raw = getEnvPrefix(env) + "raw"
    
    tableName = "WM_STOP_PRE"
    schemaName = raw
    source_schema = "WMSMIS"

    
    target_table_name = schemaName + "." + tableName
    refine_table_name = tableName[:-4]
    Prev_Run_Dt=genPrevRunDt(refine_table_name, refine,raw)
    print("The prev run date is " + Prev_Run_Dt)
    
    (username, password, connection_string) = getConfig(dcnbr, env)
    logger.info("username, password, connection_string is obtained from getConfig fun")
    
    dcnbr = dcnbr.strip()[2:]
    
    query = f"""SELECT
                    STOP.SHIPMENT_ID,
                    STOP.STOP_SEQ,
                    STOP.TC_COMPANY_ID,
                    STOP.WAVE_ID,
                    STOP.WAVE_OPTION_ID,
                    STOP.WAVE_OPTION_LIST_ID,
                    STOP.ARRIVAL_LATE_REASON_ID,
                    STOP.DEPARTURE_LATE_REASON_ID,
                    STOP.SIZE_UOM_ID,
                    STOP.DOCK_DISPATCH_CAP_ID,
                    STOP.IS_APPT_REQD,
                    STOP.POS_ARR_START_DTTM,
                    STOP.POS_ARR_END_DTTM,
                    STOP.POS_DEPART_START_DTTM,
                    STOP.POS_DEPART_END_DTTM,
                    STOP.ARRIVAL_START_DTTM,
                    STOP.ARRIVAL_END_DTTM,
                    STOP.EST_ARRIVAL_DTTM,
                    STOP.ARRIVAL_COMMIT_DTTM,
                    STOP.ACTUAL_ARRIVAL_DTTM,
                    STOP.APPT_DTTM,
                    STOP.DEPARTURE_START_DTTM,
                    STOP.DEPARTURE_END_DTTM,
                    STOP.EST_DEPARTURE_DTTM,
                    STOP.ACTUAL_DEPARTURE_DTTM,
                    STOP.START_SHIPMENT_DTTM,
                    STOP.END_SHIPMENT_DTTM,
                    STOP.PAPERWORK_START_DTTM,
                    STOP.PICKUP_START_DTTM,
                    STOP.EST_DISPATCH_DTTM,
                    STOP.SHIPMENT_START_DTTM,
                    STOP.SHIPMENT_END_DTTM,
                    STOP.CHECKIN_TIME,
                    STOP.CHECKOUT_TIME,
                    STOP.ARRIVAL_NET_DTTM,
                    STOP.ARRIVAL_NLT_DTTM,
                    STOP.DEPARTURE_NET_DTTM,
                    STOP.DEPARTURE_NLT_DTTM,
                    STOP.REC_ARRIVAL_DTTM,
                    STOP.REC_DEPARTURE_DTTM,
                    STOP.BREAK_TIME,
                    STOP.WAITING_TIME,
                    STOP.STOP_LOCATION_NAME,
                    STOP.CONTACT_FIRST_NAME,
                    STOP.CONTACT_SURNAME,
                    STOP.CONTACT_PHONE_NUMBER,
                    STOP.FACILITY_ALIAS_ID,
                    STOP.FACILITY_ID,
                    STOP.ADDRESS_1,
                    STOP.ADDRESS_2,
                    STOP.CITY,
                    STOP.STATE_PROV,
                    STOP.POSTAL_CODE,
                    STOP.COUNTY,
                    STOP.COUNTRY_CODE,
                    STOP.HANDLER,
                    STOP.DISTANCE,
                    STOP.DISTANCE_UOM,
                    STOP.STOP_TZ,
                    STOP.BILL_OF_LADING_NUMBER,
                    STOP.DROP_HOOK_INDICATOR,
                    STOP.HANDLING_TIME,
                    STOP.REPORTED_HANDLER,
                    STOP.SEGMENT_ID,
                    STOP.SEGMENT_STOP_SEQ,
                    STOP.CAPACITY,
                    STOP.HAS_NOTES,
                    STOP.IS_ADDR_OVERRIDE,
                    STOP.IS_RECONSIGNED,
                    STOP.IS_EST_ARR_USER_DEFINED,
                    STOP.IS_EST_DEP_USER_DEFINED,
                    STOP.IS_WAVE_MAN_CHANGED,
                    STOP.DELAY_TYPE,
                    STOP.STOP_STATUS,
                    STOP.SEAL_NUMBER,
                    STOP.APPOINTMENT_DURATION,
                    STOP.BOL_TYPE,
                    STOP.PRO_NBR,
                    STOP.AUTH_NBR,
                    STOP.MANIF_TYPE,
                    STOP.CURR_PLT_ID,
                    STOP.CONS_LOCN_ID,
                    STOP.RTE_ID,
                    STOP.AES_ITN,
                    STOP.BOL_BREAK_ATTR,
                    STOP.FREIGHT_TERMS,
                    STOP.ADDRESS_3,
                    STOP.DOCK_DOOR_LOCN_ID,
                    STOP.FLOOR_SHIPMENT,
                    STOP.HIBERNATE_VERSION,
                    STOP.HITCH_TIME,
                    STOP.LOAD_CLOSED_INDICATOR,
                    STOP.STOP_TIME_MODIFIED,
                    STOP.DRIVE_TIME,
                    STOP.REF_FIELD_1,
                    STOP.REF_FIELD_2,
                    STOP.REF_FIELD_3,
                    STOP.REF_FIELD_4,
                    STOP.REF_FIELD_5,
                    STOP.REF_FIELD_6,
                    STOP.REF_FIELD_7,
                    STOP.REF_FIELD_8,
                    STOP.REF_FIELD_9,
                    STOP.REF_FIELD_10,
                    STOP.ORDER_WINDOW_VIOLATION,
                    STOP.DOCK_VIOLATION,
                    STOP.WAVE_OPTION_VIOLATION,
                    STOP.STAGING_LOCN_ID,
                    STOP.CALC_EST_ARRIVAL_DTTM,
                    STOP.DEGREE_LATE_EARLY,
                    STOP.ON_STATIC_ROUTE,
                    STOP.AUTO_APPOINTMENT,
                    STOP.STOP_REVENUE,
                    STOP.STOP_REVENUE_CURRENCY_CODE,
                    STOP.STOP_MARGIN,
                    STOP.STOP_MARGIN_CURRENCY_CODE,
                    STOP.STOP_COST,
                    STOP.STOP_COST_CURRENCY_CODE,
                    STOP.STOP_LINEHAUL_REVENUE,
                    STOP.ACCESSORIAL_REVENUE,
                    STOP.STOPOFF_REVENUE,
                    STOP.CM_DISCOUNT_REVENUE
                FROM {source_schema}.STOP"""
    
    SQ_Shortcut_to_STOP = jdbcOracleConnection(query, username, password, connection_string).withColumn("sys_row_id", monotonically_increasing_id())
    logger.info("SQL query for SQ_Shortcut_to_STOP is executed and data is loaded using jdbc")
    
    
    # Processing node EXP_TRN, type EXPRESSION 
    # COLUMN COUNT: 124
    
    # for each involved DataFrame, append the dataframe name to each column
    SQ_Shortcut_to_STOP_temp = SQ_Shortcut_to_STOP.toDF(*["SQ_Shortcut_to_STOP___" + col for col in SQ_Shortcut_to_STOP.columns])
    
    EXP_TRN = SQ_Shortcut_to_STOP_temp.selectExpr( 
        "SQ_Shortcut_to_STOP___sys_row_id as sys_row_id", 
        f"{dcnbr} as DC_NBR_EXP", 
        "SQ_Shortcut_to_STOP___SHIPMENT_ID as SHIPMENT_ID", 
        "SQ_Shortcut_to_STOP___STOP_SEQ as STOP_SEQ", 
        "SQ_Shortcut_to_STOP___TC_COMPANY_ID as TC_COMPANY_ID", 
        "SQ_Shortcut_to_STOP___WAVE_ID as WAVE_ID", 
        "SQ_Shortcut_to_STOP___WAVE_OPTION_ID as WAVE_OPTION_ID", 
        "SQ_Shortcut_to_STOP___WAVE_OPTION_LIST_ID as WAVE_OPTION_LIST_ID", 
        "SQ_Shortcut_to_STOP___ARRIVAL_LATE_REASON_ID as ARRIVAL_LATE_REASON_ID", 
        "SQ_Shortcut_to_STOP___DEPARTURE_LATE_REASON_ID as DEPARTURE_LATE_REASON_ID", 
        "SQ_Shortcut_to_STOP___SIZE_UOM_ID as SIZE_UOM_ID", 
        "SQ_Shortcut_to_STOP___DOCK_DISPATCH_CAP_ID as DOCK_DISPATCH_CAP_ID", 
        "SQ_Shortcut_to_STOP___IS_APPT_REQD as IS_APPT_REQD", 
        "SQ_Shortcut_to_STOP___POS_ARR_START_DTTM as POS_ARR_START_DTTM", 
        "SQ_Shortcut_to_STOP___POS_ARR_END_DTTM as POS_ARR_END_DTTM", 
        "SQ_Shortcut_to_STOP___POS_DEPART_START_DTTM as POS_DEPART_START_DTTM", 
        "SQ_Shortcut_to_STOP___POS_DEPART_END_DTTM as POS_DEPART_END_DTTM", 
        "SQ_Shortcut_to_STOP___ARRIVAL_START_DTTM as ARRIVAL_START_DTTM", 
        "SQ_Shortcut_to_STOP___ARRIVAL_END_DTTM as ARRIVAL_END_DTTM", 
        "SQ_Shortcut_to_STOP___EST_ARRIVAL_DTTM as EST_ARRIVAL_DTTM", 
        "SQ_Shortcut_to_STOP___ARRIVAL_COMMIT_DTTM as ARRIVAL_COMMIT_DTTM", 
        "SQ_Shortcut_to_STOP___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", 
        "SQ_Shortcut_to_STOP___APPT_DTTM as APPT_DTTM", 
        "SQ_Shortcut_to_STOP___DEPARTURE_START_DTTM as DEPARTURE_START_DTTM", 
        "SQ_Shortcut_to_STOP___DEPARTURE_END_DTTM as DEPARTURE_END_DTTM", 
        "SQ_Shortcut_to_STOP___EST_DEPARTURE_DTTM as EST_DEPARTURE_DTTM", 
        "SQ_Shortcut_to_STOP___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", 
        "SQ_Shortcut_to_STOP___START_SHIPMENT_DTTM as START_SHIPMENT_DTTM", 
        "SQ_Shortcut_to_STOP___END_SHIPMENT_DTTM as END_SHIPMENT_DTTM", 
        "SQ_Shortcut_to_STOP___PAPERWORK_START_DTTM as PAPERWORK_START_DTTM", 
        "SQ_Shortcut_to_STOP___PICKUP_START_DTTM as PICKUP_START_DTTM", 
        "SQ_Shortcut_to_STOP___EST_DISPATCH_DTTM as EST_DISPATCH_DTTM", 
        "SQ_Shortcut_to_STOP___SHIPMENT_START_DTTM as SHIPMENT_START_DTTM", 
        "SQ_Shortcut_to_STOP___SHIPMENT_END_DTTM as SHIPMENT_END_DTTM", 
        "SQ_Shortcut_to_STOP___CHECKIN_TIME as CHECKIN_TIME", 
        "SQ_Shortcut_to_STOP___CHECKOUT_TIME as CHECKOUT_TIME", 
        "SQ_Shortcut_to_STOP___ARRIVAL_NET_DTTM as ARRIVAL_NET_DTTM", 
        "SQ_Shortcut_to_STOP___ARRIVAL_NLT_DTTM as ARRIVAL_NLT_DTTM", 
        "SQ_Shortcut_to_STOP___DEPARTURE_NET_DTTM as DEPARTURE_NET_DTTM", 
        "SQ_Shortcut_to_STOP___DEPARTURE_NLT_DTTM as DEPARTURE_NLT_DTTM", 
        "SQ_Shortcut_to_STOP___REC_ARRIVAL_DTTM as REC_ARRIVAL_DTTM", 
        "SQ_Shortcut_to_STOP___REC_DEPARTURE_DTTM as REC_DEPARTURE_DTTM", 
        "SQ_Shortcut_to_STOP___BREAK_TIME as BREAK_TIME", 
        "SQ_Shortcut_to_STOP___WAITING_TIME as WAITING_TIME", 
        "SQ_Shortcut_to_STOP___STOP_LOCATION_NAME as STOP_LOCATION_NAME", 
        "SQ_Shortcut_to_STOP___CONTACT_FIRST_NAME as CONTACT_FIRST_NAME", 
        "SQ_Shortcut_to_STOP___CONTACT_SURNAME as CONTACT_SURNAME", 
        "SQ_Shortcut_to_STOP___CONTACT_PHONE_NUMBER as CONTACT_PHONE_NUMBER", 
        "SQ_Shortcut_to_STOP___FACILITY_ALIAS_ID as FACILITY_ALIAS_ID", 
        "SQ_Shortcut_to_STOP___FACILITY_ID as FACILITY_ID", 
        "SQ_Shortcut_to_STOP___ADDRESS_1 as ADDRESS_1", 
        "SQ_Shortcut_to_STOP___ADDRESS_2 as ADDRESS_2", 
        "SQ_Shortcut_to_STOP___CITY as CITY", 
        "SQ_Shortcut_to_STOP___STATE_PROV as STATE_PROV", 
        "SQ_Shortcut_to_STOP___POSTAL_CODE as POSTAL_CODE", 
        "SQ_Shortcut_to_STOP___COUNTY as COUNTY", 
        "SQ_Shortcut_to_STOP___COUNTRY_CODE as COUNTRY_CODE", 
        "SQ_Shortcut_to_STOP___HANDLER as HANDLER", 
        "SQ_Shortcut_to_STOP___DISTANCE as DISTANCE", 
        "SQ_Shortcut_to_STOP___DISTANCE_UOM as DISTANCE_UOM", 
        "SQ_Shortcut_to_STOP___STOP_TZ as STOP_TZ", 
        "SQ_Shortcut_to_STOP___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", 
        "SQ_Shortcut_to_STOP___DROP_HOOK_INDICATOR as DROP_HOOK_INDICATOR", 
        "SQ_Shortcut_to_STOP___HANDLING_TIME as HANDLING_TIME", 
        "SQ_Shortcut_to_STOP___REPORTED_HANDLER as REPORTED_HANDLER", 
        "SQ_Shortcut_to_STOP___SEGMENT_ID as SEGMENT_ID", 
        "SQ_Shortcut_to_STOP___SEGMENT_STOP_SEQ as SEGMENT_STOP_SEQ", 
        "SQ_Shortcut_to_STOP___CAPACITY as CAPACITY", 
        "SQ_Shortcut_to_STOP___HAS_NOTES as HAS_NOTES", 
        "SQ_Shortcut_to_STOP___IS_ADDR_OVERRIDE as IS_ADDR_OVERRIDE", 
        "SQ_Shortcut_to_STOP___IS_RECONSIGNED as IS_RECONSIGNED", 
        "SQ_Shortcut_to_STOP___IS_EST_ARR_USER_DEFINED as IS_EST_ARR_USER_DEFINED", 
        "SQ_Shortcut_to_STOP___IS_EST_DEP_USER_DEFINED as IS_EST_DEP_USER_DEFINED", 
        "SQ_Shortcut_to_STOP___IS_WAVE_MAN_CHANGED as IS_WAVE_MAN_CHANGED", 
        "SQ_Shortcut_to_STOP___DELAY_TYPE as DELAY_TYPE", 
        "SQ_Shortcut_to_STOP___STOP_STATUS as STOP_STATUS", 
        "SQ_Shortcut_to_STOP___SEAL_NUMBER as SEAL_NUMBER", 
        "SQ_Shortcut_to_STOP___APPOINTMENT_DURATION as APPOINTMENT_DURATION", 
        "SQ_Shortcut_to_STOP___BOL_TYPE as BOL_TYPE", 
        "SQ_Shortcut_to_STOP___PRO_NBR as PRO_NBR", 
        "SQ_Shortcut_to_STOP___AUTH_NBR as AUTH_NBR", 
        "SQ_Shortcut_to_STOP___MANIF_TYPE as MANIF_TYPE", 
        "SQ_Shortcut_to_STOP___CURR_PLT_ID as CURR_PLT_ID", 
        "SQ_Shortcut_to_STOP___CONS_LOCN_ID as CONS_LOCN_ID", 
        "SQ_Shortcut_to_STOP___RTE_ID as RTE_ID", 
        "SQ_Shortcut_to_STOP___AES_ITN as AES_ITN", 
        "SQ_Shortcut_to_STOP___BOL_BREAK_ATTR as BOL_BREAK_ATTR", 
        "SQ_Shortcut_to_STOP___FREIGHT_TERMS as FREIGHT_TERMS", 
        "SQ_Shortcut_to_STOP___ADDRESS_3 as ADDRESS_3", 
        "SQ_Shortcut_to_STOP___DOCK_DOOR_LOCN_ID as DOCK_DOOR_LOCN_ID", 
        "SQ_Shortcut_to_STOP___FLOOR_SHIPMENT as FLOOR_SHIPMENT", 
        "SQ_Shortcut_to_STOP___HIBERNATE_VERSION as HIBERNATE_VERSION", 
        "SQ_Shortcut_to_STOP___HITCH_TIME as HITCH_TIME", 
        "SQ_Shortcut_to_STOP___LOAD_CLOSED_INDICATOR as LOAD_CLOSED_INDICATOR", 
        "SQ_Shortcut_to_STOP___STOP_TIME_MODIFIED as STOP_TIME_MODIFIED", 
        "SQ_Shortcut_to_STOP___DRIVE_TIME as DRIVE_TIME", 
        "SQ_Shortcut_to_STOP___REF_FIELD_1 as REF_FIELD_1", 
        "SQ_Shortcut_to_STOP___REF_FIELD_2 as REF_FIELD_2", 
        "SQ_Shortcut_to_STOP___REF_FIELD_3 as REF_FIELD_3", 
        "SQ_Shortcut_to_STOP___REF_FIELD_4 as REF_FIELD_4", 
        "SQ_Shortcut_to_STOP___REF_FIELD_5 as REF_FIELD_5", 
        "SQ_Shortcut_to_STOP___REF_FIELD_6 as REF_FIELD_6", 
        "SQ_Shortcut_to_STOP___REF_FIELD_7 as REF_FIELD_7", 
        "SQ_Shortcut_to_STOP___REF_FIELD_8 as REF_FIELD_8", 
        "SQ_Shortcut_to_STOP___REF_FIELD_9 as REF_FIELD_9", 
        "SQ_Shortcut_to_STOP___REF_FIELD_10 as REF_FIELD_10", 
        "SQ_Shortcut_to_STOP___ORDER_WINDOW_VIOLATION as ORDER_WINDOW_VIOLATION", 
        "SQ_Shortcut_to_STOP___DOCK_VIOLATION as DOCK_VIOLATION", 
        "SQ_Shortcut_to_STOP___WAVE_OPTION_VIOLATION as WAVE_OPTION_VIOLATION", 
        "SQ_Shortcut_to_STOP___STAGING_LOCN_ID as STAGING_LOCN_ID", 
        "SQ_Shortcut_to_STOP___CALC_EST_ARRIVAL_DTTM as CALC_EST_ARRIVAL_DTTM", 
        "SQ_Shortcut_to_STOP___DEGREE_LATE_EARLY as DEGREE_LATE_EARLY", 
        "SQ_Shortcut_to_STOP___ON_STATIC_ROUTE as ON_STATIC_ROUTE", 
        "SQ_Shortcut_to_STOP___AUTO_APPOINTMENT as AUTO_APPOINTMENT", 
        "SQ_Shortcut_to_STOP___STOP_REVENUE as STOP_REVENUE", 
        "SQ_Shortcut_to_STOP___STOP_REVENUE_CURRENCY_CODE as STOP_REVENUE_CURRENCY_CODE", 
        "SQ_Shortcut_to_STOP___STOP_MARGIN as STOP_MARGIN", 
        "SQ_Shortcut_to_STOP___STOP_MARGIN_CURRENCY_CODE as STOP_MARGIN_CURRENCY_CODE", 
        "SQ_Shortcut_to_STOP___STOP_COST as STOP_COST", 
        "SQ_Shortcut_to_STOP___STOP_COST_CURRENCY_CODE as STOP_COST_CURRENCY_CODE", 
        "SQ_Shortcut_to_STOP___STOP_LINEHAUL_REVENUE as STOP_LINEHAUL_REVENUE", 
        "SQ_Shortcut_to_STOP___ACCESSORIAL_REVENUE as ACCESSORIAL_REVENUE", 
        "SQ_Shortcut_to_STOP___STOPOFF_REVENUE as STOPOFF_REVENUE", 
        "SQ_Shortcut_to_STOP___CM_DISCOUNT_REVENUE as CM_DISCOUNT_REVENUE", 
        "CURRENT_TIMESTAMP() as LOAD_TSTMP_EXP" 
    )
    
    
    # Processing node Shortcut_to_WM_STOP_PRE, type TARGET 
    # COLUMN COUNT: 124
    
    
    Shortcut_to_WM_STOP_PRE = EXP_TRN.selectExpr(
        "CAST(DC_NBR_EXP AS SMALLINT) as DC_NBR",
        "CAST(SHIPMENT_ID AS BIGINT) as SHIPMENT_ID",
        "CAST(STOP_SEQ AS INT) as STOP_SEQ",
        "CAST(TC_COMPANY_ID AS INT) as TC_COMPANY_ID",
        "CAST(WAVE_ID AS BIGINT) as WAVE_ID",
        "CAST(WAVE_OPTION_ID AS BIGINT) as WAVE_OPTION_ID",
        "CAST(WAVE_OPTION_LIST_ID AS INT) as WAVE_OPTION_LIST_ID",
        "CAST(ARRIVAL_LATE_REASON_ID AS INT) as ARRIVAL_LATE_REASON_ID",
        "CAST(DEPARTURE_LATE_REASON_ID AS INT) as DEPARTURE_LATE_REASON_ID",
        "CAST(SIZE_UOM_ID AS INT) as SIZE_UOM_ID",
        "CAST(DOCK_DISPATCH_CAP_ID AS BIGINT) as DOCK_DISPATCH_CAP_ID",
        "CAST(IS_APPT_REQD AS TINYINT) as IS_APPT_REQD",
        "CAST(POS_ARR_START_DTTM AS TIMESTAMP) as POS_ARR_START_DTTM",
        "CAST(POS_ARR_END_DTTM AS TIMESTAMP) as POS_ARR_END_DTTM",
        "CAST(POS_DEPART_START_DTTM AS TIMESTAMP) as POS_DEPART_START_DTTM",
        "CAST(POS_DEPART_END_DTTM AS TIMESTAMP) as POS_DEPART_END_DTTM",
        "CAST(ARRIVAL_START_DTTM AS TIMESTAMP) as ARRIVAL_START_DTTM",
        "CAST(ARRIVAL_END_DTTM AS TIMESTAMP) as ARRIVAL_END_DTTM",
        "CAST(EST_ARRIVAL_DTTM AS TIMESTAMP) as EST_ARRIVAL_DTTM",
        "CAST(ARRIVAL_COMMIT_DTTM AS TIMESTAMP) as ARRIVAL_COMMIT_DTTM",
        "CAST(ACTUAL_ARRIVAL_DTTM AS TIMESTAMP) as ACTUAL_ARRIVAL_DTTM",
        "CAST(APPT_DTTM AS TIMESTAMP) as APPT_DTTM",
        "CAST(DEPARTURE_START_DTTM AS TIMESTAMP) as DEPARTURE_START_DTTM",
        "CAST(DEPARTURE_END_DTTM AS TIMESTAMP) as DEPARTURE_END_DTTM",
        "CAST(EST_DEPARTURE_DTTM AS TIMESTAMP) as EST_DEPARTURE_DTTM",
        "CAST(ACTUAL_DEPARTURE_DTTM AS TIMESTAMP) as ACTUAL_DEPARTURE_DTTM",
        "CAST(START_SHIPMENT_DTTM AS TIMESTAMP) as START_SHIPMENT_DTTM",
        "CAST(END_SHIPMENT_DTTM AS TIMESTAMP) as END_SHIPMENT_DTTM",
        "CAST(PAPERWORK_START_DTTM AS TIMESTAMP) as PAPERWORK_START_DTTM",
        "CAST(PICKUP_START_DTTM AS TIMESTAMP) as PICKUP_START_DTTM",
        "CAST(EST_DISPATCH_DTTM AS TIMESTAMP) as EST_DISPATCH_DTTM",
        "CAST(SHIPMENT_START_DTTM AS TIMESTAMP) as SHIPMENT_START_DTTM",
        "CAST(SHIPMENT_END_DTTM AS TIMESTAMP) as SHIPMENT_END_DTTM",
        "CAST(CHECKIN_TIME AS TIMESTAMP) as CHECKIN_TIME",
        "CAST(CHECKOUT_TIME AS TIMESTAMP) as CHECKOUT_TIME",
        "CAST(ARRIVAL_NET_DTTM AS TIMESTAMP) as ARRIVAL_NET_DTTM",
        "CAST(ARRIVAL_NLT_DTTM AS TIMESTAMP) as ARRIVAL_NLT_DTTM",
        "CAST(DEPARTURE_NET_DTTM AS TIMESTAMP) as DEPARTURE_NET_DTTM",
        "CAST(DEPARTURE_NLT_DTTM AS TIMESTAMP) as DEPARTURE_NLT_DTTM",
        "CAST(REC_ARRIVAL_DTTM AS TIMESTAMP) as REC_ARRIVAL_DTTM",
        "CAST(REC_DEPARTURE_DTTM AS TIMESTAMP) as REC_DEPARTURE_DTTM",
        "CAST(BREAK_TIME AS INT) as BREAK_TIME",
        "CAST(WAITING_TIME AS INT) as WAITING_TIME",
        "CAST(STOP_LOCATION_NAME AS STRING) as STOP_LOCATION_NAME",
        "CAST(CONTACT_FIRST_NAME AS STRING) as CONTACT_FIRST_NAME",
        "CAST(CONTACT_SURNAME AS STRING) as CONTACT_SURNAME",
        "CAST(CONTACT_PHONE_NUMBER AS STRING) as CONTACT_PHONE_NUMBER",
        "CAST(FACILITY_ALIAS_ID AS STRING) as FACILITY_ALIAS_ID",
        "CAST(FACILITY_ID AS INT) as FACILITY_ID",
        "CAST(ADDRESS_1 AS STRING) as ADDRESS_1",
        "CAST(ADDRESS_2 AS STRING) as ADDRESS_2",
        "CAST(CITY AS STRING) as CITY",
        "CAST(STATE_PROV AS STRING) as STATE_PROV",
        "CAST(POSTAL_CODE AS STRING) as POSTAL_CODE",
        "CAST(COUNTY AS STRING) as COUNTY",
        "CAST(COUNTRY_CODE AS STRING) as COUNTRY_CODE",
        "CAST(HANDLER AS TINYINT) as HANDLER",
        "CAST(DISTANCE AS DECIMAL(9,2)) as DISTANCE",
        "CAST(DISTANCE_UOM AS STRING) as DISTANCE_UOM",
        "CAST(STOP_TZ AS SMALLINT) as STOP_TZ",
        "CAST(BILL_OF_LADING_NUMBER AS STRING) as BILL_OF_LADING_NUMBER",
        "CAST(DROP_HOOK_INDICATOR AS TINYINT) as DROP_HOOK_INDICATOR",
        "CAST(HANDLING_TIME AS DECIMAL(10,2)) as HANDLING_TIME",
        "CAST(REPORTED_HANDLER AS TINYINT) as REPORTED_HANDLER",
        "CAST(SEGMENT_ID AS BIGINT) as SEGMENT_ID",
        "CAST(SEGMENT_STOP_SEQ AS SMALLINT) as SEGMENT_STOP_SEQ",
        "CAST(CAPACITY AS INT) as CAPACITY",
        "CAST(HAS_NOTES AS TINYINT) as HAS_NOTES",
        "CAST(IS_ADDR_OVERRIDE AS TINYINT) as IS_ADDR_OVERRIDE",
        "CAST(IS_RECONSIGNED AS TINYINT) as IS_RECONSIGNED",
        "CAST(IS_EST_ARR_USER_DEFINED AS TINYINT) as IS_EST_ARR_USER_DEFINED",
        "CAST(IS_EST_DEP_USER_DEFINED AS TINYINT) as IS_EST_DEP_USER_DEFINED",
        "CAST(IS_WAVE_MAN_CHANGED AS TINYINT) as IS_WAVE_MAN_CHANGED",
        "CAST(DELAY_TYPE AS INT) as DELAY_TYPE",
        "CAST(STOP_STATUS AS SMALLINT) as STOP_STATUS",
        "CAST(SEAL_NUMBER AS STRING) as SEAL_NUMBER",
        "CAST(APPOINTMENT_DURATION AS INT) as APPOINTMENT_DURATION",
        "CAST(BOL_TYPE AS TINYINT) as BOL_TYPE",
        "CAST(PRO_NBR AS STRING) as PRO_NBR",
        "CAST(AUTH_NBR AS STRING) as AUTH_NBR",
        "CAST(MANIF_TYPE AS STRING) as MANIF_TYPE",
        "CAST(CURR_PLT_ID AS STRING) as CURR_PLT_ID",
        "CAST(CONS_LOCN_ID AS STRING) as CONS_LOCN_ID",
        "CAST(RTE_ID AS STRING) as RTE_ID",
        "CAST(AES_ITN AS STRING) as AES_ITN",
        "CAST(BOL_BREAK_ATTR AS STRING) as BOL_BREAK_ATTR",
        "CAST(FREIGHT_TERMS AS STRING) as FREIGHT_TERMS",
        "CAST(ADDRESS_3 AS STRING) as ADDRESS_3",
        "CAST(DOCK_DOOR_LOCN_ID AS STRING) as DOCK_DOOR_LOCN_ID",
        "CAST(FLOOR_SHIPMENT AS STRING) as FLOOR_SHIPMENT",
        "CAST(HIBERNATE_VERSION AS BIGINT) as HIBERNATE_VERSION",
        "CAST(HITCH_TIME AS INT) as HITCH_TIME",
        "CAST(LOAD_CLOSED_INDICATOR AS TINYINT) as LOAD_CLOSED_INDICATOR",
        "CAST(STOP_TIME_MODIFIED AS TINYINT) as STOP_TIME_MODIFIED",
        "CAST(DRIVE_TIME AS INT) as DRIVE_TIME",
        "CAST(REF_FIELD_1 AS STRING) as REF_FIELD_1",
        "CAST(REF_FIELD_2 AS STRING) as REF_FIELD_2",
        "CAST(REF_FIELD_3 AS STRING) as REF_FIELD_3",
        "CAST(REF_FIELD_4 AS STRING) as REF_FIELD_4",
        "CAST(REF_FIELD_5 AS STRING) as REF_FIELD_5",
        "CAST(REF_FIELD_6 AS STRING) as REF_FIELD_6",
        "CAST(REF_FIELD_7 AS STRING) as REF_FIELD_7",
        "CAST(REF_FIELD_8 AS STRING) as REF_FIELD_8",
        "CAST(REF_FIELD_9 AS STRING) as REF_FIELD_9",
        "CAST(REF_FIELD_10 AS STRING) as REF_FIELD_10",
        "CAST(ORDER_WINDOW_VIOLATION AS BIGINT) as ORDER_WINDOW_VIOLATION",
        "CAST(DOCK_VIOLATION AS BIGINT) as DOCK_VIOLATION",
        "CAST(WAVE_OPTION_VIOLATION AS BIGINT) as WAVE_OPTION_VIOLATION",
        "CAST(STAGING_LOCN_ID AS STRING) as STAGING_LOCN_ID",
        "CAST(CALC_EST_ARRIVAL_DTTM AS TIMESTAMP) as CALC_EST_ARRIVAL_DTTM",
        "CAST(DEGREE_LATE_EARLY AS INT) as DEGREE_LATE_EARLY",
        "CAST(ON_STATIC_ROUTE AS TINYINT) as ON_STATIC_ROUTE",
        "CAST(AUTO_APPOINTMENT AS TINYINT) as AUTO_APPOINTMENT",
        "CAST(STOP_REVENUE AS DECIMAL(13,4)) as STOP_REVENUE",
        "CAST(STOP_REVENUE_CURRENCY_CODE AS STRING) as STOP_REVENUE_CURRENCY_CODE",
        "CAST(STOP_MARGIN AS DECIMAL(13,4)) as STOP_MARGIN",
        "CAST(STOP_MARGIN_CURRENCY_CODE AS STRING) as STOP_MARGIN_CURRENCY_CODE",
        "CAST(STOP_COST AS DECIMAL(13,4)) as STOP_COST",
        "CAST(STOP_COST_CURRENCY_CODE AS STRING) as STOP_COST_CURRENCY_CODE",
        "CAST(STOP_LINEHAUL_REVENUE AS DECIMAL(13,4)) as STOP_LINEHAUL_REVENUE",
        "CAST(ACCESSORIAL_REVENUE AS DECIMAL(13,4)) as ACCESSORIAL_REVENUE",
        "CAST(STOPOFF_REVENUE AS DECIMAL(13,4)) as STOPOFF_REVENUE",
        "CAST(CM_DISCOUNT_REVENUE AS DECIMAL(13,3)) as CM_DISCOUNT_REVENUE",
        "CAST(LOAD_TSTMP_EXP AS TIMESTAMP) as LOAD_TSTMP"
    )    
    overwriteDeltaPartition(Shortcut_to_WM_STOP_PRE, "DC_NBR", dcnbr, target_table_name)
    logger.info("Shortcut_to_WM_STOP_PRE is written to the target table - " + target_table_name)
