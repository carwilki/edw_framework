#Code converted on 2023-06-21 18:43:21
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from pyspark.dbutils import DBUtils
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from Datalake.utils.logger import *

# COMMAND ----------

parser = argparse.ArgumentParser()
spark = SparkSession.getActiveSession()
dbutils = DBUtils(spark)

parser.add_argument('env', type=str, help='Env Variable')
args = parser.parse_args()
env = args.env
#  env = 'dev'

if env is None or env == '':
    raise ValueError('env is not set')

refine = getEnvPrefix(env) + 'refine'
raw = getEnvPrefix(env) + 'raw'
legacy = getEnvPrefix(env) + 'legacy'

# Set global variables
starttime = datetime.now() #start timestamp of the script
raw_perf_table = f"{raw}.WM_ITEM_FACILITY_SLOTTING_PRE"
refined_perf_table = f"{refine}.WM_ITEM_FACILITY_SLOTTING"
site_profile_table = f"{legacy}.SITE_PROFILE"

Prev_Run_Dt=genPrevRunDt(refined_perf_table.split(".")[1], refine,raw)
Del_Logic= ' -- ' #args.Del_Logic

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE, type SOURCE 
# COLUMN COUNT: 92

SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE = spark.sql(f"""SELECT
DC_NBR,
ITEM_FACILITY_MAPPING_ID,
ITEM_ID,
ITEM_NAME,
WHSE_CODE,
UNIT_MEAS,
MANUAL,
IS_NEW,
ALLOW_SLU,
ALLOW_SU,
DISC_TRANS,
EACH_PER_BIN,
EX_RECPT_DATE,
DISCONT,
PROCESSED,
INN_PER_CS,
MAX_STACKING,
MAX_LANES,
NUM_UNITS_PER_BIN,
RESERVED_1,
RESERVED_2,
RESERVED_3,
RESERVED_4,
CREATE_DATE_TIME,
MOD_DATE_TIME,
MOD_USER,
RESERVE_RACK_TYPE_ID,
ALLOW_RESERVE,
PALPAT_RESERVE,
THREE_D_CALC_DONE,
MAX_SLOTS,
MAX_PALLET_STACKING,
PROP_BORROWING_OBJECT,
PROP_BORROWING_SPECIFIC,
HEIGHT_CAN_BORROW,
LENGTH_CAN_BORROW,
WIDTH_CAN_BORROW,
WEIGHT_CAN_BORROW,
VEND_PACK_CAN_BORROW,
INNER_PACK_CAN_BORROW,
TI_CAN_BORROW,
HI_CAN_BORROW,
QTY_PER_GRAB_CAN_BORROW,
HAND_ATTR_CAN_BORROW,
FAM_GRP_CAN_BORROW,
COMMODITY_CAN_BORROW,
CRUSHABILITY_CAN_BORROW,
HAZARD_CAN_BORROW,
VEND_CODE_CAN_BORROW,
MISC1_CAN_BORROW,
MISC2_CAN_BORROW,
MISC3_CAN_BORROW,
MISC4_CAN_BORROW,
MISC5_CAN_BORROW,
MISC6_CAN_BORROW,
HEIGHT_BORROWED,
LENGTH_BORROWED,
WIDTH_BORROWED,
WEIGHT_BORROWED,
VEND_PACK_BORROWED,
INNER_PACK_BORROWED,
TI_BORROWED,
HI_BORROWED,
QTY_PER_GRAB_BORROWED,
HAND_ATTR_BORROWED,
FAM_GRP_BORROWED,
COMMODITY_BORROWED,
CRUSHABILITY_BORROWED,
HAZARD_BORROWED,
VEND_CODE_BORROWED,
MISC1_BORROWED,
MISC2_BORROWED,
MISC3_BORROWED,
MISC4_BORROWED,
MISC5_BORROWED,
MISC6_BORROWED,
AFRAME_HT,
AFRAME_LEN,
AFRAME_WID,
AFRAME_WT,
AFRAME_ALLOW,
ITEM_NUM_1,
ITEM_NUM_2,
ITEM_NUM_3,
ITEM_NUM_4,
ITEM_NUM_5,
ITEM_CHAR_1,
ITEM_CHAR_2,
ITEM_CHAR_3,
ITEM_CHAR_4,
ITEM_CHAR_5,
SLOTTING_GROUP
FROM {raw_perf_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING, type SOURCE 
# COLUMN COUNT: 94

SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING = spark.sql(f"""SELECT
LOCATION_ID,
WM_ITEM_FACILITY_MAPPING_ID,
WM_ITEM_ID,
WM_ITEM_NAME,
WM_WHSE_CD,
WM_SLOTTING_GROUP,
DISC_TRANS_TSTMP,
EX_RECEIPT_TSTMP,
UNIT_MEASURE,
EACH_PER_BIN,
NBR_UNITS_PER_BIN,
INN_PER_CS,
MAX_SLOTS,
MAX_PALLET_STACKING,
MAX_STACKING,
MAX_LANES,
WM_RESERVE_RACK_TYPE_ID,
AFRAME_HT,
AFRAME_LEN,
AFRAME_WID,
AFRAME_WT,
AFRAME_ALLOW_FLAG,
ALLOW_SLU,
ALLOW_SU,
ALLOW_RESERVE,
PALPAT_RESERVE,
THREE_D_CALC_DONE,
PROP_BORROWING_OBJECT,
PROP_BORROWING_SPECIFIC,
HEIGHT_CAN_BORROW_FLAG,
LENGTH_CAN_BORROW_FLAG,
WIDTH_CAN_BORROW_FLAG,
WEIGHT_CAN_BORROW_FLAG,
VEND_PACK_CAN_BORROW_FLAG,
INNER_PACK_CAN_BORROW_FLAG,
TI_CAN_BORROW_FLAG,
HI_CAN_BORROW_FLAG,
QTY_PER_GRAB_CAN_BORROW_FLAG,
HAND_ATTR_CAN_BORROW_FLAG,
FAM_GRP_CAN_BORROW_FLAG,
COMMODITY_CAN_BORROW_FLAG,
CRUSHABILITY_CAN_BORROW_FLAG,
HAZARD_CAN_BORROW_FLAG,
VEND_CODE_CAN_BORROW_FLAG,
HEIGHT_BORROWED_FLAG,
LENGTH_BORROWED_FLAG,
WIDTH_BORROWED_FLAG,
WEIGHT_BORROWED_FLAG,
VEND_PACK_BORROWED_FLAG,
INNER_PACK_BORROWED_FLAG,
TI_BORROWED_FLAG,
HI_BORROWED_FLAG,
QTY_PER_GRAB_BORROWED_FLAG,
HAND_ATTR_BORROWED_FLAG,
FAM_GRP_BORROWED_FLAG,
COMMODITY_BORROWED_FLAG,
CRUSHABILITY_BORROWED_FLAG,
HAZARD_BORROWED_FLAG,
VEND_CODE_BORROWED_FLAG,
ITEM_NUM_1,
ITEM_NUM_2,
ITEM_NUM_3,
ITEM_NUM_4,
ITEM_NUM_5,
ITEM_CHAR_1,
ITEM_CHAR_2,
ITEM_CHAR_3,
ITEM_CHAR_4,
ITEM_CHAR_5,
RESERVED_1,
RESERVED_2,
RESERVED_3,
RESERVED_4,
MISC_1_BORROWED_FLAG,
MISC_2_BORROWED_FLAG,
MISC_3_BORROWED_FLAG,
MISC_4_BORROWED_FLAG,
MISC_5_BORROWED_FLAG,
MISC_6_BORROWED_FLAG,
MISC_1_CAN_BORROW_FLAG,
MISC_2_CAN_BORROW_FLAG,
MISC_3_CAN_BORROW_FLAG,
MISC_4_CAN_BORROW_FLAG,
MISC_5_CAN_BORROW_FLAG,
MISC_6_CAN_BORROW_FLAG,
DISCONTINUED_FLAG,
MANUAL_FLAG,
NEW_FLAG,
PROCESSED_FLAG,
WM_MOD_USER,
WM_CREATE_TSTMP,
WM_MOD_TSTMP,
DELETE_FLAG,
LOAD_TSTMP
FROM {refined_perf_table}
WHERE {Del_Logic} 1=0 and 
DELETE_FLAG = 0""").withColumn("sys_row_id", monotonically_increasing_id()).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_TRANS, type EXPRESSION 
# COLUMN COUNT: 92

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE_temp = SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE.toDF(*["SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___" + col for col in SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE.columns])

EXP_TRANS = SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE_temp.selectExpr( \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___sys_row_id as sys_row_id", \
	"cast(SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___DC_NBR as int) as o_DC_NBR", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_FACILITY_MAPPING_ID as ITEM_FACILITY_MAPPING_ID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_ID as ITEM_ID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_NAME as ITEM_NAME", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___WHSE_CODE as WHSE_CODE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___UNIT_MEAS as UNIT_MEAS", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MANUAL as MANUAL", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___IS_NEW as IS_NEW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ALLOW_SLU as ALLOW_SLU", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ALLOW_SU as ALLOW_SU", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___DISC_TRANS as DISC_TRANS", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___EACH_PER_BIN as EACH_PER_BIN", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___EX_RECPT_DATE as EX_RECPT_DATE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___DISCONT as DISCONT", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___PROCESSED as PROCESSED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___INN_PER_CS as INN_PER_CS", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MAX_STACKING as MAX_STACKING", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MAX_LANES as MAX_LANES", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___NUM_UNITS_PER_BIN as NUM_UNITS_PER_BIN", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___RESERVED_1 as RESERVED_1", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___RESERVED_2 as RESERVED_2", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___RESERVED_3 as RESERVED_3", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___RESERVED_4 as RESERVED_4", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___CREATE_DATE_TIME as CREATE_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MOD_DATE_TIME as MOD_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MOD_USER as MOD_USER", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___RESERVE_RACK_TYPE_ID as RESERVE_RACK_TYPE_ID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ALLOW_RESERVE as ALLOW_RESERVE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___PALPAT_RESERVE as PALPAT_RESERVE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___THREE_D_CALC_DONE as THREE_D_CALC_DONE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MAX_SLOTS as MAX_SLOTS", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MAX_PALLET_STACKING as MAX_PALLET_STACKING", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___PROP_BORROWING_OBJECT as PROP_BORROWING_OBJECT", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___PROP_BORROWING_SPECIFIC as PROP_BORROWING_SPECIFIC", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HEIGHT_CAN_BORROW as HEIGHT_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___LENGTH_CAN_BORROW as LENGTH_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___WIDTH_CAN_BORROW as WIDTH_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___WEIGHT_CAN_BORROW as WEIGHT_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___VEND_PACK_CAN_BORROW as VEND_PACK_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___INNER_PACK_CAN_BORROW as INNER_PACK_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___TI_CAN_BORROW as TI_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HI_CAN_BORROW as HI_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___QTY_PER_GRAB_CAN_BORROW as QTY_PER_GRAB_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HAND_ATTR_CAN_BORROW as HAND_ATTR_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___FAM_GRP_CAN_BORROW as FAM_GRP_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___COMMODITY_CAN_BORROW as COMMODITY_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___CRUSHABILITY_CAN_BORROW as CRUSHABILITY_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HAZARD_CAN_BORROW as HAZARD_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___VEND_CODE_CAN_BORROW as VEND_CODE_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC1_CAN_BORROW as MISC1_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC2_CAN_BORROW as MISC2_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC3_CAN_BORROW as MISC3_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC4_CAN_BORROW as MISC4_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC5_CAN_BORROW as MISC5_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC6_CAN_BORROW as MISC6_CAN_BORROW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HEIGHT_BORROWED as HEIGHT_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___LENGTH_BORROWED as LENGTH_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___WIDTH_BORROWED as WIDTH_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___WEIGHT_BORROWED as WEIGHT_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___VEND_PACK_BORROWED as VEND_PACK_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___INNER_PACK_BORROWED as INNER_PACK_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___TI_BORROWED as TI_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HI_BORROWED as HI_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___QTY_PER_GRAB_BORROWED as QTY_PER_GRAB_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HAND_ATTR_BORROWED as HAND_ATTR_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___FAM_GRP_BORROWED as FAM_GRP_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___COMMODITY_BORROWED as COMMODITY_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___CRUSHABILITY_BORROWED as CRUSHABILITY_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___HAZARD_BORROWED as HAZARD_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___VEND_CODE_BORROWED as VEND_CODE_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC1_BORROWED as MISC1_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC2_BORROWED as MISC2_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC3_BORROWED as MISC3_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC4_BORROWED as MISC4_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC5_BORROWED as MISC5_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___MISC6_BORROWED as MISC6_BORROWED", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___AFRAME_HT as AFRAME_HT", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___AFRAME_LEN as AFRAME_LEN", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___AFRAME_WID as AFRAME_WID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___AFRAME_WT as AFRAME_WT", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___AFRAME_ALLOW as AFRAME_ALLOW", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_NUM_1 as ITEM_NUM_1", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_NUM_2 as ITEM_NUM_2", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_NUM_3 as ITEM_NUM_3", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_NUM_4 as ITEM_NUM_4", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_NUM_5 as ITEM_NUM_5", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_CHAR_1 as ITEM_CHAR_1", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_CHAR_2 as ITEM_CHAR_2", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_CHAR_3 as ITEM_CHAR_3", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_CHAR_4 as ITEM_CHAR_4", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___ITEM_CHAR_5 as ITEM_CHAR_5", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_PRE___SLOTTING_GROUP as SLOTTING_GROUP" \
)

# COMMAND ----------
# Processing node SQ_Shortcut_to_SITE_PROFILE, type SOURCE 
# COLUMN COUNT: 2

SQ_Shortcut_to_SITE_PROFILE = spark.sql(f"""SELECT LOCATION_ID, STORE_NBR FROM {site_profile_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node JNR_SITE_PROFILE, type JOINER 
# COLUMN COUNT: 94

JNR_SITE_PROFILE = EXP_TRANS.join(SQ_Shortcut_to_SITE_PROFILE,[EXP_TRANS.o_DC_NBR == SQ_Shortcut_to_SITE_PROFILE.STORE_NBR],'inner')

# COMMAND ----------
# Processing node JNR_WM_ITEM_FACILITY_SLOTTING, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 186

# for each involved DataFrame, append the dataframe name to each column
JNR_SITE_PROFILE_temp = JNR_SITE_PROFILE.toDF(*["JNR_SITE_PROFILE___" + col for col in JNR_SITE_PROFILE.columns])
SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_temp = SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING.toDF(*["SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___" + col for col in SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING.columns])

JNR_WM_ITEM_FACILITY_SLOTTING = SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_temp.join(JNR_SITE_PROFILE_temp,[SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_temp.SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___LOCATION_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___LOCATION_ID, SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING_temp.SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_ITEM_FACILITY_MAPPING_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___ITEM_FACILITY_MAPPING_ID],'fullouter').selectExpr( \
	"JNR_SITE_PROFILE___LOCATION_ID as LOCATION_ID", \
	"JNR_SITE_PROFILE___ITEM_FACILITY_MAPPING_ID as ITEM_FACILITY_MAPPING_ID", \
	"JNR_SITE_PROFILE___ITEM_ID as ITEM_ID", \
	"JNR_SITE_PROFILE___ITEM_NAME as ITEM_NAME", \
	"JNR_SITE_PROFILE___WHSE_CODE as WHSE_CODE", \
	"JNR_SITE_PROFILE___UNIT_MEAS as UNIT_MEAS", \
	"JNR_SITE_PROFILE___MANUAL as MANUAL", \
	"JNR_SITE_PROFILE___IS_NEW as IS_NEW", \
	"JNR_SITE_PROFILE___ALLOW_SLU as ALLOW_SLU", \
	"JNR_SITE_PROFILE___ALLOW_SU as ALLOW_SU", \
	"JNR_SITE_PROFILE___DISC_TRANS as DISC_TRANS", \
	"JNR_SITE_PROFILE___EACH_PER_BIN as EACH_PER_BIN", \
	"JNR_SITE_PROFILE___EX_RECPT_DATE as EX_RECPT_DATE", \
	"JNR_SITE_PROFILE___DISCONT as DISCONT", \
	"JNR_SITE_PROFILE___PROCESSED as PROCESSED", \
	"JNR_SITE_PROFILE___INN_PER_CS as INN_PER_CS", \
	"JNR_SITE_PROFILE___MAX_STACKING as MAX_STACKING", \
	"JNR_SITE_PROFILE___MAX_LANES as MAX_LANES", \
	"JNR_SITE_PROFILE___NUM_UNITS_PER_BIN as NUM_UNITS_PER_BIN", \
	"JNR_SITE_PROFILE___RESERVED_1 as RESERVED_1", \
	"JNR_SITE_PROFILE___RESERVED_2 as RESERVED_2", \
	"JNR_SITE_PROFILE___RESERVED_3 as RESERVED_3", \
	"JNR_SITE_PROFILE___RESERVED_4 as RESERVED_4", \
	"JNR_SITE_PROFILE___CREATE_DATE_TIME as CREATE_DATE_TIME", \
	"JNR_SITE_PROFILE___MOD_DATE_TIME as MOD_DATE_TIME", \
	"JNR_SITE_PROFILE___MOD_USER as MOD_USER", \
	"JNR_SITE_PROFILE___RESERVE_RACK_TYPE_ID as RESERVE_RACK_TYPE_ID", \
	"JNR_SITE_PROFILE___ALLOW_RESERVE as ALLOW_RESERVE", \
	"JNR_SITE_PROFILE___PALPAT_RESERVE as PALPAT_RESERVE", \
	"JNR_SITE_PROFILE___THREE_D_CALC_DONE as THREE_D_CALC_DONE", \
	"JNR_SITE_PROFILE___MAX_SLOTS as MAX_SLOTS", \
	"JNR_SITE_PROFILE___MAX_PALLET_STACKING as MAX_PALLET_STACKING", \
	"JNR_SITE_PROFILE___PROP_BORROWING_OBJECT as PROP_BORROWING_OBJECT", \
	"JNR_SITE_PROFILE___PROP_BORROWING_SPECIFIC as PROP_BORROWING_SPECIFIC", \
	"JNR_SITE_PROFILE___HEIGHT_CAN_BORROW as HEIGHT_CAN_BORROW", \
	"JNR_SITE_PROFILE___LENGTH_CAN_BORROW as LENGTH_CAN_BORROW", \
	"JNR_SITE_PROFILE___WIDTH_CAN_BORROW as WIDTH_CAN_BORROW", \
	"JNR_SITE_PROFILE___WEIGHT_CAN_BORROW as WEIGHT_CAN_BORROW", \
	"JNR_SITE_PROFILE___VEND_PACK_CAN_BORROW as VEND_PACK_CAN_BORROW", \
	"JNR_SITE_PROFILE___INNER_PACK_CAN_BORROW as INNER_PACK_CAN_BORROW", \
	"JNR_SITE_PROFILE___TI_CAN_BORROW as TI_CAN_BORROW", \
	"JNR_SITE_PROFILE___HI_CAN_BORROW as HI_CAN_BORROW", \
	"JNR_SITE_PROFILE___QTY_PER_GRAB_CAN_BORROW as QTY_PER_GRAB_CAN_BORROW", \
	"JNR_SITE_PROFILE___HAND_ATTR_CAN_BORROW as HAND_ATTR_CAN_BORROW", \
	"JNR_SITE_PROFILE___FAM_GRP_CAN_BORROW as FAM_GRP_CAN_BORROW", \
	"JNR_SITE_PROFILE___COMMODITY_CAN_BORROW as COMMODITY_CAN_BORROW", \
	"JNR_SITE_PROFILE___CRUSHABILITY_CAN_BORROW as CRUSHABILITY_CAN_BORROW", \
	"JNR_SITE_PROFILE___HAZARD_CAN_BORROW as HAZARD_CAN_BORROW", \
	"JNR_SITE_PROFILE___VEND_CODE_CAN_BORROW as VEND_CODE_CAN_BORROW", \
	"JNR_SITE_PROFILE___MISC1_CAN_BORROW as MISC1_CAN_BORROW", \
	"JNR_SITE_PROFILE___MISC2_CAN_BORROW as MISC2_CAN_BORROW", \
	"JNR_SITE_PROFILE___MISC3_CAN_BORROW as MISC3_CAN_BORROW", \
	"JNR_SITE_PROFILE___MISC4_CAN_BORROW as MISC4_CAN_BORROW", \
	"JNR_SITE_PROFILE___MISC5_CAN_BORROW as MISC5_CAN_BORROW", \
	"JNR_SITE_PROFILE___MISC6_CAN_BORROW as MISC6_CAN_BORROW", \
	"JNR_SITE_PROFILE___HEIGHT_BORROWED as HEIGHT_BORROWED", \
	"JNR_SITE_PROFILE___LENGTH_BORROWED as LENGTH_BORROWED", \
	"JNR_SITE_PROFILE___WIDTH_BORROWED as WIDTH_BORROWED", \
	"JNR_SITE_PROFILE___WEIGHT_BORROWED as WEIGHT_BORROWED", \
	"JNR_SITE_PROFILE___VEND_PACK_BORROWED as VEND_PACK_BORROWED", \
	"JNR_SITE_PROFILE___INNER_PACK_BORROWED as INNER_PACK_BORROWED", \
	"JNR_SITE_PROFILE___TI_BORROWED as TI_BORROWED", \
	"JNR_SITE_PROFILE___HI_BORROWED as HI_BORROWED", \
	"JNR_SITE_PROFILE___QTY_PER_GRAB_BORROWED as QTY_PER_GRAB_BORROWED", \
	"JNR_SITE_PROFILE___HAND_ATTR_BORROWED as HAND_ATTR_BORROWED", \
	"JNR_SITE_PROFILE___FAM_GRP_BORROWED as FAM_GRP_BORROWED", \
	"JNR_SITE_PROFILE___COMMODITY_BORROWED as COMMODITY_BORROWED", \
	"JNR_SITE_PROFILE___CRUSHABILITY_BORROWED as CRUSHABILITY_BORROWED", \
	"JNR_SITE_PROFILE___HAZARD_BORROWED as HAZARD_BORROWED", \
	"JNR_SITE_PROFILE___VEND_CODE_BORROWED as VEND_CODE_BORROWED", \
	"JNR_SITE_PROFILE___MISC1_BORROWED as MISC1_BORROWED", \
	"JNR_SITE_PROFILE___MISC2_BORROWED as MISC2_BORROWED", \
	"JNR_SITE_PROFILE___MISC3_BORROWED as MISC3_BORROWED", \
	"JNR_SITE_PROFILE___MISC4_BORROWED as MISC4_BORROWED", \
	"JNR_SITE_PROFILE___MISC5_BORROWED as MISC5_BORROWED", \
	"JNR_SITE_PROFILE___MISC6_BORROWED as MISC6_BORROWED", \
	"JNR_SITE_PROFILE___AFRAME_HT as AFRAME_HT", \
	"JNR_SITE_PROFILE___AFRAME_LEN as AFRAME_LEN", \
	"JNR_SITE_PROFILE___AFRAME_WID as AFRAME_WID", \
	"JNR_SITE_PROFILE___AFRAME_WT as AFRAME_WT", \
	"JNR_SITE_PROFILE___AFRAME_ALLOW as AFRAME_ALLOW", \
	"JNR_SITE_PROFILE___ITEM_NUM_1 as ITEM_NUM_1", \
	"JNR_SITE_PROFILE___ITEM_NUM_2 as ITEM_NUM_2", \
	"JNR_SITE_PROFILE___ITEM_NUM_3 as ITEM_NUM_3", \
	"JNR_SITE_PROFILE___ITEM_NUM_4 as ITEM_NUM_4", \
	"JNR_SITE_PROFILE___ITEM_NUM_5 as ITEM_NUM_5", \
	"JNR_SITE_PROFILE___ITEM_CHAR_1 as ITEM_CHAR_1", \
	"JNR_SITE_PROFILE___ITEM_CHAR_2 as ITEM_CHAR_2", \
	"JNR_SITE_PROFILE___ITEM_CHAR_3 as ITEM_CHAR_3", \
	"JNR_SITE_PROFILE___ITEM_CHAR_4 as ITEM_CHAR_4", \
	"JNR_SITE_PROFILE___ITEM_CHAR_5 as ITEM_CHAR_5", \
	"JNR_SITE_PROFILE___SLOTTING_GROUP as SLOTTING_GROUP", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___LOCATION_ID as in_LOCATION_ID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_ITEM_FACILITY_MAPPING_ID as WM_ITEM_FACILITY_MAPPING_ID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_ITEM_ID as WM_ITEM_ID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_ITEM_NAME as WM_ITEM_NAME", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_WHSE_CD as WM_WHSE_CD", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_SLOTTING_GROUP as WM_SLOTTING_GROUP", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___DISC_TRANS_TSTMP as DISC_TRANS_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___EX_RECEIPT_TSTMP as EX_RECEIPT_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___UNIT_MEASURE as UNIT_MEASURE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___EACH_PER_BIN as in_EACH_PER_BIN", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___NBR_UNITS_PER_BIN as NBR_UNITS_PER_BIN", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___INN_PER_CS as in_INN_PER_CS", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MAX_SLOTS as in_MAX_SLOTS", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MAX_PALLET_STACKING as in_MAX_PALLET_STACKING", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MAX_STACKING as in_MAX_STACKING", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MAX_LANES as in_MAX_LANES", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_RESERVE_RACK_TYPE_ID as WM_RESERVE_RACK_TYPE_ID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___AFRAME_HT as in_AFRAME_HT", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___AFRAME_LEN as in_AFRAME_LEN", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___AFRAME_WID as in_AFRAME_WID", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___AFRAME_WT as in_AFRAME_WT", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___AFRAME_ALLOW_FLAG as AFRAME_ALLOW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ALLOW_SLU as in_ALLOW_SLU", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ALLOW_SU as in_ALLOW_SU", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ALLOW_RESERVE as in_ALLOW_RESERVE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___PALPAT_RESERVE as in_PALPAT_RESERVE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___THREE_D_CALC_DONE as in_THREE_D_CALC_DONE", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___PROP_BORROWING_OBJECT as in_PROP_BORROWING_OBJECT", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___PROP_BORROWING_SPECIFIC as in_PROP_BORROWING_SPECIFIC", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HEIGHT_CAN_BORROW_FLAG as HEIGHT_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___LENGTH_CAN_BORROW_FLAG as LENGTH_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WIDTH_CAN_BORROW_FLAG as WIDTH_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WEIGHT_CAN_BORROW_FLAG as WEIGHT_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___VEND_PACK_CAN_BORROW_FLAG as VEND_PACK_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___INNER_PACK_CAN_BORROW_FLAG as INNER_PACK_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___TI_CAN_BORROW_FLAG as TI_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HI_CAN_BORROW_FLAG as HI_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___QTY_PER_GRAB_CAN_BORROW_FLAG as QTY_PER_GRAB_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HAND_ATTR_CAN_BORROW_FLAG as HAND_ATTR_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___FAM_GRP_CAN_BORROW_FLAG as FAM_GRP_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___COMMODITY_CAN_BORROW_FLAG as COMMODITY_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___CRUSHABILITY_CAN_BORROW_FLAG as CRUSHABILITY_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HAZARD_CAN_BORROW_FLAG as HAZARD_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___VEND_CODE_CAN_BORROW_FLAG as VEND_CODE_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HEIGHT_BORROWED_FLAG as HEIGHT_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___LENGTH_BORROWED_FLAG as LENGTH_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WIDTH_BORROWED_FLAG as WIDTH_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WEIGHT_BORROWED_FLAG as WEIGHT_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___VEND_PACK_BORROWED_FLAG as VEND_PACK_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___INNER_PACK_BORROWED_FLAG as INNER_PACK_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___TI_BORROWED_FLAG as TI_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HI_BORROWED_FLAG as HI_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___QTY_PER_GRAB_BORROWED_FLAG as QTY_PER_GRAB_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HAND_ATTR_BORROWED_FLAG as HAND_ATTR_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___FAM_GRP_BORROWED_FLAG as FAM_GRP_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___COMMODITY_BORROWED_FLAG as COMMODITY_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___CRUSHABILITY_BORROWED_FLAG as CRUSHABILITY_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___HAZARD_BORROWED_FLAG as HAZARD_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___VEND_CODE_BORROWED_FLAG as VEND_CODE_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_1 as in_ITEM_NUM_1", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_2 as in_ITEM_NUM_2", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_3 as in_ITEM_NUM_3", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_4 as in_ITEM_NUM_4", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_5 as in_ITEM_NUM_5", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_1 as in_ITEM_CHAR_1", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_2 as in_ITEM_CHAR_2", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_3 as in_ITEM_CHAR_3", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_4 as in_ITEM_CHAR_4", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_5 as in_ITEM_CHAR_5", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___RESERVED_1 as in_RESERVED_1", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___RESERVED_2 as in_RESERVED_2", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___RESERVED_3 as in_RESERVED_3", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___RESERVED_4 as in_RESERVED_4", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_1_BORROWED_FLAG as MISC_1_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_2_BORROWED_FLAG as MISC_2_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_3_BORROWED_FLAG as MISC_3_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_4_BORROWED_FLAG as MISC_4_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_5_BORROWED_FLAG as MISC_5_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_6_BORROWED_FLAG as MISC_6_BORROWED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_1_CAN_BORROW_FLAG as MISC_1_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_2_CAN_BORROW_FLAG as MISC_2_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_3_CAN_BORROW_FLAG as MISC_3_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_4_CAN_BORROW_FLAG as MISC_4_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_5_CAN_BORROW_FLAG as MISC_5_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MISC_6_CAN_BORROW_FLAG as MISC_6_CAN_BORROW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___DISCONTINUED_FLAG as DISCONTINUED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___MANUAL_FLAG as MANUAL_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___NEW_FLAG as NEW_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___PROCESSED_FLAG as PROCESSED_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_MOD_USER as WM_MOD_USER", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_CREATE_TSTMP as WM_CREATE_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___WM_MOD_TSTMP as WM_MOD_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___DELETE_FLAG as in_DELETE_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_FACILITY_SLOTTING___LOAD_TSTMP as in_LOAD_TSTMP")

# COMMAND ----------
# Processing node FIL_UNCHANGED_REC, type FILTER 
# COLUMN COUNT: 186

# for each involved DataFrame, append the dataframe name to each column
JNR_WM_ITEM_FACILITY_SLOTTING_temp = JNR_WM_ITEM_FACILITY_SLOTTING.toDF(*["JNR_WM_ITEM_FACILITY_SLOTTING___" + col for col in JNR_WM_ITEM_FACILITY_SLOTTING.columns])

FIL_UNCHANGED_REC = JNR_WM_ITEM_FACILITY_SLOTTING_temp.selectExpr( \
	"JNR_WM_ITEM_FACILITY_SLOTTING___LOCATION_ID as LOCATION_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_FACILITY_MAPPING_ID as ITEM_FACILITY_MAPPING_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_ID as ITEM_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_NAME as ITEM_NAME", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WHSE_CODE as WHSE_CODE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___UNIT_MEAS as UNIT_MEAS", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MANUAL as MANUAL", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___IS_NEW as IS_NEW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ALLOW_SLU as ALLOW_SLU", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ALLOW_SU as ALLOW_SU", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___DISC_TRANS as DISC_TRANS", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___EACH_PER_BIN as EACH_PER_BIN", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___EX_RECPT_DATE as EX_RECPT_DATE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___DISCONT as DISCONT", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___PROCESSED as PROCESSED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___INN_PER_CS as INN_PER_CS", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MAX_STACKING as MAX_STACKING", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MAX_LANES as MAX_LANES", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___NUM_UNITS_PER_BIN as NUM_UNITS_PER_BIN", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___RESERVED_1 as RESERVED_1", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___RESERVED_2 as RESERVED_2", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___RESERVED_3 as RESERVED_3", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___RESERVED_4 as RESERVED_4", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___CREATE_DATE_TIME as CREATE_DATE_TIME", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MOD_DATE_TIME as MOD_DATE_TIME", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MOD_USER as MOD_USER", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___RESERVE_RACK_TYPE_ID as RESERVE_RACK_TYPE_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ALLOW_RESERVE as ALLOW_RESERVE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___PALPAT_RESERVE as PALPAT_RESERVE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___THREE_D_CALC_DONE as THREE_D_CALC_DONE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MAX_SLOTS as MAX_SLOTS", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MAX_PALLET_STACKING as MAX_PALLET_STACKING", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___PROP_BORROWING_OBJECT as PROP_BORROWING_OBJECT", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___PROP_BORROWING_SPECIFIC as PROP_BORROWING_SPECIFIC", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HEIGHT_CAN_BORROW as HEIGHT_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___LENGTH_CAN_BORROW as LENGTH_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WIDTH_CAN_BORROW as WIDTH_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WEIGHT_CAN_BORROW as WEIGHT_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_PACK_CAN_BORROW as VEND_PACK_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___INNER_PACK_CAN_BORROW as INNER_PACK_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___TI_CAN_BORROW as TI_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HI_CAN_BORROW as HI_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___QTY_PER_GRAB_CAN_BORROW as QTY_PER_GRAB_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAND_ATTR_CAN_BORROW as HAND_ATTR_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___FAM_GRP_CAN_BORROW as FAM_GRP_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___COMMODITY_CAN_BORROW as COMMODITY_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___CRUSHABILITY_CAN_BORROW as CRUSHABILITY_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAZARD_CAN_BORROW as HAZARD_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_CODE_CAN_BORROW as VEND_CODE_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC1_CAN_BORROW as MISC1_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC2_CAN_BORROW as MISC2_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC3_CAN_BORROW as MISC3_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC4_CAN_BORROW as MISC4_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC5_CAN_BORROW as MISC5_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC6_CAN_BORROW as MISC6_CAN_BORROW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HEIGHT_BORROWED as HEIGHT_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___LENGTH_BORROWED as LENGTH_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WIDTH_BORROWED as WIDTH_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WEIGHT_BORROWED as WEIGHT_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_PACK_BORROWED as VEND_PACK_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___INNER_PACK_BORROWED as INNER_PACK_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___TI_BORROWED as TI_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HI_BORROWED as HI_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___QTY_PER_GRAB_BORROWED as QTY_PER_GRAB_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAND_ATTR_BORROWED as HAND_ATTR_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___FAM_GRP_BORROWED as FAM_GRP_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___COMMODITY_BORROWED as COMMODITY_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___CRUSHABILITY_BORROWED as CRUSHABILITY_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAZARD_BORROWED as HAZARD_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_CODE_BORROWED as VEND_CODE_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC1_BORROWED as MISC1_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC2_BORROWED as MISC2_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC3_BORROWED as MISC3_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC4_BORROWED as MISC4_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC5_BORROWED as MISC5_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC6_BORROWED as MISC6_BORROWED", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___AFRAME_HT as AFRAME_HT", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___AFRAME_LEN as AFRAME_LEN", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___AFRAME_WID as AFRAME_WID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___AFRAME_WT as AFRAME_WT", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___AFRAME_ALLOW as AFRAME_ALLOW", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_1 as ITEM_NUM_1", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_2 as ITEM_NUM_2", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_3 as ITEM_NUM_3", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_4 as ITEM_NUM_4", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_NUM_5 as ITEM_NUM_5", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_1 as ITEM_CHAR_1", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_2 as ITEM_CHAR_2", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_3 as ITEM_CHAR_3", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_4 as ITEM_CHAR_4", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___ITEM_CHAR_5 as ITEM_CHAR_5", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___SLOTTING_GROUP as SLOTTING_GROUP", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_LOCATION_ID as in_LOCATION_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_ITEM_FACILITY_MAPPING_ID as WM_ITEM_FACILITY_MAPPING_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_ITEM_ID as WM_ITEM_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_ITEM_NAME as WM_ITEM_NAME", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_WHSE_CD as WM_WHSE_CD", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_SLOTTING_GROUP as WM_SLOTTING_GROUP", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___DISC_TRANS_TSTMP as DISC_TRANS_TSTMP", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___EX_RECEIPT_TSTMP as EX_RECEIPT_TSTMP", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___UNIT_MEASURE as UNIT_MEASURE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_EACH_PER_BIN as in_EACH_PER_BIN", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___NBR_UNITS_PER_BIN as NBR_UNITS_PER_BIN", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_INN_PER_CS as in_INN_PER_CS", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_MAX_SLOTS as in_MAX_SLOTS", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_MAX_PALLET_STACKING as in_MAX_PALLET_STACKING", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_MAX_STACKING as in_MAX_STACKING", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_MAX_LANES as in_MAX_LANES", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_RESERVE_RACK_TYPE_ID as WM_RESERVE_RACK_TYPE_ID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_AFRAME_HT as in_AFRAME_HT", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_AFRAME_LEN as in_AFRAME_LEN", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_AFRAME_WID as in_AFRAME_WID", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_AFRAME_WT as in_AFRAME_WT", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___AFRAME_ALLOW_FLAG as AFRAME_ALLOW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ALLOW_SLU as in_ALLOW_SLU", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ALLOW_SU as in_ALLOW_SU", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ALLOW_RESERVE as in_ALLOW_RESERVE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_PALPAT_RESERVE as in_PALPAT_RESERVE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_THREE_D_CALC_DONE as in_THREE_D_CALC_DONE", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_PROP_BORROWING_OBJECT as in_PROP_BORROWING_OBJECT", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_PROP_BORROWING_SPECIFIC as in_PROP_BORROWING_SPECIFIC", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HEIGHT_CAN_BORROW_FLAG as HEIGHT_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___LENGTH_CAN_BORROW_FLAG as LENGTH_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WIDTH_CAN_BORROW_FLAG as WIDTH_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WEIGHT_CAN_BORROW_FLAG as WEIGHT_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_PACK_CAN_BORROW_FLAG as VEND_PACK_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___INNER_PACK_CAN_BORROW_FLAG as INNER_PACK_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___TI_CAN_BORROW_FLAG as TI_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HI_CAN_BORROW_FLAG as HI_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___QTY_PER_GRAB_CAN_BORROW_FLAG as QTY_PER_GRAB_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAND_ATTR_CAN_BORROW_FLAG as HAND_ATTR_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___FAM_GRP_CAN_BORROW_FLAG as FAM_GRP_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___COMMODITY_CAN_BORROW_FLAG as COMMODITY_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___CRUSHABILITY_CAN_BORROW_FLAG as CRUSHABILITY_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAZARD_CAN_BORROW_FLAG as HAZARD_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_CODE_CAN_BORROW_FLAG as VEND_CODE_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HEIGHT_BORROWED_FLAG as HEIGHT_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___LENGTH_BORROWED_FLAG as LENGTH_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WIDTH_BORROWED_FLAG as WIDTH_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WEIGHT_BORROWED_FLAG as WEIGHT_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_PACK_BORROWED_FLAG as VEND_PACK_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___INNER_PACK_BORROWED_FLAG as INNER_PACK_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___TI_BORROWED_FLAG as TI_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HI_BORROWED_FLAG as HI_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___QTY_PER_GRAB_BORROWED_FLAG as QTY_PER_GRAB_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAND_ATTR_BORROWED_FLAG as HAND_ATTR_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___FAM_GRP_BORROWED_FLAG as FAM_GRP_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___COMMODITY_BORROWED_FLAG as COMMODITY_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___CRUSHABILITY_BORROWED_FLAG as CRUSHABILITY_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___HAZARD_BORROWED_FLAG as HAZARD_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___VEND_CODE_BORROWED_FLAG as VEND_CODE_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_NUM_1 as in_ITEM_NUM_1", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_NUM_2 as in_ITEM_NUM_2", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_NUM_3 as in_ITEM_NUM_3", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_NUM_4 as in_ITEM_NUM_4", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_NUM_5 as in_ITEM_NUM_5", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_CHAR_1 as in_ITEM_CHAR_1", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_CHAR_2 as in_ITEM_CHAR_2", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_CHAR_3 as in_ITEM_CHAR_3", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_CHAR_4 as in_ITEM_CHAR_4", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_ITEM_CHAR_5 as in_ITEM_CHAR_5", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_RESERVED_1 as in_RESERVED_1", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_RESERVED_2 as in_RESERVED_2", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_RESERVED_3 as in_RESERVED_3", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_RESERVED_4 as in_RESERVED_4", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_1_BORROWED_FLAG as MISC_1_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_2_BORROWED_FLAG as MISC_2_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_3_BORROWED_FLAG as MISC_3_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_4_BORROWED_FLAG as MISC_4_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_5_BORROWED_FLAG as MISC_5_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_6_BORROWED_FLAG as MISC_6_BORROWED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_1_CAN_BORROW_FLAG as MISC_1_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_2_CAN_BORROW_FLAG as MISC_2_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_3_CAN_BORROW_FLAG as MISC_3_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_4_CAN_BORROW_FLAG as MISC_4_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_5_CAN_BORROW_FLAG as MISC_5_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MISC_6_CAN_BORROW_FLAG as MISC_6_CAN_BORROW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___DISCONTINUED_FLAG as DISCONTINUED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___MANUAL_FLAG as MANUAL_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___NEW_FLAG as NEW_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___PROCESSED_FLAG as PROCESSED_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_MOD_USER as WM_MOD_USER", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_CREATE_TSTMP as WM_CREATE_TSTMP", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___WM_MOD_TSTMP as WM_MOD_TSTMP", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_DELETE_FLAG as in_DELETE_FLAG", \
	"JNR_WM_ITEM_FACILITY_SLOTTING___in_LOAD_TSTMP as in_LOAD_TSTMP") \
    .filter("WM_ITEM_FACILITY_MAPPING_ID is Null OR ITEM_FACILITY_MAPPING_ID is Null OR ( WM_ITEM_FACILITY_MAPPING_ID is not Null AND \
     ( COALESCE(CREATE_DATE_TIME, date'1900-01-01') != COALESCE(WM_CREATE_TSTMP, date'1900-01-01') \
    OR COALESCE(MOD_DATE_TIME, date'1900-01-01') != COALESCE(WM_MOD_TSTMP, date'1900-01-01')))").withColumn("sys_row_id", monotonically_increasing_id())


# COMMAND ----------
# Processing node EXP_UPD_VALIDATOR, type EXPRESSION 
# COLUMN COUNT: 188

# for each involved DataFrame, append the dataframe name to each column
FIL_UNCHANGED_REC_temp = FIL_UNCHANGED_REC.toDF(*["FIL_UNCHANGED_REC___" + col for col in FIL_UNCHANGED_REC.columns]) \
.withColumn("FIL_UNCHANGED_REC___v_CREATE_DATE_TIME", expr("""IF(FIL_UNCHANGED_REC___CREATE_DATE_TIME IS NULL, date'1900-01-01', FIL_UNCHANGED_REC___CREATE_DATE_TIME)""")) \
	.withColumn("FIL_UNCHANGED_REC___v_MOD_DATE_TIME", expr("""IF(FIL_UNCHANGED_REC___MOD_DATE_TIME IS NULL, date'1900-01-01', FIL_UNCHANGED_REC___MOD_DATE_TIME)""")) \
	.withColumn("FIL_UNCHANGED_REC___v_WM_CREATE_TSTMP", expr("""IF(FIL_UNCHANGED_REC___WM_CREATE_TSTMP IS NULL, date'1900-01-01', FIL_UNCHANGED_REC___WM_CREATE_TSTMP)""")) \
	.withColumn("FIL_UNCHANGED_REC___v_WM_MOD_TSTMP", expr("""IF(FIL_UNCHANGED_REC___WM_MOD_TSTMP IS NULL, date'1900-01-01', FIL_UNCHANGED_REC___WM_MOD_TSTMP)"""))
             
EXP_UPD_VALIDATOR = FIL_UNCHANGED_REC_temp.selectExpr( \
	"FIL_UNCHANGED_REC___sys_row_id as sys_row_id", \
	"FIL_UNCHANGED_REC___LOCATION_ID as LOCATION_ID", \
	"FIL_UNCHANGED_REC___ITEM_FACILITY_MAPPING_ID as ITEM_FACILITY_MAPPING_ID", \
	"FIL_UNCHANGED_REC___ITEM_ID as ITEM_ID", \
	"FIL_UNCHANGED_REC___ITEM_NAME as ITEM_NAME", \
	"FIL_UNCHANGED_REC___WHSE_CODE as WHSE_CODE", \
	"FIL_UNCHANGED_REC___UNIT_MEAS as UNIT_MEAS", \
	"FIL_UNCHANGED_REC___MANUAL as MANUAL", \
	"FIL_UNCHANGED_REC___IS_NEW as IS_NEW", \
	"FIL_UNCHANGED_REC___ALLOW_SLU as ALLOW_SLU", \
	"FIL_UNCHANGED_REC___ALLOW_SU as ALLOW_SU", \
	"FIL_UNCHANGED_REC___DISC_TRANS as DISC_TRANS", \
	"FIL_UNCHANGED_REC___EACH_PER_BIN as EACH_PER_BIN", \
	"FIL_UNCHANGED_REC___EX_RECPT_DATE as EX_RECPT_DATE", \
	"FIL_UNCHANGED_REC___DISCONT as DISCONT", \
	"FIL_UNCHANGED_REC___PROCESSED as PROCESSED", \
	"FIL_UNCHANGED_REC___INN_PER_CS as INN_PER_CS", \
	"FIL_UNCHANGED_REC___MAX_STACKING as MAX_STACKING", \
	"FIL_UNCHANGED_REC___MAX_LANES as MAX_LANES", \
	"FIL_UNCHANGED_REC___NUM_UNITS_PER_BIN as NUM_UNITS_PER_BIN", \
	"FIL_UNCHANGED_REC___RESERVED_1 as RESERVED_1", \
	"FIL_UNCHANGED_REC___RESERVED_2 as RESERVED_2", \
	"FIL_UNCHANGED_REC___RESERVED_3 as RESERVED_3", \
	"FIL_UNCHANGED_REC___RESERVED_4 as RESERVED_4", \
	"FIL_UNCHANGED_REC___CREATE_DATE_TIME as CREATE_DATE_TIME", \
	"FIL_UNCHANGED_REC___MOD_DATE_TIME as MOD_DATE_TIME", \
	"FIL_UNCHANGED_REC___MOD_USER as MOD_USER", \
	"FIL_UNCHANGED_REC___RESERVE_RACK_TYPE_ID as RESERVE_RACK_TYPE_ID", \
	"FIL_UNCHANGED_REC___ALLOW_RESERVE as ALLOW_RESERVE", \
	"FIL_UNCHANGED_REC___PALPAT_RESERVE as PALPAT_RESERVE", \
	"FIL_UNCHANGED_REC___THREE_D_CALC_DONE as THREE_D_CALC_DONE", \
	"FIL_UNCHANGED_REC___MAX_SLOTS as MAX_SLOTS", \
	"FIL_UNCHANGED_REC___MAX_PALLET_STACKING as MAX_PALLET_STACKING", \
	"FIL_UNCHANGED_REC___PROP_BORROWING_OBJECT as PROP_BORROWING_OBJECT", \
	"FIL_UNCHANGED_REC___PROP_BORROWING_SPECIFIC as PROP_BORROWING_SPECIFIC", \
	"FIL_UNCHANGED_REC___HEIGHT_CAN_BORROW as HEIGHT_CAN_BORROW", \
	"FIL_UNCHANGED_REC___LENGTH_CAN_BORROW as LENGTH_CAN_BORROW", \
	"FIL_UNCHANGED_REC___WIDTH_CAN_BORROW as WIDTH_CAN_BORROW", \
	"FIL_UNCHANGED_REC___WEIGHT_CAN_BORROW as WEIGHT_CAN_BORROW", \
	"FIL_UNCHANGED_REC___VEND_PACK_CAN_BORROW as VEND_PACK_CAN_BORROW", \
	"FIL_UNCHANGED_REC___INNER_PACK_CAN_BORROW as INNER_PACK_CAN_BORROW", \
	"FIL_UNCHANGED_REC___TI_CAN_BORROW as TI_CAN_BORROW", \
	"FIL_UNCHANGED_REC___HI_CAN_BORROW as HI_CAN_BORROW", \
	"FIL_UNCHANGED_REC___QTY_PER_GRAB_CAN_BORROW as QTY_PER_GRAB_CAN_BORROW", \
	"FIL_UNCHANGED_REC___HAND_ATTR_CAN_BORROW as HAND_ATTR_CAN_BORROW", \
	"FIL_UNCHANGED_REC___FAM_GRP_CAN_BORROW as FAM_GRP_CAN_BORROW", \
	"FIL_UNCHANGED_REC___COMMODITY_CAN_BORROW as COMMODITY_CAN_BORROW", \
	"FIL_UNCHANGED_REC___CRUSHABILITY_CAN_BORROW as CRUSHABILITY_CAN_BORROW", \
	"FIL_UNCHANGED_REC___HAZARD_CAN_BORROW as HAZARD_CAN_BORROW", \
	"FIL_UNCHANGED_REC___VEND_CODE_CAN_BORROW as VEND_CODE_CAN_BORROW", \
	"FIL_UNCHANGED_REC___MISC1_CAN_BORROW as MISC1_CAN_BORROW", \
	"FIL_UNCHANGED_REC___MISC2_CAN_BORROW as MISC2_CAN_BORROW", \
	"FIL_UNCHANGED_REC___MISC3_CAN_BORROW as MISC3_CAN_BORROW", \
	"FIL_UNCHANGED_REC___MISC4_CAN_BORROW as MISC4_CAN_BORROW", \
	"FIL_UNCHANGED_REC___MISC5_CAN_BORROW as MISC5_CAN_BORROW", \
	"FIL_UNCHANGED_REC___MISC6_CAN_BORROW as MISC6_CAN_BORROW", \
	"FIL_UNCHANGED_REC___HEIGHT_BORROWED as HEIGHT_BORROWED", \
	"FIL_UNCHANGED_REC___LENGTH_BORROWED as LENGTH_BORROWED", \
	"FIL_UNCHANGED_REC___WIDTH_BORROWED as WIDTH_BORROWED", \
	"FIL_UNCHANGED_REC___WEIGHT_BORROWED as WEIGHT_BORROWED", \
	"FIL_UNCHANGED_REC___VEND_PACK_BORROWED as VEND_PACK_BORROWED", \
	"FIL_UNCHANGED_REC___INNER_PACK_BORROWED as INNER_PACK_BORROWED", \
	"FIL_UNCHANGED_REC___TI_BORROWED as TI_BORROWED", \
	"FIL_UNCHANGED_REC___HI_BORROWED as HI_BORROWED", \
	"FIL_UNCHANGED_REC___QTY_PER_GRAB_BORROWED as QTY_PER_GRAB_BORROWED", \
	"FIL_UNCHANGED_REC___HAND_ATTR_BORROWED as HAND_ATTR_BORROWED", \
	"FIL_UNCHANGED_REC___FAM_GRP_BORROWED as FAM_GRP_BORROWED", \
	"FIL_UNCHANGED_REC___COMMODITY_BORROWED as COMMODITY_BORROWED", \
	"FIL_UNCHANGED_REC___CRUSHABILITY_BORROWED as CRUSHABILITY_BORROWED", \
	"FIL_UNCHANGED_REC___HAZARD_BORROWED as HAZARD_BORROWED", \
	"FIL_UNCHANGED_REC___VEND_CODE_BORROWED as VEND_CODE_BORROWED", \
	"FIL_UNCHANGED_REC___MISC1_BORROWED as MISC1_BORROWED", \
	"FIL_UNCHANGED_REC___MISC2_BORROWED as MISC2_BORROWED", \
	"FIL_UNCHANGED_REC___MISC3_BORROWED as MISC3_BORROWED", \
	"FIL_UNCHANGED_REC___MISC4_BORROWED as MISC4_BORROWED", \
	"FIL_UNCHANGED_REC___MISC5_BORROWED as MISC5_BORROWED", \
	"FIL_UNCHANGED_REC___MISC6_BORROWED as MISC6_BORROWED", \
	"FIL_UNCHANGED_REC___AFRAME_HT as AFRAME_HT", \
	"FIL_UNCHANGED_REC___AFRAME_LEN as AFRAME_LEN", \
	"FIL_UNCHANGED_REC___AFRAME_WID as AFRAME_WID", \
	"FIL_UNCHANGED_REC___AFRAME_WT as AFRAME_WT", \
	"FIL_UNCHANGED_REC___AFRAME_ALLOW as AFRAME_ALLOW", \
	"FIL_UNCHANGED_REC___ITEM_NUM_1 as ITEM_NUM_1", \
	"FIL_UNCHANGED_REC___ITEM_NUM_2 as ITEM_NUM_2", \
	"FIL_UNCHANGED_REC___ITEM_NUM_3 as ITEM_NUM_3", \
	"FIL_UNCHANGED_REC___ITEM_NUM_4 as ITEM_NUM_4", \
	"FIL_UNCHANGED_REC___ITEM_NUM_5 as ITEM_NUM_5", \
	"FIL_UNCHANGED_REC___ITEM_CHAR_1 as ITEM_CHAR_1", \
	"FIL_UNCHANGED_REC___ITEM_CHAR_2 as ITEM_CHAR_2", \
	"FIL_UNCHANGED_REC___ITEM_CHAR_3 as ITEM_CHAR_3", \
	"FIL_UNCHANGED_REC___ITEM_CHAR_4 as ITEM_CHAR_4", \
	"FIL_UNCHANGED_REC___ITEM_CHAR_5 as ITEM_CHAR_5", \
	"FIL_UNCHANGED_REC___SLOTTING_GROUP as SLOTTING_GROUP", \
	"FIL_UNCHANGED_REC___in_LOCATION_ID as in_LOCATION_ID", \
	"FIL_UNCHANGED_REC___WM_ITEM_FACILITY_MAPPING_ID as WM_ITEM_FACILITY_MAPPING_ID", \
	"FIL_UNCHANGED_REC___WM_ITEM_ID as WM_ITEM_ID", \
	"FIL_UNCHANGED_REC___WM_ITEM_NAME as WM_ITEM_NAME", \
	"FIL_UNCHANGED_REC___WM_WHSE_CD as WM_WHSE_CD", \
	"FIL_UNCHANGED_REC___WM_SLOTTING_GROUP as WM_SLOTTING_GROUP", \
	"FIL_UNCHANGED_REC___DISC_TRANS_TSTMP as DISC_TRANS_TSTMP", \
	"FIL_UNCHANGED_REC___EX_RECEIPT_TSTMP as EX_RECEIPT_TSTMP", \
	"FIL_UNCHANGED_REC___UNIT_MEASURE as UNIT_MEASURE", \
	"FIL_UNCHANGED_REC___in_EACH_PER_BIN as in_EACH_PER_BIN", \
	"FIL_UNCHANGED_REC___NBR_UNITS_PER_BIN as NBR_UNITS_PER_BIN", \
	"FIL_UNCHANGED_REC___in_INN_PER_CS as in_INN_PER_CS", \
	"FIL_UNCHANGED_REC___in_MAX_SLOTS as in_MAX_SLOTS", \
	"FIL_UNCHANGED_REC___in_MAX_PALLET_STACKING as in_MAX_PALLET_STACKING", \
	"FIL_UNCHANGED_REC___in_MAX_STACKING as in_MAX_STACKING", \
	"FIL_UNCHANGED_REC___in_MAX_LANES as in_MAX_LANES", \
	"FIL_UNCHANGED_REC___WM_RESERVE_RACK_TYPE_ID as WM_RESERVE_RACK_TYPE_ID", \
	"FIL_UNCHANGED_REC___in_AFRAME_HT as in_AFRAME_HT", \
	"FIL_UNCHANGED_REC___in_AFRAME_LEN as in_AFRAME_LEN", \
	"FIL_UNCHANGED_REC___in_AFRAME_WID as in_AFRAME_WID", \
	"FIL_UNCHANGED_REC___in_AFRAME_WT as in_AFRAME_WT", \
	"FIL_UNCHANGED_REC___AFRAME_ALLOW_FLAG as AFRAME_ALLOW_FLAG", \
	"FIL_UNCHANGED_REC___in_ALLOW_SLU as in_ALLOW_SLU", \
	"FIL_UNCHANGED_REC___in_ALLOW_SU as in_ALLOW_SU", \
	"FIL_UNCHANGED_REC___in_ALLOW_RESERVE as in_ALLOW_RESERVE", \
	"FIL_UNCHANGED_REC___in_PALPAT_RESERVE as in_PALPAT_RESERVE", \
	"FIL_UNCHANGED_REC___in_THREE_D_CALC_DONE as in_THREE_D_CALC_DONE", \
	"FIL_UNCHANGED_REC___in_PROP_BORROWING_OBJECT as in_PROP_BORROWING_OBJECT", \
	"FIL_UNCHANGED_REC___in_PROP_BORROWING_SPECIFIC as in_PROP_BORROWING_SPECIFIC", \
	"FIL_UNCHANGED_REC___HEIGHT_CAN_BORROW_FLAG as HEIGHT_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___LENGTH_CAN_BORROW_FLAG as LENGTH_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___WIDTH_CAN_BORROW_FLAG as WIDTH_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___WEIGHT_CAN_BORROW_FLAG as WEIGHT_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___VEND_PACK_CAN_BORROW_FLAG as VEND_PACK_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___INNER_PACK_CAN_BORROW_FLAG as INNER_PACK_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___TI_CAN_BORROW_FLAG as TI_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___HI_CAN_BORROW_FLAG as HI_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___QTY_PER_GRAB_CAN_BORROW_FLAG as QTY_PER_GRAB_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___HAND_ATTR_CAN_BORROW_FLAG as HAND_ATTR_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___FAM_GRP_CAN_BORROW_FLAG as FAM_GRP_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___COMMODITY_CAN_BORROW_FLAG as COMMODITY_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___CRUSHABILITY_CAN_BORROW_FLAG as CRUSHABILITY_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___HAZARD_CAN_BORROW_FLAG as HAZARD_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___VEND_CODE_CAN_BORROW_FLAG as VEND_CODE_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___HEIGHT_BORROWED_FLAG as HEIGHT_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___LENGTH_BORROWED_FLAG as LENGTH_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___WIDTH_BORROWED_FLAG as WIDTH_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___WEIGHT_BORROWED_FLAG as WEIGHT_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___VEND_PACK_BORROWED_FLAG as VEND_PACK_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___INNER_PACK_BORROWED_FLAG as INNER_PACK_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___TI_BORROWED_FLAG as TI_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___HI_BORROWED_FLAG as HI_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___QTY_PER_GRAB_BORROWED_FLAG as QTY_PER_GRAB_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___HAND_ATTR_BORROWED_FLAG as HAND_ATTR_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___FAM_GRP_BORROWED_FLAG as FAM_GRP_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___COMMODITY_BORROWED_FLAG as COMMODITY_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___CRUSHABILITY_BORROWED_FLAG as CRUSHABILITY_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___HAZARD_BORROWED_FLAG as HAZARD_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___VEND_CODE_BORROWED_FLAG as VEND_CODE_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___in_ITEM_NUM_1 as in_ITEM_NUM_1", \
	"FIL_UNCHANGED_REC___in_ITEM_NUM_2 as in_ITEM_NUM_2", \
	"FIL_UNCHANGED_REC___in_ITEM_NUM_3 as in_ITEM_NUM_3", \
	"FIL_UNCHANGED_REC___in_ITEM_NUM_4 as in_ITEM_NUM_4", \
	"FIL_UNCHANGED_REC___in_ITEM_NUM_5 as in_ITEM_NUM_5", \
	"FIL_UNCHANGED_REC___in_ITEM_CHAR_1 as in_ITEM_CHAR_1", \
	"FIL_UNCHANGED_REC___in_ITEM_CHAR_2 as in_ITEM_CHAR_2", \
	"FIL_UNCHANGED_REC___in_ITEM_CHAR_3 as in_ITEM_CHAR_3", \
	"FIL_UNCHANGED_REC___in_ITEM_CHAR_4 as in_ITEM_CHAR_4", \
	"FIL_UNCHANGED_REC___in_ITEM_CHAR_5 as in_ITEM_CHAR_5", \
	"FIL_UNCHANGED_REC___in_RESERVED_1 as in_RESERVED_1", \
	"FIL_UNCHANGED_REC___in_RESERVED_2 as in_RESERVED_2", \
	"FIL_UNCHANGED_REC___in_RESERVED_3 as in_RESERVED_3", \
	"FIL_UNCHANGED_REC___in_RESERVED_4 as in_RESERVED_4", \
	"FIL_UNCHANGED_REC___MISC_1_BORROWED_FLAG as MISC_1_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___MISC_2_BORROWED_FLAG as MISC_2_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___MISC_3_BORROWED_FLAG as MISC_3_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___MISC_4_BORROWED_FLAG as MISC_4_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___MISC_5_BORROWED_FLAG as MISC_5_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___MISC_6_BORROWED_FLAG as MISC_6_BORROWED_FLAG", \
	"FIL_UNCHANGED_REC___MISC_1_CAN_BORROW_FLAG as MISC_1_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___MISC_2_CAN_BORROW_FLAG as MISC_2_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___MISC_3_CAN_BORROW_FLAG as MISC_3_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___MISC_4_CAN_BORROW_FLAG as MISC_4_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___MISC_5_CAN_BORROW_FLAG as MISC_5_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___MISC_6_CAN_BORROW_FLAG as MISC_6_CAN_BORROW_FLAG", \
	"FIL_UNCHANGED_REC___DISCONTINUED_FLAG as DISCONTINUED_FLAG", \
	"FIL_UNCHANGED_REC___MANUAL_FLAG as MANUAL_FLAG", \
	"FIL_UNCHANGED_REC___NEW_FLAG as NEW_FLAG", \
	"FIL_UNCHANGED_REC___PROCESSED_FLAG as PROCESSED_FLAG", \
	"FIL_UNCHANGED_REC___WM_MOD_USER as WM_MOD_USER", \
	"FIL_UNCHANGED_REC___WM_CREATE_TSTMP as WM_CREATE_TSTMP", \
	"FIL_UNCHANGED_REC___WM_MOD_TSTMP as WM_MOD_TSTMP", \
	"IF(FIL_UNCHANGED_REC___ITEM_FACILITY_MAPPING_ID IS NULL AND FIL_UNCHANGED_REC___WM_ITEM_FACILITY_MAPPING_ID IS NOT NULL, 1, 0) as DELETE_FLAG", \
	"CURRENT_TIMESTAMP as UPDATE_TSTMP", \
	"IF(FIL_UNCHANGED_REC___in_LOAD_TSTMP IS NULL, CURRENT_TIMESTAMP, FIL_UNCHANGED_REC___in_LOAD_TSTMP) as LOAD_TSTMP", \
	f"IF(FIL_UNCHANGED_REC___ITEM_FACILITY_MAPPING_ID IS NOT NULL AND FIL_UNCHANGED_REC___WM_ITEM_FACILITY_MAPPING_ID IS NULL, 'INSERT', IF(FIL_UNCHANGED_REC___ITEM_FACILITY_MAPPING_ID IS NULL AND FIL_UNCHANGED_REC___WM_ITEM_FACILITY_MAPPING_ID IS NOT NULL AND ( FIL_UNCHANGED_REC___v_WM_CREATE_TSTMP >= DATE_ADD('{Prev_Run_Dt}',-14) OR FIL_UNCHANGED_REC___v_WM_MOD_TSTMP >= DATE_ADD('{Prev_Run_Dt}',-14) ), 'DELETE', IF(FIL_UNCHANGED_REC___ITEM_FACILITY_MAPPING_ID IS NOT NULL AND FIL_UNCHANGED_REC___WM_ITEM_FACILITY_MAPPING_ID IS NOT NULL AND ( FIL_UNCHANGED_REC___v_WM_CREATE_TSTMP <> FIL_UNCHANGED_REC___v_CREATE_DATE_TIME OR FIL_UNCHANGED_REC___v_WM_MOD_TSTMP <> FIL_UNCHANGED_REC___v_MOD_DATE_TIME ), 'UPDATE', NULL))) as o_UPD_VALIDATOR" \
)

# COMMAND ----------
# Processing node RTR_DELETE, type ROUTER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 190


# Creating output dataframe for RTR_DELETE, output group DELETE
RTR_DELETE_DELETE = EXP_UPD_VALIDATOR.selectExpr( \
	"LOCATION_ID as LOCATION_ID", \
	"ITEM_FACILITY_MAPPING_ID as ITEM_FACILITY_MAPPING_ID", \
	"ITEM_ID as ITEM_ID", \
	"ITEM_NAME as ITEM_NAME", \
	"WHSE_CODE as WHSE_CODE", \
	"UNIT_MEAS as UNIT_MEAS", \
	"MANUAL as MANUAL", \
	"IS_NEW as IS_NEW", \
	"ALLOW_SLU as ALLOW_SLU", \
	"ALLOW_SU as ALLOW_SU", \
	"DISC_TRANS as DISC_TRANS", \
	"EACH_PER_BIN as EACH_PER_BIN", \
	"EX_RECPT_DATE as EX_RECPT_DATE", \
	"DISCONT as DISCONT", \
	"PROCESSED as PROCESSED", \
	"INN_PER_CS as INN_PER_CS", \
	"MAX_STACKING as MAX_STACKING", \
	"MAX_LANES as MAX_LANES", \
	"NUM_UNITS_PER_BIN as NUM_UNITS_PER_BIN", \
	"RESERVED_1 as RESERVED_1", \
	"RESERVED_2 as RESERVED_2", \
	"RESERVED_3 as RESERVED_3", \
	"RESERVED_4 as RESERVED_4", \
	"CREATE_DATE_TIME as CREATE_DATE_TIME", \
	"MOD_DATE_TIME as MOD_DATE_TIME", \
	"MOD_USER as MOD_USER", \
	"RESERVE_RACK_TYPE_ID as RESERVE_RACK_TYPE_ID", \
	"ALLOW_RESERVE as ALLOW_RESERVE", \
	"PALPAT_RESERVE as PALPAT_RESERVE", \
	"THREE_D_CALC_DONE as THREE_D_CALC_DONE", \
	"MAX_SLOTS as MAX_SLOTS", \
	"MAX_PALLET_STACKING as MAX_PALLET_STACKING", \
	"PROP_BORROWING_OBJECT as PROP_BORROWING_OBJECT", \
	"PROP_BORROWING_SPECIFIC as PROP_BORROWING_SPECIFIC", \
	"HEIGHT_CAN_BORROW as HEIGHT_CAN_BORROW", \
	"LENGTH_CAN_BORROW as LENGTH_CAN_BORROW", \
	"WIDTH_CAN_BORROW as WIDTH_CAN_BORROW", \
	"WEIGHT_CAN_BORROW as WEIGHT_CAN_BORROW", \
	"VEND_PACK_CAN_BORROW as VEND_PACK_CAN_BORROW", \
	"INNER_PACK_CAN_BORROW as INNER_PACK_CAN_BORROW", \
	"TI_CAN_BORROW as TI_CAN_BORROW", \
	"HI_CAN_BORROW as HI_CAN_BORROW", \
	"QTY_PER_GRAB_CAN_BORROW as QTY_PER_GRAB_CAN_BORROW", \
	"HAND_ATTR_CAN_BORROW as HAND_ATTR_CAN_BORROW", \
	"FAM_GRP_CAN_BORROW as FAM_GRP_CAN_BORROW", \
	"COMMODITY_CAN_BORROW as COMMODITY_CAN_BORROW", \
	"CRUSHABILITY_CAN_BORROW as CRUSHABILITY_CAN_BORROW", \
	"HAZARD_CAN_BORROW as HAZARD_CAN_BORROW", \
	"VEND_CODE_CAN_BORROW as VEND_CODE_CAN_BORROW", \
	"MISC1_CAN_BORROW as MISC1_CAN_BORROW", \
	"MISC2_CAN_BORROW as MISC2_CAN_BORROW", \
	"MISC3_CAN_BORROW as MISC3_CAN_BORROW", \
	"MISC4_CAN_BORROW as MISC4_CAN_BORROW", \
	"MISC5_CAN_BORROW as MISC5_CAN_BORROW", \
	"MISC6_CAN_BORROW as MISC6_CAN_BORROW", \
	"HEIGHT_BORROWED as HEIGHT_BORROWED", \
	"LENGTH_BORROWED as LENGTH_BORROWED", \
	"WIDTH_BORROWED as WIDTH_BORROWED", \
	"WEIGHT_BORROWED as WEIGHT_BORROWED", \
	"VEND_PACK_BORROWED as VEND_PACK_BORROWED", \
	"INNER_PACK_BORROWED as INNER_PACK_BORROWED", \
	"TI_BORROWED as TI_BORROWED", \
	"HI_BORROWED as HI_BORROWED", \
	"QTY_PER_GRAB_BORROWED as QTY_PER_GRAB_BORROWED", \
	"HAND_ATTR_BORROWED as HAND_ATTR_BORROWED", \
	"FAM_GRP_BORROWED as FAM_GRP_BORROWED", \
	"COMMODITY_BORROWED as COMMODITY_BORROWED", \
	"CRUSHABILITY_BORROWED as CRUSHABILITY_BORROWED", \
	"HAZARD_BORROWED as HAZARD_BORROWED", \
	"VEND_CODE_BORROWED as VEND_CODE_BORROWED", \
	"MISC1_BORROWED as MISC1_BORROWED", \
	"MISC2_BORROWED as MISC2_BORROWED", \
	"MISC3_BORROWED as MISC3_BORROWED", \
	"MISC4_BORROWED as MISC4_BORROWED", \
	"MISC5_BORROWED as MISC5_BORROWED", \
	"MISC6_BORROWED as MISC6_BORROWED", \
	"AFRAME_HT as AFRAME_HT", \
	"AFRAME_LEN as AFRAME_LEN", \
	"AFRAME_WID as AFRAME_WID", \
	"AFRAME_WT as AFRAME_WT", \
	"AFRAME_ALLOW as AFRAME_ALLOW", \
	"ITEM_NUM_1 as ITEM_NUM_1", \
	"ITEM_NUM_2 as ITEM_NUM_2", \
	"ITEM_NUM_3 as ITEM_NUM_3", \
	"ITEM_NUM_4 as ITEM_NUM_4", \
	"ITEM_NUM_5 as ITEM_NUM_5", \
	"ITEM_CHAR_1 as ITEM_CHAR_1", \
	"ITEM_CHAR_2 as ITEM_CHAR_2", \
	"ITEM_CHAR_3 as ITEM_CHAR_3", \
	"ITEM_CHAR_4 as ITEM_CHAR_4", \
	"ITEM_CHAR_5 as ITEM_CHAR_5", \
	"SLOTTING_GROUP as SLOTTING_GROUP", \
	"in_LOCATION_ID as in_LOCATION_ID", \
	"WM_ITEM_FACILITY_MAPPING_ID as WM_ITEM_FACILITY_MAPPING_ID", \
	"WM_ITEM_ID as WM_ITEM_ID", \
	"WM_ITEM_NAME as WM_ITEM_NAME", \
	"WM_WHSE_CD as WM_WHSE_CD", \
	"WM_SLOTTING_GROUP as WM_SLOTTING_GROUP", \
	"DISC_TRANS_TSTMP as DISC_TRANS_TSTMP", \
	"EX_RECEIPT_TSTMP as EX_RECEIPT_TSTMP", \
	"UNIT_MEASURE as UNIT_MEASURE", \
	"in_EACH_PER_BIN as in_EACH_PER_BIN", \
	"NBR_UNITS_PER_BIN as NBR_UNITS_PER_BIN", \
	"in_INN_PER_CS as in_INN_PER_CS", \
	"in_MAX_SLOTS as in_MAX_SLOTS", \
	"in_MAX_PALLET_STACKING as in_MAX_PALLET_STACKING", \
	"in_MAX_STACKING as in_MAX_STACKING", \
	"in_MAX_LANES as in_MAX_LANES", \
	"WM_RESERVE_RACK_TYPE_ID as WM_RESERVE_RACK_TYPE_ID", \
	"in_AFRAME_HT as in_AFRAME_HT", \
	"in_AFRAME_LEN as in_AFRAME_LEN", \
	"in_AFRAME_WID as in_AFRAME_WID", \
	"in_AFRAME_WT as in_AFRAME_WT", \
	"AFRAME_ALLOW_FLAG as AFRAME_ALLOW_FLAG", \
	"in_ALLOW_SLU as in_ALLOW_SLU", \
	"in_ALLOW_SU as in_ALLOW_SU", \
	"in_ALLOW_RESERVE as in_ALLOW_RESERVE", \
	"in_PALPAT_RESERVE as in_PALPAT_RESERVE", \
	"in_THREE_D_CALC_DONE as in_THREE_D_CALC_DONE", \
	"in_PROP_BORROWING_OBJECT as in_PROP_BORROWING_OBJECT", \
	"in_PROP_BORROWING_SPECIFIC as in_PROP_BORROWING_SPECIFIC", \
	"HEIGHT_CAN_BORROW_FLAG as HEIGHT_CAN_BORROW_FLAG", \
	"LENGTH_CAN_BORROW_FLAG as LENGTH_CAN_BORROW_FLAG", \
	"WIDTH_CAN_BORROW_FLAG as WIDTH_CAN_BORROW_FLAG", \
	"WEIGHT_CAN_BORROW_FLAG as WEIGHT_CAN_BORROW_FLAG", \
	"VEND_PACK_CAN_BORROW_FLAG as VEND_PACK_CAN_BORROW_FLAG", \
	"INNER_PACK_CAN_BORROW_FLAG as INNER_PACK_CAN_BORROW_FLAG", \
	"TI_CAN_BORROW_FLAG as TI_CAN_BORROW_FLAG", \
	"HI_CAN_BORROW_FLAG as HI_CAN_BORROW_FLAG", \
	"QTY_PER_GRAB_CAN_BORROW_FLAG as QTY_PER_GRAB_CAN_BORROW_FLAG", \
	"HAND_ATTR_CAN_BORROW_FLAG as HAND_ATTR_CAN_BORROW_FLAG", \
	"FAM_GRP_CAN_BORROW_FLAG as FAM_GRP_CAN_BORROW_FLAG", \
	"COMMODITY_CAN_BORROW_FLAG as COMMODITY_CAN_BORROW_FLAG", \
	"CRUSHABILITY_CAN_BORROW_FLAG as CRUSHABILITY_CAN_BORROW_FLAG", \
	"HAZARD_CAN_BORROW_FLAG as HAZARD_CAN_BORROW_FLAG", \
	"VEND_CODE_CAN_BORROW_FLAG as VEND_CODE_CAN_BORROW_FLAG", \
	"HEIGHT_BORROWED_FLAG as HEIGHT_BORROWED_FLAG", \
	"LENGTH_BORROWED_FLAG as LENGTH_BORROWED_FLAG", \
	"WIDTH_BORROWED_FLAG as WIDTH_BORROWED_FLAG", \
	"WEIGHT_BORROWED_FLAG as WEIGHT_BORROWED_FLAG", \
	"VEND_PACK_BORROWED_FLAG as VEND_PACK_BORROWED_FLAG", \
	"INNER_PACK_BORROWED_FLAG as INNER_PACK_BORROWED_FLAG", \
	"TI_BORROWED_FLAG as TI_BORROWED_FLAG", \
	"HI_BORROWED_FLAG as HI_BORROWED_FLAG", \
	"QTY_PER_GRAB_BORROWED_FLAG as QTY_PER_GRAB_BORROWED_FLAG", \
	"HAND_ATTR_BORROWED_FLAG as HAND_ATTR_BORROWED_FLAG", \
	"FAM_GRP_BORROWED_FLAG as FAM_GRP_BORROWED_FLAG", \
	"COMMODITY_BORROWED_FLAG as COMMODITY_BORROWED_FLAG", \
	"CRUSHABILITY_BORROWED_FLAG as CRUSHABILITY_BORROWED_FLAG", \
	"HAZARD_BORROWED_FLAG as HAZARD_BORROWED_FLAG", \
	"VEND_CODE_BORROWED_FLAG as VEND_CODE_BORROWED_FLAG", \
	"in_ITEM_NUM_1 as in_ITEM_NUM_1", \
	"in_ITEM_NUM_2 as in_ITEM_NUM_2", \
	"in_ITEM_NUM_3 as in_ITEM_NUM_3", \
	"in_ITEM_NUM_4 as in_ITEM_NUM_4", \
	"in_ITEM_NUM_5 as in_ITEM_NUM_5", \
	"in_ITEM_CHAR_1 as in_ITEM_CHAR_1", \
	"in_ITEM_CHAR_2 as in_ITEM_CHAR_2", \
	"in_ITEM_CHAR_3 as in_ITEM_CHAR_3", \
	"in_ITEM_CHAR_4 as in_ITEM_CHAR_4", \
	"in_ITEM_CHAR_5 as in_ITEM_CHAR_5", \
	"in_RESERVED_1 as in_RESERVED_1", \
	"in_RESERVED_2 as in_RESERVED_2", \
	"in_RESERVED_3 as in_RESERVED_3", \
	"in_RESERVED_4 as in_RESERVED_4", \
	"MISC_1_BORROWED_FLAG as MISC_1_BORROWED_FLAG", \
	"MISC_2_BORROWED_FLAG as MISC_2_BORROWED_FLAG", \
	"MISC_3_BORROWED_FLAG as MISC_3_BORROWED_FLAG", \
	"MISC_4_BORROWED_FLAG as MISC_4_BORROWED_FLAG", \
	"MISC_5_BORROWED_FLAG as MISC_5_BORROWED_FLAG", \
	"MISC_6_BORROWED_FLAG as MISC_6_BORROWED_FLAG", \
	"MISC_1_CAN_BORROW_FLAG as MISC_1_CAN_BORROW_FLAG", \
	"MISC_2_CAN_BORROW_FLAG as MISC_2_CAN_BORROW_FLAG", \
	"MISC_3_CAN_BORROW_FLAG as MISC_3_CAN_BORROW_FLAG", \
	"MISC_4_CAN_BORROW_FLAG as MISC_4_CAN_BORROW_FLAG", \
	"MISC_5_CAN_BORROW_FLAG as MISC_5_CAN_BORROW_FLAG", \
	"MISC_6_CAN_BORROW_FLAG as MISC_6_CAN_BORROW_FLAG", \
	"DISCONTINUED_FLAG as DISCONTINUED_FLAG", \
	"MANUAL_FLAG as MANUAL_FLAG", \
	"NEW_FLAG as NEW_FLAG", \
	"PROCESSED_FLAG as PROCESSED_FLAG", \
	"WM_MOD_USER as WM_MOD_USER", \
	"WM_CREATE_TSTMP as WM_CREATE_TSTMP", \
	"WM_MOD_TSTMP as WM_MOD_TSTMP", \
	"DELETE_FLAG as DELETE_FLAG", \
	"UPDATE_TSTMP as UPDATE_TSTMP", \
	"LOAD_TSTMP as LOAD_TSTMP", \
	"o_UPD_VALIDATOR as o_UPD_VALIDATOR" ,\
      "sys_row_id as sys_row_id") \
	.withColumn('in_DELETE_FLAG', lit(None)) \
	.withColumn('in_LOAD_TSTMP', lit(None)) \
	.select(col('sys_row_id'), \
	col('LOCATION_ID').alias('LOCATION_ID3'), \
	col('ITEM_FACILITY_MAPPING_ID').alias('ITEM_FACILITY_MAPPING_ID3'), \
	col('ITEM_ID').alias('ITEM_ID3'), \
	col('ITEM_NAME').alias('ITEM_NAME3'), \
	col('WHSE_CODE').alias('WHSE_CODE3'), \
	col('UNIT_MEAS').alias('UNIT_MEAS3'), \
	col('MANUAL').alias('MANUAL3'), \
	col('IS_NEW').alias('IS_NEW3'), \
	col('ALLOW_SLU').alias('ALLOW_SLU3'), \
	col('ALLOW_SU').alias('ALLOW_SU3'), \
	col('DISC_TRANS').alias('DISC_TRANS3'), \
	col('EACH_PER_BIN').alias('EACH_PER_BIN3'), \
	col('EX_RECPT_DATE').alias('EX_RECPT_DATE3'), \
	col('DISCONT').alias('DISCONT3'), \
	col('PROCESSED').alias('PROCESSED3'), \
	col('INN_PER_CS').alias('INN_PER_CS3'), \
	col('MAX_STACKING').alias('MAX_STACKING3'), \
	col('MAX_LANES').alias('MAX_LANES3'), \
	col('NUM_UNITS_PER_BIN').alias('NUM_UNITS_PER_BIN3'), \
	col('RESERVED_1').alias('RESERVED_13'), \
	col('RESERVED_2').alias('RESERVED_23'), \
	col('RESERVED_3').alias('RESERVED_33'), \
	col('RESERVED_4').alias('RESERVED_43'), \
	col('CREATE_DATE_TIME').alias('CREATE_DATE_TIME3'), \
	col('MOD_DATE_TIME').alias('MOD_DATE_TIME3'), \
	col('MOD_USER').alias('MOD_USER3'), \
	col('RESERVE_RACK_TYPE_ID').alias('RESERVE_RACK_TYPE_ID3'), \
	col('ALLOW_RESERVE').alias('ALLOW_RESERVE3'), \
	col('PALPAT_RESERVE').alias('PALPAT_RESERVE3'), \
	col('THREE_D_CALC_DONE').alias('THREE_D_CALC_DONE3'), \
	col('MAX_SLOTS').alias('MAX_SLOTS3'), \
	col('MAX_PALLET_STACKING').alias('MAX_PALLET_STACKING3'), \
	col('PROP_BORROWING_OBJECT').alias('PROP_BORROWING_OBJECT3'), \
	col('PROP_BORROWING_SPECIFIC').alias('PROP_BORROWING_SPECIFIC3'), \
	col('HEIGHT_CAN_BORROW').alias('HEIGHT_CAN_BORROW3'), \
	col('LENGTH_CAN_BORROW').alias('LENGTH_CAN_BORROW3'), \
	col('WIDTH_CAN_BORROW').alias('WIDTH_CAN_BORROW3'), \
	col('WEIGHT_CAN_BORROW').alias('WEIGHT_CAN_BORROW3'), \
	col('VEND_PACK_CAN_BORROW').alias('VEND_PACK_CAN_BORROW3'), \
	col('INNER_PACK_CAN_BORROW').alias('INNER_PACK_CAN_BORROW3'), \
	col('TI_CAN_BORROW').alias('TI_CAN_BORROW3'), \
	col('HI_CAN_BORROW').alias('HI_CAN_BORROW3'), \
	col('QTY_PER_GRAB_CAN_BORROW').alias('QTY_PER_GRAB_CAN_BORROW3'), \
	col('HAND_ATTR_CAN_BORROW').alias('HAND_ATTR_CAN_BORROW3'), \
	col('FAM_GRP_CAN_BORROW').alias('FAM_GRP_CAN_BORROW3'), \
	col('COMMODITY_CAN_BORROW').alias('COMMODITY_CAN_BORROW3'), \
	col('CRUSHABILITY_CAN_BORROW').alias('CRUSHABILITY_CAN_BORROW3'), \
	col('HAZARD_CAN_BORROW').alias('HAZARD_CAN_BORROW3'), \
	col('VEND_CODE_CAN_BORROW').alias('VEND_CODE_CAN_BORROW3'), \
	col('MISC1_CAN_BORROW').alias('MISC1_CAN_BORROW3'), \
	col('MISC2_CAN_BORROW').alias('MISC2_CAN_BORROW3'), \
	col('MISC3_CAN_BORROW').alias('MISC3_CAN_BORROW3'), \
	col('MISC4_CAN_BORROW').alias('MISC4_CAN_BORROW3'), \
	col('MISC5_CAN_BORROW').alias('MISC5_CAN_BORROW3'), \
	col('MISC6_CAN_BORROW').alias('MISC6_CAN_BORROW3'), \
	col('HEIGHT_BORROWED').alias('HEIGHT_BORROWED3'), \
	col('LENGTH_BORROWED').alias('LENGTH_BORROWED3'), \
	col('WIDTH_BORROWED').alias('WIDTH_BORROWED3'), \
	col('WEIGHT_BORROWED').alias('WEIGHT_BORROWED3'), \
	col('VEND_PACK_BORROWED').alias('VEND_PACK_BORROWED3'), \
	col('INNER_PACK_BORROWED').alias('INNER_PACK_BORROWED3'), \
	col('TI_BORROWED').alias('TI_BORROWED3'), \
	col('HI_BORROWED').alias('HI_BORROWED3'), \
	col('QTY_PER_GRAB_BORROWED').alias('QTY_PER_GRAB_BORROWED3'), \
	col('HAND_ATTR_BORROWED').alias('HAND_ATTR_BORROWED3'), \
	col('FAM_GRP_BORROWED').alias('FAM_GRP_BORROWED3'), \
	col('COMMODITY_BORROWED').alias('COMMODITY_BORROWED3'), \
	col('CRUSHABILITY_BORROWED').alias('CRUSHABILITY_BORROWED3'), \
	col('HAZARD_BORROWED').alias('HAZARD_BORROWED3'), \
	col('VEND_CODE_BORROWED').alias('VEND_CODE_BORROWED3'), \
	col('MISC1_BORROWED').alias('MISC1_BORROWED3'), \
	col('MISC2_BORROWED').alias('MISC2_BORROWED3'), \
	col('MISC3_BORROWED').alias('MISC3_BORROWED3'), \
	col('MISC4_BORROWED').alias('MISC4_BORROWED3'), \
	col('MISC5_BORROWED').alias('MISC5_BORROWED3'), \
	col('MISC6_BORROWED').alias('MISC6_BORROWED3'), \
	col('AFRAME_HT').alias('AFRAME_HT3'), \
	col('AFRAME_LEN').alias('AFRAME_LEN3'), \
	col('AFRAME_WID').alias('AFRAME_WID3'), \
	col('AFRAME_WT').alias('AFRAME_WT3'), \
	col('AFRAME_ALLOW').alias('AFRAME_ALLOW3'), \
	col('ITEM_NUM_1').alias('ITEM_NUM_13'), \
	col('ITEM_NUM_2').alias('ITEM_NUM_23'), \
	col('ITEM_NUM_3').alias('ITEM_NUM_33'), \
	col('ITEM_NUM_4').alias('ITEM_NUM_43'), \
	col('ITEM_NUM_5').alias('ITEM_NUM_53'), \
	col('ITEM_CHAR_1').alias('ITEM_CHAR_13'), \
	col('ITEM_CHAR_2').alias('ITEM_CHAR_23'), \
	col('ITEM_CHAR_3').alias('ITEM_CHAR_33'), \
	col('ITEM_CHAR_4').alias('ITEM_CHAR_43'), \
	col('ITEM_CHAR_5').alias('ITEM_CHAR_53'), \
	col('SLOTTING_GROUP').alias('SLOTTING_GROUP3'), \
	col('in_LOCATION_ID').alias('in_LOCATION_ID3'), \
	col('WM_ITEM_FACILITY_MAPPING_ID').alias('WM_ITEM_FACILITY_MAPPING_ID3'), \
	col('WM_ITEM_ID').alias('WM_ITEM_ID3'), \
	col('WM_ITEM_NAME').alias('WM_ITEM_NAME3'), \
	col('WM_WHSE_CD').alias('WM_WHSE_CD3'), \
	col('WM_SLOTTING_GROUP').alias('WM_SLOTTING_GROUP3'), \
	col('DISC_TRANS_TSTMP').alias('DISC_TRANS_TSTMP3'), \
	col('EX_RECEIPT_TSTMP').alias('EX_RECEIPT_TSTMP3'), \
	col('UNIT_MEASURE').alias('UNIT_MEASURE3'), \
	col('in_EACH_PER_BIN').alias('in_EACH_PER_BIN3'), \
	col('NBR_UNITS_PER_BIN').alias('NBR_UNITS_PER_BIN3'), \
	col('in_INN_PER_CS').alias('in_INN_PER_CS3'), \
	col('in_MAX_SLOTS').alias('in_MAX_SLOTS3'), \
	col('in_MAX_PALLET_STACKING').alias('in_MAX_PALLET_STACKING3'), \
	col('in_MAX_STACKING').alias('in_MAX_STACKING3'), \
	col('in_MAX_LANES').alias('in_MAX_LANES3'), \
	col('WM_RESERVE_RACK_TYPE_ID').alias('WM_RESERVE_RACK_TYPE_ID3'), \
	col('in_AFRAME_HT').alias('in_AFRAME_HT3'), \
	col('in_AFRAME_LEN').alias('in_AFRAME_LEN3'), \
	col('in_AFRAME_WID').alias('in_AFRAME_WID3'), \
	col('in_AFRAME_WT').alias('in_AFRAME_WT3'), \
	col('AFRAME_ALLOW_FLAG').alias('AFRAME_ALLOW_FLAG3'), \
	col('in_ALLOW_SLU').alias('in_ALLOW_SLU3'), \
	col('in_ALLOW_SU').alias('in_ALLOW_SU3'), \
	col('in_ALLOW_RESERVE').alias('in_ALLOW_RESERVE3'), \
	col('in_PALPAT_RESERVE').alias('in_PALPAT_RESERVE3'), \
	col('in_THREE_D_CALC_DONE').alias('in_THREE_D_CALC_DONE3'), \
	col('in_PROP_BORROWING_OBJECT').alias('in_PROP_BORROWING_OBJECT3'), \
	col('in_PROP_BORROWING_SPECIFIC').alias('in_PROP_BORROWING_SPECIFIC3'), \
	col('HEIGHT_CAN_BORROW_FLAG').alias('HEIGHT_CAN_BORROW_FLAG3'), \
	col('LENGTH_CAN_BORROW_FLAG').alias('LENGTH_CAN_BORROW_FLAG3'), \
	col('WIDTH_CAN_BORROW_FLAG').alias('WIDTH_CAN_BORROW_FLAG3'), \
	col('WEIGHT_CAN_BORROW_FLAG').alias('WEIGHT_CAN_BORROW_FLAG3'), \
	col('VEND_PACK_CAN_BORROW_FLAG').alias('VEND_PACK_CAN_BORROW_FLAG3'), \
	col('INNER_PACK_CAN_BORROW_FLAG').alias('INNER_PACK_CAN_BORROW_FLAG3'), \
	col('TI_CAN_BORROW_FLAG').alias('TI_CAN_BORROW_FLAG3'), \
	col('HI_CAN_BORROW_FLAG').alias('HI_CAN_BORROW_FLAG3'), \
	col('QTY_PER_GRAB_CAN_BORROW_FLAG').alias('QTY_PER_GRAB_CAN_BORROW_FLAG3'), \
	col('HAND_ATTR_CAN_BORROW_FLAG').alias('HAND_ATTR_CAN_BORROW_FLAG3'), \
	col('FAM_GRP_CAN_BORROW_FLAG').alias('FAM_GRP_CAN_BORROW_FLAG3'), \
	col('COMMODITY_CAN_BORROW_FLAG').alias('COMMODITY_CAN_BORROW_FLAG3'), \
	col('CRUSHABILITY_CAN_BORROW_FLAG').alias('CRUSHABILITY_CAN_BORROW_FLAG3'), \
	col('HAZARD_CAN_BORROW_FLAG').alias('HAZARD_CAN_BORROW_FLAG3'), \
	col('VEND_CODE_CAN_BORROW_FLAG').alias('VEND_CODE_CAN_BORROW_FLAG3'), \
	col('HEIGHT_BORROWED_FLAG').alias('HEIGHT_BORROWED_FLAG3'), \
	col('LENGTH_BORROWED_FLAG').alias('LENGTH_BORROWED_FLAG3'), \
	col('WIDTH_BORROWED_FLAG').alias('WIDTH_BORROWED_FLAG3'), \
	col('WEIGHT_BORROWED_FLAG').alias('WEIGHT_BORROWED_FLAG3'), \
	col('VEND_PACK_BORROWED_FLAG').alias('VEND_PACK_BORROWED_FLAG3'), \
	col('INNER_PACK_BORROWED_FLAG').alias('INNER_PACK_BORROWED_FLAG3'), \
	col('TI_BORROWED_FLAG').alias('TI_BORROWED_FLAG3'), \
	col('HI_BORROWED_FLAG').alias('HI_BORROWED_FLAG3'), \
	col('QTY_PER_GRAB_BORROWED_FLAG').alias('QTY_PER_GRAB_BORROWED_FLAG3'), \
	col('HAND_ATTR_BORROWED_FLAG').alias('HAND_ATTR_BORROWED_FLAG3'), \
	col('FAM_GRP_BORROWED_FLAG').alias('FAM_GRP_BORROWED_FLAG3'), \
	col('COMMODITY_BORROWED_FLAG').alias('COMMODITY_BORROWED_FLAG3'), \
	col('CRUSHABILITY_BORROWED_FLAG').alias('CRUSHABILITY_BORROWED_FLAG3'), \
	col('HAZARD_BORROWED_FLAG').alias('HAZARD_BORROWED_FLAG3'), \
	col('VEND_CODE_BORROWED_FLAG').alias('VEND_CODE_BORROWED_FLAG3'), \
	col('in_ITEM_NUM_1').alias('in_ITEM_NUM_13'), \
	col('in_ITEM_NUM_2').alias('in_ITEM_NUM_23'), \
	col('in_ITEM_NUM_3').alias('in_ITEM_NUM_33'), \
	col('in_ITEM_NUM_4').alias('in_ITEM_NUM_43'), \
	col('in_ITEM_NUM_5').alias('in_ITEM_NUM_53'), \
	col('in_ITEM_CHAR_1').alias('in_ITEM_CHAR_13'), \
	col('in_ITEM_CHAR_2').alias('in_ITEM_CHAR_23'), \
	col('in_ITEM_CHAR_3').alias('in_ITEM_CHAR_33'), \
	col('in_ITEM_CHAR_4').alias('in_ITEM_CHAR_43'), \
	col('in_ITEM_CHAR_5').alias('in_ITEM_CHAR_53'), \
	col('in_RESERVED_1').alias('in_RESERVED_13'), \
	col('in_RESERVED_2').alias('in_RESERVED_23'), \
	col('in_RESERVED_3').alias('in_RESERVED_33'), \
	col('in_RESERVED_4').alias('in_RESERVED_43'), \
	col('MISC_1_BORROWED_FLAG').alias('MISC_1_BORROWED_FLAG3'), \
	col('MISC_2_BORROWED_FLAG').alias('MISC_2_BORROWED_FLAG3'), \
	col('MISC_3_BORROWED_FLAG').alias('MISC_3_BORROWED_FLAG3'), \
	col('MISC_4_BORROWED_FLAG').alias('MISC_4_BORROWED_FLAG3'), \
	col('MISC_5_BORROWED_FLAG').alias('MISC_5_BORROWED_FLAG3'), \
	col('MISC_6_BORROWED_FLAG').alias('MISC_6_BORROWED_FLAG3'), \
	col('MISC_1_CAN_BORROW_FLAG').alias('MISC_1_CAN_BORROW_FLAG3'), \
	col('MISC_2_CAN_BORROW_FLAG').alias('MISC_2_CAN_BORROW_FLAG3'), \
	col('MISC_3_CAN_BORROW_FLAG').alias('MISC_3_CAN_BORROW_FLAG3'), \
	col('MISC_4_CAN_BORROW_FLAG').alias('MISC_4_CAN_BORROW_FLAG3'), \
	col('MISC_5_CAN_BORROW_FLAG').alias('MISC_5_CAN_BORROW_FLAG3'), \
	col('MISC_6_CAN_BORROW_FLAG').alias('MISC_6_CAN_BORROW_FLAG3'), \
	col('DISCONTINUED_FLAG').alias('DISCONTINUED_FLAG3'), \
	col('MANUAL_FLAG').alias('MANUAL_FLAG3'), \
	col('NEW_FLAG').alias('NEW_FLAG3'), \
	col('PROCESSED_FLAG').alias('PROCESSED_FLAG3'), \
	col('WM_MOD_USER').alias('WM_MOD_USER3'), \
	col('WM_CREATE_TSTMP').alias('WM_CREATE_TSTMP3'), \
	col('WM_MOD_TSTMP').alias('WM_MOD_TSTMP3'), \
	col('in_DELETE_FLAG').alias('in_DELETE_FLAG3'), \
	col('in_LOAD_TSTMP').alias('in_LOAD_TSTMP3'), \
	col('DELETE_FLAG').alias('DELETE_FLAG3'), \
	col('UPDATE_TSTMP').alias('UPDATE_TSTMP3'), \
	col('LOAD_TSTMP').alias('LOAD_TSTMP3'), \
	col('o_UPD_VALIDATOR').alias('o_UPD_VALIDATOR3')).filter("o_UPD_VALIDATOR = 'DELETE'")

# Creating output dataframe for RTR_DELETE, output group INSERT_UPDATE
RTR_DELETE_INSERT_UPDATE = EXP_UPD_VALIDATOR.selectExpr( \
	"LOCATION_ID as LOCATION_ID", \
	"ITEM_FACILITY_MAPPING_ID as ITEM_FACILITY_MAPPING_ID", \
	"ITEM_ID as ITEM_ID", \
	"ITEM_NAME as ITEM_NAME", \
	"WHSE_CODE as WHSE_CODE", \
	"UNIT_MEAS as UNIT_MEAS", \
	"MANUAL as MANUAL", \
	"IS_NEW as IS_NEW", \
	"ALLOW_SLU as ALLOW_SLU", \
	"ALLOW_SU as ALLOW_SU", \
	"DISC_TRANS as DISC_TRANS", \
	"EACH_PER_BIN as EACH_PER_BIN", \
	"EX_RECPT_DATE as EX_RECPT_DATE", \
	"DISCONT as DISCONT", \
	"PROCESSED as PROCESSED", \
	"INN_PER_CS as INN_PER_CS", \
	"MAX_STACKING as MAX_STACKING", \
	"MAX_LANES as MAX_LANES", \
	"NUM_UNITS_PER_BIN as NUM_UNITS_PER_BIN", \
	"RESERVED_1 as RESERVED_1", \
	"RESERVED_2 as RESERVED_2", \
	"RESERVED_3 as RESERVED_3", \
	"RESERVED_4 as RESERVED_4", \
	"CREATE_DATE_TIME as CREATE_DATE_TIME", \
	"MOD_DATE_TIME as MOD_DATE_TIME", \
	"MOD_USER as MOD_USER", \
	"RESERVE_RACK_TYPE_ID as RESERVE_RACK_TYPE_ID", \
	"ALLOW_RESERVE as ALLOW_RESERVE", \
	"PALPAT_RESERVE as PALPAT_RESERVE", \
	"THREE_D_CALC_DONE as THREE_D_CALC_DONE", \
	"MAX_SLOTS as MAX_SLOTS", \
	"MAX_PALLET_STACKING as MAX_PALLET_STACKING", \
	"PROP_BORROWING_OBJECT as PROP_BORROWING_OBJECT", \
	"PROP_BORROWING_SPECIFIC as PROP_BORROWING_SPECIFIC", \
	"HEIGHT_CAN_BORROW as HEIGHT_CAN_BORROW", \
	"LENGTH_CAN_BORROW as LENGTH_CAN_BORROW", \
	"WIDTH_CAN_BORROW as WIDTH_CAN_BORROW", \
	"WEIGHT_CAN_BORROW as WEIGHT_CAN_BORROW", \
	"VEND_PACK_CAN_BORROW as VEND_PACK_CAN_BORROW", \
	"INNER_PACK_CAN_BORROW as INNER_PACK_CAN_BORROW", \
	"TI_CAN_BORROW as TI_CAN_BORROW", \
	"HI_CAN_BORROW as HI_CAN_BORROW", \
	"QTY_PER_GRAB_CAN_BORROW as QTY_PER_GRAB_CAN_BORROW", \
	"HAND_ATTR_CAN_BORROW as HAND_ATTR_CAN_BORROW", \
	"FAM_GRP_CAN_BORROW as FAM_GRP_CAN_BORROW", \
	"COMMODITY_CAN_BORROW as COMMODITY_CAN_BORROW", \
	"CRUSHABILITY_CAN_BORROW as CRUSHABILITY_CAN_BORROW", \
	"HAZARD_CAN_BORROW as HAZARD_CAN_BORROW", \
	"VEND_CODE_CAN_BORROW as VEND_CODE_CAN_BORROW", \
	"MISC1_CAN_BORROW as MISC1_CAN_BORROW", \
	"MISC2_CAN_BORROW as MISC2_CAN_BORROW", \
	"MISC3_CAN_BORROW as MISC3_CAN_BORROW", \
	"MISC4_CAN_BORROW as MISC4_CAN_BORROW", \
	"MISC5_CAN_BORROW as MISC5_CAN_BORROW", \
	"MISC6_CAN_BORROW as MISC6_CAN_BORROW", \
	"HEIGHT_BORROWED as HEIGHT_BORROWED", \
	"LENGTH_BORROWED as LENGTH_BORROWED", \
	"WIDTH_BORROWED as WIDTH_BORROWED", \
	"WEIGHT_BORROWED as WEIGHT_BORROWED", \
	"VEND_PACK_BORROWED as VEND_PACK_BORROWED", \
	"INNER_PACK_BORROWED as INNER_PACK_BORROWED", \
	"TI_BORROWED as TI_BORROWED", \
	"HI_BORROWED as HI_BORROWED", \
	"QTY_PER_GRAB_BORROWED as QTY_PER_GRAB_BORROWED", \
	"HAND_ATTR_BORROWED as HAND_ATTR_BORROWED", \
	"FAM_GRP_BORROWED as FAM_GRP_BORROWED", \
	"COMMODITY_BORROWED as COMMODITY_BORROWED", \
	"CRUSHABILITY_BORROWED as CRUSHABILITY_BORROWED", \
	"HAZARD_BORROWED as HAZARD_BORROWED", \
	"VEND_CODE_BORROWED as VEND_CODE_BORROWED", \
	"MISC1_BORROWED as MISC1_BORROWED", \
	"MISC2_BORROWED as MISC2_BORROWED", \
	"MISC3_BORROWED as MISC3_BORROWED", \
	"MISC4_BORROWED as MISC4_BORROWED", \
	"MISC5_BORROWED as MISC5_BORROWED", \
	"MISC6_BORROWED as MISC6_BORROWED", \
	"AFRAME_HT as AFRAME_HT", \
	"AFRAME_LEN as AFRAME_LEN", \
	"AFRAME_WID as AFRAME_WID", \
	"AFRAME_WT as AFRAME_WT", \
	"AFRAME_ALLOW as AFRAME_ALLOW", \
	"ITEM_NUM_1 as ITEM_NUM_1", \
	"ITEM_NUM_2 as ITEM_NUM_2", \
	"ITEM_NUM_3 as ITEM_NUM_3", \
	"ITEM_NUM_4 as ITEM_NUM_4", \
	"ITEM_NUM_5 as ITEM_NUM_5", \
	"ITEM_CHAR_1 as ITEM_CHAR_1", \
	"ITEM_CHAR_2 as ITEM_CHAR_2", \
	"ITEM_CHAR_3 as ITEM_CHAR_3", \
	"ITEM_CHAR_4 as ITEM_CHAR_4", \
	"ITEM_CHAR_5 as ITEM_CHAR_5", \
	"SLOTTING_GROUP as SLOTTING_GROUP", \
	"in_LOCATION_ID as in_LOCATION_ID", \
	"WM_ITEM_FACILITY_MAPPING_ID as WM_ITEM_FACILITY_MAPPING_ID", \
	"WM_ITEM_ID as WM_ITEM_ID", \
	"WM_ITEM_NAME as WM_ITEM_NAME", \
	"WM_WHSE_CD as WM_WHSE_CD", \
	"WM_SLOTTING_GROUP as WM_SLOTTING_GROUP", \
	"DISC_TRANS_TSTMP as DISC_TRANS_TSTMP", \
	"EX_RECEIPT_TSTMP as EX_RECEIPT_TSTMP", \
	"UNIT_MEASURE as UNIT_MEASURE", \
	"in_EACH_PER_BIN as in_EACH_PER_BIN", \
	"NBR_UNITS_PER_BIN as NBR_UNITS_PER_BIN", \
	"in_INN_PER_CS as in_INN_PER_CS", \
	"in_MAX_SLOTS as in_MAX_SLOTS", \
	"in_MAX_PALLET_STACKING as in_MAX_PALLET_STACKING", \
	"in_MAX_STACKING as in_MAX_STACKING", \
	"in_MAX_LANES as in_MAX_LANES", \
	"WM_RESERVE_RACK_TYPE_ID as WM_RESERVE_RACK_TYPE_ID", \
	"in_AFRAME_HT as in_AFRAME_HT", \
	"in_AFRAME_LEN as in_AFRAME_LEN", \
	"in_AFRAME_WID as in_AFRAME_WID", \
	"in_AFRAME_WT as in_AFRAME_WT", \
	"AFRAME_ALLOW_FLAG as AFRAME_ALLOW_FLAG", \
	"in_ALLOW_SLU as in_ALLOW_SLU", \
	"in_ALLOW_SU as in_ALLOW_SU", \
	"in_ALLOW_RESERVE as in_ALLOW_RESERVE", \
	"in_PALPAT_RESERVE as in_PALPAT_RESERVE", \
	"in_THREE_D_CALC_DONE as in_THREE_D_CALC_DONE", \
	"in_PROP_BORROWING_OBJECT as in_PROP_BORROWING_OBJECT", \
	"in_PROP_BORROWING_SPECIFIC as in_PROP_BORROWING_SPECIFIC", \
	"HEIGHT_CAN_BORROW_FLAG as HEIGHT_CAN_BORROW_FLAG", \
	"LENGTH_CAN_BORROW_FLAG as LENGTH_CAN_BORROW_FLAG", \
	"WIDTH_CAN_BORROW_FLAG as WIDTH_CAN_BORROW_FLAG", \
	"WEIGHT_CAN_BORROW_FLAG as WEIGHT_CAN_BORROW_FLAG", \
	"VEND_PACK_CAN_BORROW_FLAG as VEND_PACK_CAN_BORROW_FLAG", \
	"INNER_PACK_CAN_BORROW_FLAG as INNER_PACK_CAN_BORROW_FLAG", \
	"TI_CAN_BORROW_FLAG as TI_CAN_BORROW_FLAG", \
	"HI_CAN_BORROW_FLAG as HI_CAN_BORROW_FLAG", \
	"QTY_PER_GRAB_CAN_BORROW_FLAG as QTY_PER_GRAB_CAN_BORROW_FLAG", \
	"HAND_ATTR_CAN_BORROW_FLAG as HAND_ATTR_CAN_BORROW_FLAG", \
	"FAM_GRP_CAN_BORROW_FLAG as FAM_GRP_CAN_BORROW_FLAG", \
	"COMMODITY_CAN_BORROW_FLAG as COMMODITY_CAN_BORROW_FLAG", \
	"CRUSHABILITY_CAN_BORROW_FLAG as CRUSHABILITY_CAN_BORROW_FLAG", \
	"HAZARD_CAN_BORROW_FLAG as HAZARD_CAN_BORROW_FLAG", \
	"VEND_CODE_CAN_BORROW_FLAG as VEND_CODE_CAN_BORROW_FLAG", \
	"HEIGHT_BORROWED_FLAG as HEIGHT_BORROWED_FLAG", \
	"LENGTH_BORROWED_FLAG as LENGTH_BORROWED_FLAG", \
	"WIDTH_BORROWED_FLAG as WIDTH_BORROWED_FLAG", \
	"WEIGHT_BORROWED_FLAG as WEIGHT_BORROWED_FLAG", \
	"VEND_PACK_BORROWED_FLAG as VEND_PACK_BORROWED_FLAG", \
	"INNER_PACK_BORROWED_FLAG as INNER_PACK_BORROWED_FLAG", \
	"TI_BORROWED_FLAG as TI_BORROWED_FLAG", \
	"HI_BORROWED_FLAG as HI_BORROWED_FLAG", \
	"QTY_PER_GRAB_BORROWED_FLAG as QTY_PER_GRAB_BORROWED_FLAG", \
	"HAND_ATTR_BORROWED_FLAG as HAND_ATTR_BORROWED_FLAG", \
	"FAM_GRP_BORROWED_FLAG as FAM_GRP_BORROWED_FLAG", \
	"COMMODITY_BORROWED_FLAG as COMMODITY_BORROWED_FLAG", \
	"CRUSHABILITY_BORROWED_FLAG as CRUSHABILITY_BORROWED_FLAG", \
	"HAZARD_BORROWED_FLAG as HAZARD_BORROWED_FLAG", \
	"VEND_CODE_BORROWED_FLAG as VEND_CODE_BORROWED_FLAG", \
	"in_ITEM_NUM_1 as in_ITEM_NUM_1", \
	"in_ITEM_NUM_2 as in_ITEM_NUM_2", \
	"in_ITEM_NUM_3 as in_ITEM_NUM_3", \
	"in_ITEM_NUM_4 as in_ITEM_NUM_4", \
	"in_ITEM_NUM_5 as in_ITEM_NUM_5", \
	"in_ITEM_CHAR_1 as in_ITEM_CHAR_1", \
	"in_ITEM_CHAR_2 as in_ITEM_CHAR_2", \
	"in_ITEM_CHAR_3 as in_ITEM_CHAR_3", \
	"in_ITEM_CHAR_4 as in_ITEM_CHAR_4", \
	"in_ITEM_CHAR_5 as in_ITEM_CHAR_5", \
	"in_RESERVED_1 as in_RESERVED_1", \
	"in_RESERVED_2 as in_RESERVED_2", \
	"in_RESERVED_3 as in_RESERVED_3", \
	"in_RESERVED_4 as in_RESERVED_4", \
	"MISC_1_BORROWED_FLAG as MISC_1_BORROWED_FLAG", \
	"MISC_2_BORROWED_FLAG as MISC_2_BORROWED_FLAG", \
	"MISC_3_BORROWED_FLAG as MISC_3_BORROWED_FLAG", \
	"MISC_4_BORROWED_FLAG as MISC_4_BORROWED_FLAG", \
	"MISC_5_BORROWED_FLAG as MISC_5_BORROWED_FLAG", \
	"MISC_6_BORROWED_FLAG as MISC_6_BORROWED_FLAG", \
	"MISC_1_CAN_BORROW_FLAG as MISC_1_CAN_BORROW_FLAG", \
	"MISC_2_CAN_BORROW_FLAG as MISC_2_CAN_BORROW_FLAG", \
	"MISC_3_CAN_BORROW_FLAG as MISC_3_CAN_BORROW_FLAG", \
	"MISC_4_CAN_BORROW_FLAG as MISC_4_CAN_BORROW_FLAG", \
	"MISC_5_CAN_BORROW_FLAG as MISC_5_CAN_BORROW_FLAG", \
	"MISC_6_CAN_BORROW_FLAG as MISC_6_CAN_BORROW_FLAG", \
	"DISCONTINUED_FLAG as DISCONTINUED_FLAG", \
	"MANUAL_FLAG as MANUAL_FLAG", \
	"NEW_FLAG as NEW_FLAG", \
	"PROCESSED_FLAG as PROCESSED_FLAG", \
	"WM_MOD_USER as WM_MOD_USER", \
	"WM_CREATE_TSTMP as WM_CREATE_TSTMP", \
	"WM_MOD_TSTMP as WM_MOD_TSTMP", \
	"DELETE_FLAG as DELETE_FLAG", \
	"UPDATE_TSTMP as UPDATE_TSTMP", \
	"LOAD_TSTMP as LOAD_TSTMP", \
	"o_UPD_VALIDATOR as o_UPD_VALIDATOR" ,\
      "sys_row_id as sys_row_id") \
	.withColumn('in_DELETE_FLAG', lit(None)) \
	.withColumn('in_LOAD_TSTMP', lit(None)) \
	.select(col('sys_row_id'), \
	col('LOCATION_ID').alias('LOCATION_ID1'), \
	col('ITEM_FACILITY_MAPPING_ID').alias('ITEM_FACILITY_MAPPING_ID1'), \
	col('ITEM_ID').alias('ITEM_ID1'), \
	col('ITEM_NAME').alias('ITEM_NAME1'), \
	col('WHSE_CODE').alias('WHSE_CODE1'), \
	col('UNIT_MEAS').alias('UNIT_MEAS1'), \
	col('MANUAL').alias('MANUAL1'), \
	col('IS_NEW').alias('IS_NEW1'), \
	col('ALLOW_SLU').alias('ALLOW_SLU1'), \
	col('ALLOW_SU').alias('ALLOW_SU1'), \
	col('DISC_TRANS').alias('DISC_TRANS1'), \
	col('EACH_PER_BIN').alias('EACH_PER_BIN1'), \
	col('EX_RECPT_DATE').alias('EX_RECPT_DATE1'), \
	col('DISCONT').alias('DISCONT1'), \
	col('PROCESSED').alias('PROCESSED1'), \
	col('INN_PER_CS').alias('INN_PER_CS1'), \
	col('MAX_STACKING').alias('MAX_STACKING1'), \
	col('MAX_LANES').alias('MAX_LANES1'), \
	col('NUM_UNITS_PER_BIN').alias('NUM_UNITS_PER_BIN1'), \
	col('RESERVED_1').alias('RESERVED_11'), \
	col('RESERVED_2').alias('RESERVED_21'), \
	col('RESERVED_3').alias('RESERVED_31'), \
	col('RESERVED_4').alias('RESERVED_41'), \
	col('CREATE_DATE_TIME').alias('CREATE_DATE_TIME1'), \
	col('MOD_DATE_TIME').alias('MOD_DATE_TIME1'), \
	col('MOD_USER').alias('MOD_USER1'), \
	col('RESERVE_RACK_TYPE_ID').alias('RESERVE_RACK_TYPE_ID1'), \
	col('ALLOW_RESERVE').alias('ALLOW_RESERVE1'), \
	col('PALPAT_RESERVE').alias('PALPAT_RESERVE1'), \
	col('THREE_D_CALC_DONE').alias('THREE_D_CALC_DONE1'), \
	col('MAX_SLOTS').alias('MAX_SLOTS1'), \
	col('MAX_PALLET_STACKING').alias('MAX_PALLET_STACKING1'), \
	col('PROP_BORROWING_OBJECT').alias('PROP_BORROWING_OBJECT1'), \
	col('PROP_BORROWING_SPECIFIC').alias('PROP_BORROWING_SPECIFIC1'), \
	col('HEIGHT_CAN_BORROW').alias('HEIGHT_CAN_BORROW1'), \
	col('LENGTH_CAN_BORROW').alias('LENGTH_CAN_BORROW1'), \
	col('WIDTH_CAN_BORROW').alias('WIDTH_CAN_BORROW1'), \
	col('WEIGHT_CAN_BORROW').alias('WEIGHT_CAN_BORROW1'), \
	col('VEND_PACK_CAN_BORROW').alias('VEND_PACK_CAN_BORROW1'), \
	col('INNER_PACK_CAN_BORROW').alias('INNER_PACK_CAN_BORROW1'), \
	col('TI_CAN_BORROW').alias('TI_CAN_BORROW1'), \
	col('HI_CAN_BORROW').alias('HI_CAN_BORROW1'), \
	col('QTY_PER_GRAB_CAN_BORROW').alias('QTY_PER_GRAB_CAN_BORROW1'), \
	col('HAND_ATTR_CAN_BORROW').alias('HAND_ATTR_CAN_BORROW1'), \
	col('FAM_GRP_CAN_BORROW').alias('FAM_GRP_CAN_BORROW1'), \
	col('COMMODITY_CAN_BORROW').alias('COMMODITY_CAN_BORROW1'), \
	col('CRUSHABILITY_CAN_BORROW').alias('CRUSHABILITY_CAN_BORROW1'), \
	col('HAZARD_CAN_BORROW').alias('HAZARD_CAN_BORROW1'), \
	col('VEND_CODE_CAN_BORROW').alias('VEND_CODE_CAN_BORROW1'), \
	col('MISC1_CAN_BORROW').alias('MISC1_CAN_BORROW1'), \
	col('MISC2_CAN_BORROW').alias('MISC2_CAN_BORROW1'), \
	col('MISC3_CAN_BORROW').alias('MISC3_CAN_BORROW1'), \
	col('MISC4_CAN_BORROW').alias('MISC4_CAN_BORROW1'), \
	col('MISC5_CAN_BORROW').alias('MISC5_CAN_BORROW1'), \
	col('MISC6_CAN_BORROW').alias('MISC6_CAN_BORROW1'), \
	col('HEIGHT_BORROWED').alias('HEIGHT_BORROWED1'), \
	col('LENGTH_BORROWED').alias('LENGTH_BORROWED1'), \
	col('WIDTH_BORROWED').alias('WIDTH_BORROWED1'), \
	col('WEIGHT_BORROWED').alias('WEIGHT_BORROWED1'), \
	col('VEND_PACK_BORROWED').alias('VEND_PACK_BORROWED1'), \
	col('INNER_PACK_BORROWED').alias('INNER_PACK_BORROWED1'), \
	col('TI_BORROWED').alias('TI_BORROWED1'), \
	col('HI_BORROWED').alias('HI_BORROWED1'), \
	col('QTY_PER_GRAB_BORROWED').alias('QTY_PER_GRAB_BORROWED1'), \
	col('HAND_ATTR_BORROWED').alias('HAND_ATTR_BORROWED1'), \
	col('FAM_GRP_BORROWED').alias('FAM_GRP_BORROWED1'), \
	col('COMMODITY_BORROWED').alias('COMMODITY_BORROWED1'), \
	col('CRUSHABILITY_BORROWED').alias('CRUSHABILITY_BORROWED1'), \
	col('HAZARD_BORROWED').alias('HAZARD_BORROWED1'), \
	col('VEND_CODE_BORROWED').alias('VEND_CODE_BORROWED1'), \
	col('MISC1_BORROWED').alias('MISC1_BORROWED1'), \
	col('MISC2_BORROWED').alias('MISC2_BORROWED1'), \
	col('MISC3_BORROWED').alias('MISC3_BORROWED1'), \
	col('MISC4_BORROWED').alias('MISC4_BORROWED1'), \
	col('MISC5_BORROWED').alias('MISC5_BORROWED1'), \
	col('MISC6_BORROWED').alias('MISC6_BORROWED1'), \
	col('AFRAME_HT').alias('AFRAME_HT1'), \
	col('AFRAME_LEN').alias('AFRAME_LEN1'), \
	col('AFRAME_WID').alias('AFRAME_WID1'), \
	col('AFRAME_WT').alias('AFRAME_WT1'), \
	col('AFRAME_ALLOW').alias('AFRAME_ALLOW1'), \
	col('ITEM_NUM_1').alias('ITEM_NUM_11'), \
	col('ITEM_NUM_2').alias('ITEM_NUM_21'), \
	col('ITEM_NUM_3').alias('ITEM_NUM_31'), \
	col('ITEM_NUM_4').alias('ITEM_NUM_41'), \
	col('ITEM_NUM_5').alias('ITEM_NUM_51'), \
	col('ITEM_CHAR_1').alias('ITEM_CHAR_11'), \
	col('ITEM_CHAR_2').alias('ITEM_CHAR_21'), \
	col('ITEM_CHAR_3').alias('ITEM_CHAR_31'), \
	col('ITEM_CHAR_4').alias('ITEM_CHAR_41'), \
	col('ITEM_CHAR_5').alias('ITEM_CHAR_51'), \
	col('SLOTTING_GROUP').alias('SLOTTING_GROUP1'), \
	col('in_LOCATION_ID').alias('in_LOCATION_ID1'), \
	col('WM_ITEM_FACILITY_MAPPING_ID').alias('WM_ITEM_FACILITY_MAPPING_ID1'), \
	col('WM_ITEM_ID').alias('WM_ITEM_ID1'), \
	col('WM_ITEM_NAME').alias('WM_ITEM_NAME1'), \
	col('WM_WHSE_CD').alias('WM_WHSE_CD1'), \
	col('WM_SLOTTING_GROUP').alias('WM_SLOTTING_GROUP1'), \
	col('DISC_TRANS_TSTMP').alias('DISC_TRANS_TSTMP1'), \
	col('EX_RECEIPT_TSTMP').alias('EX_RECEIPT_TSTMP1'), \
	col('UNIT_MEASURE').alias('UNIT_MEASURE1'), \
	col('in_EACH_PER_BIN').alias('in_EACH_PER_BIN1'), \
	col('NBR_UNITS_PER_BIN').alias('NBR_UNITS_PER_BIN1'), \
	col('in_INN_PER_CS').alias('in_INN_PER_CS1'), \
	col('in_MAX_SLOTS').alias('in_MAX_SLOTS1'), \
	col('in_MAX_PALLET_STACKING').alias('in_MAX_PALLET_STACKING1'), \
	col('in_MAX_STACKING').alias('in_MAX_STACKING1'), \
	col('in_MAX_LANES').alias('in_MAX_LANES1'), \
	col('WM_RESERVE_RACK_TYPE_ID').alias('WM_RESERVE_RACK_TYPE_ID1'), \
	col('in_AFRAME_HT').alias('in_AFRAME_HT1'), \
	col('in_AFRAME_LEN').alias('in_AFRAME_LEN1'), \
	col('in_AFRAME_WID').alias('in_AFRAME_WID1'), \
	col('in_AFRAME_WT').alias('in_AFRAME_WT1'), \
	col('AFRAME_ALLOW_FLAG').alias('AFRAME_ALLOW_FLAG1'), \
	col('in_ALLOW_SLU').alias('in_ALLOW_SLU1'), \
	col('in_ALLOW_SU').alias('in_ALLOW_SU1'), \
	col('in_ALLOW_RESERVE').alias('in_ALLOW_RESERVE1'), \
	col('in_PALPAT_RESERVE').alias('in_PALPAT_RESERVE1'), \
	col('in_THREE_D_CALC_DONE').alias('in_THREE_D_CALC_DONE1'), \
	col('in_PROP_BORROWING_OBJECT').alias('in_PROP_BORROWING_OBJECT1'), \
	col('in_PROP_BORROWING_SPECIFIC').alias('in_PROP_BORROWING_SPECIFIC1'), \
	col('HEIGHT_CAN_BORROW_FLAG').alias('HEIGHT_CAN_BORROW_FLAG1'), \
	col('LENGTH_CAN_BORROW_FLAG').alias('LENGTH_CAN_BORROW_FLAG1'), \
	col('WIDTH_CAN_BORROW_FLAG').alias('WIDTH_CAN_BORROW_FLAG1'), \
	col('WEIGHT_CAN_BORROW_FLAG').alias('WEIGHT_CAN_BORROW_FLAG1'), \
	col('VEND_PACK_CAN_BORROW_FLAG').alias('VEND_PACK_CAN_BORROW_FLAG1'), \
	col('INNER_PACK_CAN_BORROW_FLAG').alias('INNER_PACK_CAN_BORROW_FLAG1'), \
	col('TI_CAN_BORROW_FLAG').alias('TI_CAN_BORROW_FLAG1'), \
	col('HI_CAN_BORROW_FLAG').alias('HI_CAN_BORROW_FLAG1'), \
	col('QTY_PER_GRAB_CAN_BORROW_FLAG').alias('QTY_PER_GRAB_CAN_BORROW_FLAG1'), \
	col('HAND_ATTR_CAN_BORROW_FLAG').alias('HAND_ATTR_CAN_BORROW_FLAG1'), \
	col('FAM_GRP_CAN_BORROW_FLAG').alias('FAM_GRP_CAN_BORROW_FLAG1'), \
	col('COMMODITY_CAN_BORROW_FLAG').alias('COMMODITY_CAN_BORROW_FLAG1'), \
	col('CRUSHABILITY_CAN_BORROW_FLAG').alias('CRUSHABILITY_CAN_BORROW_FLAG1'), \
	col('HAZARD_CAN_BORROW_FLAG').alias('HAZARD_CAN_BORROW_FLAG1'), \
	col('VEND_CODE_CAN_BORROW_FLAG').alias('VEND_CODE_CAN_BORROW_FLAG1'), \
	col('HEIGHT_BORROWED_FLAG').alias('HEIGHT_BORROWED_FLAG1'), \
	col('LENGTH_BORROWED_FLAG').alias('LENGTH_BORROWED_FLAG1'), \
	col('WIDTH_BORROWED_FLAG').alias('WIDTH_BORROWED_FLAG1'), \
	col('WEIGHT_BORROWED_FLAG').alias('WEIGHT_BORROWED_FLAG1'), \
	col('VEND_PACK_BORROWED_FLAG').alias('VEND_PACK_BORROWED_FLAG1'), \
	col('INNER_PACK_BORROWED_FLAG').alias('INNER_PACK_BORROWED_FLAG1'), \
	col('TI_BORROWED_FLAG').alias('TI_BORROWED_FLAG1'), \
	col('HI_BORROWED_FLAG').alias('HI_BORROWED_FLAG1'), \
	col('QTY_PER_GRAB_BORROWED_FLAG').alias('QTY_PER_GRAB_BORROWED_FLAG1'), \
	col('HAND_ATTR_BORROWED_FLAG').alias('HAND_ATTR_BORROWED_FLAG1'), \
	col('FAM_GRP_BORROWED_FLAG').alias('FAM_GRP_BORROWED_FLAG1'), \
	col('COMMODITY_BORROWED_FLAG').alias('COMMODITY_BORROWED_FLAG1'), \
	col('CRUSHABILITY_BORROWED_FLAG').alias('CRUSHABILITY_BORROWED_FLAG1'), \
	col('HAZARD_BORROWED_FLAG').alias('HAZARD_BORROWED_FLAG1'), \
	col('VEND_CODE_BORROWED_FLAG').alias('VEND_CODE_BORROWED_FLAG1'), \
	col('in_ITEM_NUM_1').alias('in_ITEM_NUM_11'), \
	col('in_ITEM_NUM_2').alias('in_ITEM_NUM_21'), \
	col('in_ITEM_NUM_3').alias('in_ITEM_NUM_31'), \
	col('in_ITEM_NUM_4').alias('in_ITEM_NUM_41'), \
	col('in_ITEM_NUM_5').alias('in_ITEM_NUM_51'), \
	col('in_ITEM_CHAR_1').alias('in_ITEM_CHAR_11'), \
	col('in_ITEM_CHAR_2').alias('in_ITEM_CHAR_21'), \
	col('in_ITEM_CHAR_3').alias('in_ITEM_CHAR_31'), \
	col('in_ITEM_CHAR_4').alias('in_ITEM_CHAR_41'), \
	col('in_ITEM_CHAR_5').alias('in_ITEM_CHAR_51'), \
	col('in_RESERVED_1').alias('in_RESERVED_11'), \
	col('in_RESERVED_2').alias('in_RESERVED_21'), \
	col('in_RESERVED_3').alias('in_RESERVED_31'), \
	col('in_RESERVED_4').alias('in_RESERVED_41'), \
	col('MISC_1_BORROWED_FLAG').alias('MISC_1_BORROWED_FLAG1'), \
	col('MISC_2_BORROWED_FLAG').alias('MISC_2_BORROWED_FLAG1'), \
	col('MISC_3_BORROWED_FLAG').alias('MISC_3_BORROWED_FLAG1'), \
	col('MISC_4_BORROWED_FLAG').alias('MISC_4_BORROWED_FLAG1'), \
	col('MISC_5_BORROWED_FLAG').alias('MISC_5_BORROWED_FLAG1'), \
	col('MISC_6_BORROWED_FLAG').alias('MISC_6_BORROWED_FLAG1'), \
	col('MISC_1_CAN_BORROW_FLAG').alias('MISC_1_CAN_BORROW_FLAG1'), \
	col('MISC_2_CAN_BORROW_FLAG').alias('MISC_2_CAN_BORROW_FLAG1'), \
	col('MISC_3_CAN_BORROW_FLAG').alias('MISC_3_CAN_BORROW_FLAG1'), \
	col('MISC_4_CAN_BORROW_FLAG').alias('MISC_4_CAN_BORROW_FLAG1'), \
	col('MISC_5_CAN_BORROW_FLAG').alias('MISC_5_CAN_BORROW_FLAG1'), \
	col('MISC_6_CAN_BORROW_FLAG').alias('MISC_6_CAN_BORROW_FLAG1'), \
	col('DISCONTINUED_FLAG').alias('DISCONTINUED_FLAG1'), \
	col('MANUAL_FLAG').alias('MANUAL_FLAG1'), \
	col('NEW_FLAG').alias('NEW_FLAG1'), \
	col('PROCESSED_FLAG').alias('PROCESSED_FLAG1'), \
	col('WM_MOD_USER').alias('WM_MOD_USER1'), \
	col('WM_CREATE_TSTMP').alias('WM_CREATE_TSTMP1'), \
	col('WM_MOD_TSTMP').alias('WM_MOD_TSTMP1'), \
	col('in_DELETE_FLAG').alias('in_DELETE_FLAG1'), \
	col('in_LOAD_TSTMP').alias('in_LOAD_TSTMP1'), \
	col('DELETE_FLAG').alias('DELETE_FLAG1'), \
	col('UPDATE_TSTMP').alias('UPDATE_TSTMP1'), \
	col('LOAD_TSTMP').alias('LOAD_TSTMP1'), \
	col('o_UPD_VALIDATOR').alias('o_UPD_VALIDATOR1')).filter("o_UPD_VALIDATOR = 'INSERT' OR o_UPD_VALIDATOR = 'UPDATE'")


# COMMAND ----------
# Processing node UPD_INS_UPD, type UPDATE_STRATEGY 
# COLUMN COUNT: 96

# for each involved DataFrame, append the dataframe name to each column
RTR_DELETE_INSERT_UPDATE_temp = RTR_DELETE_INSERT_UPDATE.toDF(*["RTR_DELETE_INSERT_UPDATE___" + col for col in RTR_DELETE_INSERT_UPDATE.columns])

UPD_INS_UPD = RTR_DELETE_INSERT_UPDATE_temp.selectExpr( \
	"RTR_DELETE_INSERT_UPDATE___LOCATION_ID1 as LOCATION_ID1", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_FACILITY_MAPPING_ID1 as ITEM_FACILITY_MAPPING_ID1", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_ID1 as ITEM_ID1", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_NAME1 as ITEM_NAME1", \
	"RTR_DELETE_INSERT_UPDATE___WHSE_CODE1 as WHSE_CODE1", \
	"RTR_DELETE_INSERT_UPDATE___SLOTTING_GROUP1 as SLOTTING_GROUP1", \
	"RTR_DELETE_INSERT_UPDATE___DISC_TRANS1 as DISC_TRANS1", \
	"RTR_DELETE_INSERT_UPDATE___EX_RECPT_DATE1 as EX_RECPT_DATE1", \
	"RTR_DELETE_INSERT_UPDATE___UNIT_MEAS1 as UNIT_MEAS1", \
	"RTR_DELETE_INSERT_UPDATE___EACH_PER_BIN1 as EACH_PER_BIN1", \
	"RTR_DELETE_INSERT_UPDATE___NUM_UNITS_PER_BIN1 as NUM_UNITS_PER_BIN1", \
	"RTR_DELETE_INSERT_UPDATE___INN_PER_CS1 as INN_PER_CS1", \
	"RTR_DELETE_INSERT_UPDATE___MAX_SLOTS1 as MAX_SLOTS1", \
	"RTR_DELETE_INSERT_UPDATE___MAX_PALLET_STACKING1 as MAX_PALLET_STACKING1", \
	"RTR_DELETE_INSERT_UPDATE___MAX_STACKING1 as MAX_STACKING1", \
	"RTR_DELETE_INSERT_UPDATE___MAX_LANES1 as MAX_LANES1", \
	"RTR_DELETE_INSERT_UPDATE___RESERVE_RACK_TYPE_ID1 as RESERVE_RACK_TYPE_ID1", \
	"RTR_DELETE_INSERT_UPDATE___AFRAME_HT1 as AFRAME_HT1", \
	"RTR_DELETE_INSERT_UPDATE___AFRAME_LEN1 as AFRAME_LEN1", \
	"RTR_DELETE_INSERT_UPDATE___AFRAME_WID1 as AFRAME_WID1", \
	"RTR_DELETE_INSERT_UPDATE___AFRAME_WT1 as AFRAME_WT1", \
	"RTR_DELETE_INSERT_UPDATE___AFRAME_ALLOW1 as AFRAME_ALLOW1", \
	"RTR_DELETE_INSERT_UPDATE___ALLOW_SLU1 as ALLOW_SLU1", \
	"RTR_DELETE_INSERT_UPDATE___ALLOW_SU1 as ALLOW_SU1", \
	"RTR_DELETE_INSERT_UPDATE___ALLOW_RESERVE1 as ALLOW_RESERVE1", \
	"RTR_DELETE_INSERT_UPDATE___PALPAT_RESERVE1 as PALPAT_RESERVE1", \
	"RTR_DELETE_INSERT_UPDATE___THREE_D_CALC_DONE1 as THREE_D_CALC_DONE1", \
	"RTR_DELETE_INSERT_UPDATE___PROP_BORROWING_OBJECT1 as PROP_BORROWING_OBJECT1", \
	"RTR_DELETE_INSERT_UPDATE___PROP_BORROWING_SPECIFIC1 as PROP_BORROWING_SPECIFIC1", \
	"RTR_DELETE_INSERT_UPDATE___HEIGHT_CAN_BORROW1 as HEIGHT_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___LENGTH_CAN_BORROW1 as LENGTH_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___WIDTH_CAN_BORROW1 as WIDTH_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___WEIGHT_CAN_BORROW1 as WEIGHT_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___VEND_PACK_CAN_BORROW1 as VEND_PACK_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___INNER_PACK_CAN_BORROW1 as INNER_PACK_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___TI_CAN_BORROW1 as TI_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___HI_CAN_BORROW1 as HI_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___QTY_PER_GRAB_CAN_BORROW1 as QTY_PER_GRAB_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___HAND_ATTR_CAN_BORROW1 as HAND_ATTR_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___FAM_GRP_CAN_BORROW1 as FAM_GRP_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___COMMODITY_CAN_BORROW1 as COMMODITY_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___CRUSHABILITY_CAN_BORROW1 as CRUSHABILITY_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___HAZARD_CAN_BORROW1 as HAZARD_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___VEND_CODE_CAN_BORROW1 as VEND_CODE_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___HEIGHT_BORROWED1 as HEIGHT_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___LENGTH_BORROWED1 as LENGTH_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___WIDTH_BORROWED1 as WIDTH_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___WEIGHT_BORROWED1 as WEIGHT_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___VEND_PACK_BORROWED1 as VEND_PACK_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___INNER_PACK_BORROWED1 as INNER_PACK_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___TI_BORROWED1 as TI_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___HI_BORROWED1 as HI_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___QTY_PER_GRAB_BORROWED1 as QTY_PER_GRAB_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___HAND_ATTR_BORROWED1 as HAND_ATTR_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___FAM_GRP_BORROWED1 as FAM_GRP_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___COMMODITY_BORROWED1 as COMMODITY_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___CRUSHABILITY_BORROWED1 as CRUSHABILITY_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___HAZARD_BORROWED1 as HAZARD_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___VEND_CODE_BORROWED1 as VEND_CODE_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_NUM_11 as ITEM_NUM_11", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_NUM_21 as ITEM_NUM_21", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_NUM_31 as ITEM_NUM_31", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_NUM_41 as ITEM_NUM_41", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_NUM_51 as ITEM_NUM_51", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_CHAR_11 as ITEM_CHAR_11", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_CHAR_21 as ITEM_CHAR_21", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_CHAR_31 as ITEM_CHAR_31", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_CHAR_41 as ITEM_CHAR_41", \
	"RTR_DELETE_INSERT_UPDATE___ITEM_CHAR_51 as ITEM_CHAR_51", \
	"RTR_DELETE_INSERT_UPDATE___RESERVED_11 as RESERVED_11", \
	"RTR_DELETE_INSERT_UPDATE___RESERVED_21 as RESERVED_21", \
	"RTR_DELETE_INSERT_UPDATE___RESERVED_31 as RESERVED_31", \
	"RTR_DELETE_INSERT_UPDATE___RESERVED_41 as RESERVED_41", \
	"RTR_DELETE_INSERT_UPDATE___MISC1_BORROWED1 as MISC1_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___MISC2_BORROWED1 as MISC2_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___MISC3_BORROWED1 as MISC3_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___MISC4_BORROWED1 as MISC4_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___MISC5_BORROWED1 as MISC5_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___MISC6_BORROWED1 as MISC6_BORROWED1", \
	"RTR_DELETE_INSERT_UPDATE___MISC1_CAN_BORROW1 as MISC1_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___MISC2_CAN_BORROW1 as MISC2_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___MISC3_CAN_BORROW1 as MISC3_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___MISC4_CAN_BORROW1 as MISC4_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___MISC5_CAN_BORROW1 as MISC5_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___MISC6_CAN_BORROW1 as MISC6_CAN_BORROW1", \
	"RTR_DELETE_INSERT_UPDATE___DISCONT1 as DISCONT1", \
	"RTR_DELETE_INSERT_UPDATE___MANUAL1 as MANUAL1", \
	"RTR_DELETE_INSERT_UPDATE___IS_NEW1 as IS_NEW1", \
	"RTR_DELETE_INSERT_UPDATE___PROCESSED1 as PROCESSED1", \
	"RTR_DELETE_INSERT_UPDATE___MOD_USER1 as MOD_USER1", \
	"RTR_DELETE_INSERT_UPDATE___CREATE_DATE_TIME1 as CREATE_DATE_TIME1", \
	"RTR_DELETE_INSERT_UPDATE___MOD_DATE_TIME1 as MOD_DATE_TIME1", \
	"RTR_DELETE_INSERT_UPDATE___DELETE_FLAG1 as DELETE_FLAG1", \
	"RTR_DELETE_INSERT_UPDATE___UPDATE_TSTMP1 as UPDATE_TSTMP1", \
	"RTR_DELETE_INSERT_UPDATE___LOAD_TSTMP1 as LOAD_TSTMP1", \
	"RTR_DELETE_INSERT_UPDATE___o_UPD_VALIDATOR1 as o_UPD_VALIDATOR1") \
	.withColumn('pyspark_data_action', when(col('o_UPD_VALIDATOR1') ==(lit('INSERT')), lit(0)).when(col('o_UPD_VALIDATOR1') ==(lit('UPDATE')), lit(1)))

# COMMAND ----------
# Processing node UPD_DELETE, type UPDATE_STRATEGY 
# COLUMN COUNT: 95

# for each involved DataFrame, append the dataframe name to each column
RTR_DELETE_DELETE_temp = RTR_DELETE_DELETE.toDF(*["RTR_DELETE_DELETE___" + col for col in RTR_DELETE_DELETE.columns])

UPD_DELETE = RTR_DELETE_DELETE_temp.selectExpr( \
	"RTR_DELETE_DELETE___in_LOCATION_ID3 as in_LOCATION_ID3", \
	"RTR_DELETE_DELETE___WM_ITEM_FACILITY_MAPPING_ID3 as WM_ITEM_FACILITY_MAPPING_ID3", \
	"RTR_DELETE_DELETE___WM_ITEM_ID3 as WM_ITEM_ID3", \
	"RTR_DELETE_DELETE___WM_ITEM_NAME3 as WM_ITEM_NAME3", \
	"RTR_DELETE_DELETE___WM_WHSE_CD3 as WM_WHSE_CD3", \
	"RTR_DELETE_DELETE___WM_SLOTTING_GROUP3 as WM_SLOTTING_GROUP3", \
	"RTR_DELETE_DELETE___DISC_TRANS_TSTMP3 as DISC_TRANS_TSTMP3", \
	"RTR_DELETE_DELETE___EX_RECEIPT_TSTMP3 as EX_RECEIPT_TSTMP3", \
	"RTR_DELETE_DELETE___UNIT_MEASURE3 as UNIT_MEASURE3", \
	"RTR_DELETE_DELETE___in_EACH_PER_BIN3 as in_EACH_PER_BIN3", \
	"RTR_DELETE_DELETE___NBR_UNITS_PER_BIN3 as NBR_UNITS_PER_BIN3", \
	"RTR_DELETE_DELETE___in_INN_PER_CS3 as in_INN_PER_CS3", \
	"RTR_DELETE_DELETE___in_MAX_SLOTS3 as in_MAX_SLOTS3", \
	"RTR_DELETE_DELETE___in_MAX_PALLET_STACKING3 as in_MAX_PALLET_STACKING3", \
	"RTR_DELETE_DELETE___in_MAX_STACKING3 as in_MAX_STACKING3", \
	"RTR_DELETE_DELETE___in_MAX_LANES3 as in_MAX_LANES3", \
	"RTR_DELETE_DELETE___WM_RESERVE_RACK_TYPE_ID3 as WM_RESERVE_RACK_TYPE_ID3", \
	"RTR_DELETE_DELETE___in_AFRAME_HT3 as in_AFRAME_HT3", \
	"RTR_DELETE_DELETE___in_AFRAME_LEN3 as in_AFRAME_LEN3", \
	"RTR_DELETE_DELETE___in_AFRAME_WID3 as in_AFRAME_WID3", \
	"RTR_DELETE_DELETE___in_AFRAME_WT3 as in_AFRAME_WT3", \
	"RTR_DELETE_DELETE___AFRAME_ALLOW_FLAG3 as AFRAME_ALLOW_FLAG3", \
	"RTR_DELETE_DELETE___in_ALLOW_SLU3 as in_ALLOW_SLU3", \
	"RTR_DELETE_DELETE___in_ALLOW_SU3 as in_ALLOW_SU3", \
	"RTR_DELETE_DELETE___in_ALLOW_RESERVE3 as in_ALLOW_RESERVE3", \
	"RTR_DELETE_DELETE___in_PALPAT_RESERVE3 as in_PALPAT_RESERVE3", \
	"RTR_DELETE_DELETE___in_THREE_D_CALC_DONE3 as in_THREE_D_CALC_DONE3", \
	"RTR_DELETE_DELETE___in_PROP_BORROWING_OBJECT3 as in_PROP_BORROWING_OBJECT3", \
	"RTR_DELETE_DELETE___in_PROP_BORROWING_SPECIFIC3 as in_PROP_BORROWING_SPECIFIC3", \
	"RTR_DELETE_DELETE___HEIGHT_CAN_BORROW_FLAG3 as HEIGHT_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___LENGTH_CAN_BORROW_FLAG3 as LENGTH_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___WIDTH_CAN_BORROW_FLAG3 as WIDTH_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___WEIGHT_CAN_BORROW_FLAG3 as WEIGHT_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___VEND_PACK_CAN_BORROW_FLAG3 as VEND_PACK_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___INNER_PACK_CAN_BORROW_FLAG3 as INNER_PACK_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___TI_CAN_BORROW_FLAG3 as TI_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___HI_CAN_BORROW_FLAG3 as HI_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___QTY_PER_GRAB_CAN_BORROW_FLAG3 as QTY_PER_GRAB_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___HAND_ATTR_CAN_BORROW_FLAG3 as HAND_ATTR_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___FAM_GRP_CAN_BORROW_FLAG3 as FAM_GRP_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___COMMODITY_CAN_BORROW_FLAG3 as COMMODITY_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___CRUSHABILITY_CAN_BORROW_FLAG3 as CRUSHABILITY_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___HAZARD_CAN_BORROW_FLAG3 as HAZARD_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___VEND_CODE_CAN_BORROW_FLAG3 as VEND_CODE_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___HEIGHT_BORROWED_FLAG3 as HEIGHT_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___LENGTH_BORROWED_FLAG3 as LENGTH_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___WIDTH_BORROWED_FLAG3 as WIDTH_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___WEIGHT_BORROWED_FLAG3 as WEIGHT_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___VEND_PACK_BORROWED_FLAG3 as VEND_PACK_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___INNER_PACK_BORROWED_FLAG3 as INNER_PACK_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___TI_BORROWED_FLAG3 as TI_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___HI_BORROWED_FLAG3 as HI_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___QTY_PER_GRAB_BORROWED_FLAG3 as QTY_PER_GRAB_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___HAND_ATTR_BORROWED_FLAG3 as HAND_ATTR_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___FAM_GRP_BORROWED_FLAG3 as FAM_GRP_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___COMMODITY_BORROWED_FLAG3 as COMMODITY_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___CRUSHABILITY_BORROWED_FLAG3 as CRUSHABILITY_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___HAZARD_BORROWED_FLAG3 as HAZARD_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___VEND_CODE_BORROWED_FLAG3 as VEND_CODE_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___in_ITEM_NUM_13 as in_ITEM_NUM_13", \
	"RTR_DELETE_DELETE___in_ITEM_NUM_23 as in_ITEM_NUM_23", \
	"RTR_DELETE_DELETE___in_ITEM_NUM_33 as in_ITEM_NUM_33", \
	"RTR_DELETE_DELETE___in_ITEM_NUM_43 as in_ITEM_NUM_43", \
	"RTR_DELETE_DELETE___in_ITEM_NUM_53 as in_ITEM_NUM_53", \
	"RTR_DELETE_DELETE___in_ITEM_CHAR_13 as in_ITEM_CHAR_13", \
	"RTR_DELETE_DELETE___in_ITEM_CHAR_23 as in_ITEM_CHAR_23", \
	"RTR_DELETE_DELETE___in_ITEM_CHAR_33 as in_ITEM_CHAR_33", \
	"RTR_DELETE_DELETE___in_ITEM_CHAR_43 as in_ITEM_CHAR_43", \
	"RTR_DELETE_DELETE___in_ITEM_CHAR_53 as in_ITEM_CHAR_53", \
	"RTR_DELETE_DELETE___in_RESERVED_13 as in_RESERVED_13", \
	"RTR_DELETE_DELETE___in_RESERVED_23 as in_RESERVED_23", \
	"RTR_DELETE_DELETE___in_RESERVED_33 as in_RESERVED_33", \
	"RTR_DELETE_DELETE___in_RESERVED_43 as in_RESERVED_43", \
	"RTR_DELETE_DELETE___MISC_1_BORROWED_FLAG3 as MISC_1_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___MISC_2_BORROWED_FLAG3 as MISC_2_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___MISC_3_BORROWED_FLAG3 as MISC_3_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___MISC_4_BORROWED_FLAG3 as MISC_4_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___MISC_5_BORROWED_FLAG3 as MISC_5_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___MISC_6_BORROWED_FLAG3 as MISC_6_BORROWED_FLAG3", \
	"RTR_DELETE_DELETE___MISC_1_CAN_BORROW_FLAG3 as MISC_1_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___MISC_2_CAN_BORROW_FLAG3 as MISC_2_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___MISC_3_CAN_BORROW_FLAG3 as MISC_3_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___MISC_4_CAN_BORROW_FLAG3 as MISC_4_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___MISC_5_CAN_BORROW_FLAG3 as MISC_5_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___MISC_6_CAN_BORROW_FLAG3 as MISC_6_CAN_BORROW_FLAG3", \
	"RTR_DELETE_DELETE___DISCONTINUED_FLAG3 as DISCONTINUED_FLAG3", \
	"RTR_DELETE_DELETE___MANUAL_FLAG3 as MANUAL_FLAG3", \
	"RTR_DELETE_DELETE___NEW_FLAG3 as NEW_FLAG3", \
	"RTR_DELETE_DELETE___PROCESSED_FLAG3 as PROCESSED_FLAG3", \
	"RTR_DELETE_DELETE___WM_MOD_USER3 as WM_MOD_USER3", \
	"RTR_DELETE_DELETE___WM_CREATE_TSTMP3 as WM_CREATE_TSTMP3", \
	"RTR_DELETE_DELETE___WM_MOD_TSTMP3 as WM_MOD_TSTMP3", \
	"RTR_DELETE_DELETE___DELETE_FLAG3 as DELETE_FLAG3", \
	"RTR_DELETE_DELETE___UPDATE_TSTMP3 as UPDATE_TSTMP3", \
	"RTR_DELETE_DELETE___LOAD_TSTMP3 as LOAD_TSTMP3") \
	.withColumn('pyspark_data_action', lit(1))

# COMMAND ----------
# Processing node Shortcut_to_WM_ITEM_FACILITY_SLOTTING2, type TARGET 
# COLUMN COUNT: 95


# Shortcut_to_WM_ITEM_FACILITY_SLOTTING2 = UPD_DELETE.selectExpr( \
# 	"CAST(in_LOCATION_ID3 AS BIGINT) as LOCATION_ID", \
# 	"CAST(WM_ITEM_FACILITY_MAPPING_ID3 AS BIGINT) as WM_ITEM_FACILITY_MAPPING_ID", \
# 	"CAST(NULL AS BIGINT) as WM_ITEM_ID", \
# 	"CAST(NULL AS STRING) as WM_ITEM_NAME", \
# 	"CAST(NULL AS STRING) as WM_WHSE_CD", \
# 	"CAST(NULL AS STRING) as WM_SLOTTING_GROUP", \
# 	"CAST(NULL AS TIMESTAMP) as DISC_TRANS_TSTMP", \
# 	"CAST(NULL AS TIMESTAMP) as EX_RECEIPT_TSTMP", \
# 	"CAST(NULL AS BIGINT) as UNIT_MEASURE", \
# 	"CAST(NULL AS BIGINT) as EACH_PER_BIN", \
# 	"CAST(NULL AS BIGINT) as NBR_UNITS_PER_BIN", \
# 	"CAST(NULL AS BIGINT) as INN_PER_CS", \
# 	"CAST(NULL AS BIGINT) as MAX_SLOTS", \
# 	"CAST(NULL AS BIGINT) as MAX_PALLET_STACKING", \
# 	"CAST(NULL AS BIGINT) as MAX_STACKING", \
# 	"CAST(NULL AS BIGINT) as MAX_LANES", \
# 	"CAST(NULL AS BIGINT) as WM_RESERVE_RACK_TYPE_ID", \
# 	"CAST(NULL AS BIGINT) as AFRAME_HT", \
# 	"CAST(NULL AS BIGINT) as AFRAME_LEN", \
# 	"CAST(NULL AS BIGINT) as AFRAME_WID", \
# 	"CAST(NULL AS BIGINT) as AFRAME_WT", \
# 	"CAST(NULL AS BIGINT) as AFRAME_ALLOW_FLAG", \
# 	"CAST(NULL AS BIGINT) as ALLOW_SLU", \
# 	"CAST(NULL AS BIGINT) as ALLOW_SU", \
# 	"CAST(NULL AS BIGINT) as ALLOW_RESERVE", \
# 	"CAST(NULL AS BIGINT) as PALPAT_RESERVE", \
# 	"CAST(NULL AS BIGINT) as THREE_D_CALC_DONE", \
# 	"CAST(NULL AS BIGINT) as PROP_BORROWING_OBJECT", \
# 	"CAST(NULL AS BIGINT) as PROP_BORROWING_SPECIFIC", \
# 	"CAST(NULL AS BIGINT) as HEIGHT_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as LENGTH_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as WIDTH_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as WEIGHT_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as VEND_PACK_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as INNER_PACK_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as TI_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as HI_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as QTY_PER_GRAB_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as HAND_ATTR_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as FAM_GRP_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as COMMODITY_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as CRUSHABILITY_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as HAZARD_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as VEND_CODE_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as HEIGHT_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as LENGTH_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as WIDTH_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as WEIGHT_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as VEND_PACK_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as INNER_PACK_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as TI_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as HI_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as QTY_PER_GRAB_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as HAND_ATTR_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as FAM_GRP_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as COMMODITY_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as CRUSHABILITY_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as HAZARD_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as VEND_CODE_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as ITEM_NUM_1", \
# 	"CAST(NULL AS BIGINT) as ITEM_NUM_2", \
# 	"CAST(NULL AS BIGINT) as ITEM_NUM_3", \
# 	"CAST(NULL AS BIGINT) as ITEM_NUM_4", \
# 	"CAST(NULL AS BIGINT) as ITEM_NUM_5", \
# 	"CAST(NULL AS STRING) as ITEM_CHAR_1", \
# 	"CAST(NULL AS STRING) as ITEM_CHAR_2", \
# 	"CAST(NULL AS STRING) as ITEM_CHAR_3", \
# 	"CAST(NULL AS STRING) as ITEM_CHAR_4", \
# 	"CAST(NULL AS STRING) as ITEM_CHAR_5", \
# 	"CAST(NULL AS STRING) as RESERVED_1", \
# 	"CAST(NULL AS STRING) as RESERVED_2", \
# 	"CAST(NULL AS BIGINT) as RESERVED_3", \
# 	"CAST(NULL AS BIGINT) as RESERVED_4", \
# 	"CAST(NULL AS BIGINT) as MISC_1_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_2_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_3_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_4_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_5_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_6_BORROWED_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_1_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_2_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_3_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_4_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_5_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as MISC_6_CAN_BORROW_FLAG", \
# 	"CAST(NULL AS BIGINT) as DISCONTINUED_FLAG", \
# 	"CAST(NULL AS BIGINT) as MANUAL_FLAG", \
# 	"CAST(NULL AS BIGINT) as NEW_FLAG", \
# 	"CAST(NULL AS BIGINT) as PROCESSED_FLAG", \
# 	"CAST(NULL AS STRING) as WM_MOD_USER", \
# 	"CAST(NULL AS TIMESTAMP) as WM_CREATE_TSTMP", \
# 	"CAST(NULL AS TIMESTAMP) as WM_MOD_TSTMP", \
# 	"CAST(DELETE_FLAG3 AS BIGINT) as DELETE_FLAG", \
# 	"CAST(UPDATE_TSTMP3 AS TIMESTAMP) as UPDATE_TSTMP", \
# 	"CAST(LOAD_TSTMP3 AS TIMESTAMP) as LOAD_TSTMP" \
# )
# Shortcut_to_WM_ITEM_FACILITY_SLOTTING2.write.saveAsTable(f'{raw}.WM_ITEM_FACILITY_SLOTTING', mode = 'append')

# COMMAND ----------
# Processing node Shortcut_to_WM_ITEM_FACILITY_SLOTTING1, type TARGET 
# COLUMN COUNT: 95

Shortcut_to_WM_ITEM_FACILITY_SLOTTING1 = UPD_INS_UPD.selectExpr(
	"CAST(LOCATION_ID1 AS BIGINT) as LOCATION_ID",
	"CAST(ITEM_FACILITY_MAPPING_ID1 AS INT) as WM_ITEM_FACILITY_MAPPING_ID",
	"CAST(ITEM_ID1 AS INT) as WM_ITEM_ID",
	"CAST(ITEM_NAME1 AS STRING) as WM_ITEM_NAME",
	"CAST(WHSE_CODE1 AS STRING) as WM_WHSE_CD",
	"CAST(SLOTTING_GROUP1 AS STRING) as WM_SLOTTING_GROUP",
	"CAST(DISC_TRANS1 AS TIMESTAMP) as DISC_TRANS_TSTMP",
	"CAST(EX_RECPT_DATE1 AS TIMESTAMP) as EX_RECEIPT_TSTMP",
	"CAST(UNIT_MEAS1 AS BIGINT) as UNIT_MEASURE",
	"CAST(EACH_PER_BIN1 AS BIGINT) as EACH_PER_BIN",
	"CAST(NUM_UNITS_PER_BIN1 AS BIGINT) as NBR_UNITS_PER_BIN",
	"CAST(INN_PER_CS1 AS BIGINT) as INN_PER_CS",
	"CAST(MAX_SLOTS1 AS BIGINT) as MAX_SLOTS",
	"CAST(MAX_PALLET_STACKING1 AS BIGINT) as MAX_PALLET_STACKING",
	"CAST(MAX_STACKING1 AS BIGINT) as MAX_STACKING",
	"CAST(MAX_LANES1 AS BIGINT) as MAX_LANES",
	"CAST(RESERVE_RACK_TYPE_ID1 AS BIGINT) as WM_RESERVE_RACK_TYPE_ID",
	"CAST(AFRAME_HT1 AS DECIMAL(9,4)) as AFRAME_HT",
	"CAST(AFRAME_LEN1 AS DECIMAL(9,4)) as AFRAME_LEN",
	"CAST(AFRAME_WID1 AS DECIMAL(9,4)) as AFRAME_WID",
	"CAST(AFRAME_WT1 AS DECIMAL(9,4)) as AFRAME_WT",
	"CAST(AFRAME_ALLOW1 AS TINYINT) as AFRAME_ALLOW_FLAG",
	"CAST(ALLOW_SLU1 AS BIGINT) as ALLOW_SLU",
	"CAST(ALLOW_SU1 AS BIGINT) as ALLOW_SU",
	"CAST(ALLOW_RESERVE1 AS BIGINT) as ALLOW_RESERVE",
	"CAST(PALPAT_RESERVE1 AS SMALLINT) as PALPAT_RESERVE",
	"CAST(THREE_D_CALC_DONE1 AS TINYINT) as THREE_D_CALC_DONE",
	"CAST(PROP_BORROWING_OBJECT1 AS BIGINT) as PROP_BORROWING_OBJECT",
	"CAST(PROP_BORROWING_SPECIFIC1 AS BIGINT) as PROP_BORROWING_SPECIFIC",
	"CAST(HEIGHT_CAN_BORROW1 AS TINYINT) as HEIGHT_CAN_BORROW_FLAG",
	"CAST(LENGTH_CAN_BORROW1 AS TINYINT) as LENGTH_CAN_BORROW_FLAG",
	"CAST(WIDTH_CAN_BORROW1 AS TINYINT) as WIDTH_CAN_BORROW_FLAG",
	"CAST(WEIGHT_CAN_BORROW1 AS TINYINT) as WEIGHT_CAN_BORROW_FLAG",
	"CAST(VEND_PACK_CAN_BORROW1 AS TINYINT) as VEND_PACK_CAN_BORROW_FLAG",
	"CAST(INNER_PACK_CAN_BORROW1 AS TINYINT) as INNER_PACK_CAN_BORROW_FLAG",
	"CAST(TI_CAN_BORROW1 AS TINYINT) as TI_CAN_BORROW_FLAG",
	"CAST(HI_CAN_BORROW1 AS TINYINT) as HI_CAN_BORROW_FLAG",
	"CAST(QTY_PER_GRAB_CAN_BORROW1 AS TINYINT) as QTY_PER_GRAB_CAN_BORROW_FLAG",
	"CAST(HAND_ATTR_CAN_BORROW1 AS TINYINT) as HAND_ATTR_CAN_BORROW_FLAG",
	"CAST(FAM_GRP_CAN_BORROW1 AS TINYINT) as FAM_GRP_CAN_BORROW_FLAG",
	"CAST(COMMODITY_CAN_BORROW1 AS TINYINT) as COMMODITY_CAN_BORROW_FLAG",
	"CAST(CRUSHABILITY_CAN_BORROW1 AS TINYINT) as CRUSHABILITY_CAN_BORROW_FLAG",
	"CAST(HAZARD_CAN_BORROW1 AS TINYINT) as HAZARD_CAN_BORROW_FLAG",
	"CAST(VEND_CODE_CAN_BORROW1 AS TINYINT) as VEND_CODE_CAN_BORROW_FLAG",
	"CAST(HEIGHT_BORROWED1 AS TINYINT) as HEIGHT_BORROWED_FLAG",
	"CAST(LENGTH_BORROWED1 AS TINYINT) as LENGTH_BORROWED_FLAG",
	"CAST(WIDTH_BORROWED1 AS TINYINT) as WIDTH_BORROWED_FLAG",
	"CAST(WEIGHT_BORROWED1 AS TINYINT) as WEIGHT_BORROWED_FLAG",
	"CAST(VEND_PACK_BORROWED1 AS TINYINT) as VEND_PACK_BORROWED_FLAG",
	"CAST(INNER_PACK_BORROWED1 AS TINYINT) as INNER_PACK_BORROWED_FLAG",
	"CAST(TI_BORROWED1 AS TINYINT) as TI_BORROWED_FLAG",
	"CAST(HI_BORROWED1 AS TINYINT) as HI_BORROWED_FLAG",
	"CAST(QTY_PER_GRAB_BORROWED1 AS TINYINT) as QTY_PER_GRAB_BORROWED_FLAG",
	"CAST(HAND_ATTR_BORROWED1 AS TINYINT) as HAND_ATTR_BORROWED_FLAG",
	"CAST(FAM_GRP_BORROWED1 AS TINYINT) as FAM_GRP_BORROWED_FLAG",
	"CAST(COMMODITY_BORROWED1 AS TINYINT) as COMMODITY_BORROWED_FLAG",
	"CAST(CRUSHABILITY_BORROWED1 AS TINYINT) as CRUSHABILITY_BORROWED_FLAG",
	"CAST(HAZARD_BORROWED1 AS TINYINT) as HAZARD_BORROWED_FLAG",
	"CAST(VEND_CODE_BORROWED1 AS TINYINT) as VEND_CODE_BORROWED_FLAG",
	"CAST(ITEM_NUM_11 AS DECIMAL(13,4)) as ITEM_NUM_1",
	"CAST(ITEM_NUM_21 AS DECIMAL(13,4)) as ITEM_NUM_2",
	"CAST(ITEM_NUM_31 AS DECIMAL(13,4)) as ITEM_NUM_3",
	"CAST(ITEM_NUM_41 AS DECIMAL(13,4)) as ITEM_NUM_4",
	"CAST(ITEM_NUM_51 AS DECIMAL(13,4)) as ITEM_NUM_5",
	"CAST(ITEM_CHAR_11 AS STRING) as ITEM_CHAR_1",
	"CAST(ITEM_CHAR_21 AS STRING) as ITEM_CHAR_2",
	"CAST(ITEM_CHAR_31 AS STRING) as ITEM_CHAR_3",
	"CAST(ITEM_CHAR_41 AS STRING) as ITEM_CHAR_4",
	"CAST(ITEM_CHAR_51 AS STRING) as ITEM_CHAR_5",
	"CAST(RESERVED_11 AS STRING) as RESERVED_1",
	"CAST(RESERVED_21 AS STRING) as RESERVED_2",
	"CAST(RESERVED_31 AS BIGINT) as RESERVED_3",
	"CAST(RESERVED_41 AS BIGINT) as RESERVED_4",
	"CAST(MISC1_BORROWED1 AS TINYINT) as MISC_1_BORROWED_FLAG",
	"CAST(MISC2_BORROWED1 AS TINYINT) as MISC_2_BORROWED_FLAG",
	"CAST(MISC3_BORROWED1 AS TINYINT) as MISC_3_BORROWED_FLAG",
	"CAST(MISC4_BORROWED1 AS TINYINT) as MISC_4_BORROWED_FLAG",
	"CAST(MISC5_BORROWED1 AS TINYINT) as MISC_5_BORROWED_FLAG",
	"CAST(MISC6_BORROWED1 AS TINYINT) as MISC_6_BORROWED_FLAG",
	"CAST(MISC1_CAN_BORROW1 AS TINYINT) as MISC_1_CAN_BORROW_FLAG",
	"CAST(MISC2_CAN_BORROW1 AS TINYINT) as MISC_2_CAN_BORROW_FLAG",
	"CAST(MISC3_CAN_BORROW1 AS TINYINT) as MISC_3_CAN_BORROW_FLAG",
	"CAST(MISC4_CAN_BORROW1 AS TINYINT) as MISC_4_CAN_BORROW_FLAG",
	"CAST(MISC5_CAN_BORROW1 AS TINYINT) as MISC_5_CAN_BORROW_FLAG",
	"CAST(MISC6_CAN_BORROW1 AS TINYINT) as MISC_6_CAN_BORROW_FLAG",
	"CAST(DISCONT1 AS TINYINT) as DISCONTINUED_FLAG",
	"CAST(MANUAL1 AS TINYINT) as MANUAL_FLAG",
	"CAST(IS_NEW1 AS TINYINT) as NEW_FLAG",
	"CAST(PROCESSED1 AS TINYINT) as PROCESSED_FLAG",
	"CAST(MOD_USER1 AS STRING) as WM_MOD_USER",
	"CAST(CREATE_DATE_TIME1 AS TIMESTAMP) as WM_CREATE_TSTMP",
	"CAST(MOD_DATE_TIME1 AS TIMESTAMP) as WM_MOD_TSTMP",
	"CAST(DELETE_FLAG1 AS TINYINT) as DELETE_FLAG",
	"CAST(UPDATE_TSTMP1 AS TIMESTAMP) as UPDATE_TSTMP",
	"CAST(LOAD_TSTMP1 AS TIMESTAMP) as LOAD_TSTMP", 
    "pyspark_data_action" 
)

try:
  primary_key = """source.LOCATION_ID = target.LOCATION_ID AND source.WM_ITEM_FACILITY_MAPPING_ID = target.WM_ITEM_FACILITY_MAPPING_ID"""
#   refined_perf_table = "WM_ITEM_FACILITY_SLOTTING"
  executeMerge(Shortcut_to_WM_ITEM_FACILITY_SLOTTING1, refined_perf_table, primary_key)
  logger.info(f"Merge with {refined_perf_table} completed]")
  logPrevRunDt("WM_ITEM_FACILITY_SLOTTING", "WM_ITEM_FACILITY_SLOTTING", "Completed", "N/A", f"{raw}.log_run_details")
except Exception as e:
  logPrevRunDt("WM_ITEM_FACILITY_SLOTTING", "WM_ITEM_FACILITY_SLOTTING","Failed",str(e), f"{raw}.log_run_details", )
  raise e
	