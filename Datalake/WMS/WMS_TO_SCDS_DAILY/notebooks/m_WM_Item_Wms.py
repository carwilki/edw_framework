#Code converted on 2023-06-22 10:47:19
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from pyspark.dbutils import DBUtils
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from Datalake.utils.logger import *
# COMMAND ----------

parser = argparse.ArgumentParser()
spark = SparkSession.getActiveSession()
dbutils = DBUtils(spark)

parser.add_argument('env', type=str, help='Env Variable')
# args = parser.parse_args()
# env = args.env
env = 'dev'

if env is None or env == '':
    raise ValueError('env is not set')

refine = getEnvPrefix(env) + 'refine'
raw = getEnvPrefix(env) + 'raw'
legacy = getEnvPrefix(env) + 'legacy'

# Set global variables
starttime = datetime.now() #start timestamp of the script
refined_perf_table = f"{refine}.WM_ITEM_WMS"
raw_perf_table = f"{raw}.WM_ITEM_WMS_PRE"
site_profile_table = f"{legacy}.SITE_PROFILE"


# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ITEM_WMS, type SOURCE 
# COLUMN COUNT: 5

SQ_Shortcut_to_WM_ITEM_WMS = spark.sql(f"""SELECT
LOCATION_ID,
WM_ITEM_ID,
WM_AUDIT_CREATED_TSTMP,
WM_AUDIT_LAST_UPDATED_TSTMP,
LOAD_TSTMP
FROM {refined_perf_table}
WHERE WM_ITEM_ID IN (SELECT ITEM_ID FROM {raw_perf_table})""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ITEM_WMS_PRE, type SOURCE 
# COLUMN COUNT: 139

SQ_Shortcut_to_WM_ITEM_WMS_PRE = spark.sql(f"""SELECT
DC_NBR,
ITEM_ID,
SIZE_RANGE_CODE,
SIZE_REL_POSN_IN_TABLE,
VOLTY_CODE,
PKG_TYPE,
PROD_SUB_GRP,
PROD_TYPE,
PROD_LINE,
SALE_GRP,
COORD_1,
COORD_2,
CARTON_TYPE,
UNIT_PRICE,
RETAIL_PRICE,
OPER_CODE,
MAX_CASE_QTY,
CUBE_MULT_QTY,
NEST_VOL,
NEST_CNT,
UNITS_PER_PICK_ACTIVE,
HNDL_ATTR_ACTIVE,
UNITS_PER_PICK_CASE_PICK,
HNDL_ATTR_CASE_PICK,
UNITS_PER_PICK_RESV,
HNDL_ATTR_RESV,
PROD_LIFE_IN_DAY,
MAX_RECV_TO_XPIRE_DAYS,
AVG_DLY_DMND,
WT_TOL_PCNT,
CONS_PRTY_DATE_CODE,
CONS_PRTY_DATE_WINDOW,
CONS_PRTY_DATE_WINDOW_INCR,
ACTVTN_DATE,
ALLOW_RCPT_OLDER_ITEM,
CRITCL_DIM_1,
CRITCL_DIM_2,
CRITCL_DIM_3,
MFG_DATE_REQD,
XPIRE_DATE_REQD,
SHIP_BY_DATE_REQD,
ITEM_ATTR_REQD,
BATCH_REQD,
PROD_STAT_REQD,
CNTRY_OF_ORGN_REQD,
VENDOR_ITEM_NBR,
PICK_WT_TOL_TYPE,
PICK_WT_TOL_AMNT,
MHE_WT_TOL_TYPE,
MHE_WT_TOL_AMNT,
LOAD_ATTR,
TEMP_ZONE,
TRLR_TEMP_ZONE,
PKT_CONSOL_ATTR,
BUYER_DISP_CODE,
CRUSH_CODE,
CONVEY_FLAG,
STORE_DEPT,
MERCH_TYPE,
MERCH_GROUP,
SPL_INSTR_CODE_1,
SPL_INSTR_CODE_2,
SPL_INSTR_CODE_3,
SPL_INSTR_CODE_4,
SPL_INSTR_CODE_5,
SPL_INSTR_CODE_6,
SPL_INSTR_CODE_7,
SPL_INSTR_CODE_8,
SPL_INSTR_CODE_9,
SPL_INSTR_CODE_10,
SPL_INSTR_1,
SPL_INSTR_2,
PROMPT_FOR_VENDOR_ITEM_NBR,
PROMPT_PACK_QTY,
ECCN_NBR,
EXP_LICN_NBR,
EXP_LICN_XP_DATE,
EXP_LICN_SYMBOL,
ORGN_CERT_CODE,
ITAR_EXEMPT_NBR,
NMFC_CODE,
FRT_CLASS,
DFLT_BATCH_STAT,
DFLT_INCUB_LOCK,
BASE_INCUB_FLAG,
INCUB_DAYS,
INCUB_HOURS,
SRL_NBR_BRCD_TYPE,
MINOR_SRL_NBR_REQ,
DUP_SRL_NBR_FLAG,
MAX_RCPT_QTY,
VOCOLLECT_BASE_WT,
VOCOLLECT_BASE_QTY,
VOCOLLECT_BASE_ITEM,
PICK_WT_TOL_AMNT_ERROR,
PRICE_TKT_TYPE,
MONETARY_VALUE,
MV_CURRENCY_CODE,
CODE_DATE_PROMPT_METHOD_FLAG,
MIN_RECV_TO_XPIRE_DAYS,
MIN_PCNT_FOR_LPN_SPLIT,
MIN_LPN_QTY_FOR_SPLIT,
PROD_CATGRY,
AUDIT_CREATED_SOURCE,
AUDIT_CREATED_SOURCE_TYPE,
AUDIT_CREATED_DTTM,
AUDIT_LAST_UPDATED_SOURCE,
AUDIT_LAST_UPDATED_SOURCE_TYPE,
AUDIT_LAST_UPDATED_DTTM,
MARK_FOR_DELETION,
TOP_SHELF_ELIGIBLE,
VOCO_ABS_PICK_TOL_AMT,
CARTON_CNT_DATE_TIME,
TRANS_INVN_CNT_DATE_TIME,
WORK_ORD_CNT_DATE_TIME,
SHELF_DAYS,
VENDOR_MASTER_ID,
NBR_OF_DYN_ACTV_PICK_PER_SKU,
NBR_OF_DYN_CASE_PICK_PER_SKU,
LET_UP_PRTY,
PREF_CRITERIA_FLAG,
PRODUCER_FLAG,
NET_COST_FLAG,
MARKS_NBRS,
SLOTTING_OPT_STAT_CODE,
PRICE_TIX_AVAIL,
MV_SIZE_UOM,
UNITS_PER_GRAB_PLT,
HNDL_ATTR_PLT,
HNDL_ATTR_ACT_UOM_ID,
HNDL_ATTR_CASE_PICK_UOM_ID,
SRL_NBR_REQD,
CC_UNIT_TOLER_VALUE,
CC_WGT_TOLER_VALUE,
CC_DLR_TOLER_VALUE,
CC_PCNT_TOLER_VALUE,
DISPOSITION_TYPE,
EXP_LICN_DESCRIPTION,
LOAD_TSTMP
FROM {raw_perf_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_INT_CONV, type EXPRESSION 
# COLUMN COUNT: 139

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_ITEM_WMS_PRE_temp = SQ_Shortcut_to_WM_ITEM_WMS_PRE.toDF(*["SQ_Shortcut_to_WM_ITEM_WMS_PRE___" + col for col in SQ_Shortcut_to_WM_ITEM_WMS_PRE.columns])

EXP_INT_CONV = SQ_Shortcut_to_WM_ITEM_WMS_PRE_temp.selectExpr( \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___sys_row_id as sys_row_id", \
	"cast(SQ_Shortcut_to_WM_ITEM_WMS_PRE___DC_NBR as int) as o_DC_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ITEM_ID as ITEM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOLTY_CODE as VOLTY_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PKG_TYPE as PKG_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_SUB_GRP as PROD_SUB_GRP", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_TYPE as PROD_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_LINE as PROD_LINE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SALE_GRP as SALE_GRP", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___COORD_1 as COORD_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___COORD_2 as COORD_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CARTON_TYPE as CARTON_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNIT_PRICE as UNIT_PRICE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___RETAIL_PRICE as RETAIL_PRICE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___OPER_CODE as OPER_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MAX_CASE_QTY as MAX_CASE_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NEST_VOL as NEST_VOL", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NEST_CNT as NEST_CNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AVG_DLY_DMND as AVG_DLY_DMND", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___WT_TOL_PCNT as WT_TOL_PCNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ACTVTN_DATE as ACTVTN_DATE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MFG_DATE_REQD as MFG_DATE_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___BATCH_REQD as BATCH_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_STAT_REQD as PROD_STAT_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___LOAD_ATTR as LOAD_ATTR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TEMP_ZONE as TEMP_ZONE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRUSH_CODE as CRUSH_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONVEY_FLAG as CONVEY_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___STORE_DEPT as STORE_DEPT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MERCH_TYPE as MERCH_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MERCH_GROUP as MERCH_GROUP", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_1 as SPL_INSTR_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_2 as SPL_INSTR_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ECCN_NBR as ECCN_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_NBR as EXP_LICN_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NMFC_CODE as NMFC_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___FRT_CLASS as FRT_CLASS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___INCUB_DAYS as INCUB_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___INCUB_HOURS as INCUB_HOURS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MONETARY_VALUE as MONETARY_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_CATGRY as PROD_CATGRY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SHELF_DAYS as SHELF_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___LET_UP_PRTY as LET_UP_PRTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PRODUCER_FLAG as PRODUCER_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NET_COST_FLAG as NET_COST_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MARKS_NBRS as MARKS_NBRS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MV_SIZE_UOM as MV_SIZE_UOM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SRL_NBR_REQD as SRL_NBR_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___LOAD_TSTMP as LOAD_TSTMP" \
)

# COMMAND ----------
# Processing node SQ_Shortcut_to_SITE_PROFILE, type SOURCE 
# COLUMN COUNT: 2

SQ_Shortcut_to_SITE_PROFILE = spark.sql(f"""SELECT LOCATION_ID, STORE_NBR FROM {site_profile_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node JNR_SITE_PROFILE, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 140

# for each involved DataFrame, append the dataframe name to each column
EXP_INT_CONV_temp = EXP_INT_CONV.toDF(*["EXP_INT_CONV___" + col for col in EXP_INT_CONV.columns])
SQ_Shortcut_to_SITE_PROFILE_temp = SQ_Shortcut_to_SITE_PROFILE.toDF(*["SQ_Shortcut_to_SITE_PROFILE___" + col for col in SQ_Shortcut_to_SITE_PROFILE.columns])

JNR_SITE_PROFILE = SQ_Shortcut_to_SITE_PROFILE_temp.join(EXP_INT_CONV_temp,[SQ_Shortcut_to_SITE_PROFILE_temp.SQ_Shortcut_to_SITE_PROFILE___STORE_NBR == EXP_INT_CONV_temp.EXP_INT_CONV___o_DC_NBR],'inner').selectExpr( \
	"EXP_INT_CONV___o_DC_NBR as DC_NBR", \
	"EXP_INT_CONV___ITEM_ID as ITEM_ID", \
	"EXP_INT_CONV___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"EXP_INT_CONV___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"EXP_INT_CONV___VOLTY_CODE as VOLTY_CODE", \
	"EXP_INT_CONV___PKG_TYPE as PKG_TYPE", \
	"EXP_INT_CONV___PROD_SUB_GRP as PROD_SUB_GRP", \
	"EXP_INT_CONV___PROD_TYPE as PROD_TYPE", \
	"EXP_INT_CONV___PROD_LINE as PROD_LINE", \
	"EXP_INT_CONV___SALE_GRP as SALE_GRP", \
	"EXP_INT_CONV___COORD_1 as COORD_1", \
	"EXP_INT_CONV___COORD_2 as COORD_2", \
	"EXP_INT_CONV___CARTON_TYPE as CARTON_TYPE", \
	"EXP_INT_CONV___UNIT_PRICE as UNIT_PRICE", \
	"EXP_INT_CONV___RETAIL_PRICE as RETAIL_PRICE", \
	"EXP_INT_CONV___OPER_CODE as OPER_CODE", \
	"EXP_INT_CONV___MAX_CASE_QTY as MAX_CASE_QTY", \
	"EXP_INT_CONV___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"EXP_INT_CONV___NEST_VOL as NEST_VOL", \
	"EXP_INT_CONV___NEST_CNT as NEST_CNT", \
	"EXP_INT_CONV___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"EXP_INT_CONV___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"EXP_INT_CONV___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"EXP_INT_CONV___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"EXP_INT_CONV___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"EXP_INT_CONV___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"EXP_INT_CONV___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"EXP_INT_CONV___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"EXP_INT_CONV___AVG_DLY_DMND as AVG_DLY_DMND", \
	"EXP_INT_CONV___WT_TOL_PCNT as WT_TOL_PCNT", \
	"EXP_INT_CONV___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"EXP_INT_CONV___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"EXP_INT_CONV___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"EXP_INT_CONV___ACTVTN_DATE as ACTVTN_DATE", \
	"EXP_INT_CONV___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"EXP_INT_CONV___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"EXP_INT_CONV___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"EXP_INT_CONV___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"EXP_INT_CONV___MFG_DATE_REQD as MFG_DATE_REQD", \
	"EXP_INT_CONV___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"EXP_INT_CONV___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"EXP_INT_CONV___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"EXP_INT_CONV___BATCH_REQD as BATCH_REQD", \
	"EXP_INT_CONV___PROD_STAT_REQD as PROD_STAT_REQD", \
	"EXP_INT_CONV___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"EXP_INT_CONV___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"EXP_INT_CONV___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"EXP_INT_CONV___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"EXP_INT_CONV___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"EXP_INT_CONV___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"EXP_INT_CONV___LOAD_ATTR as LOAD_ATTR", \
	"EXP_INT_CONV___TEMP_ZONE as TEMP_ZONE", \
	"EXP_INT_CONV___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"EXP_INT_CONV___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"EXP_INT_CONV___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"EXP_INT_CONV___CRUSH_CODE as CRUSH_CODE", \
	"EXP_INT_CONV___CONVEY_FLAG as CONVEY_FLAG", \
	"EXP_INT_CONV___STORE_DEPT as STORE_DEPT", \
	"EXP_INT_CONV___MERCH_TYPE as MERCH_TYPE", \
	"EXP_INT_CONV___MERCH_GROUP as MERCH_GROUP", \
	"EXP_INT_CONV___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"EXP_INT_CONV___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"EXP_INT_CONV___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"EXP_INT_CONV___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"EXP_INT_CONV___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"EXP_INT_CONV___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"EXP_INT_CONV___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"EXP_INT_CONV___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"EXP_INT_CONV___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"EXP_INT_CONV___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"EXP_INT_CONV___SPL_INSTR_1 as SPL_INSTR_1", \
	"EXP_INT_CONV___SPL_INSTR_2 as SPL_INSTR_2", \
	"EXP_INT_CONV___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"EXP_INT_CONV___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"EXP_INT_CONV___ECCN_NBR as ECCN_NBR", \
	"EXP_INT_CONV___EXP_LICN_NBR as EXP_LICN_NBR", \
	"EXP_INT_CONV___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"EXP_INT_CONV___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"EXP_INT_CONV___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"EXP_INT_CONV___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"EXP_INT_CONV___NMFC_CODE as NMFC_CODE", \
	"EXP_INT_CONV___FRT_CLASS as FRT_CLASS", \
	"EXP_INT_CONV___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"EXP_INT_CONV___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"EXP_INT_CONV___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"EXP_INT_CONV___INCUB_DAYS as INCUB_DAYS", \
	"EXP_INT_CONV___INCUB_HOURS as INCUB_HOURS", \
	"EXP_INT_CONV___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"EXP_INT_CONV___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"EXP_INT_CONV___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"EXP_INT_CONV___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"EXP_INT_CONV___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"EXP_INT_CONV___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"EXP_INT_CONV___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"EXP_INT_CONV___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"EXP_INT_CONV___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"EXP_INT_CONV___MONETARY_VALUE as MONETARY_VALUE", \
	"EXP_INT_CONV___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"EXP_INT_CONV___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"EXP_INT_CONV___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"EXP_INT_CONV___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"EXP_INT_CONV___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"EXP_INT_CONV___PROD_CATGRY as PROD_CATGRY", \
	"EXP_INT_CONV___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"EXP_INT_CONV___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"EXP_INT_CONV___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"EXP_INT_CONV___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"EXP_INT_CONV___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"EXP_INT_CONV___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"EXP_INT_CONV___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"EXP_INT_CONV___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"EXP_INT_CONV___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"EXP_INT_CONV___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"EXP_INT_CONV___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"EXP_INT_CONV___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"EXP_INT_CONV___SHELF_DAYS as SHELF_DAYS", \
	"EXP_INT_CONV___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"EXP_INT_CONV___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"EXP_INT_CONV___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"EXP_INT_CONV___LET_UP_PRTY as LET_UP_PRTY", \
	"EXP_INT_CONV___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"EXP_INT_CONV___PRODUCER_FLAG as PRODUCER_FLAG", \
	"EXP_INT_CONV___NET_COST_FLAG as NET_COST_FLAG", \
	"EXP_INT_CONV___MARKS_NBRS as MARKS_NBRS", \
	"EXP_INT_CONV___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"EXP_INT_CONV___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"EXP_INT_CONV___MV_SIZE_UOM as MV_SIZE_UOM", \
	"EXP_INT_CONV___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"EXP_INT_CONV___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"EXP_INT_CONV___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"EXP_INT_CONV___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"EXP_INT_CONV___SRL_NBR_REQD as SRL_NBR_REQD", \
	"EXP_INT_CONV___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"EXP_INT_CONV___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"EXP_INT_CONV___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"EXP_INT_CONV___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"EXP_INT_CONV___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"EXP_INT_CONV___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"SQ_Shortcut_to_SITE_PROFILE___LOCATION_ID as LOCATION_ID", \
	"SQ_Shortcut_to_SITE_PROFILE___STORE_NBR as STORE_NBR")

# COMMAND ----------
# Processing node JNR_WM_ITEM_WMS, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 143

# for each involved DataFrame, append the dataframe name to each column
JNR_SITE_PROFILE_temp = JNR_SITE_PROFILE.toDF(*["JNR_SITE_PROFILE___" + col for col in JNR_SITE_PROFILE.columns])
SQ_Shortcut_to_WM_ITEM_WMS_temp = SQ_Shortcut_to_WM_ITEM_WMS.toDF(*["SQ_Shortcut_to_WM_ITEM_WMS___" + col for col in SQ_Shortcut_to_WM_ITEM_WMS.columns])

JNR_WM_ITEM_WMS = SQ_Shortcut_to_WM_ITEM_WMS_temp.join(JNR_SITE_PROFILE_temp,[SQ_Shortcut_to_WM_ITEM_WMS_temp.SQ_Shortcut_to_WM_ITEM_WMS___LOCATION_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___LOCATION_ID, SQ_Shortcut_to_WM_ITEM_WMS_temp.SQ_Shortcut_to_WM_ITEM_WMS___WM_ITEM_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___ITEM_ID],'right_outer').selectExpr( \
	"JNR_SITE_PROFILE___LOCATION_ID as LOCATION_ID", \
	"JNR_SITE_PROFILE___ITEM_ID as ITEM_ID", \
	"JNR_SITE_PROFILE___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"JNR_SITE_PROFILE___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"JNR_SITE_PROFILE___VOLTY_CODE as VOLTY_CODE", \
	"JNR_SITE_PROFILE___PKG_TYPE as PKG_TYPE", \
	"JNR_SITE_PROFILE___PROD_SUB_GRP as PROD_SUB_GRP", \
	"JNR_SITE_PROFILE___PROD_TYPE as PROD_TYPE", \
	"JNR_SITE_PROFILE___PROD_LINE as PROD_LINE", \
	"JNR_SITE_PROFILE___SALE_GRP as SALE_GRP", \
	"JNR_SITE_PROFILE___COORD_1 as COORD_1", \
	"JNR_SITE_PROFILE___COORD_2 as COORD_2", \
	"JNR_SITE_PROFILE___CARTON_TYPE as CARTON_TYPE", \
	"JNR_SITE_PROFILE___UNIT_PRICE as UNIT_PRICE", \
	"JNR_SITE_PROFILE___RETAIL_PRICE as RETAIL_PRICE", \
	"JNR_SITE_PROFILE___OPER_CODE as OPER_CODE", \
	"JNR_SITE_PROFILE___MAX_CASE_QTY as MAX_CASE_QTY", \
	"JNR_SITE_PROFILE___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"JNR_SITE_PROFILE___NEST_VOL as NEST_VOL", \
	"JNR_SITE_PROFILE___NEST_CNT as NEST_CNT", \
	"JNR_SITE_PROFILE___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"JNR_SITE_PROFILE___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"JNR_SITE_PROFILE___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"JNR_SITE_PROFILE___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"JNR_SITE_PROFILE___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"JNR_SITE_PROFILE___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"JNR_SITE_PROFILE___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"JNR_SITE_PROFILE___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"JNR_SITE_PROFILE___AVG_DLY_DMND as AVG_DLY_DMND", \
	"JNR_SITE_PROFILE___WT_TOL_PCNT as WT_TOL_PCNT", \
	"JNR_SITE_PROFILE___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"JNR_SITE_PROFILE___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"JNR_SITE_PROFILE___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"JNR_SITE_PROFILE___ACTVTN_DATE as ACTVTN_DATE", \
	"JNR_SITE_PROFILE___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"JNR_SITE_PROFILE___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"JNR_SITE_PROFILE___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"JNR_SITE_PROFILE___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"JNR_SITE_PROFILE___MFG_DATE_REQD as MFG_DATE_REQD", \
	"JNR_SITE_PROFILE___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"JNR_SITE_PROFILE___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"JNR_SITE_PROFILE___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"JNR_SITE_PROFILE___BATCH_REQD as BATCH_REQD", \
	"JNR_SITE_PROFILE___PROD_STAT_REQD as PROD_STAT_REQD", \
	"JNR_SITE_PROFILE___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"JNR_SITE_PROFILE___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"JNR_SITE_PROFILE___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"JNR_SITE_PROFILE___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"JNR_SITE_PROFILE___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"JNR_SITE_PROFILE___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"JNR_SITE_PROFILE___LOAD_ATTR as LOAD_ATTR", \
	"JNR_SITE_PROFILE___TEMP_ZONE as TEMP_ZONE", \
	"JNR_SITE_PROFILE___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"JNR_SITE_PROFILE___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"JNR_SITE_PROFILE___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"JNR_SITE_PROFILE___CRUSH_CODE as CRUSH_CODE", \
	"JNR_SITE_PROFILE___CONVEY_FLAG as CONVEY_FLAG", \
	"JNR_SITE_PROFILE___STORE_DEPT as STORE_DEPT", \
	"JNR_SITE_PROFILE___MERCH_TYPE as MERCH_TYPE", \
	"JNR_SITE_PROFILE___MERCH_GROUP as MERCH_GROUP", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"JNR_SITE_PROFILE___SPL_INSTR_1 as SPL_INSTR_1", \
	"JNR_SITE_PROFILE___SPL_INSTR_2 as SPL_INSTR_2", \
	"JNR_SITE_PROFILE___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"JNR_SITE_PROFILE___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"JNR_SITE_PROFILE___ECCN_NBR as ECCN_NBR", \
	"JNR_SITE_PROFILE___EXP_LICN_NBR as EXP_LICN_NBR", \
	"JNR_SITE_PROFILE___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"JNR_SITE_PROFILE___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"JNR_SITE_PROFILE___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"JNR_SITE_PROFILE___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"JNR_SITE_PROFILE___NMFC_CODE as NMFC_CODE", \
	"JNR_SITE_PROFILE___FRT_CLASS as FRT_CLASS", \
	"JNR_SITE_PROFILE___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"JNR_SITE_PROFILE___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"JNR_SITE_PROFILE___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"JNR_SITE_PROFILE___INCUB_DAYS as INCUB_DAYS", \
	"JNR_SITE_PROFILE___INCUB_HOURS as INCUB_HOURS", \
	"JNR_SITE_PROFILE___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"JNR_SITE_PROFILE___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"JNR_SITE_PROFILE___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"JNR_SITE_PROFILE___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"JNR_SITE_PROFILE___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"JNR_SITE_PROFILE___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"JNR_SITE_PROFILE___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"JNR_SITE_PROFILE___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"JNR_SITE_PROFILE___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"JNR_SITE_PROFILE___MONETARY_VALUE as MONETARY_VALUE", \
	"JNR_SITE_PROFILE___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"JNR_SITE_PROFILE___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"JNR_SITE_PROFILE___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"JNR_SITE_PROFILE___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"JNR_SITE_PROFILE___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"JNR_SITE_PROFILE___PROD_CATGRY as PROD_CATGRY", \
	"JNR_SITE_PROFILE___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"JNR_SITE_PROFILE___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"JNR_SITE_PROFILE___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"JNR_SITE_PROFILE___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"JNR_SITE_PROFILE___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"JNR_SITE_PROFILE___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"JNR_SITE_PROFILE___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"JNR_SITE_PROFILE___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"JNR_SITE_PROFILE___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"JNR_SITE_PROFILE___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"JNR_SITE_PROFILE___SHELF_DAYS as SHELF_DAYS", \
	"JNR_SITE_PROFILE___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"JNR_SITE_PROFILE___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"JNR_SITE_PROFILE___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"JNR_SITE_PROFILE___LET_UP_PRTY as LET_UP_PRTY", \
	"JNR_SITE_PROFILE___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"JNR_SITE_PROFILE___PRODUCER_FLAG as PRODUCER_FLAG", \
	"JNR_SITE_PROFILE___NET_COST_FLAG as NET_COST_FLAG", \
	"JNR_SITE_PROFILE___MARKS_NBRS as MARKS_NBRS", \
	"JNR_SITE_PROFILE___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"JNR_SITE_PROFILE___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"JNR_SITE_PROFILE___MV_SIZE_UOM as MV_SIZE_UOM", \
	"JNR_SITE_PROFILE___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"JNR_SITE_PROFILE___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"JNR_SITE_PROFILE___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"JNR_SITE_PROFILE___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"JNR_SITE_PROFILE___SRL_NBR_REQD as SRL_NBR_REQD", \
	"JNR_SITE_PROFILE___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"JNR_SITE_PROFILE___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"JNR_SITE_PROFILE___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"JNR_SITE_PROFILE___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"JNR_SITE_PROFILE___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"JNR_SITE_PROFILE___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"SQ_Shortcut_to_WM_ITEM_WMS___LOCATION_ID as in_LOCATION_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS___WM_ITEM_ID as in_WM_ITEM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS___WM_AUDIT_CREATED_TSTMP as in_WM_AUDIT_CREATED_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_WMS___WM_AUDIT_LAST_UPDATED_TSTMP as in_WM_AUDIT_LAST_UPDATED_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_WMS___LOAD_TSTMP as in_LOAD_TSTMP")

# COMMAND ----------
# Processing node FIL_UNCHANGED_REC, type FILTER 
# COLUMN COUNT: 143

# for each involved DataFrame, append the dataframe name to each column
JNR_WM_ITEM_WMS_temp = JNR_WM_ITEM_WMS.toDF(*["JNR_WM_ITEM_WMS___" + col for col in JNR_WM_ITEM_WMS.columns])

FIL_UNCHANGED_REC = JNR_WM_ITEM_WMS_temp.selectExpr( \
	"JNR_WM_ITEM_WMS___LOCATION_ID as LOCATION_ID", \
	"JNR_WM_ITEM_WMS___ITEM_ID as ITEM_ID", \
	"JNR_WM_ITEM_WMS___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"JNR_WM_ITEM_WMS___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"JNR_WM_ITEM_WMS___VOLTY_CODE as VOLTY_CODE", \
	"JNR_WM_ITEM_WMS___PKG_TYPE as PKG_TYPE", \
	"JNR_WM_ITEM_WMS___PROD_SUB_GRP as PROD_SUB_GRP", \
	"JNR_WM_ITEM_WMS___PROD_TYPE as PROD_TYPE", \
	"JNR_WM_ITEM_WMS___PROD_LINE as PROD_LINE", \
	"JNR_WM_ITEM_WMS___SALE_GRP as SALE_GRP", \
	"JNR_WM_ITEM_WMS___COORD_1 as COORD_1", \
	"JNR_WM_ITEM_WMS___COORD_2 as COORD_2", \
	"JNR_WM_ITEM_WMS___CARTON_TYPE as CARTON_TYPE", \
	"JNR_WM_ITEM_WMS___UNIT_PRICE as UNIT_PRICE", \
	"JNR_WM_ITEM_WMS___RETAIL_PRICE as RETAIL_PRICE", \
	"JNR_WM_ITEM_WMS___OPER_CODE as OPER_CODE", \
	"JNR_WM_ITEM_WMS___MAX_CASE_QTY as MAX_CASE_QTY", \
	"JNR_WM_ITEM_WMS___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"JNR_WM_ITEM_WMS___NEST_VOL as NEST_VOL", \
	"JNR_WM_ITEM_WMS___NEST_CNT as NEST_CNT", \
	"JNR_WM_ITEM_WMS___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"JNR_WM_ITEM_WMS___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"JNR_WM_ITEM_WMS___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"JNR_WM_ITEM_WMS___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"JNR_WM_ITEM_WMS___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"JNR_WM_ITEM_WMS___AVG_DLY_DMND as AVG_DLY_DMND", \
	"JNR_WM_ITEM_WMS___WT_TOL_PCNT as WT_TOL_PCNT", \
	"JNR_WM_ITEM_WMS___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"JNR_WM_ITEM_WMS___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"JNR_WM_ITEM_WMS___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"JNR_WM_ITEM_WMS___ACTVTN_DATE as ACTVTN_DATE", \
	"JNR_WM_ITEM_WMS___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"JNR_WM_ITEM_WMS___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"JNR_WM_ITEM_WMS___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"JNR_WM_ITEM_WMS___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"JNR_WM_ITEM_WMS___MFG_DATE_REQD as MFG_DATE_REQD", \
	"JNR_WM_ITEM_WMS___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"JNR_WM_ITEM_WMS___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"JNR_WM_ITEM_WMS___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"JNR_WM_ITEM_WMS___BATCH_REQD as BATCH_REQD", \
	"JNR_WM_ITEM_WMS___PROD_STAT_REQD as PROD_STAT_REQD", \
	"JNR_WM_ITEM_WMS___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"JNR_WM_ITEM_WMS___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"JNR_WM_ITEM_WMS___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"JNR_WM_ITEM_WMS___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"JNR_WM_ITEM_WMS___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"JNR_WM_ITEM_WMS___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"JNR_WM_ITEM_WMS___LOAD_ATTR as LOAD_ATTR", \
	"JNR_WM_ITEM_WMS___TEMP_ZONE as TEMP_ZONE", \
	"JNR_WM_ITEM_WMS___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"JNR_WM_ITEM_WMS___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"JNR_WM_ITEM_WMS___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"JNR_WM_ITEM_WMS___CRUSH_CODE as CRUSH_CODE", \
	"JNR_WM_ITEM_WMS___CONVEY_FLAG as CONVEY_FLAG", \
	"JNR_WM_ITEM_WMS___STORE_DEPT as STORE_DEPT", \
	"JNR_WM_ITEM_WMS___MERCH_TYPE as MERCH_TYPE", \
	"JNR_WM_ITEM_WMS___MERCH_GROUP as MERCH_GROUP", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_1 as SPL_INSTR_1", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_2 as SPL_INSTR_2", \
	"JNR_WM_ITEM_WMS___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"JNR_WM_ITEM_WMS___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"JNR_WM_ITEM_WMS___ECCN_NBR as ECCN_NBR", \
	"JNR_WM_ITEM_WMS___EXP_LICN_NBR as EXP_LICN_NBR", \
	"JNR_WM_ITEM_WMS___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"JNR_WM_ITEM_WMS___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"JNR_WM_ITEM_WMS___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"JNR_WM_ITEM_WMS___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"JNR_WM_ITEM_WMS___NMFC_CODE as NMFC_CODE", \
	"JNR_WM_ITEM_WMS___FRT_CLASS as FRT_CLASS", \
	"JNR_WM_ITEM_WMS___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"JNR_WM_ITEM_WMS___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"JNR_WM_ITEM_WMS___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"JNR_WM_ITEM_WMS___INCUB_DAYS as INCUB_DAYS", \
	"JNR_WM_ITEM_WMS___INCUB_HOURS as INCUB_HOURS", \
	"JNR_WM_ITEM_WMS___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"JNR_WM_ITEM_WMS___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"JNR_WM_ITEM_WMS___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"JNR_WM_ITEM_WMS___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"JNR_WM_ITEM_WMS___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"JNR_WM_ITEM_WMS___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"JNR_WM_ITEM_WMS___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"JNR_WM_ITEM_WMS___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"JNR_WM_ITEM_WMS___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"JNR_WM_ITEM_WMS___MONETARY_VALUE as MONETARY_VALUE", \
	"JNR_WM_ITEM_WMS___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"JNR_WM_ITEM_WMS___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"JNR_WM_ITEM_WMS___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"JNR_WM_ITEM_WMS___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"JNR_WM_ITEM_WMS___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"JNR_WM_ITEM_WMS___PROD_CATGRY as PROD_CATGRY", \
	"JNR_WM_ITEM_WMS___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"JNR_WM_ITEM_WMS___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"JNR_WM_ITEM_WMS___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"JNR_WM_ITEM_WMS___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"JNR_WM_ITEM_WMS___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"JNR_WM_ITEM_WMS___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"JNR_WM_ITEM_WMS___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"JNR_WM_ITEM_WMS___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"JNR_WM_ITEM_WMS___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"JNR_WM_ITEM_WMS___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"JNR_WM_ITEM_WMS___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"JNR_WM_ITEM_WMS___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"JNR_WM_ITEM_WMS___SHELF_DAYS as SHELF_DAYS", \
	"JNR_WM_ITEM_WMS___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"JNR_WM_ITEM_WMS___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"JNR_WM_ITEM_WMS___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"JNR_WM_ITEM_WMS___LET_UP_PRTY as LET_UP_PRTY", \
	"JNR_WM_ITEM_WMS___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"JNR_WM_ITEM_WMS___PRODUCER_FLAG as PRODUCER_FLAG", \
	"JNR_WM_ITEM_WMS___NET_COST_FLAG as NET_COST_FLAG", \
	"JNR_WM_ITEM_WMS___MARKS_NBRS as MARKS_NBRS", \
	"JNR_WM_ITEM_WMS___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"JNR_WM_ITEM_WMS___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"JNR_WM_ITEM_WMS___MV_SIZE_UOM as MV_SIZE_UOM", \
	"JNR_WM_ITEM_WMS___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"JNR_WM_ITEM_WMS___SRL_NBR_REQD as SRL_NBR_REQD", \
	"JNR_WM_ITEM_WMS___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"JNR_WM_ITEM_WMS___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"JNR_WM_ITEM_WMS___in_LOCATION_ID as in_LOCATION_ID", \
	"JNR_WM_ITEM_WMS___in_WM_ITEM_ID as in_WM_ITEM_ID", \
	"JNR_WM_ITEM_WMS___in_WM_AUDIT_CREATED_TSTMP as in_WM_AUDIT_CREATED_TSTMP", \
	"JNR_WM_ITEM_WMS___in_WM_AUDIT_LAST_UPDATED_TSTMP as in_WM_AUDIT_LAST_UPDATED_TSTMP", \
	"JNR_WM_ITEM_WMS___in_LOAD_TSTMP as in_LOAD_TSTMP") \
    .filter("in_WM_ITEM_ID is Null OR ( in_WM_ITEM_ID is Null AND \
     ( COALESCE(AUDIT_CREATED_DTTM, date'1900-01-01') != COALESCE(in_WM_AUDIT_CREATED_TSTMP, date'1900-01-01') \
    OR COALESCE(AUDIT_LAST_UPDATED_DTTM, date'1900-01-01') != COALESCE(in_WM_AUDIT_LAST_UPDATED_TSTMP, date'1900-01-01')))").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_EVALUATE, type EXPRESSION 
# COLUMN COUNT: 144

# for each involved DataFrame, append the dataframe name to each column
FIL_UNCHANGED_REC_temp = FIL_UNCHANGED_REC.toDF(*["FIL_UNCHANGED_REC___" + col for col in FIL_UNCHANGED_REC.columns])

EXP_EVALUATE = FIL_UNCHANGED_REC_temp.selectExpr( \
	"FIL_UNCHANGED_REC___sys_row_id as sys_row_id", \
	"FIL_UNCHANGED_REC___LOCATION_ID as LOCATION_ID", \
	"FIL_UNCHANGED_REC___ITEM_ID as ITEM_ID", \
	"FIL_UNCHANGED_REC___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"FIL_UNCHANGED_REC___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"FIL_UNCHANGED_REC___VOLTY_CODE as VOLTY_CODE", \
	"FIL_UNCHANGED_REC___PKG_TYPE as PKG_TYPE", \
	"FIL_UNCHANGED_REC___PROD_SUB_GRP as PROD_SUB_GRP", \
	"FIL_UNCHANGED_REC___PROD_TYPE as PROD_TYPE", \
	"FIL_UNCHANGED_REC___PROD_LINE as PROD_LINE", \
	"FIL_UNCHANGED_REC___SALE_GRP as SALE_GRP", \
	"FIL_UNCHANGED_REC___COORD_1 as COORD_1", \
	"FIL_UNCHANGED_REC___COORD_2 as COORD_2", \
	"FIL_UNCHANGED_REC___CARTON_TYPE as CARTON_TYPE", \
	"FIL_UNCHANGED_REC___UNIT_PRICE as UNIT_PRICE", \
	"FIL_UNCHANGED_REC___RETAIL_PRICE as RETAIL_PRICE", \
	"FIL_UNCHANGED_REC___OPER_CODE as OPER_CODE", \
	"FIL_UNCHANGED_REC___MAX_CASE_QTY as MAX_CASE_QTY", \
	"FIL_UNCHANGED_REC___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"FIL_UNCHANGED_REC___NEST_VOL as NEST_VOL", \
	"FIL_UNCHANGED_REC___NEST_CNT as NEST_CNT", \
	"FIL_UNCHANGED_REC___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"FIL_UNCHANGED_REC___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"FIL_UNCHANGED_REC___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"FIL_UNCHANGED_REC___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"FIL_UNCHANGED_REC___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"FIL_UNCHANGED_REC___AVG_DLY_DMND as AVG_DLY_DMND", \
	"FIL_UNCHANGED_REC___WT_TOL_PCNT as WT_TOL_PCNT", \
	"FIL_UNCHANGED_REC___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"FIL_UNCHANGED_REC___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"FIL_UNCHANGED_REC___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"FIL_UNCHANGED_REC___ACTVTN_DATE as ACTVTN_DATE", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___ALLOW_RCPT_OLDER_ITEM)) IN ('Y', '1') THEN '1' ELSE '0' END as ALLOW_RCPT_OLDER_ITEM_EXP", \
	"FIL_UNCHANGED_REC___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"FIL_UNCHANGED_REC___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"FIL_UNCHANGED_REC___CRITCL_DIM_3 as CRITCL_DIM_3", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___MFG_DATE_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as MFG_DATE_REQD_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___XPIRE_DATE_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as XPIRE_DATE_REQD_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___SHIP_BY_DATE_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as SHIP_BY_DATE_REQD_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___ITEM_ATTR_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as ITEM_ATTR_REQD_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___BATCH_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as BATCH_REQD_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___PROD_STAT_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as PROD_STAT_REQD_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___CNTRY_OF_ORGN_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as CNTRY_OF_ORGN_REQD_EXP", \
	"FIL_UNCHANGED_REC___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"FIL_UNCHANGED_REC___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"FIL_UNCHANGED_REC___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"FIL_UNCHANGED_REC___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"FIL_UNCHANGED_REC___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"FIL_UNCHANGED_REC___LOAD_ATTR as LOAD_ATTR", \
	"FIL_UNCHANGED_REC___TEMP_ZONE as TEMP_ZONE", \
	"FIL_UNCHANGED_REC___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"FIL_UNCHANGED_REC___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"FIL_UNCHANGED_REC___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"FIL_UNCHANGED_REC___CRUSH_CODE as CRUSH_CODE", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___CONVEY_FLAG)) IN ('Y', '1') THEN '1' ELSE '0' END as CONVEY_FLAG_EXP", \
	"FIL_UNCHANGED_REC___STORE_DEPT as STORE_DEPT", \
	"FIL_UNCHANGED_REC___MERCH_TYPE as MERCH_TYPE", \
	"FIL_UNCHANGED_REC___MERCH_GROUP as MERCH_GROUP", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"FIL_UNCHANGED_REC___SPL_INSTR_1 as SPL_INSTR_1", \
	"FIL_UNCHANGED_REC___SPL_INSTR_2 as SPL_INSTR_2", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___PROMPT_FOR_VENDOR_ITEM_NBR)) IN ('Y', '1') THEN '1' ELSE '0' END as PROMPT_FOR_VENDOR_ITEM_NBR_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___PROMPT_PACK_QTY)) IN ('Y', '1') THEN '1' ELSE '0' END as PROMPT_PACK_QTY_EXP", \
	"FIL_UNCHANGED_REC___ECCN_NBR as ECCN_NBR", \
	"FIL_UNCHANGED_REC___EXP_LICN_NBR as EXP_LICN_NBR", \
	"FIL_UNCHANGED_REC___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"FIL_UNCHANGED_REC___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"FIL_UNCHANGED_REC___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"FIL_UNCHANGED_REC___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"FIL_UNCHANGED_REC___NMFC_CODE as NMFC_CODE", \
	"FIL_UNCHANGED_REC___FRT_CLASS as FRT_CLASS", \
	"FIL_UNCHANGED_REC___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"FIL_UNCHANGED_REC___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___BASE_INCUB_FLAG)) IN ('Y', '1') THEN '1' ELSE '0' END as BASE_INCUB_FLAG_EXP", \
	"FIL_UNCHANGED_REC___INCUB_DAYS as INCUB_DAYS", \
	"FIL_UNCHANGED_REC___INCUB_HOURS as INCUB_HOURS", \
	"FIL_UNCHANGED_REC___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"FIL_UNCHANGED_REC___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"FIL_UNCHANGED_REC___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"FIL_UNCHANGED_REC___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"FIL_UNCHANGED_REC___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"FIL_UNCHANGED_REC___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"FIL_UNCHANGED_REC___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"FIL_UNCHANGED_REC___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"FIL_UNCHANGED_REC___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"FIL_UNCHANGED_REC___MONETARY_VALUE as MONETARY_VALUE", \
	"FIL_UNCHANGED_REC___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"FIL_UNCHANGED_REC___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"FIL_UNCHANGED_REC___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"FIL_UNCHANGED_REC___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"FIL_UNCHANGED_REC___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"FIL_UNCHANGED_REC___PROD_CATGRY as PROD_CATGRY", \
	"FIL_UNCHANGED_REC___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"FIL_UNCHANGED_REC___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_REC___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"FIL_UNCHANGED_REC___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"FIL_UNCHANGED_REC___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_REC___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"FIL_UNCHANGED_REC___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"FIL_UNCHANGED_REC___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"FIL_UNCHANGED_REC___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"FIL_UNCHANGED_REC___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"FIL_UNCHANGED_REC___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"FIL_UNCHANGED_REC___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"FIL_UNCHANGED_REC___SHELF_DAYS as SHELF_DAYS", \
	"FIL_UNCHANGED_REC___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"FIL_UNCHANGED_REC___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"FIL_UNCHANGED_REC___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"FIL_UNCHANGED_REC___LET_UP_PRTY as LET_UP_PRTY", \
	"FIL_UNCHANGED_REC___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"FIL_UNCHANGED_REC___PRODUCER_FLAG as PRODUCER_FLAG", \
	"FIL_UNCHANGED_REC___NET_COST_FLAG as NET_COST_FLAG", \
	"FIL_UNCHANGED_REC___MARKS_NBRS as MARKS_NBRS", \
	"FIL_UNCHANGED_REC___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_REC___PRICE_TIX_AVAIL)) IN ('Y', '1') THEN '1' ELSE '0' END as PRICE_TIX_AVAIL_EXP", \
	"FIL_UNCHANGED_REC___MV_SIZE_UOM as MV_SIZE_UOM", \
	"FIL_UNCHANGED_REC___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"FIL_UNCHANGED_REC___SRL_NBR_REQD as SRL_NBR_REQD", \
	"FIL_UNCHANGED_REC___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"FIL_UNCHANGED_REC___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"FIL_UNCHANGED_REC___in_LOCATION_ID as in_LOCATION_ID", \
	"FIL_UNCHANGED_REC___in_WM_ITEM_ID as in_WM_ITEM_ID", \
	"FIL_UNCHANGED_REC___in_WM_AUDIT_CREATED_TSTMP as in_WM_AUDIT_CREATED_TSTMP", \
	"FIL_UNCHANGED_REC___in_WM_AUDIT_LAST_UPDATED_TSTMP as in_WM_AUDIT_LAST_UPDATED_TSTMP", \
	"IF(FIL_UNCHANGED_REC___in_LOAD_TSTMP IS NULL, CURRENT_TIMESTAMP, FIL_UNCHANGED_REC___in_LOAD_TSTMP) as LOAD_TSTMP", \
	"CURRENT_TIMESTAMP as UPDATE_TSTMP" \
)

# COMMAND ----------
# Processing node UPD_INS_UPD, type UPDATE_STRATEGY . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 141

# for each involved DataFrame, append the dataframe name to each column
EXP_EVALUATE_temp = EXP_EVALUATE.toDF(*["EXP_EVALUATE___" + col for col in EXP_EVALUATE.columns])

UPD_INS_UPD = EXP_EVALUATE_temp.selectExpr( \
	"EXP_EVALUATE___LOCATION_ID as LOCATION_ID", \
	"EXP_EVALUATE___ITEM_ID as ITEM_ID", \
	"EXP_EVALUATE___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"EXP_EVALUATE___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"EXP_EVALUATE___VOLTY_CODE as VOLTY_CODE", \
	"EXP_EVALUATE___PKG_TYPE as PKG_TYPE", \
	"EXP_EVALUATE___PROD_SUB_GRP as PROD_SUB_GRP", \
	"EXP_EVALUATE___PROD_TYPE as PROD_TYPE", \
	"EXP_EVALUATE___PROD_LINE as PROD_LINE", \
	"EXP_EVALUATE___SALE_GRP as SALE_GRP", \
	"EXP_EVALUATE___COORD_1 as COORD_1", \
	"EXP_EVALUATE___COORD_2 as COORD_2", \
	"EXP_EVALUATE___CARTON_TYPE as CARTON_TYPE", \
	"EXP_EVALUATE___UNIT_PRICE as UNIT_PRICE", \
	"EXP_EVALUATE___RETAIL_PRICE as RETAIL_PRICE", \
	"EXP_EVALUATE___OPER_CODE as OPER_CODE", \
	"EXP_EVALUATE___MAX_CASE_QTY as MAX_CASE_QTY", \
	"EXP_EVALUATE___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"EXP_EVALUATE___NEST_VOL as NEST_VOL", \
	"EXP_EVALUATE___NEST_CNT as NEST_CNT", \
	"EXP_EVALUATE___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"EXP_EVALUATE___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"EXP_EVALUATE___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"EXP_EVALUATE___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"EXP_EVALUATE___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"EXP_EVALUATE___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"EXP_EVALUATE___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"EXP_EVALUATE___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"EXP_EVALUATE___AVG_DLY_DMND as AVG_DLY_DMND", \
	"EXP_EVALUATE___WT_TOL_PCNT as WT_TOL_PCNT", \
	"EXP_EVALUATE___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"EXP_EVALUATE___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"EXP_EVALUATE___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"EXP_EVALUATE___ACTVTN_DATE as ACTVTN_DATE", \
	"EXP_EVALUATE___ALLOW_RCPT_OLDER_ITEM_EXP as ALLOW_RCPT_OLDER_ITEM", \
	"EXP_EVALUATE___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"EXP_EVALUATE___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"EXP_EVALUATE___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"EXP_EVALUATE___MFG_DATE_REQD_EXP as MFG_DATE_REQD", \
	"EXP_EVALUATE___XPIRE_DATE_REQD_EXP as XPIRE_DATE_REQD", \
	"EXP_EVALUATE___SHIP_BY_DATE_REQD_EXP as SHIP_BY_DATE_REQD", \
	"EXP_EVALUATE___ITEM_ATTR_REQD_EXP as ITEM_ATTR_REQD", \
	"EXP_EVALUATE___BATCH_REQD_EXP as BATCH_REQD", \
	"EXP_EVALUATE___PROD_STAT_REQD_EXP as PROD_STAT_REQD", \
	"EXP_EVALUATE___CNTRY_OF_ORGN_REQD_EXP as CNTRY_OF_ORGN_REQD", \
	"EXP_EVALUATE___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"EXP_EVALUATE___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"EXP_EVALUATE___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"EXP_EVALUATE___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"EXP_EVALUATE___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"EXP_EVALUATE___LOAD_ATTR as LOAD_ATTR", \
	"EXP_EVALUATE___TEMP_ZONE as TEMP_ZONE", \
	"EXP_EVALUATE___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"EXP_EVALUATE___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"EXP_EVALUATE___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"EXP_EVALUATE___CRUSH_CODE as CRUSH_CODE", \
	"EXP_EVALUATE___CONVEY_FLAG_EXP as CONVEY_FLAG", \
	"EXP_EVALUATE___STORE_DEPT as STORE_DEPT", \
	"EXP_EVALUATE___MERCH_TYPE as MERCH_TYPE", \
	"EXP_EVALUATE___MERCH_GROUP as MERCH_GROUP", \
	"EXP_EVALUATE___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"EXP_EVALUATE___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"EXP_EVALUATE___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"EXP_EVALUATE___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"EXP_EVALUATE___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"EXP_EVALUATE___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"EXP_EVALUATE___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"EXP_EVALUATE___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"EXP_EVALUATE___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"EXP_EVALUATE___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"EXP_EVALUATE___SPL_INSTR_1 as SPL_INSTR_1", \
	"EXP_EVALUATE___SPL_INSTR_2 as SPL_INSTR_2", \
	"EXP_EVALUATE___PROMPT_FOR_VENDOR_ITEM_NBR_EXP as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"EXP_EVALUATE___PROMPT_PACK_QTY_EXP as PROMPT_PACK_QTY", \
	"EXP_EVALUATE___ECCN_NBR as ECCN_NBR", \
	"EXP_EVALUATE___EXP_LICN_NBR as EXP_LICN_NBR", \
	"EXP_EVALUATE___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"EXP_EVALUATE___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"EXP_EVALUATE___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"EXP_EVALUATE___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"EXP_EVALUATE___NMFC_CODE as NMFC_CODE", \
	"EXP_EVALUATE___FRT_CLASS as FRT_CLASS", \
	"EXP_EVALUATE___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"EXP_EVALUATE___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"EXP_EVALUATE___BASE_INCUB_FLAG_EXP as BASE_INCUB_FLAG", \
	"EXP_EVALUATE___INCUB_DAYS as INCUB_DAYS", \
	"EXP_EVALUATE___INCUB_HOURS as INCUB_HOURS", \
	"EXP_EVALUATE___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"EXP_EVALUATE___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"EXP_EVALUATE___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"EXP_EVALUATE___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"EXP_EVALUATE___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"EXP_EVALUATE___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"EXP_EVALUATE___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"EXP_EVALUATE___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"EXP_EVALUATE___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"EXP_EVALUATE___MONETARY_VALUE as MONETARY_VALUE", \
	"EXP_EVALUATE___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"EXP_EVALUATE___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"EXP_EVALUATE___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"EXP_EVALUATE___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"EXP_EVALUATE___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"EXP_EVALUATE___PROD_CATGRY as PROD_CATGRY", \
	"EXP_EVALUATE___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"EXP_EVALUATE___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"EXP_EVALUATE___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"EXP_EVALUATE___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"EXP_EVALUATE___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"EXP_EVALUATE___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"EXP_EVALUATE___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"EXP_EVALUATE___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"EXP_EVALUATE___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"EXP_EVALUATE___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"EXP_EVALUATE___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"EXP_EVALUATE___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"EXP_EVALUATE___SHELF_DAYS as SHELF_DAYS", \
	"EXP_EVALUATE___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"EXP_EVALUATE___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"EXP_EVALUATE___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"EXP_EVALUATE___LET_UP_PRTY as LET_UP_PRTY", \
	"EXP_EVALUATE___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"EXP_EVALUATE___PRODUCER_FLAG as PRODUCER_FLAG", \
	"EXP_EVALUATE___NET_COST_FLAG as NET_COST_FLAG", \
	"EXP_EVALUATE___MARKS_NBRS as MARKS_NBRS", \
	"EXP_EVALUATE___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"EXP_EVALUATE___PRICE_TIX_AVAIL_EXP as PRICE_TIX_AVAIL", \
	"EXP_EVALUATE___MV_SIZE_UOM as MV_SIZE_UOM", \
	"EXP_EVALUATE___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"EXP_EVALUATE___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"EXP_EVALUATE___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"EXP_EVALUATE___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"EXP_EVALUATE___SRL_NBR_REQD as SRL_NBR_REQD", \
	"EXP_EVALUATE___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"EXP_EVALUATE___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"EXP_EVALUATE___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"EXP_EVALUATE___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"EXP_EVALUATE___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"EXP_EVALUATE___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"EXP_EVALUATE___in_WM_ITEM_ID as in_WM_ITEM_ID", \
	"EXP_EVALUATE___LOAD_TSTMP as LOAD_TSTMP", \
	"EXP_EVALUATE___UPDATE_TSTMP as UPDATE_TSTMP") \
	.withColumn('pyspark_data_action', when((col('in_WM_ITEM_ID').isNull()) ,(lit(0))).otherwise(lit(1)))

# COMMAND ----------
# Processing node Shortcut_to_WM_ITEM_WMS1, type TARGET 
# COLUMN COUNT: 140

Shortcut_to_WM_ITEM_WMS1 = UPD_INS_UPD.selectExpr(
	"CAST(LOCATION_ID AS BIGINT) as LOCATION_ID",
	"CAST(ITEM_ID AS DECIMAL(9,0)) as WM_ITEM_ID",
	"CAST(VENDOR_MASTER_ID AS DECIMAL(9,0)) as WM_VENDOR_MASTER_ID",
	"CAST(VENDOR_ITEM_NBR AS STRING) as WM_VENDOR_ITEM_NBR",
	"CAST(PROD_TYPE AS STRING) as WM_PROD_TYPE",
	"CAST(PROD_CATGRY AS STRING) as WM_PROD_CATGRY",
	"CAST(PROD_LINE AS STRING) as WM_PROD_LINE",
	"CAST(PROD_SUB_GRP AS STRING) as WM_PROD_SUB_GRP",
	"CAST(MERCH_TYPE AS STRING) as WM_MERCH_TYPE",
	"CAST(MERCH_GROUP AS STRING) as WM_MERCH_GROUP",
	"CAST(CARTON_TYPE AS STRING) as WM_CARTON_TYPE",
	"CAST(STORE_DEPT AS STRING) as WM_STORE_DEPT",
	"CAST(SRL_NBR_BRCD_TYPE AS STRING) as WM_SRL_NBR_BRCD_TYPE",
	"CAST(SALE_GRP AS STRING) as WM_SALE_GRP",
	"CAST(SIZE_RANGE_CODE AS STRING) as WM_SIZE_RANGE_CD",
	"CAST(SIZE_REL_POSN_IN_TABLE AS STRING) as WM_SIZE_REL_POSN_IN_TABLE",
	"CAST(VOLTY_CODE AS STRING) as WM_VOLTY_CD",
	"CAST(PKG_TYPE AS STRING) as WM_PKG_TYPE",
	"CAST(PKT_CONSOL_ATTR AS STRING) as WM_PKT_CONSOL_ATTR",
	"CAST(BUYER_DISP_CODE AS STRING) as WM_BUYER_DISP_CD",
	"CAST(SLOTTING_OPT_STAT_CODE AS DECIMAL(4,0)) as WM_SLOTTING_OPT_STAT_CD",
	"CAST(OPER_CODE AS STRING) as WM_OPER_CD",
	"CAST(CRUSH_CODE AS STRING) as WM_CRUSH_CD",
	"CAST(ACTVTN_DATE AS DATE) as ACTIVATION_DT",
	"CAST(LOAD_ATTR AS STRING) as LOAD_ATTR",
	"CAST(TEMP_ZONE AS STRING) as TEMP_ZONE",
	"CAST(TRLR_TEMP_ZONE AS STRING) as TRLR_TEMP_ZONE",
	"CAST(ECCN_NBR AS STRING) as ECCN_NBR",
	"CAST(EXP_LICN_NBR AS STRING) as EXP_LICN_NBR",
	"CAST(EXP_LICN_XP_DATE AS DATE) as EXP_LICN_XP_DT",
	"CAST(EXP_LICN_SYMBOL AS STRING) as EXP_LICN_SYMBOL",
	"CAST(EXP_LICN_DESCRIPTION AS STRING) as EXP_LICN_DESC",
	"CAST(ORGN_CERT_CODE AS STRING) as WM_ORGN_CERT_CD",
	"CAST(ITAR_EXEMPT_NBR AS STRING) as ITAR_EXEMPT_NBR",
	"CAST(NMFC_CODE AS STRING) as NMFC_CD",
	"CAST(FRT_CLASS AS STRING) as FRT_CLASS",
	"CAST(CARTON_CNT_DATE_TIME AS TIMESTAMP) as CARTON_CNT_TSTMP",
	"CAST(TRANS_INVN_CNT_DATE_TIME AS TIMESTAMP) as TRANS_INVN_CNT_TSTMP",
	"CAST(WORK_ORD_CNT_DATE_TIME AS TIMESTAMP) as WORK_ORD_CNT_TSTMP",
	"CAST(PROMPT_FOR_VENDOR_ITEM_NBR AS DECIMAL(1,0)) as PROMPT_FOR_VENDOR_ITEM_NBR_FLAG",
	"CAST(PROMPT_PACK_QTY AS DECIMAL(1,0)) as PROMPT_PACK_QTY_FLAG",
	"CAST(CONVEY_FLAG AS DECIMAL(1,0)) as CONVEY_FLAG",
	"CAST(MINOR_SRL_NBR_REQ AS DECIMAL(1,0)) as MINOR_SRL_NBR_REQ_FLAG",
	"CAST(DUP_SRL_NBR_FLAG AS DECIMAL(1,0)) as DUP_SRL_NBR_FLAG",
	"CAST(ALLOW_RCPT_OLDER_ITEM AS DECIMAL(1,0)) as ALLOW_RCPT_OLDER_ITEM_FLAG",
	"CAST(BASE_INCUB_FLAG AS DECIMAL(1,0)) as BASE_INCUB_FLAG",
	"CAST(CODE_DATE_PROMPT_METHOD_FLAG AS STRING) as CD_DT_PROMPT_METHOD_FLAG",
	"CAST(TOP_SHELF_ELIGIBLE AS DECIMAL(1,0)) as TOP_SHELF_ELIGIBLE_FLAG",
	"CAST(PREF_CRITERIA_FLAG AS STRING) as PREF_CRITERIA_FLAG",
	"CAST(PRODUCER_FLAG AS STRING) as PRODUCER_FLAG",
	"CAST(SRL_NBR_REQD AS DECIMAL(1,0)) as SRL_NBR_REQD_FLAG",
	"CAST(MFG_DATE_REQD AS DECIMAL(1,0)) as MFG_DATE_REQD_FLAG",
	"CAST(XPIRE_DATE_REQD AS DECIMAL(1,0)) as XPIRE_DATE_REQD_FLAG",
	"CAST(SHIP_BY_DATE_REQD AS DECIMAL(1,0)) as SHIP_BY_DATE_REQD_FLAG",
	"CAST(ITEM_ATTR_REQD AS DECIMAL(1,0)) as ITEM_ATTR_REQD_FLAG",
	"CAST(BATCH_REQD AS DECIMAL(1,0)) as BATCH_REQD_FLAG",
	"CAST(PROD_STAT_REQD AS DECIMAL(1,0)) as PROD_STAT_REQD_FLAG",
	"CAST(CNTRY_OF_ORGN_REQD AS DECIMAL(1,0)) as COUNTRY_OF_ORIGIN_REQD_FLAG",
	"CAST(NET_COST_FLAG AS STRING) as NET_COST_FLAG",
	"CAST(PRICE_TIX_AVAIL AS DECIMAL(1,0)) as PRICE_TIX_AVAIL_FLAG",
	"CAST(UNIT_PRICE AS DECIMAL(16,4)) as WM_UNIT_PRICE",
	"CAST(RETAIL_PRICE AS DECIMAL(16,4)) as WM_RETAIL_PRICE",
	"CAST(PRICE_TKT_TYPE AS STRING) as WM_PRICE_TKT_TYPE",
	"CAST(MONETARY_VALUE AS DECIMAL(16,4)) as MONETARY_VALUE",
	"CAST(MV_CURRENCY_CODE AS STRING) as MV_CURRENCY_CD",
	"CAST(AVG_DLY_DMND AS DECIMAL(13,5)) as AVG_DLY_DMND",
	"CAST(COORD_1 AS DECIMAL(5,0)) as COORD_1",
	"CAST(COORD_2 AS DECIMAL(5,0)) as COORD_2",
	"CAST(DISPOSITION_TYPE AS STRING) as WM_DISPOSITION_TYPE",
	"CAST(SHELF_DAYS AS DECIMAL(8,0)) as SHELF_DAYS",
	"CAST(DFLT_INCUB_LOCK AS STRING) as DFLT_INCUB_LOCK",
	"CAST(INCUB_DAYS AS DECIMAL(3,0)) as INCUB_DAYS",
	"CAST(INCUB_HOURS AS DECIMAL(4,2)) as INCUB_HOURS",
	"CAST(LET_UP_PRTY AS DECIMAL(5,0)) as LET_UP_PRTY",
	"CAST(MARKS_NBRS AS STRING) as MARKS_NBRS",
	"CAST(UNITS_PER_GRAB_PLT AS DECIMAL(13,4)) as UNITS_PER_GRAB_PLT",
	"CAST(HNDL_ATTR_PLT AS STRING) as HNDL_ATTR_PLT",
	"CAST(MAX_CASE_QTY AS DECIMAL(9,2)) as MAX_CASE_QTY",
	"CAST(MAX_RCPT_QTY AS DECIMAL(9,2)) as MAX_RCPT_QTY",
	"CAST(VOCOLLECT_BASE_WT AS DECIMAL(13,4)) as VOCOLLECT_BASE_WT",
	"CAST(VOCOLLECT_BASE_QTY AS DECIMAL(9,2)) as VOCOLLECT_BASE_QTY",
	"CAST(VOCOLLECT_BASE_ITEM AS STRING) as VOCOLLECT_BASE_ITEM",
	"CAST(CUBE_MULT_QTY AS DECIMAL(13,4)) as CUBE_MULT_QTY",
	"CAST(NEST_VOL AS DECIMAL(13,4)) as NEST_VOL",
	"CAST(NEST_CNT AS DECIMAL(5,0)) as NEST_CNT",
	"CAST(PICK_WT_TOL_AMNT AS DECIMAL(4,0)) as PICK_WT_TOL_AMT",
	"CAST(PICK_WT_TOL_AMNT_ERROR AS DECIMAL(4,0)) as PICK_WT_TOL_AMNT_ERROR",
	"CAST(PICK_WT_TOL_TYPE AS STRING) as WM_PICK_WT_TOL_TYPE",
	"CAST(MHE_WT_TOL_AMNT AS DECIMAL(4,0)) as MHE_WT_TOL_AMT",
	"CAST(MHE_WT_TOL_TYPE AS STRING) as WM_MHE_WT_TOL_TYPE",
	"CAST(NBR_OF_DYN_ACTV_PICK_PER_SKU AS DECIMAL(3,0)) as NBR_OF_DYN_ACTV_PICK_PER_SKU",
	"CAST(NBR_OF_DYN_CASE_PICK_PER_SKU AS DECIMAL(3,0)) as NBR_OF_DYN_CASE_PICK_PER_SKU",
	"CAST(PROD_LIFE_IN_DAY AS DECIMAL(9,0)) as PROD_LIFE_IN_DAY",
	"CAST(MIN_RECV_TO_XPIRE_DAYS AS DECIMAL(9,0)) as MIN_RECV_TO_XPIRE_DAYS",
	"CAST(MAX_RECV_TO_XPIRE_DAYS AS DECIMAL(9,0)) as MAX_RECV_TO_XPIRE_DAYS",
	"CAST(WT_TOL_PCNT AS DECIMAL(5,2)) as WT_TOL_PCNT",
	"CAST(MIN_PCNT_FOR_LPN_SPLIT AS DECIMAL(3,0)) as MIN_PCNT_FOR_LPN_SPLIT",
	"CAST(MIN_LPN_QTY_FOR_SPLIT AS DECIMAL(13,5)) as MIN_LPN_QTY_FOR_SPLIT",
	"CAST(VOCO_ABS_PICK_TOL_AMT AS DECIMAL(5,0)) as VOCO_ABS_PICK_TOL_AMT",
	"CAST(CONS_PRTY_DATE_CODE AS STRING) as WM_CONS_PRTY_DATE_CD",
	"CAST(CONS_PRTY_DATE_WINDOW AS STRING) as CONS_PRTY_DATE_WINDOW",
	"CAST(CONS_PRTY_DATE_WINDOW_INCR AS DECIMAL(4,0)) as CONS_PRTY_DATE_WINDOW_INCR",
	"CAST(CC_UNIT_TOLER_VALUE AS DECIMAL(10,0)) as CC_UNIT_TOLER_VALUE",
	"CAST(CC_WGT_TOLER_VALUE AS DECIMAL(13,4)) as CC_WGT_TOLER_VALUE",
	"CAST(CC_DLR_TOLER_VALUE AS DECIMAL(13,4)) as CC_DLR_TOLER_VALUE",
	"CAST(CC_PCNT_TOLER_VALUE AS DECIMAL(13,4)) as CC_PCNT_TOLER_VALUE",
	"CAST(UNITS_PER_PICK_ACTIVE AS DECIMAL(9,2)) as UNITS_PER_PICK_ACTIVE",
	"CAST(HNDL_ATTR_ACTIVE AS STRING) as HNDL_ATTR_ACTIVE",
	"CAST(UNITS_PER_PICK_CASE_PICK AS DECIMAL(9,2)) as UNITS_PER_PICK_CASE_PICK",
	"CAST(HNDL_ATTR_CASE_PICK AS STRING) as HNDL_ATTR_CASE_PICK",
	"CAST(UNITS_PER_PICK_RESV AS DECIMAL(9,2)) as UNITS_PER_PICK_RESV",
	"CAST(HNDL_ATTR_RESV AS STRING) as HNDL_ATTR_RESV",
	"CAST(MV_SIZE_UOM AS DECIMAL(8,0)) as WM_MV_SIZE_UOM_ID",
	"CAST(HNDL_ATTR_ACT_UOM_ID AS DECIMAL(8,0)) as WM_HNDL_ATTR_ACT_UOM_ID",
	"CAST(HNDL_ATTR_CASE_PICK_UOM_ID AS DECIMAL(8,0)) as WM_HNDL_ATTR_CASE_PICK_UOM_ID",
	"CAST(CRITCL_DIM_1 AS DECIMAL(7,2)) as CRITCL_DIM_1",
	"CAST(CRITCL_DIM_2 AS DECIMAL(7,2)) as CRITCL_DIM_2",
	"CAST(CRITCL_DIM_3 AS DECIMAL(7,2)) as CRITCL_DIM_3",
	"CAST(SPL_INSTR_1 AS STRING) as SPL_INSTR_1",
	"CAST(SPL_INSTR_2 AS STRING) as SPL_INSTR_2",
	"CAST(SPL_INSTR_CODE_1 AS STRING) as SPL_INSTR_CD_1",
	"CAST(SPL_INSTR_CODE_2 AS STRING) as SPL_INSTR_CD_2",
	"CAST(SPL_INSTR_CODE_3 AS STRING) as SPL_INSTR_CD_3",
	"CAST(SPL_INSTR_CODE_4 AS STRING) as SPL_INSTR_CD_4",
	"CAST(SPL_INSTR_CODE_5 AS STRING) as SPL_INSTR_CD_5",
	"CAST(SPL_INSTR_CODE_6 AS STRING) as SPL_INSTR_CD_6",
	"CAST(SPL_INSTR_CODE_7 AS STRING) as SPL_INSTR_CD_7",
	"CAST(SPL_INSTR_CODE_8 AS STRING) as SPL_INSTR_CD_8",
	"CAST(SPL_INSTR_CODE_9 AS STRING) as SPL_INSTR_CD_9",
	"CAST(SPL_INSTR_CODE_10 AS STRING) as SPL_INSTR_CD_10",
	"CAST(DFLT_BATCH_STAT AS STRING) as WM_DFLT_BATCH_STAT",
	"CAST(MARK_FOR_DELETION AS DECIMAL(1,0)) as MARK_FOR_DELETION_FLAG",
	"CAST(AUDIT_CREATED_SOURCE_TYPE AS DECIMAL(2,0)) as WM_AUDIT_CREATED_SOURCE_TYPE",
	"CAST(AUDIT_CREATED_SOURCE AS STRING) as WM_AUDIT_CREATED_SOURCE",
	"CAST(AUDIT_CREATED_DTTM AS TIMESTAMP) as WM_AUDIT_CREATED_TSTMP",
	"CAST(AUDIT_LAST_UPDATED_SOURCE_TYPE AS DECIMAL(2,0)) as WM_AUDIT_LAST_UPDATED_SOURCE_TYPE",
	"CAST(AUDIT_LAST_UPDATED_SOURCE AS STRING) as WM_AUDIT_LAST_UPDATED_SOURCE",
	"CAST(AUDIT_LAST_UPDATED_DTTM AS TIMESTAMP) as WM_AUDIT_LAST_UPDATED_TSTMP",
	"CAST(UPDATE_TSTMP AS TIMESTAMP) as UPDATE_TSTMP",
	"CAST(LOAD_TSTMP AS TIMESTAMP) as LOAD_TSTMP", 
    "pyspark_data_action" 
)

try:
  primary_key = """source.LOCATION_ID = target.LOCATION_ID AND source.WM_ITEM_ID = target.WM_ITEM_ID"""
#   refined_perf_table = "WM_ITEM_WMS"
  executeMerge(Shortcut_to_WM_ITEM_WMS1, refined_perf_table, primary_key)
  logger.info(f"Merge with {refined_perf_table} completed]")
  logPrevRunDt("WM_ITEM_WMS", "WM_ITEM_WMS", "Completed", "N/A", f"{raw}.log_run_details")
except Exception as e:
  logPrevRunDt("WM_ITEM_WMS", "WM_ITEM_WMS","Failed",str(e), f"{raw}.log_run_details", )
  raise e
	