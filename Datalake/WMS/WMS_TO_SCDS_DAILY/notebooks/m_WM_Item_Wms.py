#Code converted on 2023-06-22 10:47:19
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from pyspark.dbutils import DBUtils
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from Datalake.utils.logger import *
# COMMAND ----------

parser = argparse.ArgumentParser()
spark = SparkSession.getActiveSession()
dbutils = DBUtils(spark)
parser.add_argument('env', type=str, help='Env Variable')
args = parser.parse_args()
env = args.env

if env is None or env == '':
    raise ValueError('env is not set')

refine = getEnvPrefix(env) + 'refine'
raw = getEnvPrefix(env) + 'raw'
legacy = getEnvPrefix(env) + 'legacy'

# Set global variables
starttime = datetime.now() #start timestamp of the script

refined_perf_table = f"{refine}.WM_ITEM_WMS"
raw_perf_table = f"{raw}.WM_ITEM_WMS_PRE"
site_profile_table = f"{legacy}.SITE_PROFILE"


# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ITEM_WMS, type SOURCE 
# COLUMN COUNT: 5

SQ_Shortcut_to_WM_ITEM_WMS = spark.sql(f"""SELECT
WM_ITEM_WMS.LOCATION_ID,
WM_ITEM_WMS.WM_ITEM_ID,
WM_ITEM_WMS.WM_AUDIT_CREATED_TSTMP,
WM_ITEM_WMS.WM_AUDIT_LAST_UPDATED_TSTMP,
WM_ITEM_WMS.LOAD_TSTMP
FROM {refined_perf_table}
WHERE WM_ITEM_ID IN (SELECT ITEM_ID FROM {raw_perf_table})""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ITEM_WMS_PRE, type SOURCE 
# COLUMN COUNT: 139

SQ_Shortcut_to_WM_ITEM_WMS_PRE = spark.sql(f"""SELECT
WM_ITEM_WMS_PRE.DC_NBR,
WM_ITEM_WMS_PRE.ITEM_ID,
WM_ITEM_WMS_PRE.SIZE_RANGE_CODE,
WM_ITEM_WMS_PRE.SIZE_REL_POSN_IN_TABLE,
WM_ITEM_WMS_PRE.VOLTY_CODE,
WM_ITEM_WMS_PRE.PKG_TYPE,
WM_ITEM_WMS_PRE.PROD_SUB_GRP,
WM_ITEM_WMS_PRE.PROD_TYPE,
WM_ITEM_WMS_PRE.PROD_LINE,
WM_ITEM_WMS_PRE.SALE_GRP,
WM_ITEM_WMS_PRE.COORD_1,
WM_ITEM_WMS_PRE.COORD_2,
WM_ITEM_WMS_PRE.CARTON_TYPE,
WM_ITEM_WMS_PRE.UNIT_PRICE,
WM_ITEM_WMS_PRE.RETAIL_PRICE,
WM_ITEM_WMS_PRE.OPER_CODE,
WM_ITEM_WMS_PRE.MAX_CASE_QTY,
WM_ITEM_WMS_PRE.CUBE_MULT_QTY,
WM_ITEM_WMS_PRE.NEST_VOL,
WM_ITEM_WMS_PRE.NEST_CNT,
WM_ITEM_WMS_PRE.UNITS_PER_PICK_ACTIVE,
WM_ITEM_WMS_PRE.HNDL_ATTR_ACTIVE,
WM_ITEM_WMS_PRE.UNITS_PER_PICK_CASE_PICK,
WM_ITEM_WMS_PRE.HNDL_ATTR_CASE_PICK,
WM_ITEM_WMS_PRE.UNITS_PER_PICK_RESV,
WM_ITEM_WMS_PRE.HNDL_ATTR_RESV,
WM_ITEM_WMS_PRE.PROD_LIFE_IN_DAY,
WM_ITEM_WMS_PRE.MAX_RECV_TO_XPIRE_DAYS,
WM_ITEM_WMS_PRE.AVG_DLY_DMND,
WM_ITEM_WMS_PRE.WT_TOL_PCNT,
WM_ITEM_WMS_PRE.CONS_PRTY_DATE_CODE,
WM_ITEM_WMS_PRE.CONS_PRTY_DATE_WINDOW,
WM_ITEM_WMS_PRE.CONS_PRTY_DATE_WINDOW_INCR,
WM_ITEM_WMS_PRE.ACTVTN_DATE,
WM_ITEM_WMS_PRE.ALLOW_RCPT_OLDER_ITEM,
WM_ITEM_WMS_PRE.CRITCL_DIM_1,
WM_ITEM_WMS_PRE.CRITCL_DIM_2,
WM_ITEM_WMS_PRE.CRITCL_DIM_3,
WM_ITEM_WMS_PRE.MFG_DATE_REQD,
WM_ITEM_WMS_PRE.XPIRE_DATE_REQD,
WM_ITEM_WMS_PRE.SHIP_BY_DATE_REQD,
WM_ITEM_WMS_PRE.ITEM_ATTR_REQD,
WM_ITEM_WMS_PRE.BATCH_REQD,
WM_ITEM_WMS_PRE.PROD_STAT_REQD,
WM_ITEM_WMS_PRE.CNTRY_OF_ORGN_REQD,
WM_ITEM_WMS_PRE.VENDOR_ITEM_NBR,
WM_ITEM_WMS_PRE.PICK_WT_TOL_TYPE,
WM_ITEM_WMS_PRE.PICK_WT_TOL_AMNT,
WM_ITEM_WMS_PRE.MHE_WT_TOL_TYPE,
WM_ITEM_WMS_PRE.MHE_WT_TOL_AMNT,
WM_ITEM_WMS_PRE.LOAD_ATTR,
WM_ITEM_WMS_PRE.TEMP_ZONE,
WM_ITEM_WMS_PRE.TRLR_TEMP_ZONE,
WM_ITEM_WMS_PRE.PKT_CONSOL_ATTR,
WM_ITEM_WMS_PRE.BUYER_DISP_CODE,
WM_ITEM_WMS_PRE.CRUSH_CODE,
WM_ITEM_WMS_PRE.CONVEY_FLAG,
WM_ITEM_WMS_PRE.STORE_DEPT,
WM_ITEM_WMS_PRE.MERCH_TYPE,
WM_ITEM_WMS_PRE.MERCH_GROUP,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_1,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_2,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_3,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_4,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_5,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_6,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_7,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_8,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_9,
WM_ITEM_WMS_PRE.SPL_INSTR_CODE_10,
WM_ITEM_WMS_PRE.SPL_INSTR_1,
WM_ITEM_WMS_PRE.SPL_INSTR_2,
WM_ITEM_WMS_PRE.PROMPT_FOR_VENDOR_ITEM_NBR,
WM_ITEM_WMS_PRE.PROMPT_PACK_QTY,
WM_ITEM_WMS_PRE.ECCN_NBR,
WM_ITEM_WMS_PRE.EXP_LICN_NBR,
WM_ITEM_WMS_PRE.EXP_LICN_XP_DATE,
WM_ITEM_WMS_PRE.EXP_LICN_SYMBOL,
WM_ITEM_WMS_PRE.ORGN_CERT_CODE,
WM_ITEM_WMS_PRE.ITAR_EXEMPT_NBR,
WM_ITEM_WMS_PRE.NMFC_CODE,
WM_ITEM_WMS_PRE.FRT_CLASS,
WM_ITEM_WMS_PRE.DFLT_BATCH_STAT,
WM_ITEM_WMS_PRE.DFLT_INCUB_LOCK,
WM_ITEM_WMS_PRE.BASE_INCUB_FLAG,
WM_ITEM_WMS_PRE.INCUB_DAYS,
WM_ITEM_WMS_PRE.INCUB_HOURS,
WM_ITEM_WMS_PRE.SRL_NBR_BRCD_TYPE,
WM_ITEM_WMS_PRE.MINOR_SRL_NBR_REQ,
WM_ITEM_WMS_PRE.DUP_SRL_NBR_FLAG,
WM_ITEM_WMS_PRE.MAX_RCPT_QTY,
WM_ITEM_WMS_PRE.VOCOLLECT_BASE_WT,
WM_ITEM_WMS_PRE.VOCOLLECT_BASE_QTY,
WM_ITEM_WMS_PRE.VOCOLLECT_BASE_ITEM,
WM_ITEM_WMS_PRE.PICK_WT_TOL_AMNT_ERROR,
WM_ITEM_WMS_PRE.PRICE_TKT_TYPE,
WM_ITEM_WMS_PRE.MONETARY_VALUE,
WM_ITEM_WMS_PRE.MV_CURRENCY_CODE,
WM_ITEM_WMS_PRE.CODE_DATE_PROMPT_METHOD_FLAG,
WM_ITEM_WMS_PRE.MIN_RECV_TO_XPIRE_DAYS,
WM_ITEM_WMS_PRE.MIN_PCNT_FOR_LPN_SPLIT,
WM_ITEM_WMS_PRE.MIN_LPN_QTY_FOR_SPLIT,
WM_ITEM_WMS_PRE.PROD_CATGRY,
WM_ITEM_WMS_PRE.AUDIT_CREATED_SOURCE,
WM_ITEM_WMS_PRE.AUDIT_CREATED_SOURCE_TYPE,
WM_ITEM_WMS_PRE.AUDIT_CREATED_DTTM,
WM_ITEM_WMS_PRE.AUDIT_LAST_UPDATED_SOURCE,
WM_ITEM_WMS_PRE.AUDIT_LAST_UPDATED_SOURCE_TYPE,
WM_ITEM_WMS_PRE.AUDIT_LAST_UPDATED_DTTM,
WM_ITEM_WMS_PRE.MARK_FOR_DELETION,
WM_ITEM_WMS_PRE.TOP_SHELF_ELIGIBLE,
WM_ITEM_WMS_PRE.VOCO_ABS_PICK_TOL_AMT,
WM_ITEM_WMS_PRE.CARTON_CNT_DATE_TIME,
WM_ITEM_WMS_PRE.TRANS_INVN_CNT_DATE_TIME,
WM_ITEM_WMS_PRE.WORK_ORD_CNT_DATE_TIME,
WM_ITEM_WMS_PRE.SHELF_DAYS,
WM_ITEM_WMS_PRE.VENDOR_MASTER_ID,
WM_ITEM_WMS_PRE.NBR_OF_DYN_ACTV_PICK_PER_SKU,
WM_ITEM_WMS_PRE.NBR_OF_DYN_CASE_PICK_PER_SKU,
WM_ITEM_WMS_PRE.LET_UP_PRTY,
WM_ITEM_WMS_PRE.PREF_CRITERIA_FLAG,
WM_ITEM_WMS_PRE.PRODUCER_FLAG,
WM_ITEM_WMS_PRE.NET_COST_FLAG,
WM_ITEM_WMS_PRE.MARKS_NBRS,
WM_ITEM_WMS_PRE.SLOTTING_OPT_STAT_CODE,
WM_ITEM_WMS_PRE.PRICE_TIX_AVAIL,
WM_ITEM_WMS_PRE.MV_SIZE_UOM,
WM_ITEM_WMS_PRE.UNITS_PER_GRAB_PLT,
WM_ITEM_WMS_PRE.HNDL_ATTR_PLT,
WM_ITEM_WMS_PRE.HNDL_ATTR_ACT_UOM_ID,
WM_ITEM_WMS_PRE.HNDL_ATTR_CASE_PICK_UOM_ID,
WM_ITEM_WMS_PRE.SRL_NBR_REQD,
WM_ITEM_WMS_PRE.CC_UNIT_TOLER_VALUE,
WM_ITEM_WMS_PRE.CC_WGT_TOLER_VALUE,
WM_ITEM_WMS_PRE.CC_DLR_TOLER_VALUE,
WM_ITEM_WMS_PRE.CC_PCNT_TOLER_VALUE,
WM_ITEM_WMS_PRE.DISPOSITION_TYPE,
WM_ITEM_WMS_PRE.EXP_LICN_DESCRIPTION,
WM_ITEM_WMS_PRE.LOAD_TSTMP
FROM {raw_perf_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_INT_CONV, type EXPRESSION 
# COLUMN COUNT: 139

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_ITEM_WMS_PRE_temp = SQ_Shortcut_to_WM_ITEM_WMS_PRE.toDF(*["SQ_Shortcut_to_WM_ITEM_WMS_PRE___" + col for col in SQ_Shortcut_to_WM_ITEM_WMS_PRE.columns])

EXP_INT_CONV = SQ_Shortcut_to_WM_ITEM_WMS_PRE_temp.selectExpr( \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___sys_row_id as sys_row_id", \
	"cast(SQ_Shortcut_to_WM_ITEM_WMS_PRE___DC_NBR as int) as o_DC_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ITEM_ID as ITEM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOLTY_CODE as VOLTY_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PKG_TYPE as PKG_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_SUB_GRP as PROD_SUB_GRP", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_TYPE as PROD_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_LINE as PROD_LINE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SALE_GRP as SALE_GRP", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___COORD_1 as COORD_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___COORD_2 as COORD_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CARTON_TYPE as CARTON_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNIT_PRICE as UNIT_PRICE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___RETAIL_PRICE as RETAIL_PRICE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___OPER_CODE as OPER_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MAX_CASE_QTY as MAX_CASE_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NEST_VOL as NEST_VOL", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NEST_CNT as NEST_CNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AVG_DLY_DMND as AVG_DLY_DMND", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___WT_TOL_PCNT as WT_TOL_PCNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ACTVTN_DATE as ACTVTN_DATE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MFG_DATE_REQD as MFG_DATE_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___BATCH_REQD as BATCH_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_STAT_REQD as PROD_STAT_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___LOAD_ATTR as LOAD_ATTR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TEMP_ZONE as TEMP_ZONE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CRUSH_CODE as CRUSH_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CONVEY_FLAG as CONVEY_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___STORE_DEPT as STORE_DEPT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MERCH_TYPE as MERCH_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MERCH_GROUP as MERCH_GROUP", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_1 as SPL_INSTR_1", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SPL_INSTR_2 as SPL_INSTR_2", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ECCN_NBR as ECCN_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_NBR as EXP_LICN_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NMFC_CODE as NMFC_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___FRT_CLASS as FRT_CLASS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___INCUB_DAYS as INCUB_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___INCUB_HOURS as INCUB_HOURS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MONETARY_VALUE as MONETARY_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PROD_CATGRY as PROD_CATGRY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SHELF_DAYS as SHELF_DAYS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___LET_UP_PRTY as LET_UP_PRTY", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PRODUCER_FLAG as PRODUCER_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___NET_COST_FLAG as NET_COST_FLAG", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MARKS_NBRS as MARKS_NBRS", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___MV_SIZE_UOM as MV_SIZE_UOM", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___SRL_NBR_REQD as SRL_NBR_REQD", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"SQ_Shortcut_to_WM_ITEM_WMS_PRE___LOAD_TSTMP as LOAD_TSTMP" \
)

# COMMAND ----------
# Processing node SQ_Shortcut_to_SITE_PROFILE, type SOURCE 
# COLUMN COUNT: 2

SQ_Shortcut_to_SITE_PROFILE = spark.sql(f"""SELECT
SITE_PROFILE.LOCATION_ID,
SITE_PROFILE.STORE_NBR
FROM {site_profile_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node JNR_SITE_PROFILE, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 140

# for each involved DataFrame, append the dataframe name to each column
EXP_INT_CONV_temp = EXP_INT_CONV.toDF(*["EXP_INT_CONV___" + col for col in EXP_INT_CONV.columns])
SQ_Shortcut_to_SITE_PROFILE_temp = SQ_Shortcut_to_SITE_PROFILE.toDF(*["SQ_Shortcut_to_SITE_PROFILE___" + col for col in SQ_Shortcut_to_SITE_PROFILE.columns])

JNR_SITE_PROFILE = SQ_Shortcut_to_SITE_PROFILE_temp.join(EXP_INT_CONV_temp,[SQ_Shortcut_to_SITE_PROFILE_temp.SQ_Shortcut_to_SITE_PROFILE___STORE_NBR == EXP_INT_CONV_temp.EXP_INT_CONV___o_DC_NBR],'inner').selectExpr( \
	"EXP_INT_CONV___o_DC_NBR as DC_NBR", \
	"EXP_INT_CONV___ITEM_ID as ITEM_ID", \
	"EXP_INT_CONV___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"EXP_INT_CONV___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"EXP_INT_CONV___VOLTY_CODE as VOLTY_CODE", \
	"EXP_INT_CONV___PKG_TYPE as PKG_TYPE", \
	"EXP_INT_CONV___PROD_SUB_GRP as PROD_SUB_GRP", \
	"EXP_INT_CONV___PROD_TYPE as PROD_TYPE", \
	"EXP_INT_CONV___PROD_LINE as PROD_LINE", \
	"EXP_INT_CONV___SALE_GRP as SALE_GRP", \
	"EXP_INT_CONV___COORD_1 as COORD_1", \
	"EXP_INT_CONV___COORD_2 as COORD_2", \
	"EXP_INT_CONV___CARTON_TYPE as CARTON_TYPE", \
	"EXP_INT_CONV___UNIT_PRICE as UNIT_PRICE", \
	"EXP_INT_CONV___RETAIL_PRICE as RETAIL_PRICE", \
	"EXP_INT_CONV___OPER_CODE as OPER_CODE", \
	"EXP_INT_CONV___MAX_CASE_QTY as MAX_CASE_QTY", \
	"EXP_INT_CONV___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"EXP_INT_CONV___NEST_VOL as NEST_VOL", \
	"EXP_INT_CONV___NEST_CNT as NEST_CNT", \
	"EXP_INT_CONV___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"EXP_INT_CONV___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"EXP_INT_CONV___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"EXP_INT_CONV___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"EXP_INT_CONV___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"EXP_INT_CONV___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"EXP_INT_CONV___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"EXP_INT_CONV___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"EXP_INT_CONV___AVG_DLY_DMND as AVG_DLY_DMND", \
	"EXP_INT_CONV___WT_TOL_PCNT as WT_TOL_PCNT", \
	"EXP_INT_CONV___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"EXP_INT_CONV___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"EXP_INT_CONV___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"EXP_INT_CONV___ACTVTN_DATE as ACTVTN_DATE", \
	"EXP_INT_CONV___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"EXP_INT_CONV___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"EXP_INT_CONV___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"EXP_INT_CONV___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"EXP_INT_CONV___MFG_DATE_REQD as MFG_DATE_REQD", \
	"EXP_INT_CONV___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"EXP_INT_CONV___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"EXP_INT_CONV___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"EXP_INT_CONV___BATCH_REQD as BATCH_REQD", \
	"EXP_INT_CONV___PROD_STAT_REQD as PROD_STAT_REQD", \
	"EXP_INT_CONV___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"EXP_INT_CONV___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"EXP_INT_CONV___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"EXP_INT_CONV___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"EXP_INT_CONV___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"EXP_INT_CONV___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"EXP_INT_CONV___LOAD_ATTR as LOAD_ATTR", \
	"EXP_INT_CONV___TEMP_ZONE as TEMP_ZONE", \
	"EXP_INT_CONV___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"EXP_INT_CONV___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"EXP_INT_CONV___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"EXP_INT_CONV___CRUSH_CODE as CRUSH_CODE", \
	"EXP_INT_CONV___CONVEY_FLAG as CONVEY_FLAG", \
	"EXP_INT_CONV___STORE_DEPT as STORE_DEPT", \
	"EXP_INT_CONV___MERCH_TYPE as MERCH_TYPE", \
	"EXP_INT_CONV___MERCH_GROUP as MERCH_GROUP", \
	"EXP_INT_CONV___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"EXP_INT_CONV___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"EXP_INT_CONV___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"EXP_INT_CONV___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"EXP_INT_CONV___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"EXP_INT_CONV___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"EXP_INT_CONV___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"EXP_INT_CONV___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"EXP_INT_CONV___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"EXP_INT_CONV___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"EXP_INT_CONV___SPL_INSTR_1 as SPL_INSTR_1", \
	"EXP_INT_CONV___SPL_INSTR_2 as SPL_INSTR_2", \
	"EXP_INT_CONV___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"EXP_INT_CONV___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"EXP_INT_CONV___ECCN_NBR as ECCN_NBR", \
	"EXP_INT_CONV___EXP_LICN_NBR as EXP_LICN_NBR", \
	"EXP_INT_CONV___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"EXP_INT_CONV___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"EXP_INT_CONV___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"EXP_INT_CONV___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"EXP_INT_CONV___NMFC_CODE as NMFC_CODE", \
	"EXP_INT_CONV___FRT_CLASS as FRT_CLASS", \
	"EXP_INT_CONV___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"EXP_INT_CONV___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"EXP_INT_CONV___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"EXP_INT_CONV___INCUB_DAYS as INCUB_DAYS", \
	"EXP_INT_CONV___INCUB_HOURS as INCUB_HOURS", \
	"EXP_INT_CONV___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"EXP_INT_CONV___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"EXP_INT_CONV___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"EXP_INT_CONV___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"EXP_INT_CONV___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"EXP_INT_CONV___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"EXP_INT_CONV___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"EXP_INT_CONV___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"EXP_INT_CONV___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"EXP_INT_CONV___MONETARY_VALUE as MONETARY_VALUE", \
	"EXP_INT_CONV___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"EXP_INT_CONV___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"EXP_INT_CONV___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"EXP_INT_CONV___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"EXP_INT_CONV___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"EXP_INT_CONV___PROD_CATGRY as PROD_CATGRY", \
	"EXP_INT_CONV___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"EXP_INT_CONV___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"EXP_INT_CONV___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"EXP_INT_CONV___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"EXP_INT_CONV___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"EXP_INT_CONV___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"EXP_INT_CONV___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"EXP_INT_CONV___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"EXP_INT_CONV___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"EXP_INT_CONV___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"EXP_INT_CONV___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"EXP_INT_CONV___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"EXP_INT_CONV___SHELF_DAYS as SHELF_DAYS", \
	"EXP_INT_CONV___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"EXP_INT_CONV___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"EXP_INT_CONV___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"EXP_INT_CONV___LET_UP_PRTY as LET_UP_PRTY", \
	"EXP_INT_CONV___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"EXP_INT_CONV___PRODUCER_FLAG as PRODUCER_FLAG", \
	"EXP_INT_CONV___NET_COST_FLAG as NET_COST_FLAG", \
	"EXP_INT_CONV___MARKS_NBRS as MARKS_NBRS", \
	"EXP_INT_CONV___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"EXP_INT_CONV___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"EXP_INT_CONV___MV_SIZE_UOM as MV_SIZE_UOM", \
	"EXP_INT_CONV___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"EXP_INT_CONV___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"EXP_INT_CONV___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"EXP_INT_CONV___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"EXP_INT_CONV___SRL_NBR_REQD as SRL_NBR_REQD", \
	"EXP_INT_CONV___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"EXP_INT_CONV___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"EXP_INT_CONV___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"EXP_INT_CONV___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"EXP_INT_CONV___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"EXP_INT_CONV___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"SQ_Shortcut_to_SITE_PROFILE___LOCATION_ID as LOCATION_ID", \
	"SQ_Shortcut_to_SITE_PROFILE___STORE_NBR as STORE_NBR")

# COMMAND ----------
# Processing node JNR_WM_ITEM_WMS, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 143

# for each involved DataFrame, append the dataframe name to each column
JNR_SITE_PROFILE_temp = JNR_SITE_PROFILE.toDF(*["JNR_SITE_PROFILE___" + col for col in JNR_SITE_PROFILE.columns])
SQ_Shortcut_to_WM_ITEM_WMS_temp = SQ_Shortcut_to_WM_ITEM_WMS.toDF(*["SQ_Shortcut_to_WM_ITEM_WMS___" + col for col in SQ_Shortcut_to_WM_ITEM_WMS.columns])

JNR_WM_ITEM_WMS = SQ_Shortcut_to_WM_ITEM_WMS_temp.join(JNR_SITE_PROFILE_temp,[SQ_Shortcut_to_WM_ITEM_WMS_temp.SQ_Shortcut_to_WM_ITEM_WMS___LOCATION_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___LOCATION_ID, SQ_Shortcut_to_WM_ITEM_WMS_temp.SQ_Shortcut_to_WM_ITEM_WMS___WM_ITEM_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___ITEM_ID],'right_outer').selectExpr( \
	"JNR_SITE_PROFILE___LOCATION_ID as LOCATION_ID", \
	"JNR_SITE_PROFILE___ITEM_ID as ITEM_ID", \
	"JNR_SITE_PROFILE___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"JNR_SITE_PROFILE___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"JNR_SITE_PROFILE___VOLTY_CODE as VOLTY_CODE", \
	"JNR_SITE_PROFILE___PKG_TYPE as PKG_TYPE", \
	"JNR_SITE_PROFILE___PROD_SUB_GRP as PROD_SUB_GRP", \
	"JNR_SITE_PROFILE___PROD_TYPE as PROD_TYPE", \
	"JNR_SITE_PROFILE___PROD_LINE as PROD_LINE", \
	"JNR_SITE_PROFILE___SALE_GRP as SALE_GRP", \
	"JNR_SITE_PROFILE___COORD_1 as COORD_1", \
	"JNR_SITE_PROFILE___COORD_2 as COORD_2", \
	"JNR_SITE_PROFILE___CARTON_TYPE as CARTON_TYPE", \
	"JNR_SITE_PROFILE___UNIT_PRICE as UNIT_PRICE", \
	"JNR_SITE_PROFILE___RETAIL_PRICE as RETAIL_PRICE", \
	"JNR_SITE_PROFILE___OPER_CODE as OPER_CODE", \
	"JNR_SITE_PROFILE___MAX_CASE_QTY as MAX_CASE_QTY", \
	"JNR_SITE_PROFILE___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"JNR_SITE_PROFILE___NEST_VOL as NEST_VOL", \
	"JNR_SITE_PROFILE___NEST_CNT as NEST_CNT", \
	"JNR_SITE_PROFILE___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"JNR_SITE_PROFILE___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"JNR_SITE_PROFILE___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"JNR_SITE_PROFILE___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"JNR_SITE_PROFILE___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"JNR_SITE_PROFILE___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"JNR_SITE_PROFILE___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"JNR_SITE_PROFILE___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"JNR_SITE_PROFILE___AVG_DLY_DMND as AVG_DLY_DMND", \
	"JNR_SITE_PROFILE___WT_TOL_PCNT as WT_TOL_PCNT", \
	"JNR_SITE_PROFILE___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"JNR_SITE_PROFILE___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"JNR_SITE_PROFILE___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"JNR_SITE_PROFILE___ACTVTN_DATE as ACTVTN_DATE", \
	"JNR_SITE_PROFILE___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"JNR_SITE_PROFILE___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"JNR_SITE_PROFILE___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"JNR_SITE_PROFILE___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"JNR_SITE_PROFILE___MFG_DATE_REQD as MFG_DATE_REQD", \
	"JNR_SITE_PROFILE___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"JNR_SITE_PROFILE___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"JNR_SITE_PROFILE___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"JNR_SITE_PROFILE___BATCH_REQD as BATCH_REQD", \
	"JNR_SITE_PROFILE___PROD_STAT_REQD as PROD_STAT_REQD", \
	"JNR_SITE_PROFILE___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"JNR_SITE_PROFILE___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"JNR_SITE_PROFILE___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"JNR_SITE_PROFILE___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"JNR_SITE_PROFILE___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"JNR_SITE_PROFILE___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"JNR_SITE_PROFILE___LOAD_ATTR as LOAD_ATTR", \
	"JNR_SITE_PROFILE___TEMP_ZONE as TEMP_ZONE", \
	"JNR_SITE_PROFILE___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"JNR_SITE_PROFILE___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"JNR_SITE_PROFILE___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"JNR_SITE_PROFILE___CRUSH_CODE as CRUSH_CODE", \
	"JNR_SITE_PROFILE___CONVEY_FLAG as CONVEY_FLAG", \
	"JNR_SITE_PROFILE___STORE_DEPT as STORE_DEPT", \
	"JNR_SITE_PROFILE___MERCH_TYPE as MERCH_TYPE", \
	"JNR_SITE_PROFILE___MERCH_GROUP as MERCH_GROUP", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"JNR_SITE_PROFILE___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"JNR_SITE_PROFILE___SPL_INSTR_1 as SPL_INSTR_1", \
	"JNR_SITE_PROFILE___SPL_INSTR_2 as SPL_INSTR_2", \
	"JNR_SITE_PROFILE___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"JNR_SITE_PROFILE___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"JNR_SITE_PROFILE___ECCN_NBR as ECCN_NBR", \
	"JNR_SITE_PROFILE___EXP_LICN_NBR as EXP_LICN_NBR", \
	"JNR_SITE_PROFILE___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"JNR_SITE_PROFILE___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"JNR_SITE_PROFILE___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"JNR_SITE_PROFILE___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"JNR_SITE_PROFILE___NMFC_CODE as NMFC_CODE", \
	"JNR_SITE_PROFILE___FRT_CLASS as FRT_CLASS", \
	"JNR_SITE_PROFILE___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"JNR_SITE_PROFILE___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"JNR_SITE_PROFILE___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"JNR_SITE_PROFILE___INCUB_DAYS as INCUB_DAYS", \
	"JNR_SITE_PROFILE___INCUB_HOURS as INCUB_HOURS", \
	"JNR_SITE_PROFILE___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"JNR_SITE_PROFILE___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"JNR_SITE_PROFILE___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"JNR_SITE_PROFILE___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"JNR_SITE_PROFILE___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"JNR_SITE_PROFILE___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"JNR_SITE_PROFILE___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"JNR_SITE_PROFILE___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"JNR_SITE_PROFILE___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"JNR_SITE_PROFILE___MONETARY_VALUE as MONETARY_VALUE", \
	"JNR_SITE_PROFILE___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"JNR_SITE_PROFILE___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"JNR_SITE_PROFILE___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"JNR_SITE_PROFILE___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"JNR_SITE_PROFILE___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"JNR_SITE_PROFILE___PROD_CATGRY as PROD_CATGRY", \
	"JNR_SITE_PROFILE___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"JNR_SITE_PROFILE___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"JNR_SITE_PROFILE___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"JNR_SITE_PROFILE___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"JNR_SITE_PROFILE___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"JNR_SITE_PROFILE___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"JNR_SITE_PROFILE___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"JNR_SITE_PROFILE___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"JNR_SITE_PROFILE___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"JNR_SITE_PROFILE___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"JNR_SITE_PROFILE___SHELF_DAYS as SHELF_DAYS", \
	"JNR_SITE_PROFILE___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"JNR_SITE_PROFILE___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"JNR_SITE_PROFILE___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"JNR_SITE_PROFILE___LET_UP_PRTY as LET_UP_PRTY", \
	"JNR_SITE_PROFILE___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"JNR_SITE_PROFILE___PRODUCER_FLAG as PRODUCER_FLAG", \
	"JNR_SITE_PROFILE___NET_COST_FLAG as NET_COST_FLAG", \
	"JNR_SITE_PROFILE___MARKS_NBRS as MARKS_NBRS", \
	"JNR_SITE_PROFILE___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"JNR_SITE_PROFILE___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"JNR_SITE_PROFILE___MV_SIZE_UOM as MV_SIZE_UOM", \
	"JNR_SITE_PROFILE___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"JNR_SITE_PROFILE___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"JNR_SITE_PROFILE___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"JNR_SITE_PROFILE___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"JNR_SITE_PROFILE___SRL_NBR_REQD as SRL_NBR_REQD", \
	"JNR_SITE_PROFILE___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"JNR_SITE_PROFILE___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"JNR_SITE_PROFILE___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"JNR_SITE_PROFILE___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"JNR_SITE_PROFILE___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"JNR_SITE_PROFILE___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"SQ_Shortcut_to_WM_ITEM_WMS___LOCATION_ID as in_LOCATION_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS___WM_ITEM_ID as in_WM_ITEM_ID", \
	"SQ_Shortcut_to_WM_ITEM_WMS___WM_AUDIT_CREATED_TSTMP as in_WM_AUDIT_CREATED_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_WMS___WM_AUDIT_LAST_UPDATED_TSTMP as in_WM_AUDIT_LAST_UPDATED_TSTMP", \
	"SQ_Shortcut_to_WM_ITEM_WMS___LOAD_TSTMP as in_LOAD_TSTMP")

# COMMAND ----------
# Processing node FIL_UNCHANGED_REC, type FILTER 
# COLUMN COUNT: 143

# for each involved DataFrame, append the dataframe name to each column
JNR_WM_ITEM_WMS_temp = JNR_WM_ITEM_WMS.toDF(*["JNR_WM_ITEM_WMS___" + col for col in JNR_WM_ITEM_WMS.columns])

FIL_UNCHANGED_REC = JNR_WM_ITEM_WMS_temp.selectExpr( \
	"JNR_WM_ITEM_WMS___LOCATION_ID as LOCATION_ID", \
	"JNR_WM_ITEM_WMS___ITEM_ID as ITEM_ID", \
	"JNR_WM_ITEM_WMS___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"JNR_WM_ITEM_WMS___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"JNR_WM_ITEM_WMS___VOLTY_CODE as VOLTY_CODE", \
	"JNR_WM_ITEM_WMS___PKG_TYPE as PKG_TYPE", \
	"JNR_WM_ITEM_WMS___PROD_SUB_GRP as PROD_SUB_GRP", \
	"JNR_WM_ITEM_WMS___PROD_TYPE as PROD_TYPE", \
	"JNR_WM_ITEM_WMS___PROD_LINE as PROD_LINE", \
	"JNR_WM_ITEM_WMS___SALE_GRP as SALE_GRP", \
	"JNR_WM_ITEM_WMS___COORD_1 as COORD_1", \
	"JNR_WM_ITEM_WMS___COORD_2 as COORD_2", \
	"JNR_WM_ITEM_WMS___CARTON_TYPE as CARTON_TYPE", \
	"JNR_WM_ITEM_WMS___UNIT_PRICE as UNIT_PRICE", \
	"JNR_WM_ITEM_WMS___RETAIL_PRICE as RETAIL_PRICE", \
	"JNR_WM_ITEM_WMS___OPER_CODE as OPER_CODE", \
	"JNR_WM_ITEM_WMS___MAX_CASE_QTY as MAX_CASE_QTY", \
	"JNR_WM_ITEM_WMS___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"JNR_WM_ITEM_WMS___NEST_VOL as NEST_VOL", \
	"JNR_WM_ITEM_WMS___NEST_CNT as NEST_CNT", \
	"JNR_WM_ITEM_WMS___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"JNR_WM_ITEM_WMS___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"JNR_WM_ITEM_WMS___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"JNR_WM_ITEM_WMS___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"JNR_WM_ITEM_WMS___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"JNR_WM_ITEM_WMS___AVG_DLY_DMND as AVG_DLY_DMND", \
	"JNR_WM_ITEM_WMS___WT_TOL_PCNT as WT_TOL_PCNT", \
	"JNR_WM_ITEM_WMS___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"JNR_WM_ITEM_WMS___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"JNR_WM_ITEM_WMS___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"JNR_WM_ITEM_WMS___ACTVTN_DATE as ACTVTN_DATE", \
	"JNR_WM_ITEM_WMS___ALLOW_RCPT_OLDER_ITEM as ALLOW_RCPT_OLDER_ITEM", \
	"JNR_WM_ITEM_WMS___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"JNR_WM_ITEM_WMS___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"JNR_WM_ITEM_WMS___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"JNR_WM_ITEM_WMS___MFG_DATE_REQD as MFG_DATE_REQD", \
	"JNR_WM_ITEM_WMS___XPIRE_DATE_REQD as XPIRE_DATE_REQD", \
	"JNR_WM_ITEM_WMS___SHIP_BY_DATE_REQD as SHIP_BY_DATE_REQD", \
	"JNR_WM_ITEM_WMS___ITEM_ATTR_REQD as ITEM_ATTR_REQD", \
	"JNR_WM_ITEM_WMS___BATCH_REQD as BATCH_REQD", \
	"JNR_WM_ITEM_WMS___PROD_STAT_REQD as PROD_STAT_REQD", \
	"JNR_WM_ITEM_WMS___CNTRY_OF_ORGN_REQD as CNTRY_OF_ORGN_REQD", \
	"JNR_WM_ITEM_WMS___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"JNR_WM_ITEM_WMS___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"JNR_WM_ITEM_WMS___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"JNR_WM_ITEM_WMS___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"JNR_WM_ITEM_WMS___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"JNR_WM_ITEM_WMS___LOAD_ATTR as LOAD_ATTR", \
	"JNR_WM_ITEM_WMS___TEMP_ZONE as TEMP_ZONE", \
	"JNR_WM_ITEM_WMS___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"JNR_WM_ITEM_WMS___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"JNR_WM_ITEM_WMS___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"JNR_WM_ITEM_WMS___CRUSH_CODE as CRUSH_CODE", \
	"JNR_WM_ITEM_WMS___CONVEY_FLAG as CONVEY_FLAG", \
	"JNR_WM_ITEM_WMS___STORE_DEPT as STORE_DEPT", \
	"JNR_WM_ITEM_WMS___MERCH_TYPE as MERCH_TYPE", \
	"JNR_WM_ITEM_WMS___MERCH_GROUP as MERCH_GROUP", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_1 as SPL_INSTR_1", \
	"JNR_WM_ITEM_WMS___SPL_INSTR_2 as SPL_INSTR_2", \
	"JNR_WM_ITEM_WMS___PROMPT_FOR_VENDOR_ITEM_NBR as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"JNR_WM_ITEM_WMS___PROMPT_PACK_QTY as PROMPT_PACK_QTY", \
	"JNR_WM_ITEM_WMS___ECCN_NBR as ECCN_NBR", \
	"JNR_WM_ITEM_WMS___EXP_LICN_NBR as EXP_LICN_NBR", \
	"JNR_WM_ITEM_WMS___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"JNR_WM_ITEM_WMS___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"JNR_WM_ITEM_WMS___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"JNR_WM_ITEM_WMS___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"JNR_WM_ITEM_WMS___NMFC_CODE as NMFC_CODE", \
	"JNR_WM_ITEM_WMS___FRT_CLASS as FRT_CLASS", \
	"JNR_WM_ITEM_WMS___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"JNR_WM_ITEM_WMS___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"JNR_WM_ITEM_WMS___BASE_INCUB_FLAG as BASE_INCUB_FLAG", \
	"JNR_WM_ITEM_WMS___INCUB_DAYS as INCUB_DAYS", \
	"JNR_WM_ITEM_WMS___INCUB_HOURS as INCUB_HOURS", \
	"JNR_WM_ITEM_WMS___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"JNR_WM_ITEM_WMS___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"JNR_WM_ITEM_WMS___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"JNR_WM_ITEM_WMS___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"JNR_WM_ITEM_WMS___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"JNR_WM_ITEM_WMS___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"JNR_WM_ITEM_WMS___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"JNR_WM_ITEM_WMS___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"JNR_WM_ITEM_WMS___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"JNR_WM_ITEM_WMS___MONETARY_VALUE as MONETARY_VALUE", \
	"JNR_WM_ITEM_WMS___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"JNR_WM_ITEM_WMS___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"JNR_WM_ITEM_WMS___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"JNR_WM_ITEM_WMS___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"JNR_WM_ITEM_WMS___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"JNR_WM_ITEM_WMS___PROD_CATGRY as PROD_CATGRY", \
	"JNR_WM_ITEM_WMS___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"JNR_WM_ITEM_WMS___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"JNR_WM_ITEM_WMS___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"JNR_WM_ITEM_WMS___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"JNR_WM_ITEM_WMS___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"JNR_WM_ITEM_WMS___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"JNR_WM_ITEM_WMS___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"JNR_WM_ITEM_WMS___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"JNR_WM_ITEM_WMS___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"JNR_WM_ITEM_WMS___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"JNR_WM_ITEM_WMS___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"JNR_WM_ITEM_WMS___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"JNR_WM_ITEM_WMS___SHELF_DAYS as SHELF_DAYS", \
	"JNR_WM_ITEM_WMS___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"JNR_WM_ITEM_WMS___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"JNR_WM_ITEM_WMS___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"JNR_WM_ITEM_WMS___LET_UP_PRTY as LET_UP_PRTY", \
	"JNR_WM_ITEM_WMS___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"JNR_WM_ITEM_WMS___PRODUCER_FLAG as PRODUCER_FLAG", \
	"JNR_WM_ITEM_WMS___NET_COST_FLAG as NET_COST_FLAG", \
	"JNR_WM_ITEM_WMS___MARKS_NBRS as MARKS_NBRS", \
	"JNR_WM_ITEM_WMS___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"JNR_WM_ITEM_WMS___PRICE_TIX_AVAIL as PRICE_TIX_AVAIL", \
	"JNR_WM_ITEM_WMS___MV_SIZE_UOM as MV_SIZE_UOM", \
	"JNR_WM_ITEM_WMS___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"JNR_WM_ITEM_WMS___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"JNR_WM_ITEM_WMS___SRL_NBR_REQD as SRL_NBR_REQD", \
	"JNR_WM_ITEM_WMS___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"JNR_WM_ITEM_WMS___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"JNR_WM_ITEM_WMS___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"JNR_WM_ITEM_WMS___in_LOCATION_ID as in_LOCATION_ID", \
	"JNR_WM_ITEM_WMS___in_WM_ITEM_ID as in_WM_ITEM_ID", \
	"JNR_WM_ITEM_WMS___in_WM_AUDIT_CREATED_TSTMP as in_WM_AUDIT_CREATED_TSTMP", \
	"JNR_WM_ITEM_WMS___in_WM_AUDIT_LAST_UPDATED_TSTMP as in_WM_AUDIT_LAST_UPDATED_TSTMP", \
	"JNR_WM_ITEM_WMS___in_LOAD_TSTMP as in_LOAD_TSTMP")\
    .filter("in_WM_ITEM_ID is Null OR ( in_WM_ITEM_ID is Null AND\
     ( COALESCE(AUDIT_CREATED_DTTM, date'1900-01-01') != COALESCE(in_WM_AUDIT_CREATED_TSTMP, date'1900-01-01') \
    OR COALESCE(AUDIT_LAST_UPDATED_DTTM, date'1900-01-01') != COALESCE(in_WM_AUDIT_LAST_UPDATED_TSTMP, date'1900-01-01')))").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_EVALUATE, type EXPRESSION 
# COLUMN COUNT: 144

# for each involved DataFrame, append the dataframe name to each column
FIL_UNCHANGED_REC_temp = FIL_UNCHANGED_REC.toDF(*["FIL_UNCHANGED_REC___" + col for col in FIL_UNCHANGED_REC.columns])

EXP_EVALUATE = FIL_UNCHANGED_REC_temp.selectExpr( \
	"FIL_UNCHANGED_REC___sys_row_id as sys_row_id", \
	"FIL_UNCHANGED_REC___LOCATION_ID as LOCATION_ID", \
	"FIL_UNCHANGED_REC___ITEM_ID as ITEM_ID", \
	"FIL_UNCHANGED_REC___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"FIL_UNCHANGED_REC___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"FIL_UNCHANGED_REC___VOLTY_CODE as VOLTY_CODE", \
	"FIL_UNCHANGED_REC___PKG_TYPE as PKG_TYPE", \
	"FIL_UNCHANGED_REC___PROD_SUB_GRP as PROD_SUB_GRP", \
	"FIL_UNCHANGED_REC___PROD_TYPE as PROD_TYPE", \
	"FIL_UNCHANGED_REC___PROD_LINE as PROD_LINE", \
	"FIL_UNCHANGED_REC___SALE_GRP as SALE_GRP", \
	"FIL_UNCHANGED_REC___COORD_1 as COORD_1", \
	"FIL_UNCHANGED_REC___COORD_2 as COORD_2", \
	"FIL_UNCHANGED_REC___CARTON_TYPE as CARTON_TYPE", \
	"FIL_UNCHANGED_REC___UNIT_PRICE as UNIT_PRICE", \
	"FIL_UNCHANGED_REC___RETAIL_PRICE as RETAIL_PRICE", \
	"FIL_UNCHANGED_REC___OPER_CODE as OPER_CODE", \
	"FIL_UNCHANGED_REC___MAX_CASE_QTY as MAX_CASE_QTY", \
	"FIL_UNCHANGED_REC___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"FIL_UNCHANGED_REC___NEST_VOL as NEST_VOL", \
	"FIL_UNCHANGED_REC___NEST_CNT as NEST_CNT", \
	"FIL_UNCHANGED_REC___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"FIL_UNCHANGED_REC___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"FIL_UNCHANGED_REC___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"FIL_UNCHANGED_REC___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"FIL_UNCHANGED_REC___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"FIL_UNCHANGED_REC___AVG_DLY_DMND as AVG_DLY_DMND", \
	"FIL_UNCHANGED_REC___WT_TOL_PCNT as WT_TOL_PCNT", \
	"FIL_UNCHANGED_REC___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"FIL_UNCHANGED_REC___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"FIL_UNCHANGED_REC___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"FIL_UNCHANGED_REC___ACTVTN_DATE as ACTVTN_DATE", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___ALLOW_RCPT_OLDER_ITEM ) ) ) , '1','1' , 'Y','1','0' ) as ALLOW_RCPT_OLDER_ITEM_EXP", \
	"FIL_UNCHANGED_REC___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"FIL_UNCHANGED_REC___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"FIL_UNCHANGED_REC___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___MFG_DATE_REQD ) ) ) , '1','1' , 'Y','1','0' ) as MFG_DATE_REQD_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___XPIRE_DATE_REQD ) ) ) , '1','1' , 'Y','1','0' ) as XPIRE_DATE_REQD_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___SHIP_BY_DATE_REQD ) ) ) , '1','1' , 'Y','1','0' ) as SHIP_BY_DATE_REQD_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___ITEM_ATTR_REQD ) ) ) , '1','1' , 'Y','1','0' ) as ITEM_ATTR_REQD_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___BATCH_REQD ) ) ) , '1','1' , 'Y','1','0' ) as BATCH_REQD_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___PROD_STAT_REQD ) ) ) , '1','1' , 'Y','1','0' ) as PROD_STAT_REQD_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___CNTRY_OF_ORGN_REQD ) ) ) , '1','1' , 'Y','1','0' ) as CNTRY_OF_ORGN_REQD_EXP", \
	"FIL_UNCHANGED_REC___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"FIL_UNCHANGED_REC___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"FIL_UNCHANGED_REC___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"FIL_UNCHANGED_REC___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"FIL_UNCHANGED_REC___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"FIL_UNCHANGED_REC___LOAD_ATTR as LOAD_ATTR", \
	"FIL_UNCHANGED_REC___TEMP_ZONE as TEMP_ZONE", \
	"FIL_UNCHANGED_REC___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"FIL_UNCHANGED_REC___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"FIL_UNCHANGED_REC___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"FIL_UNCHANGED_REC___CRUSH_CODE as CRUSH_CODE", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___CONVEY_FLAG ) ) ) , '1','1' , 'Y','1','0' ) as CONVEY_FLAG_EXP", \
	"FIL_UNCHANGED_REC___STORE_DEPT as STORE_DEPT", \
	"FIL_UNCHANGED_REC___MERCH_TYPE as MERCH_TYPE", \
	"FIL_UNCHANGED_REC___MERCH_GROUP as MERCH_GROUP", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"FIL_UNCHANGED_REC___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"FIL_UNCHANGED_REC___SPL_INSTR_1 as SPL_INSTR_1", \
	"FIL_UNCHANGED_REC___SPL_INSTR_2 as SPL_INSTR_2", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___PROMPT_FOR_VENDOR_ITEM_NBR ) ) ) , '1','1' , 'Y','1','0' ) as PROMPT_FOR_VENDOR_ITEM_NBR_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___PROMPT_PACK_QTY ) ) ) , '1','1' , 'Y','1','0' ) as PROMPT_PACK_QTY_EXP", \
	"FIL_UNCHANGED_REC___ECCN_NBR as ECCN_NBR", \
	"FIL_UNCHANGED_REC___EXP_LICN_NBR as EXP_LICN_NBR", \
	"FIL_UNCHANGED_REC___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"FIL_UNCHANGED_REC___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"FIL_UNCHANGED_REC___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"FIL_UNCHANGED_REC___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"FIL_UNCHANGED_REC___NMFC_CODE as NMFC_CODE", \
	"FIL_UNCHANGED_REC___FRT_CLASS as FRT_CLASS", \
	"FIL_UNCHANGED_REC___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"FIL_UNCHANGED_REC___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___BASE_INCUB_FLAG ) ) ) , '1','1' , 'Y','1','0' ) as BASE_INCUB_FLAG_EXP", \
	"FIL_UNCHANGED_REC___INCUB_DAYS as INCUB_DAYS", \
	"FIL_UNCHANGED_REC___INCUB_HOURS as INCUB_HOURS", \
	"FIL_UNCHANGED_REC___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"FIL_UNCHANGED_REC___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"FIL_UNCHANGED_REC___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"FIL_UNCHANGED_REC___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"FIL_UNCHANGED_REC___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"FIL_UNCHANGED_REC___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"FIL_UNCHANGED_REC___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"FIL_UNCHANGED_REC___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"FIL_UNCHANGED_REC___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"FIL_UNCHANGED_REC___MONETARY_VALUE as MONETARY_VALUE", \
	"FIL_UNCHANGED_REC___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"FIL_UNCHANGED_REC___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"FIL_UNCHANGED_REC___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"FIL_UNCHANGED_REC___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"FIL_UNCHANGED_REC___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"FIL_UNCHANGED_REC___PROD_CATGRY as PROD_CATGRY", \
	"FIL_UNCHANGED_REC___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"FIL_UNCHANGED_REC___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_REC___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"FIL_UNCHANGED_REC___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"FIL_UNCHANGED_REC___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_REC___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"FIL_UNCHANGED_REC___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"FIL_UNCHANGED_REC___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"FIL_UNCHANGED_REC___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"FIL_UNCHANGED_REC___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"FIL_UNCHANGED_REC___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"FIL_UNCHANGED_REC___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"FIL_UNCHANGED_REC___SHELF_DAYS as SHELF_DAYS", \
	"FIL_UNCHANGED_REC___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"FIL_UNCHANGED_REC___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"FIL_UNCHANGED_REC___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"FIL_UNCHANGED_REC___LET_UP_PRTY as LET_UP_PRTY", \
	"FIL_UNCHANGED_REC___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"FIL_UNCHANGED_REC___PRODUCER_FLAG as PRODUCER_FLAG", \
	"FIL_UNCHANGED_REC___NET_COST_FLAG as NET_COST_FLAG", \
	"FIL_UNCHANGED_REC___MARKS_NBRS as MARKS_NBRS", \
	"FIL_UNCHANGED_REC___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_REC___PRICE_TIX_AVAIL ) ) ) , '1','1' , 'Y','1','0' ) as PRICE_TIX_AVAIL_EXP", \
	"FIL_UNCHANGED_REC___MV_SIZE_UOM as MV_SIZE_UOM", \
	"FIL_UNCHANGED_REC___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"FIL_UNCHANGED_REC___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"FIL_UNCHANGED_REC___SRL_NBR_REQD as SRL_NBR_REQD", \
	"FIL_UNCHANGED_REC___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"FIL_UNCHANGED_REC___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"FIL_UNCHANGED_REC___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"FIL_UNCHANGED_REC___in_LOCATION_ID as in_LOCATION_ID", \
	"FIL_UNCHANGED_REC___in_WM_ITEM_ID as in_WM_ITEM_ID", \
	"FIL_UNCHANGED_REC___in_WM_AUDIT_CREATED_TSTMP as in_WM_AUDIT_CREATED_TSTMP", \
	"FIL_UNCHANGED_REC___in_WM_AUDIT_LAST_UPDATED_TSTMP as in_WM_AUDIT_LAST_UPDATED_TSTMP", \
	"IF (FIL_UNCHANGED_REC___in_LOAD_TSTMP IS NULL, CURRENT_TIMESTAMP, FIL_UNCHANGED_REC___in_LOAD_TSTMP) as LOAD_TSTMP", \
	"CURRENT_TIMESTAMP as UPDATE_TSTMP" \
)

# COMMAND ----------
# Processing node UPD_INS_UPD, type UPDATE_STRATEGY . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 141

# for each involved DataFrame, append the dataframe name to each column
EXP_EVALUATE_temp = EXP_EVALUATE.toDF(*["EXP_EVALUATE___" + col for col in EXP_EVALUATE.columns])

UPD_INS_UPD = EXP_EVALUATE_temp.selectExpr( \
	"EXP_EVALUATE___LOCATION_ID as LOCATION_ID", \
	"EXP_EVALUATE___ITEM_ID as ITEM_ID", \
	"EXP_EVALUATE___SIZE_RANGE_CODE as SIZE_RANGE_CODE", \
	"EXP_EVALUATE___SIZE_REL_POSN_IN_TABLE as SIZE_REL_POSN_IN_TABLE", \
	"EXP_EVALUATE___VOLTY_CODE as VOLTY_CODE", \
	"EXP_EVALUATE___PKG_TYPE as PKG_TYPE", \
	"EXP_EVALUATE___PROD_SUB_GRP as PROD_SUB_GRP", \
	"EXP_EVALUATE___PROD_TYPE as PROD_TYPE", \
	"EXP_EVALUATE___PROD_LINE as PROD_LINE", \
	"EXP_EVALUATE___SALE_GRP as SALE_GRP", \
	"EXP_EVALUATE___COORD_1 as COORD_1", \
	"EXP_EVALUATE___COORD_2 as COORD_2", \
	"EXP_EVALUATE___CARTON_TYPE as CARTON_TYPE", \
	"EXP_EVALUATE___UNIT_PRICE as UNIT_PRICE", \
	"EXP_EVALUATE___RETAIL_PRICE as RETAIL_PRICE", \
	"EXP_EVALUATE___OPER_CODE as OPER_CODE", \
	"EXP_EVALUATE___MAX_CASE_QTY as MAX_CASE_QTY", \
	"EXP_EVALUATE___CUBE_MULT_QTY as CUBE_MULT_QTY", \
	"EXP_EVALUATE___NEST_VOL as NEST_VOL", \
	"EXP_EVALUATE___NEST_CNT as NEST_CNT", \
	"EXP_EVALUATE___UNITS_PER_PICK_ACTIVE as UNITS_PER_PICK_ACTIVE", \
	"EXP_EVALUATE___HNDL_ATTR_ACTIVE as HNDL_ATTR_ACTIVE", \
	"EXP_EVALUATE___UNITS_PER_PICK_CASE_PICK as UNITS_PER_PICK_CASE_PICK", \
	"EXP_EVALUATE___HNDL_ATTR_CASE_PICK as HNDL_ATTR_CASE_PICK", \
	"EXP_EVALUATE___UNITS_PER_PICK_RESV as UNITS_PER_PICK_RESV", \
	"EXP_EVALUATE___HNDL_ATTR_RESV as HNDL_ATTR_RESV", \
	"EXP_EVALUATE___PROD_LIFE_IN_DAY as PROD_LIFE_IN_DAY", \
	"EXP_EVALUATE___MAX_RECV_TO_XPIRE_DAYS as MAX_RECV_TO_XPIRE_DAYS", \
	"EXP_EVALUATE___AVG_DLY_DMND as AVG_DLY_DMND", \
	"EXP_EVALUATE___WT_TOL_PCNT as WT_TOL_PCNT", \
	"EXP_EVALUATE___CONS_PRTY_DATE_CODE as CONS_PRTY_DATE_CODE", \
	"EXP_EVALUATE___CONS_PRTY_DATE_WINDOW as CONS_PRTY_DATE_WINDOW", \
	"EXP_EVALUATE___CONS_PRTY_DATE_WINDOW_INCR as CONS_PRTY_DATE_WINDOW_INCR", \
	"EXP_EVALUATE___ACTVTN_DATE as ACTVTN_DATE", \
	"EXP_EVALUATE___ALLOW_RCPT_OLDER_ITEM_EXP as ALLOW_RCPT_OLDER_ITEM", \
	"EXP_EVALUATE___CRITCL_DIM_1 as CRITCL_DIM_1", \
	"EXP_EVALUATE___CRITCL_DIM_2 as CRITCL_DIM_2", \
	"EXP_EVALUATE___CRITCL_DIM_3 as CRITCL_DIM_3", \
	"EXP_EVALUATE___MFG_DATE_REQD_EXP as MFG_DATE_REQD", \
	"EXP_EVALUATE___XPIRE_DATE_REQD_EXP as XPIRE_DATE_REQD", \
	"EXP_EVALUATE___SHIP_BY_DATE_REQD_EXP as SHIP_BY_DATE_REQD", \
	"EXP_EVALUATE___ITEM_ATTR_REQD_EXP as ITEM_ATTR_REQD", \
	"EXP_EVALUATE___BATCH_REQD_EXP as BATCH_REQD", \
	"EXP_EVALUATE___PROD_STAT_REQD_EXP as PROD_STAT_REQD", \
	"EXP_EVALUATE___CNTRY_OF_ORGN_REQD_EXP as CNTRY_OF_ORGN_REQD", \
	"EXP_EVALUATE___VENDOR_ITEM_NBR as VENDOR_ITEM_NBR", \
	"EXP_EVALUATE___PICK_WT_TOL_TYPE as PICK_WT_TOL_TYPE", \
	"EXP_EVALUATE___PICK_WT_TOL_AMNT as PICK_WT_TOL_AMNT", \
	"EXP_EVALUATE___MHE_WT_TOL_TYPE as MHE_WT_TOL_TYPE", \
	"EXP_EVALUATE___MHE_WT_TOL_AMNT as MHE_WT_TOL_AMNT", \
	"EXP_EVALUATE___LOAD_ATTR as LOAD_ATTR", \
	"EXP_EVALUATE___TEMP_ZONE as TEMP_ZONE", \
	"EXP_EVALUATE___TRLR_TEMP_ZONE as TRLR_TEMP_ZONE", \
	"EXP_EVALUATE___PKT_CONSOL_ATTR as PKT_CONSOL_ATTR", \
	"EXP_EVALUATE___BUYER_DISP_CODE as BUYER_DISP_CODE", \
	"EXP_EVALUATE___CRUSH_CODE as CRUSH_CODE", \
	"EXP_EVALUATE___CONVEY_FLAG_EXP as CONVEY_FLAG", \
	"EXP_EVALUATE___STORE_DEPT as STORE_DEPT", \
	"EXP_EVALUATE___MERCH_TYPE as MERCH_TYPE", \
	"EXP_EVALUATE___MERCH_GROUP as MERCH_GROUP", \
	"EXP_EVALUATE___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
	"EXP_EVALUATE___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
	"EXP_EVALUATE___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
	"EXP_EVALUATE___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
	"EXP_EVALUATE___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
	"EXP_EVALUATE___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
	"EXP_EVALUATE___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
	"EXP_EVALUATE___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
	"EXP_EVALUATE___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
	"EXP_EVALUATE___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
	"EXP_EVALUATE___SPL_INSTR_1 as SPL_INSTR_1", \
	"EXP_EVALUATE___SPL_INSTR_2 as SPL_INSTR_2", \
	"EXP_EVALUATE___PROMPT_FOR_VENDOR_ITEM_NBR_EXP as PROMPT_FOR_VENDOR_ITEM_NBR", \
	"EXP_EVALUATE___PROMPT_PACK_QTY_EXP as PROMPT_PACK_QTY", \
	"EXP_EVALUATE___ECCN_NBR as ECCN_NBR", \
	"EXP_EVALUATE___EXP_LICN_NBR as EXP_LICN_NBR", \
	"EXP_EVALUATE___EXP_LICN_XP_DATE as EXP_LICN_XP_DATE", \
	"EXP_EVALUATE___EXP_LICN_SYMBOL as EXP_LICN_SYMBOL", \
	"EXP_EVALUATE___ORGN_CERT_CODE as ORGN_CERT_CODE", \
	"EXP_EVALUATE___ITAR_EXEMPT_NBR as ITAR_EXEMPT_NBR", \
	"EXP_EVALUATE___NMFC_CODE as NMFC_CODE", \
	"EXP_EVALUATE___FRT_CLASS as FRT_CLASS", \
	"EXP_EVALUATE___DFLT_BATCH_STAT as DFLT_BATCH_STAT", \
	"EXP_EVALUATE___DFLT_INCUB_LOCK as DFLT_INCUB_LOCK", \
	"EXP_EVALUATE___BASE_INCUB_FLAG_EXP as BASE_INCUB_FLAG", \
	"EXP_EVALUATE___INCUB_DAYS as INCUB_DAYS", \
	"EXP_EVALUATE___INCUB_HOURS as INCUB_HOURS", \
	"EXP_EVALUATE___SRL_NBR_BRCD_TYPE as SRL_NBR_BRCD_TYPE", \
	"EXP_EVALUATE___MINOR_SRL_NBR_REQ as MINOR_SRL_NBR_REQ", \
	"EXP_EVALUATE___DUP_SRL_NBR_FLAG as DUP_SRL_NBR_FLAG", \
	"EXP_EVALUATE___MAX_RCPT_QTY as MAX_RCPT_QTY", \
	"EXP_EVALUATE___VOCOLLECT_BASE_WT as VOCOLLECT_BASE_WT", \
	"EXP_EVALUATE___VOCOLLECT_BASE_QTY as VOCOLLECT_BASE_QTY", \
	"EXP_EVALUATE___VOCOLLECT_BASE_ITEM as VOCOLLECT_BASE_ITEM", \
	"EXP_EVALUATE___PICK_WT_TOL_AMNT_ERROR as PICK_WT_TOL_AMNT_ERROR", \
	"EXP_EVALUATE___PRICE_TKT_TYPE as PRICE_TKT_TYPE", \
	"EXP_EVALUATE___MONETARY_VALUE as MONETARY_VALUE", \
	"EXP_EVALUATE___MV_CURRENCY_CODE as MV_CURRENCY_CODE", \
	"EXP_EVALUATE___CODE_DATE_PROMPT_METHOD_FLAG as CODE_DATE_PROMPT_METHOD_FLAG", \
	"EXP_EVALUATE___MIN_RECV_TO_XPIRE_DAYS as MIN_RECV_TO_XPIRE_DAYS", \
	"EXP_EVALUATE___MIN_PCNT_FOR_LPN_SPLIT as MIN_PCNT_FOR_LPN_SPLIT", \
	"EXP_EVALUATE___MIN_LPN_QTY_FOR_SPLIT as MIN_LPN_QTY_FOR_SPLIT", \
	"EXP_EVALUATE___PROD_CATGRY as PROD_CATGRY", \
	"EXP_EVALUATE___AUDIT_CREATED_SOURCE as AUDIT_CREATED_SOURCE", \
	"EXP_EVALUATE___AUDIT_CREATED_SOURCE_TYPE as AUDIT_CREATED_SOURCE_TYPE", \
	"EXP_EVALUATE___AUDIT_CREATED_DTTM as AUDIT_CREATED_DTTM", \
	"EXP_EVALUATE___AUDIT_LAST_UPDATED_SOURCE as AUDIT_LAST_UPDATED_SOURCE", \
	"EXP_EVALUATE___AUDIT_LAST_UPDATED_SOURCE_TYPE as AUDIT_LAST_UPDATED_SOURCE_TYPE", \
	"EXP_EVALUATE___AUDIT_LAST_UPDATED_DTTM as AUDIT_LAST_UPDATED_DTTM", \
	"EXP_EVALUATE___MARK_FOR_DELETION as MARK_FOR_DELETION", \
	"EXP_EVALUATE___TOP_SHELF_ELIGIBLE as TOP_SHELF_ELIGIBLE", \
	"EXP_EVALUATE___VOCO_ABS_PICK_TOL_AMT as VOCO_ABS_PICK_TOL_AMT", \
	"EXP_EVALUATE___CARTON_CNT_DATE_TIME as CARTON_CNT_DATE_TIME", \
	"EXP_EVALUATE___TRANS_INVN_CNT_DATE_TIME as TRANS_INVN_CNT_DATE_TIME", \
	"EXP_EVALUATE___WORK_ORD_CNT_DATE_TIME as WORK_ORD_CNT_DATE_TIME", \
	"EXP_EVALUATE___SHELF_DAYS as SHELF_DAYS", \
	"EXP_EVALUATE___VENDOR_MASTER_ID as VENDOR_MASTER_ID", \
	"EXP_EVALUATE___NBR_OF_DYN_ACTV_PICK_PER_SKU as NBR_OF_DYN_ACTV_PICK_PER_SKU", \
	"EXP_EVALUATE___NBR_OF_DYN_CASE_PICK_PER_SKU as NBR_OF_DYN_CASE_PICK_PER_SKU", \
	"EXP_EVALUATE___LET_UP_PRTY as LET_UP_PRTY", \
	"EXP_EVALUATE___PREF_CRITERIA_FLAG as PREF_CRITERIA_FLAG", \
	"EXP_EVALUATE___PRODUCER_FLAG as PRODUCER_FLAG", \
	"EXP_EVALUATE___NET_COST_FLAG as NET_COST_FLAG", \
	"EXP_EVALUATE___MARKS_NBRS as MARKS_NBRS", \
	"EXP_EVALUATE___SLOTTING_OPT_STAT_CODE as SLOTTING_OPT_STAT_CODE", \
	"EXP_EVALUATE___PRICE_TIX_AVAIL_EXP as PRICE_TIX_AVAIL", \
	"EXP_EVALUATE___MV_SIZE_UOM as MV_SIZE_UOM", \
	"EXP_EVALUATE___UNITS_PER_GRAB_PLT as UNITS_PER_GRAB_PLT", \
	"EXP_EVALUATE___HNDL_ATTR_PLT as HNDL_ATTR_PLT", \
	"EXP_EVALUATE___HNDL_ATTR_ACT_UOM_ID as HNDL_ATTR_ACT_UOM_ID", \
	"EXP_EVALUATE___HNDL_ATTR_CASE_PICK_UOM_ID as HNDL_ATTR_CASE_PICK_UOM_ID", \
	"EXP_EVALUATE___SRL_NBR_REQD as SRL_NBR_REQD", \
	"EXP_EVALUATE___CC_UNIT_TOLER_VALUE as CC_UNIT_TOLER_VALUE", \
	"EXP_EVALUATE___CC_WGT_TOLER_VALUE as CC_WGT_TOLER_VALUE", \
	"EXP_EVALUATE___CC_DLR_TOLER_VALUE as CC_DLR_TOLER_VALUE", \
	"EXP_EVALUATE___CC_PCNT_TOLER_VALUE as CC_PCNT_TOLER_VALUE", \
	"EXP_EVALUATE___DISPOSITION_TYPE as DISPOSITION_TYPE", \
	"EXP_EVALUATE___EXP_LICN_DESCRIPTION as EXP_LICN_DESCRIPTION", \
	"EXP_EVALUATE___in_WM_ITEM_ID as in_WM_ITEM_ID", \
	"EXP_EVALUATE___LOAD_TSTMP as LOAD_TSTMP", \
	"EXP_EVALUATE___UPDATE_TSTMP as UPDATE_TSTMP") \
	.withColumn('pyspark_data_action', when((in_WM_ITEM_ID.isNull()) ,(lit(0))).otherwise(lit(1)))

# COMMAND ----------
# Processing node Shortcut_to_WM_ITEM_WMS1, type TARGET 
# COLUMN COUNT: 140

try:
  primary_key = """source.LOCATION_ID = target.LOCATION_ID AND source.WM_ITEM_ID = target.WM_ITEM_ID"""
#   refined_perf_table = "WM_ITEM_WMS"
  executeMerge(UPD_INS_UPD, refined_perf_table, primary_key)
  logger.info(f"Merge with {refined_perf_table} completed]")
  logPrevRunDt("WM_ITEM_WMS", "WM_ITEM_WMS", "Completed", "N/A", f"{raw}.log_run_details")
except Exception as e:
  logPrevRunDt("WM_ITEM_WMS", "WM_ITEM_WMS","Failed",str(e), f"{raw}.log_run_details", )
  raise e
	