#Code converted on 2023-06-15 14:12:38
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from pyspark.dbutils import DBUtils
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from Datalake.utils.logger import *
# COMMAND ----------

# parser = argparse.ArgumentParser()
spark = SparkSession.getActiveSession()
dbutils = DBUtils(spark)

# parser.add_argument('env', type=str, help='Env Variable')
# args = parser.parse_args()
# env = args.env
# env = args.env
env = 'dev'


if env is None or env == '':
    raise ValueError('env is not set')

refine = getEnvPrefix(env) + 'refine'
raw = getEnvPrefix(env) + 'raw'
legacy = getEnvPrefix(env) + 'legacy'

# Set global variables
starttime = datetime.now() #start timestamp of the script
refined_perf_table = f"{refine}.WM_ASN"
raw_perf_table = f"{raw}.WM_ASN_PRE"
site_profile_table = f"{legacy}.SITE_PROFILE"

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ASN_PRE, type SOURCE 
# COLUMN COUNT: 142

SQ_Shortcut_to_WM_ASN_PRE = spark.sql(f"""SELECT
DC_NBR,
ASN_ID,
TC_COMPANY_ID,
TC_ASN_ID,
TC_ASN_ID_U,
ASN_TYPE,
ASN_STATUS,
TRACTOR_NUMBER,
DELIVERY_STOP_SEQ,
ORIGIN_FACILITY_ALIAS_ID,
ORIGIN_FACILITY_ID,
PICKUP_END_DTTM,
ACTUAL_DEPARTURE_DTTM,
DESTINATION_FACILITY_ALIAS_ID,
DESTINATION_FACILITY_ID,
DELIVERY_START_DTTM,
DELIVERY_END_DTTM,
ACTUAL_ARRIVAL_DTTM,
RECEIPT_DTTM,
INBOUND_REGION_NAME,
OUTBOUND_REGION_NAME,
REF_FIELD_1,
REF_FIELD_2,
REF_FIELD_3,
TOTAL_WEIGHT,
APPOINTMENT_ID,
APPOINTMENT_DTTM,
APPOINTMENT_DURATION,
PALLET_FOOTPRINT,
LAST_TRANSMITTED_DTTM,
TOTAL_SHIPPED_QTY,
TOTAL_RECEIVED_QTY,
ASSIGNED_CARRIER_CODE,
BILL_OF_LADING_NUMBER,
PRO_NUMBER,
EQUIPMENT_CODE,
EQUIPMENT_CODE_ID,
ASSIGNED_CARRIER_CODE_ID,
TOTAL_VOLUME,
VOLUME_UOM_ID_BASE,
FIRM_APPT_IND,
TRACTOR_CARRIER_CODE_ID,
TRACTOR_CARRIER_CODE,
BUYER_CODE,
REP_NAME,
CONTACT_ADDRESS_1,
CONTACT_ADDRESS_2,
CONTACT_ADDRESS_3,
CONTACT_CITY,
CONTACT_STATE_PROV,
CONTACT_ZIP,
CONTACT_NUMBER,
EXT_CREATED_DTTM,
INBOUND_REGION_ID,
OUTBOUND_REGION_ID,
REGION_ID,
ASN_LEVEL,
RECEIPT_VARIANCE,
HAS_IMPORT_ERROR,
HAS_SOFT_CHECK_ERROR,
HAS_ALERTS,
SYSTEM_ALLOCATED,
IS_COGI_GENERATED,
ASN_PRIORITY,
SCHEDULE_APPT,
IS_ASSOCIATED_TO_OUTBOUND,
IS_CANCELLED,
IS_CLOSED,
BUSINESS_PARTNER_ID,
MANIF_NBR,
MANIF_TYPE,
WORK_ORD_NBR,
CUT_NBR,
MFG_PLNT,
IS_WHSE_TRANSFER,
QUALITY_CHECK_HOLD_UPON_RCPT,
QUALITY_AUDIT_PERCENT,
SHIPPED_LPN_COUNT,
RECEIVED_LPN_COUNT,
ACTUAL_SHIPPED_DTTM,
LAST_RECEIPT_DTTM,
VERIFIED_DTTM,
LABEL_PRINT_REQD,
INITIATE_FLAG,
CREATED_SOURCE_TYPE,
CREATED_SOURCE,
CREATED_DTTM,
LAST_UPDATED_SOURCE_TYPE,
LAST_UPDATED_SOURCE,
LAST_UPDATED_DTTM,
SHIPMENT_ID,
TC_SHIPMENT_ID,
VERIFICATION_ATTEMPTED,
FLOW_THRU_ALLOC_IN_PROG,
ALLOCATION_COMPLETED,
EQUIPMENT_TYPE,
ASN_ORGN_TYPE,
DC_ORD_NBR,
CONTRAC_LOCN,
MHE_SENT,
FLOW_THROUGH_ALLOCATION_METHOD,
FIRST_RECEIPT_DTTM,
MISC_INSTR_CODE_1,
MISC_INSTR_CODE_2,
DOCK_DOOR_ID,
MODE_ID,
SHIPPING_COST,
SHIPPING_COST_CURRENCY_CODE,
FLOWTHROUGH_ALLOCATION_STATUS,
HIBERNATE_VERSION,
QTY_UOM_ID_BASE,
WEIGHT_UOM_ID_BASE,
DRIVER_NAME,
TRAILER_NUMBER,
DESTINATION_TYPE,
CONTACT_COUNTY,
CONTACT_COUNTRY_CODE,
RECEIPT_TYPE,
VARIANCE_TYPE,
HAS_NOTES,
ORIGINAL_ASN_ID,
RETURN_REFERENCE_NUMBER,
REF_FIELD_4,
REF_FIELD_5,
REF_FIELD_6,
REF_FIELD_7,
REF_FIELD_8,
REF_FIELD_9,
REF_FIELD_10,
REF_NUM1,
REF_NUM2,
REF_NUM3,
REF_NUM4,
REF_NUM5,
INVOICE_DATE,
INVOICE_NUMBER,
PRE_RECEIPT_STATUS,
PRE_ALLOCATION_FIT_PERCENTAGE,
TRAILER_CLOSED,
IS_GIFT,
ORIGINAL_ORDER_NUMBER,
ASN_SHPMT_TYPE
FROM {raw_perf_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ASN, type SOURCE 
# COLUMN COUNT: 5

SQ_Shortcut_to_WM_ASN = spark.sql(f"""SELECT
LOCATION_ID,
WM_ASN_ID,
WM_CREATED_TSTMP,
WM_LAST_UPDATED_TSTMP,
LOAD_TSTMP
FROM {refined_perf_table}
WHERE WM_ASN_ID IN (SELECT ASN_ID FROM {raw_perf_table})""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_INT_CONVERSION, type EXPRESSION 
# COLUMN COUNT: 142

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_ASN_PRE_temp = SQ_Shortcut_to_WM_ASN_PRE.toDF(*["SQ_Shortcut_to_WM_ASN_PRE___" + col for col in SQ_Shortcut_to_WM_ASN_PRE.columns])

EXP_INT_CONVERSION = SQ_Shortcut_to_WM_ASN_PRE_temp.selectExpr( \
	"SQ_Shortcut_to_WM_ASN_PRE___sys_row_id as sys_row_id", \
	"cast(SQ_Shortcut_to_WM_ASN_PRE___DC_NBR as int) as o_DC_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_ID as ASN_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_COMPANY_ID as TC_COMPANY_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_ASN_ID as TC_ASN_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_ASN_ID_U as TC_ASN_ID_U", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_TYPE as ASN_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_STATUS as ASN_STATUS", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIPT_DTTM as RECEIPT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_1 as REF_FIELD_1", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_2 as REF_FIELD_2", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_3 as REF_FIELD_3", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"SQ_Shortcut_to_WM_ASN_PRE___APPOINTMENT_ID as APPOINTMENT_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"SQ_Shortcut_to_WM_ASN_PRE___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___PRO_NUMBER as PRO_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_VOLUME as TOTAL_VOLUME", \
	"SQ_Shortcut_to_WM_ASN_PRE___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"SQ_Shortcut_to_WM_ASN_PRE___FIRM_APPT_IND as FIRM_APPT_IND", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___BUYER_CODE as BUYER_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___REP_NAME as REP_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_CITY as CONTACT_CITY", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ZIP as CONTACT_ZIP", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_NUMBER as CONTACT_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___REGION_ID as REGION_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_LEVEL as ASN_LEVEL", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_ALERTS as HAS_ALERTS", \
	"SQ_Shortcut_to_WM_ASN_PRE___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_PRIORITY as ASN_PRIORITY", \
	"SQ_Shortcut_to_WM_ASN_PRE___SCHEDULE_APPT as SCHEDULE_APPT", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_CANCELLED as IS_CANCELLED", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_CLOSED as IS_CLOSED", \
	"SQ_Shortcut_to_WM_ASN_PRE___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___MANIF_NBR as MANIF_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___MANIF_TYPE as MANIF_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___WORK_ORD_NBR as WORK_ORD_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___CUT_NBR as CUT_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___MFG_PLNT as MFG_PLNT", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_WHSE_TRANSFER as IS_WHSE_TRANSFER", \
	"SQ_Shortcut_to_WM_ASN_PRE___QUALITY_CHECK_HOLD_UPON_RCPT as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"SQ_Shortcut_to_WM_ASN_PRE___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"SQ_Shortcut_to_WM_ASN_PRE___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___VERIFIED_DTTM as VERIFIED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___LABEL_PRINT_REQD as LABEL_PRINT_REQD", \
	"SQ_Shortcut_to_WM_ASN_PRE___INITIATE_FLAG as INITIATE_FLAG", \
	"SQ_Shortcut_to_WM_ASN_PRE___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___CREATED_SOURCE as CREATED_SOURCE", \
	"SQ_Shortcut_to_WM_ASN_PRE___CREATED_DTTM as CREATED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPMENT_ID as SHIPMENT_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___VERIFICATION_ATTEMPTED as VERIFICATION_ATTEMPTED", \
	"SQ_Shortcut_to_WM_ASN_PRE___FLOW_THRU_ALLOC_IN_PROG as FLOW_THRU_ALLOC_IN_PROG", \
	"SQ_Shortcut_to_WM_ASN_PRE___ALLOCATION_COMPLETED as ALLOCATION_COMPLETED", \
	"SQ_Shortcut_to_WM_ASN_PRE___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___DC_ORD_NBR as DC_ORD_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTRAC_LOCN as CONTRAC_LOCN", \
	"SQ_Shortcut_to_WM_ASN_PRE___MHE_SENT as MHE_SENT", \
	"SQ_Shortcut_to_WM_ASN_PRE___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"SQ_Shortcut_to_WM_ASN_PRE___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"SQ_Shortcut_to_WM_ASN_PRE___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"SQ_Shortcut_to_WM_ASN_PRE___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___MODE_ID as MODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPPING_COST as SHIPPING_COST", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"SQ_Shortcut_to_WM_ASN_PRE___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"SQ_Shortcut_to_WM_ASN_PRE___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"SQ_Shortcut_to_WM_ASN_PRE___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"SQ_Shortcut_to_WM_ASN_PRE___DRIVER_NAME as DRIVER_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRAILER_NUMBER as TRAILER_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___DESTINATION_TYPE as DESTINATION_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_COUNTY as CONTACT_COUNTY", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIPT_TYPE as RECEIPT_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___VARIANCE_TYPE as VARIANCE_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_NOTES as HAS_NOTES", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_4 as REF_FIELD_4", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_5 as REF_FIELD_5", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_6 as REF_FIELD_6", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_7 as REF_FIELD_7", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_8 as REF_FIELD_8", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_9 as REF_FIELD_9", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_10 as REF_FIELD_10", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM1 as REF_NUM1", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM2 as REF_NUM2", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM3 as REF_NUM3", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM4 as REF_NUM4", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM5 as REF_NUM5", \
	"SQ_Shortcut_to_WM_ASN_PRE___INVOICE_DATE as INVOICE_DATE", \
	"SQ_Shortcut_to_WM_ASN_PRE___INVOICE_NUMBER as INVOICE_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"SQ_Shortcut_to_WM_ASN_PRE___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRAILER_CLOSED as TRAILER_CLOSED", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_GIFT as IS_GIFT", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE" \
)

# COMMAND ----------
# Processing node SQ_Shortcut_to_SITE_PROFILE, type SOURCE 
# COLUMN COUNT: 2

SQ_Shortcut_to_SITE_PROFILE = spark.sql(f"""SELECT LOCATION_ID, STORE_NBR FROM {site_profile_table}""").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node JNR_SITE_PROFILE, type JOINER 
# COLUMN COUNT: 144

JNR_SITE_PROFILE = SQ_Shortcut_to_SITE_PROFILE.join(EXP_INT_CONVERSION,[SQ_Shortcut_to_SITE_PROFILE.STORE_NBR == EXP_INT_CONVERSION.o_DC_NBR],'inner')

# COMMAND ----------
# Processing node JNR_WM_ASN, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 147

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_ASN_temp = SQ_Shortcut_to_WM_ASN.toDF(*["SQ_Shortcut_to_WM_ASN___" + col for col in SQ_Shortcut_to_WM_ASN.columns])
JNR_SITE_PROFILE_temp = JNR_SITE_PROFILE.toDF(*["JNR_SITE_PROFILE___" + col for col in JNR_SITE_PROFILE.columns])

JNR_WM_ASN = SQ_Shortcut_to_WM_ASN_temp.join(JNR_SITE_PROFILE_temp,[SQ_Shortcut_to_WM_ASN_temp.SQ_Shortcut_to_WM_ASN___LOCATION_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___LOCATION_ID, SQ_Shortcut_to_WM_ASN_temp.SQ_Shortcut_to_WM_ASN___WM_ASN_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___ASN_ID],'right_outer').selectExpr( \
	"JNR_SITE_PROFILE___LOCATION_ID as LOCATION_ID", \
	"JNR_SITE_PROFILE___ASN_ID as ASN_ID", \
	"JNR_SITE_PROFILE___TC_COMPANY_ID as TC_COMPANY_ID", \
	"JNR_SITE_PROFILE___TC_ASN_ID as TC_ASN_ID", \
	"JNR_SITE_PROFILE___TC_ASN_ID_U as TC_ASN_ID_U", \
	"JNR_SITE_PROFILE___ASN_TYPE as ASN_TYPE", \
	"JNR_SITE_PROFILE___ASN_STATUS as ASN_STATUS", \
	"JNR_SITE_PROFILE___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"JNR_SITE_PROFILE___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"JNR_SITE_PROFILE___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"JNR_SITE_PROFILE___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"JNR_SITE_PROFILE___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"JNR_SITE_PROFILE___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"JNR_SITE_PROFILE___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"JNR_SITE_PROFILE___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"JNR_SITE_PROFILE___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"JNR_SITE_PROFILE___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"JNR_SITE_PROFILE___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"JNR_SITE_PROFILE___RECEIPT_DTTM as RECEIPT_DTTM", \
	"JNR_SITE_PROFILE___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"JNR_SITE_PROFILE___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"JNR_SITE_PROFILE___REF_FIELD_1 as REF_FIELD_1", \
	"JNR_SITE_PROFILE___REF_FIELD_2 as REF_FIELD_2", \
	"JNR_SITE_PROFILE___REF_FIELD_3 as REF_FIELD_3", \
	"JNR_SITE_PROFILE___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"JNR_SITE_PROFILE___APPOINTMENT_ID as APPOINTMENT_ID", \
	"JNR_SITE_PROFILE___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"JNR_SITE_PROFILE___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"JNR_SITE_PROFILE___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"JNR_SITE_PROFILE___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"JNR_SITE_PROFILE___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"JNR_SITE_PROFILE___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"JNR_SITE_PROFILE___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"JNR_SITE_PROFILE___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"JNR_SITE_PROFILE___PRO_NUMBER as PRO_NUMBER", \
	"JNR_SITE_PROFILE___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"JNR_SITE_PROFILE___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"JNR_SITE_PROFILE___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"JNR_SITE_PROFILE___TOTAL_VOLUME as TOTAL_VOLUME", \
	"JNR_SITE_PROFILE___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"JNR_SITE_PROFILE___FIRM_APPT_IND as FIRM_APPT_IND", \
	"JNR_SITE_PROFILE___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"JNR_SITE_PROFILE___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"JNR_SITE_PROFILE___BUYER_CODE as BUYER_CODE", \
	"JNR_SITE_PROFILE___REP_NAME as REP_NAME", \
	"JNR_SITE_PROFILE___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"JNR_SITE_PROFILE___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"JNR_SITE_PROFILE___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"JNR_SITE_PROFILE___CONTACT_CITY as CONTACT_CITY", \
	"JNR_SITE_PROFILE___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"JNR_SITE_PROFILE___CONTACT_ZIP as CONTACT_ZIP", \
	"JNR_SITE_PROFILE___CONTACT_NUMBER as CONTACT_NUMBER", \
	"JNR_SITE_PROFILE___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"JNR_SITE_PROFILE___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"JNR_SITE_PROFILE___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"JNR_SITE_PROFILE___REGION_ID as REGION_ID", \
	"JNR_SITE_PROFILE___ASN_LEVEL as ASN_LEVEL", \
	"JNR_SITE_PROFILE___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"JNR_SITE_PROFILE___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"JNR_SITE_PROFILE___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"JNR_SITE_PROFILE___HAS_ALERTS as HAS_ALERTS", \
	"JNR_SITE_PROFILE___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"JNR_SITE_PROFILE___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"JNR_SITE_PROFILE___ASN_PRIORITY as ASN_PRIORITY", \
	"JNR_SITE_PROFILE___SCHEDULE_APPT as SCHEDULE_APPT", \
	"JNR_SITE_PROFILE___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"JNR_SITE_PROFILE___IS_CANCELLED as IS_CANCELLED", \
	"JNR_SITE_PROFILE___IS_CLOSED as IS_CLOSED", \
	"JNR_SITE_PROFILE___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"JNR_SITE_PROFILE___MANIF_NBR as MANIF_NBR", \
	"JNR_SITE_PROFILE___MANIF_TYPE as MANIF_TYPE", \
	"JNR_SITE_PROFILE___WORK_ORD_NBR as WORK_ORD_NBR", \
	"JNR_SITE_PROFILE___CUT_NBR as CUT_NBR", \
	"JNR_SITE_PROFILE___MFG_PLNT as MFG_PLNT", \
	"JNR_SITE_PROFILE___IS_WHSE_TRANSFER as IS_WHSE_TRANSFER", \
	"JNR_SITE_PROFILE___QUALITY_CHECK_HOLD_UPON_RCPT as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"JNR_SITE_PROFILE___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"JNR_SITE_PROFILE___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"JNR_SITE_PROFILE___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"JNR_SITE_PROFILE___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"JNR_SITE_PROFILE___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"JNR_SITE_PROFILE___VERIFIED_DTTM as VERIFIED_DTTM", \
	"JNR_SITE_PROFILE___LABEL_PRINT_REQD as LABEL_PRINT_REQD", \
	"JNR_SITE_PROFILE___INITIATE_FLAG as INITIATE_FLAG", \
	"JNR_SITE_PROFILE___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___CREATED_SOURCE as CREATED_SOURCE", \
	"JNR_SITE_PROFILE___CREATED_DTTM as CREATED_DTTM", \
	"JNR_SITE_PROFILE___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"JNR_SITE_PROFILE___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"JNR_SITE_PROFILE___SHIPMENT_ID as SHIPMENT_ID", \
	"JNR_SITE_PROFILE___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"JNR_SITE_PROFILE___VERIFICATION_ATTEMPTED as VERIFICATION_ATTEMPTED", \
	"JNR_SITE_PROFILE___FLOW_THRU_ALLOC_IN_PROG as FLOW_THRU_ALLOC_IN_PROG", \
	"JNR_SITE_PROFILE___ALLOCATION_COMPLETED as ALLOCATION_COMPLETED", \
	"JNR_SITE_PROFILE___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"JNR_SITE_PROFILE___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"JNR_SITE_PROFILE___DC_ORD_NBR as DC_ORD_NBR", \
	"JNR_SITE_PROFILE___CONTRAC_LOCN as CONTRAC_LOCN", \
	"JNR_SITE_PROFILE___MHE_SENT as MHE_SENT", \
	"JNR_SITE_PROFILE___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"JNR_SITE_PROFILE___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"JNR_SITE_PROFILE___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"JNR_SITE_PROFILE___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"JNR_SITE_PROFILE___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"JNR_SITE_PROFILE___MODE_ID as MODE_ID", \
	"JNR_SITE_PROFILE___SHIPPING_COST as SHIPPING_COST", \
	"JNR_SITE_PROFILE___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"JNR_SITE_PROFILE___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"JNR_SITE_PROFILE___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"JNR_SITE_PROFILE___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"JNR_SITE_PROFILE___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"JNR_SITE_PROFILE___DRIVER_NAME as DRIVER_NAME", \
	"JNR_SITE_PROFILE___TRAILER_NUMBER as TRAILER_NUMBER", \
	"JNR_SITE_PROFILE___DESTINATION_TYPE as DESTINATION_TYPE", \
	"JNR_SITE_PROFILE___CONTACT_COUNTY as CONTACT_COUNTY", \
	"JNR_SITE_PROFILE___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"JNR_SITE_PROFILE___RECEIPT_TYPE as RECEIPT_TYPE", \
	"JNR_SITE_PROFILE___VARIANCE_TYPE as VARIANCE_TYPE", \
	"JNR_SITE_PROFILE___HAS_NOTES as HAS_NOTES", \
	"JNR_SITE_PROFILE___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"JNR_SITE_PROFILE___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"JNR_SITE_PROFILE___REF_FIELD_4 as REF_FIELD_4", \
	"JNR_SITE_PROFILE___REF_FIELD_5 as REF_FIELD_5", \
	"JNR_SITE_PROFILE___REF_FIELD_6 as REF_FIELD_6", \
	"JNR_SITE_PROFILE___REF_FIELD_7 as REF_FIELD_7", \
	"JNR_SITE_PROFILE___REF_FIELD_8 as REF_FIELD_8", \
	"JNR_SITE_PROFILE___REF_FIELD_9 as REF_FIELD_9", \
	"JNR_SITE_PROFILE___REF_FIELD_10 as REF_FIELD_10", \
	"JNR_SITE_PROFILE___REF_NUM1 as REF_NUM1", \
	"JNR_SITE_PROFILE___REF_NUM2 as REF_NUM2", \
	"JNR_SITE_PROFILE___REF_NUM3 as REF_NUM3", \
	"JNR_SITE_PROFILE___REF_NUM4 as REF_NUM4", \
	"JNR_SITE_PROFILE___REF_NUM5 as REF_NUM5", \
	"JNR_SITE_PROFILE___INVOICE_DATE as INVOICE_DATE", \
	"JNR_SITE_PROFILE___INVOICE_NUMBER as INVOICE_NUMBER", \
	"JNR_SITE_PROFILE___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"JNR_SITE_PROFILE___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"JNR_SITE_PROFILE___TRAILER_CLOSED as TRAILER_CLOSED", \
	"JNR_SITE_PROFILE___IS_GIFT as IS_GIFT", \
	"JNR_SITE_PROFILE___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"JNR_SITE_PROFILE___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"SQ_Shortcut_to_WM_ASN___LOCATION_ID as i_LOCATION_ID", \
	"SQ_Shortcut_to_WM_ASN___WM_ASN_ID as i_WM_ASN_ID", \
	"SQ_Shortcut_to_WM_ASN___WM_CREATED_TSTMP as i_WM_CREATED_TSTMP", \
	"SQ_Shortcut_to_WM_ASN___WM_LAST_UPDATED_TSTMP as i_WM_LAST_UPDATED_TSTMP", \
	"SQ_Shortcut_to_WM_ASN___LOAD_TSTMP as i_LOAD_TSTMP")

# COMMAND ----------
# Processing node FIL_UNCHANGED_RECORDS, type FILTER 
# COLUMN COUNT: 146

# for each involved DataFrame, append the dataframe name to each column
JNR_WM_ASN_temp = JNR_WM_ASN.toDF(*["JNR_WM_ASN___" + col for col in JNR_WM_ASN.columns])

FIL_UNCHANGED_RECORDS = JNR_WM_ASN_temp.selectExpr( \
	"JNR_WM_ASN___LOCATION_ID as LOCATION_ID", \
	"JNR_WM_ASN___ASN_ID as ASN_ID", \
	"JNR_WM_ASN___TC_COMPANY_ID as TC_COMPANY_ID", \
	"JNR_WM_ASN___TC_ASN_ID as TC_ASN_ID", \
	"JNR_WM_ASN___TC_ASN_ID_U as TC_ASN_ID_U", \
	"JNR_WM_ASN___ASN_TYPE as ASN_TYPE", \
	"JNR_WM_ASN___ASN_STATUS as ASN_STATUS", \
	"JNR_WM_ASN___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"JNR_WM_ASN___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"JNR_WM_ASN___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"JNR_WM_ASN___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"JNR_WM_ASN___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"JNR_WM_ASN___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"JNR_WM_ASN___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"JNR_WM_ASN___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"JNR_WM_ASN___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"JNR_WM_ASN___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"JNR_WM_ASN___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"JNR_WM_ASN___RECEIPT_DTTM as RECEIPT_DTTM", \
	"JNR_WM_ASN___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"JNR_WM_ASN___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"JNR_WM_ASN___REF_FIELD_1 as REF_FIELD_1", \
	"JNR_WM_ASN___REF_FIELD_2 as REF_FIELD_2", \
	"JNR_WM_ASN___REF_FIELD_3 as REF_FIELD_3", \
	"JNR_WM_ASN___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"JNR_WM_ASN___APPOINTMENT_ID as APPOINTMENT_ID", \
	"JNR_WM_ASN___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"JNR_WM_ASN___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"JNR_WM_ASN___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"JNR_WM_ASN___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"JNR_WM_ASN___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"JNR_WM_ASN___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"JNR_WM_ASN___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"JNR_WM_ASN___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"JNR_WM_ASN___PRO_NUMBER as PRO_NUMBER", \
	"JNR_WM_ASN___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"JNR_WM_ASN___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"JNR_WM_ASN___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"JNR_WM_ASN___TOTAL_VOLUME as TOTAL_VOLUME", \
	"JNR_WM_ASN___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"JNR_WM_ASN___FIRM_APPT_IND as FIRM_APPT_IND", \
	"JNR_WM_ASN___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"JNR_WM_ASN___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"JNR_WM_ASN___BUYER_CODE as BUYER_CODE", \
	"JNR_WM_ASN___REP_NAME as REP_NAME", \
	"JNR_WM_ASN___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"JNR_WM_ASN___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"JNR_WM_ASN___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"JNR_WM_ASN___CONTACT_CITY as CONTACT_CITY", \
	"JNR_WM_ASN___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"JNR_WM_ASN___CONTACT_ZIP as CONTACT_ZIP", \
	"JNR_WM_ASN___CONTACT_NUMBER as CONTACT_NUMBER", \
	"JNR_WM_ASN___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"JNR_WM_ASN___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"JNR_WM_ASN___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"JNR_WM_ASN___REGION_ID as REGION_ID", \
	"JNR_WM_ASN___ASN_LEVEL as ASN_LEVEL", \
	"JNR_WM_ASN___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"JNR_WM_ASN___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"JNR_WM_ASN___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"JNR_WM_ASN___HAS_ALERTS as HAS_ALERTS", \
	"JNR_WM_ASN___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"JNR_WM_ASN___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"JNR_WM_ASN___ASN_PRIORITY as ASN_PRIORITY", \
	"JNR_WM_ASN___SCHEDULE_APPT as SCHEDULE_APPT", \
	"JNR_WM_ASN___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"JNR_WM_ASN___IS_CANCELLED as IS_CANCELLED", \
	"JNR_WM_ASN___IS_CLOSED as IS_CLOSED", \
	"JNR_WM_ASN___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"JNR_WM_ASN___MANIF_NBR as MANIF_NBR", \
	"JNR_WM_ASN___MANIF_TYPE as MANIF_TYPE", \
	"JNR_WM_ASN___WORK_ORD_NBR as WORK_ORD_NBR", \
	"JNR_WM_ASN___CUT_NBR as CUT_NBR", \
	"JNR_WM_ASN___MFG_PLNT as MFG_PLNT", \
	"JNR_WM_ASN___IS_WHSE_TRANSFER as IS_WHSE_TRANSFER", \
	"JNR_WM_ASN___QUALITY_CHECK_HOLD_UPON_RCPT as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"JNR_WM_ASN___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"JNR_WM_ASN___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"JNR_WM_ASN___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"JNR_WM_ASN___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"JNR_WM_ASN___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"JNR_WM_ASN___VERIFIED_DTTM as VERIFIED_DTTM", \
	"JNR_WM_ASN___LABEL_PRINT_REQD as LABEL_PRINT_REQD", \
	"JNR_WM_ASN___INITIATE_FLAG as INITIATE_FLAG", \
	"JNR_WM_ASN___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"JNR_WM_ASN___CREATED_SOURCE as CREATED_SOURCE", \
	"JNR_WM_ASN___CREATED_DTTM as CREATED_DTTM", \
	"JNR_WM_ASN___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"JNR_WM_ASN___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"JNR_WM_ASN___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"JNR_WM_ASN___SHIPMENT_ID as SHIPMENT_ID", \
	"JNR_WM_ASN___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"JNR_WM_ASN___VERIFICATION_ATTEMPTED as VERIFICATION_ATTEMPTED", \
	"JNR_WM_ASN___FLOW_THRU_ALLOC_IN_PROG as FLOW_THRU_ALLOC_IN_PROG", \
	"JNR_WM_ASN___ALLOCATION_COMPLETED as ALLOCATION_COMPLETED", \
	"JNR_WM_ASN___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"JNR_WM_ASN___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"JNR_WM_ASN___DC_ORD_NBR as DC_ORD_NBR", \
	"JNR_WM_ASN___CONTRAC_LOCN as CONTRAC_LOCN", \
	"JNR_WM_ASN___MHE_SENT as MHE_SENT", \
	"JNR_WM_ASN___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"JNR_WM_ASN___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"JNR_WM_ASN___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"JNR_WM_ASN___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"JNR_WM_ASN___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"JNR_WM_ASN___MODE_ID as MODE_ID", \
	"JNR_WM_ASN___SHIPPING_COST as SHIPPING_COST", \
	"JNR_WM_ASN___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"JNR_WM_ASN___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"JNR_WM_ASN___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"JNR_WM_ASN___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"JNR_WM_ASN___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"JNR_WM_ASN___DRIVER_NAME as DRIVER_NAME", \
	"JNR_WM_ASN___TRAILER_NUMBER as TRAILER_NUMBER", \
	"JNR_WM_ASN___DESTINATION_TYPE as DESTINATION_TYPE", \
	"JNR_WM_ASN___CONTACT_COUNTY as CONTACT_COUNTY", \
	"JNR_WM_ASN___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"JNR_WM_ASN___RECEIPT_TYPE as RECEIPT_TYPE", \
	"JNR_WM_ASN___VARIANCE_TYPE as VARIANCE_TYPE", \
	"JNR_WM_ASN___HAS_NOTES as HAS_NOTES", \
	"JNR_WM_ASN___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"JNR_WM_ASN___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"JNR_WM_ASN___REF_FIELD_4 as REF_FIELD_4", \
	"JNR_WM_ASN___REF_FIELD_5 as REF_FIELD_5", \
	"JNR_WM_ASN___REF_FIELD_6 as REF_FIELD_6", \
	"JNR_WM_ASN___REF_FIELD_7 as REF_FIELD_7", \
	"JNR_WM_ASN___REF_FIELD_8 as REF_FIELD_8", \
	"JNR_WM_ASN___REF_FIELD_9 as REF_FIELD_9", \
	"JNR_WM_ASN___REF_FIELD_10 as REF_FIELD_10", \
	"JNR_WM_ASN___REF_NUM1 as REF_NUM1", \
	"JNR_WM_ASN___REF_NUM2 as REF_NUM2", \
	"JNR_WM_ASN___REF_NUM3 as REF_NUM3", \
	"JNR_WM_ASN___REF_NUM4 as REF_NUM4", \
	"JNR_WM_ASN___REF_NUM5 as REF_NUM5", \
	"JNR_WM_ASN___INVOICE_DATE as INVOICE_DATE", \
	"JNR_WM_ASN___INVOICE_NUMBER as INVOICE_NUMBER", \
	"JNR_WM_ASN___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"JNR_WM_ASN___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"JNR_WM_ASN___TRAILER_CLOSED as TRAILER_CLOSED", \
	"JNR_WM_ASN___IS_GIFT as IS_GIFT", \
	"JNR_WM_ASN___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"JNR_WM_ASN___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"JNR_WM_ASN___i_WM_ASN_ID as i_WM_ASN_ID", \
	"JNR_WM_ASN___i_WM_CREATED_TSTMP as i_WM_CREATED_TSTMP", \
	"JNR_WM_ASN___i_WM_LAST_UPDATED_TSTMP as i_WM_LAST_UPDATED_TSTMP", \
	"JNR_WM_ASN___i_LOAD_TSTMP as i_LOAD_TSTMP") \
.filter("i_WM_ASN_ID is Null OR ( i_WM_ASN_ID is Not Null AND ( COALESCE(CREATED_DTTM, date'1900-01-01') != COALESCE(i_WM_CREATED_TSTMP, date'1900-01-01') \
        OR COALESCE(LAST_UPDATED_DTTM, date'1900-01-01') != COALESCE(i_WM_LAST_UPDATED_TSTMP, date'1900-01-01') ))").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_UPD_VALIDATOR, type EXPRESSION 
# COLUMN COUNT: 145

# for each involved DataFrame, append the dataframe name to each column
FIL_UNCHANGED_RECORDS_temp = FIL_UNCHANGED_RECORDS.toDF(*["FIL_UNCHANGED_RECORDS___" + col for col in FIL_UNCHANGED_RECORDS.columns])

EXP_UPD_VALIDATOR = FIL_UNCHANGED_RECORDS_temp.selectExpr( \
	"FIL_UNCHANGED_RECORDS___sys_row_id as sys_row_id", \
	"FIL_UNCHANGED_RECORDS___LOCATION_ID as LOCATION_ID", \
	"FIL_UNCHANGED_RECORDS___ASN_ID as ASN_ID", \
	"FIL_UNCHANGED_RECORDS___TC_COMPANY_ID as TC_COMPANY_ID", \
	"FIL_UNCHANGED_RECORDS___TC_ASN_ID as TC_ASN_ID", \
	"FIL_UNCHANGED_RECORDS___TC_ASN_ID_U as TC_ASN_ID_U", \
	"FIL_UNCHANGED_RECORDS___ASN_TYPE as ASN_TYPE", \
	"FIL_UNCHANGED_RECORDS___ASN_STATUS as ASN_STATUS", \
	"FIL_UNCHANGED_RECORDS___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"FIL_UNCHANGED_RECORDS___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"FIL_UNCHANGED_RECORDS___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"FIL_UNCHANGED_RECORDS___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"FIL_UNCHANGED_RECORDS___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"FIL_UNCHANGED_RECORDS___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"FIL_UNCHANGED_RECORDS___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"FIL_UNCHANGED_RECORDS___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"FIL_UNCHANGED_RECORDS___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"FIL_UNCHANGED_RECORDS___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"FIL_UNCHANGED_RECORDS___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"FIL_UNCHANGED_RECORDS___RECEIPT_DTTM as RECEIPT_DTTM", \
	"FIL_UNCHANGED_RECORDS___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"FIL_UNCHANGED_RECORDS___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_1 as REF_FIELD_1", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_2 as REF_FIELD_2", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_3 as REF_FIELD_3", \
	"FIL_UNCHANGED_RECORDS___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"FIL_UNCHANGED_RECORDS___APPOINTMENT_ID as APPOINTMENT_ID", \
	"FIL_UNCHANGED_RECORDS___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"FIL_UNCHANGED_RECORDS___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"FIL_UNCHANGED_RECORDS___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"FIL_UNCHANGED_RECORDS___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"FIL_UNCHANGED_RECORDS___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"FIL_UNCHANGED_RECORDS___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"FIL_UNCHANGED_RECORDS___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"FIL_UNCHANGED_RECORDS___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"FIL_UNCHANGED_RECORDS___PRO_NUMBER as PRO_NUMBER", \
	"FIL_UNCHANGED_RECORDS___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"FIL_UNCHANGED_RECORDS___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"FIL_UNCHANGED_RECORDS___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"FIL_UNCHANGED_RECORDS___TOTAL_VOLUME as TOTAL_VOLUME", \
	"FIL_UNCHANGED_RECORDS___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"FIL_UNCHANGED_RECORDS___FIRM_APPT_IND as FIRM_APPT_IND_EXP", \
	"FIL_UNCHANGED_RECORDS___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"FIL_UNCHANGED_RECORDS___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"FIL_UNCHANGED_RECORDS___BUYER_CODE as BUYER_CODE", \
	"FIL_UNCHANGED_RECORDS___REP_NAME as REP_NAME", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"FIL_UNCHANGED_RECORDS___CONTACT_CITY as CONTACT_CITY", \
	"FIL_UNCHANGED_RECORDS___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ZIP as CONTACT_ZIP", \
	"FIL_UNCHANGED_RECORDS___CONTACT_NUMBER as CONTACT_NUMBER", \
	"FIL_UNCHANGED_RECORDS___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"FIL_UNCHANGED_RECORDS___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"FIL_UNCHANGED_RECORDS___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"FIL_UNCHANGED_RECORDS___REGION_ID as REGION_ID", \
	"FIL_UNCHANGED_RECORDS___ASN_LEVEL as ASN_LEVEL", \
	"FIL_UNCHANGED_RECORDS___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"FIL_UNCHANGED_RECORDS___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"FIL_UNCHANGED_RECORDS___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"FIL_UNCHANGED_RECORDS___HAS_ALERTS as HAS_ALERTS", \
	"FIL_UNCHANGED_RECORDS___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"FIL_UNCHANGED_RECORDS___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"FIL_UNCHANGED_RECORDS___ASN_PRIORITY as ASN_PRIORITY", \
	"FIL_UNCHANGED_RECORDS___SCHEDULE_APPT as SCHEDULE_APPT", \
	"FIL_UNCHANGED_RECORDS___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"FIL_UNCHANGED_RECORDS___IS_CANCELLED as IS_CANCELLED", \
	"FIL_UNCHANGED_RECORDS___IS_CLOSED as IS_CLOSED", \
	"FIL_UNCHANGED_RECORDS___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"FIL_UNCHANGED_RECORDS___MANIF_NBR as MANIF_NBR", \
	"FIL_UNCHANGED_RECORDS___MANIF_TYPE as MANIF_TYPE", \
	"FIL_UNCHANGED_RECORDS___WORK_ORD_NBR as WORK_ORD_NBR", \
	"FIL_UNCHANGED_RECORDS___CUT_NBR as CUT_NBR", \
	"FIL_UNCHANGED_RECORDS___MFG_PLNT as MFG_PLNT", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_RECORDS___IS_WHSE_TRANSFER)) IN ('Y', '1') THEN '1' ELSE '0' END as IS_WHSE_TRANSFER_EXP", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_RECORDS___QUALITY_CHECK_HOLD_UPON_RCPT)) IN ('Y', '1') THEN '1' ELSE '0' END as QUALITY_CHECK_HOLD_UPON_RCPT_EXP", \
	"FIL_UNCHANGED_RECORDS___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"FIL_UNCHANGED_RECORDS___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"FIL_UNCHANGED_RECORDS___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"FIL_UNCHANGED_RECORDS___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"FIL_UNCHANGED_RECORDS___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"FIL_UNCHANGED_RECORDS___VERIFIED_DTTM as VERIFIED_DTTM", \
    "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_RECORDS___LABEL_PRINT_REQD)) IN ('Y', '1') THEN '1' ELSE '0' END as LABEL_PRINT_REQD_EXP", \
	"FIL_UNCHANGED_RECORDS___INITIATE_FLAG as INITIATE_FLAG", \
	"FIL_UNCHANGED_RECORDS___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_RECORDS___CREATED_SOURCE as CREATED_SOURCE", \
	"FIL_UNCHANGED_RECORDS___CREATED_DTTM as CREATED_DTTM", \
	"FIL_UNCHANGED_RECORDS___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_RECORDS___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"FIL_UNCHANGED_RECORDS___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"FIL_UNCHANGED_RECORDS___SHIPMENT_ID as SHIPMENT_ID", \
	"FIL_UNCHANGED_RECORDS___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
  "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_RECORDS___VERIFICATION_ATTEMPTED)) IN ('Y', '1') THEN '1' ELSE '0' END as VERIFICATION_ATTEMPTED_EXP", \
  "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_RECORDS___FLOW_THRU_ALLOC_IN_PROG)) IN ('Y', '1') THEN '1' ELSE '0' END as FLOW_THRU_ALLOC_IN_PROG_EXP", \
  "CASE WHEN TRIM(UPPER(FIL_UNCHANGED_RECORDS___ALLOCATION_COMPLETED)) IN ('Y', '1') THEN '1' ELSE '0' END as ALLOCATION_COMPLETED_EXP", \
	"FIL_UNCHANGED_RECORDS___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"FIL_UNCHANGED_RECORDS___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"FIL_UNCHANGED_RECORDS___DC_ORD_NBR as DC_ORD_NBR", \
	"FIL_UNCHANGED_RECORDS___CONTRAC_LOCN as CONTRAC_LOCN", \
	"FIL_UNCHANGED_RECORDS___MHE_SENT as MHE_SENT", \
	"FIL_UNCHANGED_RECORDS___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"FIL_UNCHANGED_RECORDS___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"FIL_UNCHANGED_RECORDS___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"FIL_UNCHANGED_RECORDS___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"FIL_UNCHANGED_RECORDS___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"FIL_UNCHANGED_RECORDS___MODE_ID as MODE_ID", \
	"FIL_UNCHANGED_RECORDS___SHIPPING_COST as SHIPPING_COST", \
	"FIL_UNCHANGED_RECORDS___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"FIL_UNCHANGED_RECORDS___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"FIL_UNCHANGED_RECORDS___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"FIL_UNCHANGED_RECORDS___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"FIL_UNCHANGED_RECORDS___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"FIL_UNCHANGED_RECORDS___DRIVER_NAME as DRIVER_NAME", \
	"FIL_UNCHANGED_RECORDS___TRAILER_NUMBER as TRAILER_NUMBER", \
	"FIL_UNCHANGED_RECORDS___DESTINATION_TYPE as DESTINATION_TYPE", \
	"FIL_UNCHANGED_RECORDS___CONTACT_COUNTY as CONTACT_COUNTY", \
	"FIL_UNCHANGED_RECORDS___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"FIL_UNCHANGED_RECORDS___RECEIPT_TYPE as RECEIPT_TYPE", \
	"FIL_UNCHANGED_RECORDS___VARIANCE_TYPE as VARIANCE_TYPE", \
	"FIL_UNCHANGED_RECORDS___HAS_NOTES as HAS_NOTES", \
	"FIL_UNCHANGED_RECORDS___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"FIL_UNCHANGED_RECORDS___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_4 as REF_FIELD_4", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_5 as REF_FIELD_5", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_6 as REF_FIELD_6", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_7 as REF_FIELD_7", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_8 as REF_FIELD_8", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_9 as REF_FIELD_9", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_10 as REF_FIELD_10", \
	"FIL_UNCHANGED_RECORDS___REF_NUM1 as REF_NUM1", \
	"FIL_UNCHANGED_RECORDS___REF_NUM2 as REF_NUM2", \
	"FIL_UNCHANGED_RECORDS___REF_NUM3 as REF_NUM3", \
	"FIL_UNCHANGED_RECORDS___REF_NUM4 as REF_NUM4", \
	"FIL_UNCHANGED_RECORDS___REF_NUM5 as REF_NUM5", \
	"FIL_UNCHANGED_RECORDS___INVOICE_DATE as INVOICE_DATE", \
	"FIL_UNCHANGED_RECORDS___INVOICE_NUMBER as INVOICE_NUMBER", \
	"FIL_UNCHANGED_RECORDS___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"FIL_UNCHANGED_RECORDS___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"FIL_UNCHANGED_RECORDS___TRAILER_CLOSED as TRAILER_CLOSED", \
	"FIL_UNCHANGED_RECORDS___IS_GIFT as IS_GIFT", \
	"FIL_UNCHANGED_RECORDS___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"FIL_UNCHANGED_RECORDS___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"CURRENT_TIMESTAMP as UPDATE_TSTMP", \
	"IF(FIL_UNCHANGED_RECORDS___i_LOAD_TSTMP IS NULL, CURRENT_TIMESTAMP, FIL_UNCHANGED_RECORDS___i_LOAD_TSTMP) as LOAD_TSTMP", \
	"IF(FIL_UNCHANGED_RECORDS___i_WM_ASN_ID IS NULL, 1, 2) as o_UPDATE_VALIDATOR" \
)

# COMMAND ----------
# Processing node UPD_INS_UPD, type UPDATE_STRATEGY . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 145

# for each involved DataFrame, append the dataframe name to each column
EXP_UPD_VALIDATOR_temp = EXP_UPD_VALIDATOR.toDF(*["EXP_UPD_VALIDATOR___" + col for col in EXP_UPD_VALIDATOR.columns])

UPD_INS_UPD = EXP_UPD_VALIDATOR_temp.selectExpr( \
	"EXP_UPD_VALIDATOR___LOCATION_ID as LOCATION_ID", \
	"EXP_UPD_VALIDATOR___ASN_ID as ASN_ID", \
	"EXP_UPD_VALIDATOR___TC_COMPANY_ID as TC_COMPANY_ID", \
	"EXP_UPD_VALIDATOR___TC_ASN_ID as TC_ASN_ID", \
	"EXP_UPD_VALIDATOR___TC_ASN_ID_U as TC_ASN_ID_U", \
	"EXP_UPD_VALIDATOR___ASN_TYPE as ASN_TYPE", \
	"EXP_UPD_VALIDATOR___ASN_STATUS as ASN_STATUS", \
	"EXP_UPD_VALIDATOR___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"EXP_UPD_VALIDATOR___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"EXP_UPD_VALIDATOR___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"EXP_UPD_VALIDATOR___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"EXP_UPD_VALIDATOR___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"EXP_UPD_VALIDATOR___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"EXP_UPD_VALIDATOR___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"EXP_UPD_VALIDATOR___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"EXP_UPD_VALIDATOR___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"EXP_UPD_VALIDATOR___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"EXP_UPD_VALIDATOR___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"EXP_UPD_VALIDATOR___RECEIPT_DTTM as RECEIPT_DTTM", \
	"EXP_UPD_VALIDATOR___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"EXP_UPD_VALIDATOR___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"EXP_UPD_VALIDATOR___REF_FIELD_1 as REF_FIELD_1", \
	"EXP_UPD_VALIDATOR___REF_FIELD_2 as REF_FIELD_2", \
	"EXP_UPD_VALIDATOR___REF_FIELD_3 as REF_FIELD_3", \
	"EXP_UPD_VALIDATOR___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"EXP_UPD_VALIDATOR___APPOINTMENT_ID as APPOINTMENT_ID", \
	"EXP_UPD_VALIDATOR___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"EXP_UPD_VALIDATOR___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"EXP_UPD_VALIDATOR___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"EXP_UPD_VALIDATOR___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"EXP_UPD_VALIDATOR___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"EXP_UPD_VALIDATOR___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"EXP_UPD_VALIDATOR___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"EXP_UPD_VALIDATOR___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"EXP_UPD_VALIDATOR___PRO_NUMBER as PRO_NUMBER", \
	"EXP_UPD_VALIDATOR___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"EXP_UPD_VALIDATOR___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"EXP_UPD_VALIDATOR___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"EXP_UPD_VALIDATOR___TOTAL_VOLUME as TOTAL_VOLUME", \
	"EXP_UPD_VALIDATOR___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"EXP_UPD_VALIDATOR___FIRM_APPT_IND_EXP as FIRM_APPT_IND", \
	"EXP_UPD_VALIDATOR___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"EXP_UPD_VALIDATOR___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"EXP_UPD_VALIDATOR___BUYER_CODE as BUYER_CODE", \
	"EXP_UPD_VALIDATOR___REP_NAME as REP_NAME", \
	"EXP_UPD_VALIDATOR___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"EXP_UPD_VALIDATOR___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"EXP_UPD_VALIDATOR___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"EXP_UPD_VALIDATOR___CONTACT_CITY as CONTACT_CITY", \
	"EXP_UPD_VALIDATOR___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"EXP_UPD_VALIDATOR___CONTACT_ZIP as CONTACT_ZIP", \
	"EXP_UPD_VALIDATOR___CONTACT_NUMBER as CONTACT_NUMBER", \
	"EXP_UPD_VALIDATOR___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"EXP_UPD_VALIDATOR___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"EXP_UPD_VALIDATOR___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"EXP_UPD_VALIDATOR___REGION_ID as REGION_ID", \
	"EXP_UPD_VALIDATOR___ASN_LEVEL as ASN_LEVEL", \
	"EXP_UPD_VALIDATOR___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"EXP_UPD_VALIDATOR___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"EXP_UPD_VALIDATOR___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"EXP_UPD_VALIDATOR___HAS_ALERTS as HAS_ALERTS", \
	"EXP_UPD_VALIDATOR___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"EXP_UPD_VALIDATOR___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"EXP_UPD_VALIDATOR___ASN_PRIORITY as ASN_PRIORITY", \
	"EXP_UPD_VALIDATOR___SCHEDULE_APPT as SCHEDULE_APPT", \
	"EXP_UPD_VALIDATOR___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"EXP_UPD_VALIDATOR___IS_CANCELLED as IS_CANCELLED", \
	"EXP_UPD_VALIDATOR___IS_CLOSED as IS_CLOSED", \
	"EXP_UPD_VALIDATOR___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"EXP_UPD_VALIDATOR___MANIF_NBR as MANIF_NBR", \
	"EXP_UPD_VALIDATOR___MANIF_TYPE as MANIF_TYPE", \
	"EXP_UPD_VALIDATOR___WORK_ORD_NBR as WORK_ORD_NBR", \
	"EXP_UPD_VALIDATOR___CUT_NBR as CUT_NBR", \
	"EXP_UPD_VALIDATOR___MFG_PLNT as MFG_PLNT", \
	"EXP_UPD_VALIDATOR___IS_WHSE_TRANSFER_EXP as IS_WHSE_TRANSFER", \
	"EXP_UPD_VALIDATOR___QUALITY_CHECK_HOLD_UPON_RCPT_EXP as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"EXP_UPD_VALIDATOR___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"EXP_UPD_VALIDATOR___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"EXP_UPD_VALIDATOR___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"EXP_UPD_VALIDATOR___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"EXP_UPD_VALIDATOR___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"EXP_UPD_VALIDATOR___VERIFIED_DTTM as VERIFIED_DTTM", \
	"EXP_UPD_VALIDATOR___LABEL_PRINT_REQD_EXP as LABEL_PRINT_REQD", \
	"EXP_UPD_VALIDATOR___INITIATE_FLAG as INITIATE_FLAG", \
	"EXP_UPD_VALIDATOR___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"EXP_UPD_VALIDATOR___CREATED_SOURCE as CREATED_SOURCE", \
	"EXP_UPD_VALIDATOR___CREATED_DTTM as CREATED_DTTM", \
	"EXP_UPD_VALIDATOR___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"EXP_UPD_VALIDATOR___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"EXP_UPD_VALIDATOR___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"EXP_UPD_VALIDATOR___SHIPMENT_ID as SHIPMENT_ID", \
	"EXP_UPD_VALIDATOR___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"EXP_UPD_VALIDATOR___VERIFICATION_ATTEMPTED_EXP as VERIFICATION_ATTEMPTED", \
	"EXP_UPD_VALIDATOR___FLOW_THRU_ALLOC_IN_PROG_EXP as FLOW_THRU_ALLOC_IN_PROG", \
	"EXP_UPD_VALIDATOR___ALLOCATION_COMPLETED_EXP as ALLOCATION_COMPLETED", \
	"EXP_UPD_VALIDATOR___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"EXP_UPD_VALIDATOR___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"EXP_UPD_VALIDATOR___DC_ORD_NBR as DC_ORD_NBR", \
	"EXP_UPD_VALIDATOR___CONTRAC_LOCN as CONTRAC_LOCN", \
	"EXP_UPD_VALIDATOR___MHE_SENT as MHE_SENT", \
	"EXP_UPD_VALIDATOR___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"EXP_UPD_VALIDATOR___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"EXP_UPD_VALIDATOR___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"EXP_UPD_VALIDATOR___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"EXP_UPD_VALIDATOR___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"EXP_UPD_VALIDATOR___MODE_ID as MODE_ID", \
	"EXP_UPD_VALIDATOR___SHIPPING_COST as SHIPPING_COST", \
	"EXP_UPD_VALIDATOR___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"EXP_UPD_VALIDATOR___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"EXP_UPD_VALIDATOR___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"EXP_UPD_VALIDATOR___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"EXP_UPD_VALIDATOR___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"EXP_UPD_VALIDATOR___DRIVER_NAME as DRIVER_NAME", \
	"EXP_UPD_VALIDATOR___TRAILER_NUMBER as TRAILER_NUMBER", \
	"EXP_UPD_VALIDATOR___DESTINATION_TYPE as DESTINATION_TYPE", \
	"EXP_UPD_VALIDATOR___CONTACT_COUNTY as CONTACT_COUNTY", \
	"EXP_UPD_VALIDATOR___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"EXP_UPD_VALIDATOR___RECEIPT_TYPE as RECEIPT_TYPE", \
	"EXP_UPD_VALIDATOR___VARIANCE_TYPE as VARIANCE_TYPE", \
	"EXP_UPD_VALIDATOR___HAS_NOTES as HAS_NOTES", \
	"EXP_UPD_VALIDATOR___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"EXP_UPD_VALIDATOR___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"EXP_UPD_VALIDATOR___REF_FIELD_4 as REF_FIELD_4", \
	"EXP_UPD_VALIDATOR___REF_FIELD_5 as REF_FIELD_5", \
	"EXP_UPD_VALIDATOR___REF_FIELD_6 as REF_FIELD_6", \
	"EXP_UPD_VALIDATOR___REF_FIELD_7 as REF_FIELD_7", \
	"EXP_UPD_VALIDATOR___REF_FIELD_8 as REF_FIELD_8", \
	"EXP_UPD_VALIDATOR___REF_FIELD_9 as REF_FIELD_9", \
	"EXP_UPD_VALIDATOR___REF_FIELD_10 as REF_FIELD_10", \
	"EXP_UPD_VALIDATOR___REF_NUM1 as REF_NUM1", \
	"EXP_UPD_VALIDATOR___REF_NUM2 as REF_NUM2", \
	"EXP_UPD_VALIDATOR___REF_NUM3 as REF_NUM3", \
	"EXP_UPD_VALIDATOR___REF_NUM4 as REF_NUM4", \
	"EXP_UPD_VALIDATOR___REF_NUM5 as REF_NUM5", \
	"EXP_UPD_VALIDATOR___INVOICE_DATE as INVOICE_DATE", \
	"EXP_UPD_VALIDATOR___INVOICE_NUMBER as INVOICE_NUMBER", \
	"EXP_UPD_VALIDATOR___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"EXP_UPD_VALIDATOR___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"EXP_UPD_VALIDATOR___TRAILER_CLOSED as TRAILER_CLOSED", \
	"EXP_UPD_VALIDATOR___IS_GIFT as IS_GIFT", \
	"EXP_UPD_VALIDATOR___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"EXP_UPD_VALIDATOR___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"EXP_UPD_VALIDATOR___UPDATE_TSTMP as UPDATE_TSTMP", \
	"EXP_UPD_VALIDATOR___LOAD_TSTMP as LOAD_TSTMP", \
	"EXP_UPD_VALIDATOR___o_UPDATE_VALIDATOR as o_UPDATE_VALIDATOR") \
	.withColumn('pyspark_data_action', when(col('o_UPDATE_VALIDATOR') ==(lit(1)) , lit(0)).when(col('o_UPDATE_VALIDATOR') ==(lit(2)) , lit(1)))

# COMMAND ----------
# Processing node Shortcut_to_WM_ASN1, type TARGET 
# COLUMN COUNT: 144

Shortcut_to_WM_ASN1 = UPD_INS_UPD.selectExpr( 
	"CAST(LOCATION_ID AS BIGINT) as LOCATION_ID", 
	"CAST(ASN_ID AS BIGINT) as WM_ASN_ID", 
	"CAST(TC_ASN_ID AS STRING) as WM_TC_ASN_ID", 
	"CAST(TC_ASN_ID_U AS STRING) as WM_TC_ASN_ID_UPPER_CASE", 
	"CAST(TC_COMPANY_ID AS BIGINT) as WM_TC_COMPANY_ID", 
	"CAST(ASN_TYPE AS BIGINT) as WM_ASN_TYPE", 
	"CAST(ASN_LEVEL AS BIGINT) as WM_ASN_LEVEL", 
	"CAST(ASN_PRIORITY AS BIGINT) as WM_ASN_PRIORITY", 
	"CAST(ASN_SHPMT_TYPE AS STRING) as WM_ASN_SHPMT_TYPE", 
	"CAST(ASN_STATUS AS BIGINT) as WM_ASN_STATUS", 
	"CAST(APPOINTMENT_ID AS STRING) as WM_APPOINTMENT_ID", 
	"CAST(APPOINTMENT_DTTM AS TIMESTAMP) as WM_APPOINTMENT_TSTMP", 
	"CAST(APPOINTMENT_DURATION AS BIGINT) as APPOINTMENT_DURATION", 
	"CAST(SHIPMENT_ID AS BIGINT) as WM_SHIPMENT_ID", 
	"CAST(TC_SHIPMENT_ID AS STRING) as WM_TC_SHIPMENT_ID", 
	"CAST(INVOICE_NUMBER AS STRING) as WM_INVOICE_NBR", 
	"CAST(INVOICE_DATE AS TIMESTAMP) as WM_INVOICE_TSTMP", 
	"CAST(DC_ORD_NBR AS STRING) as WM_DC_ORD_NBR", 
	"CAST(WORK_ORD_NBR AS STRING) as WM_WORK_ORD_NBR", 
	"CAST(ORIGINAL_ASN_ID AS BIGINT) as WM_ORIGINAL_ASN_ID", 
	"CAST(ASN_ORGN_TYPE AS STRING) as WM_ASN_ORGN_TYPE", 
	"CAST(ORIGINAL_ORDER_NUMBER AS STRING) as WM_ORIGINAL_ORDER_NBR", 
	"CAST(ORIGIN_FACILITY_ALIAS_ID AS STRING) as WM_ORIGIN_FACILITY_ALIAS_ID", 
	"CAST(ORIGIN_FACILITY_ID AS BIGINT) as WM_ORIGIN_FACILITY_ID", 
	"CAST(DESTINATION_FACILITY_ALIAS_ID AS STRING) as WM_DESTINATION_FACILITY_ALIAS_ID", 
	"CAST(DESTINATION_FACILITY_ID AS BIGINT) as WM_DESTINATION_FACILITY_ID", 
	"CAST(RETURN_REFERENCE_NUMBER AS STRING) as WM_RETURN_REFERENCE_NBR", 
	"CAST(DELIVERY_STOP_SEQ AS BIGINT) as WM_DELIVERY_STOP_SEQ", 
	"CAST(RECEIPT_TYPE AS BIGINT) as WM_RECEIPT_TYPE", 
	"CAST(RECEIPT_VARIANCE AS BIGINT) as WM_RECEIPT_VARIANCE", 
	"CAST(PRE_RECEIPT_STATUS AS STRING) as WM_PRE_RECEIPT_STATUS", 
	"CAST(RECEIPT_DTTM AS TIMESTAMP) as WM_RECEIPT_TSTMP", 
	"CAST(FIRST_RECEIPT_DTTM AS TIMESTAMP) as WM_FIRST_RECEIPT_TSTMP", 
	"CAST(LAST_RECEIPT_DTTM AS TIMESTAMP) as WM_LAST_RECEIPT_TSTMP", 
	"CAST(VERIFICATION_ATTEMPTED AS BIGINT) as VERIFICATION_ATTEMPTED_FLAG", 
	"CAST(VERIFIED_DTTM AS TIMESTAMP) as WM_VERIFIED_TSTMP", 
	"CAST(PICKUP_END_DTTM AS TIMESTAMP) as WM_PICKUP_END_TSTMP", 
	"CAST(ACTUAL_DEPARTURE_DTTM AS TIMESTAMP) as WM_ACTUAL_DEPARTURE_TSTMP", 
	"CAST(ACTUAL_ARRIVAL_DTTM AS TIMESTAMP) as WM_ACTUAL_ARRIVAL_TSTMP", 
	"CAST(ACTUAL_SHIPPED_DTTM AS TIMESTAMP) as WM_ACTUAL_SHIPPED_TSTMP", 
	"CAST(DELIVERY_START_DTTM AS TIMESTAMP) as WM_DELIVERY_START_TSTMP", 
	"CAST(DELIVERY_END_DTTM AS TIMESTAMP) as WM_DELIVERY_END_TSTMP", 
	"CAST(LAST_TRANSMITTED_DTTM AS TIMESTAMP) as WM_LAST_TRANSMITTED_TSTMP", 
	"CAST(FLOW_THRU_ALLOC_IN_PROG AS BIGINT) as FLOW_THRU_ALLOC_IN_PROG_FLAG", 
	"CAST(FLOW_THROUGH_ALLOCATION_METHOD AS STRING) as WM_FLOW_THROUGH_ALLOCATION_METHOD", 
	"CAST(FLOWTHROUGH_ALLOCATION_STATUS AS BIGINT) as WM_FLOW_THROUGH_ALLOCATION_STATUS", 
	"CAST(BUSINESS_PARTNER_ID AS STRING) as WM_BUSINESS_PARTNER_ID", 
	"CAST(BILL_OF_LADING_NUMBER AS STRING) as WM_BILL_OF_LADING_NBR", 
	"CAST(MANIF_NBR AS STRING) as WM_MANIF_NBR", 
	"CAST(MANIF_TYPE AS STRING) as WM_MANIF_TYPE", 
	"CAST(PRO_NUMBER AS STRING) as WM_PRO_NBR", 
	"CAST(EQUIPMENT_CODE_ID AS BIGINT) as WM_EQUIPMENT_CD_ID", 
	"CAST(EQUIPMENT_CODE AS STRING) as WM_EQUIPMENT_CD", 
	"CAST(EQUIPMENT_TYPE AS STRING) as WM_EQUIPMENT_TYPE", 
	"CAST(TRACTOR_NUMBER AS STRING) as WM_TRACTOR_NBR", 
	"CAST(TRACTOR_CARRIER_CODE_ID AS BIGINT) as WM_TRACTOR_CARRIER_CD_ID", 
	"CAST(TRACTOR_CARRIER_CODE AS STRING) as WM_TRACTOR_CARRIER_CD", 
	"CAST(REGION_ID AS BIGINT) as WM_REGION_ID", 
	"CAST(INBOUND_REGION_ID AS BIGINT) as WM_INBOUND_REGION_ID", 
	"CAST(INBOUND_REGION_NAME AS STRING) as WM_INBOUND_REGION_NAME", 
	"CAST(IS_ASSOCIATED_TO_OUTBOUND AS BIGINT) as ASSOCIATED_TO_OUTBOUND_FLAG", 
	"CAST(OUTBOUND_REGION_ID AS BIGINT) as WM_OUTBOUND_REGION_ID", 
	"CAST(OUTBOUND_REGION_NAME AS STRING) as WM_OUTBOUND_REGION_NAME", 
	"CAST(ASSIGNED_CARRIER_CODE_ID AS BIGINT) as WM_ASSIGNED_CARRIER_CD_ID", 
	"CAST(ASSIGNED_CARRIER_CODE AS STRING) as WM_ASSIGNED_CARRIER_CD", 
	"CAST(CUT_NBR AS STRING) as WM_CUT_NBR", 
	"CAST(MFG_PLNT AS STRING) as WM_MFG_PLNT", 
	"CAST(DOCK_DOOR_ID AS BIGINT) as WM_DOCK_DOOR_ID", 
	"CAST(MODE_ID AS BIGINT) as WM_MODE_ID", 
	"CAST(TRAILER_NUMBER AS STRING) as WM_TRAILER_NBR", 
	"CAST(TRAILER_CLOSED AS BIGINT) as TRAILER_CLOSED_FLAG", 
	"CAST(DESTINATION_TYPE AS STRING) as WM_DESTINATION_TYPE", 
	"CAST(VARIANCE_TYPE AS BIGINT) as WM_VARIANCE_TYPE", 
	"CAST(CONTRAC_LOCN AS STRING) as WM_CONTRAC_LOCN", 
	"CAST(MHE_SENT AS STRING) as WM_MHE_SENT", 
	"CAST(BUYER_CODE AS STRING) as WM_BUYER_CD", 
	"CAST(REP_NAME AS STRING) as WM_REP_NAME", 
	"CAST(DRIVER_NAME AS STRING) as DRIVER_NAME", 
	"CAST(FIRM_APPT_IND AS BIGINT) as FIRM_APPT_FLAG", 
	"CAST(HAS_ALERTS AS BIGINT) as ALERTS_FLAG", 
	"CAST(SYSTEM_ALLOCATED AS BIGINT) as SYSTEM_ALLOCATED_FLAG", 
	"CAST(IS_COGI_GENERATED AS BIGINT) as COGI_GENERATED_FLAG", 
	"CAST(SCHEDULE_APPT AS BIGINT) as WM_SCHEDULE_APPT_IND", 
	"CAST(IS_WHSE_TRANSFER AS BIGINT) as WHSE_TRANSFER_FLAG", 
	"CAST(HAS_NOTES AS BIGINT) as HAS_NOTES_FLAG", 
	"CAST(IS_GIFT AS BIGINT) as GIFT_FLAG", 
	"CAST(QUALITY_CHECK_HOLD_UPON_RCPT AS BIGINT) as QUALITY_CHECK_HOLD_UPON_RCPT_FLAG", 
	"CAST(LABEL_PRINT_REQD AS BIGINT) as LABEL_PRINT_REQD_FLAG", 
	"CAST(INITIATE_FLAG AS STRING) as INITIATE_IND", 
	"CAST(ALLOCATION_COMPLETED AS BIGINT) as ALLOCATION_COMPLETED_FLAG", 
	"CAST(PALLET_FOOTPRINT AS STRING) as WM_PALLET_FOOTPRINT", 
	"CAST(PRE_ALLOCATION_FIT_PERCENTAGE AS BIGINT) as PRE_ALLOCATION_FIT_PCT", 
	"CAST(QUALITY_AUDIT_PERCENT AS BIGINT) as QUALITY_AUDIT_PCT", 
	"CAST(SHIPPED_LPN_COUNT AS BIGINT) as WM_SHIPPED_LPN_CNT", 
	"CAST(RECEIVED_LPN_COUNT AS BIGINT) as WM_RECEIVED_LPN_CNT", 
	"CAST(TOTAL_SHIPPED_QTY AS BIGINT) as TOTAL_SHIPPED_QTY", 
	"CAST(TOTAL_RECEIVED_QTY AS BIGINT) as TOTAL_RECEIVED_QTY", 
	"CAST(TOTAL_WEIGHT AS BIGINT) as TOTAL_WEIGHT", 
	"CAST(TOTAL_VOLUME AS BIGINT) as TOTAL_VOLUME", 
	"CAST(QTY_UOM_ID_BASE AS BIGINT) as WM_QTY_UOM_ID_BASE", 
	"CAST(WEIGHT_UOM_ID_BASE AS BIGINT) as WM_WEIGHT_UOM_ID_BASE", 
	"CAST(VOLUME_UOM_ID_BASE AS BIGINT) as WM_VOLUME_UOM_ID_BASE", 
	"CAST(SHIPPING_COST AS BIGINT) as SHIPPING_COST", 
	"CAST(SHIPPING_COST_CURRENCY_CODE AS STRING) as SHIPPING_COST_CURRENCY_CD", 
	"CAST(CONTACT_NUMBER AS STRING) as WM_CONTACT_NBR", 
	"CAST(CONTACT_ADDRESS_1 AS STRING) as CONTACT_ADDR_1", 
	"CAST(CONTACT_ADDRESS_2 AS STRING) as CONTACT_ADDR_2", 
	"CAST(CONTACT_ADDRESS_3 AS STRING) as CONTACT_ADDR_3", 
	"CAST(CONTACT_CITY AS STRING) as CONTACT_CITY", 
	"CAST(CONTACT_STATE_PROV AS STRING) as CONTACT_STATE_PROV", 
	"CAST(CONTACT_ZIP AS STRING) as CONTACT_ZIP", 
	"CAST(CONTACT_COUNTY AS STRING) as CONTACT_COUNTY", 
	"CAST(CONTACT_COUNTRY_CODE AS STRING) as CONTACT_COUNTRY_CD", 
	"CAST(HAS_IMPORT_ERROR AS BIGINT) as IMPORT_ERROR_FLAG", 
	"CAST(HAS_SOFT_CHECK_ERROR AS BIGINT) as SOFT_CHECK_ERROR_FLAG", 
	"CAST(IS_CANCELLED AS BIGINT) as CANCELLED_FLAG", 
	"CAST(IS_CLOSED AS BIGINT) as CLOSED_FLAG", 
	"CAST(REF_FIELD_1 AS STRING) as REF_FIELD_1", 
	"CAST(REF_FIELD_2 AS STRING) as REF_FIELD_2", 
	"CAST(REF_FIELD_3 AS STRING) as REF_FIELD_3", 
	"CAST(REF_FIELD_4 AS STRING) as REF_FIELD_4", 
	"CAST(REF_FIELD_5 AS STRING) as REF_FIELD_5", 
	"CAST(REF_FIELD_6 AS STRING) as REF_FIELD_6", 
	"CAST(REF_FIELD_7 AS STRING) as REF_FIELD_7", 
	"CAST(REF_FIELD_8 AS STRING) as REF_FIELD_8", 
	"CAST(REF_FIELD_9 AS STRING) as REF_FIELD_9", 
	"CAST(REF_FIELD_10 AS STRING) as REF_FIELD_10", 
	"CAST(REF_NUM1 AS BIGINT) as REF_NUM_1", 
	"CAST(REF_NUM2 AS BIGINT) as REF_NUM_2", 
	"CAST(REF_NUM3 AS BIGINT) as REF_NUM_3", 
	"CAST(REF_NUM4 AS BIGINT) as REF_NUM_4", 
	"CAST(REF_NUM5 AS BIGINT) as REF_NUM_5", 
	"CAST(MISC_INSTR_CODE_1 AS STRING) as MISC_INSTR_CD_1", 
	"CAST(MISC_INSTR_CODE_2 AS STRING) as MISC_INSTR_CD_2", 
	"CAST(HIBERNATE_VERSION AS BIGINT) as WM_HIBERNATE_VERSION", 
	"CAST(EXT_CREATED_DTTM AS TIMESTAMP) as WM_EXT_CREATED_TSTMP", 
	"CAST(CREATED_SOURCE_TYPE AS BIGINT) as WM_CREATED_SOURCE_TYPE", 
	"CAST(CREATED_SOURCE AS STRING) as WM_CREATED_SOURCE", 
	"CAST(CREATED_DTTM AS TIMESTAMP) as WM_CREATED_TSTMP", 
	"CAST(LAST_UPDATED_SOURCE_TYPE AS BIGINT) as WM_LAST_UPDATED_SOURCE_TYPE", 
	"CAST(LAST_UPDATED_SOURCE AS STRING) as WM_LAST_UPDATED_SOURCE", 
	"CAST(LAST_UPDATED_DTTM AS TIMESTAMP) as WM_LAST_UPDATED_TSTMP", 
	"CAST(UPDATE_TSTMP AS TIMESTAMP) as UPDATE_TSTMP", 
	"CAST(LOAD_TSTMP AS TIMESTAMP) as LOAD_TSTMP", 
    "pyspark_data_action" 
)

try:
  primary_key = """source.LOCATION_ID = target.LOCATION_ID AND source.WM_ASN_ID = target.WM_ASN_ID"""
#   refined_perf_table = "WM_ASN"
  executeMerge(Shortcut_to_WM_ASN1, refined_perf_table, primary_key)
  logger.info(f"Merge with {refined_perf_table} completed]")
  logPrevRunDt("WM_ASN", "WM_ASN", "Completed", "N/A", f"{raw}.log_run_details")
except Exception as e:
  logPrevRunDt("WM_ASN", "WM_ASN","Failed",str(e), f"{raw}.log_run_details", )
  raise e
	