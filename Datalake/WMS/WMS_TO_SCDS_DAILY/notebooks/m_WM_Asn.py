#Code converted on 2023-06-15 14:12:38
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from pyspark.dbutils import DBUtils
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from Datalake.utils.logger import *
# COMMAND ----------

parser = argparse.ArgumentParser()
spark = SparkSession.getActiveSession()
dbutils = DBUtils(spark)

parser.add_argument('env', type=str, help='Env Variable')
args = parser.parse_args()
env = args.env

if env is None or env == '':
    raise ValueError('env is not set')

refine = getEnvPrefix(env) + 'refine'
raw = getEnvPrefix(env) + 'raw'
legacy = getEnvPrefix(env) + 'legacy'

# Set global variables
starttime = datetime.now() #start timestamp of the script
refined_perf_table = f"{refine}.WM_ASN"
raw_perf_table = f"{raw}.WM_ASN_PRE"
site_profile_table = f"{legacy}.SITE_PROFILE"

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ASN_PRE, type SOURCE 
# COLUMN COUNT: 142

SQ_Shortcut_to_WM_ASN_PRE = (spark.sql("""SELECT
WM_ASN_PRE.DC_NBR,
WM_ASN_PRE.ASN_ID,
WM_ASN_PRE.TC_COMPANY_ID,
WM_ASN_PRE.TC_ASN_ID,
WM_ASN_PRE.TC_ASN_ID_U,
WM_ASN_PRE.ASN_TYPE,
WM_ASN_PRE.ASN_STATUS,
WM_ASN_PRE.TRACTOR_NUMBER,
WM_ASN_PRE.DELIVERY_STOP_SEQ,
WM_ASN_PRE.ORIGIN_FACILITY_ALIAS_ID,
WM_ASN_PRE.ORIGIN_FACILITY_ID,
WM_ASN_PRE.PICKUP_END_DTTM,
WM_ASN_PRE.ACTUAL_DEPARTURE_DTTM,
WM_ASN_PRE.DESTINATION_FACILITY_ALIAS_ID,
WM_ASN_PRE.DESTINATION_FACILITY_ID,
WM_ASN_PRE.DELIVERY_START_DTTM,
WM_ASN_PRE.DELIVERY_END_DTTM,
WM_ASN_PRE.ACTUAL_ARRIVAL_DTTM,
WM_ASN_PRE.RECEIPT_DTTM,
WM_ASN_PRE.INBOUND_REGION_NAME,
WM_ASN_PRE.OUTBOUND_REGION_NAME,
WM_ASN_PRE.REF_FIELD_1,
WM_ASN_PRE.REF_FIELD_2,
WM_ASN_PRE.REF_FIELD_3,
WM_ASN_PRE.TOTAL_WEIGHT,
WM_ASN_PRE.APPOINTMENT_ID,
WM_ASN_PRE.APPOINTMENT_DTTM,
WM_ASN_PRE.APPOINTMENT_DURATION,
WM_ASN_PRE.PALLET_FOOTPRINT,
WM_ASN_PRE.LAST_TRANSMITTED_DTTM,
WM_ASN_PRE.TOTAL_SHIPPED_QTY,
WM_ASN_PRE.TOTAL_RECEIVED_QTY,
WM_ASN_PRE.ASSIGNED_CARRIER_CODE,
WM_ASN_PRE.BILL_OF_LADING_NUMBER,
WM_ASN_PRE.PRO_NUMBER,
WM_ASN_PRE.EQUIPMENT_CODE,
WM_ASN_PRE.EQUIPMENT_CODE_ID,
WM_ASN_PRE.ASSIGNED_CARRIER_CODE_ID,
WM_ASN_PRE.TOTAL_VOLUME,
WM_ASN_PRE.VOLUME_UOM_ID_BASE,
WM_ASN_PRE.FIRM_APPT_IND,
WM_ASN_PRE.TRACTOR_CARRIER_CODE_ID,
WM_ASN_PRE.TRACTOR_CARRIER_CODE,
WM_ASN_PRE.BUYER_CODE,
WM_ASN_PRE.REP_NAME,
WM_ASN_PRE.CONTACT_ADDRESS_1,
WM_ASN_PRE.CONTACT_ADDRESS_2,
WM_ASN_PRE.CONTACT_ADDRESS_3,
WM_ASN_PRE.CONTACT_CITY,
WM_ASN_PRE.CONTACT_STATE_PROV,
WM_ASN_PRE.CONTACT_ZIP,
WM_ASN_PRE.CONTACT_NUMBER,
WM_ASN_PRE.EXT_CREATED_DTTM,
WM_ASN_PRE.INBOUND_REGION_ID,
WM_ASN_PRE.OUTBOUND_REGION_ID,
WM_ASN_PRE.REGION_ID,
WM_ASN_PRE.ASN_LEVEL,
WM_ASN_PRE.RECEIPT_VARIANCE,
WM_ASN_PRE.HAS_IMPORT_ERROR,
WM_ASN_PRE.HAS_SOFT_CHECK_ERROR,
WM_ASN_PRE.HAS_ALERTS,
WM_ASN_PRE.SYSTEM_ALLOCATED,
WM_ASN_PRE.IS_COGI_GENERATED,
WM_ASN_PRE.ASN_PRIORITY,
WM_ASN_PRE.SCHEDULE_APPT,
WM_ASN_PRE.IS_ASSOCIATED_TO_OUTBOUND,
WM_ASN_PRE.IS_CANCELLED,
WM_ASN_PRE.IS_CLOSED,
WM_ASN_PRE.BUSINESS_PARTNER_ID,
WM_ASN_PRE.MANIF_NBR,
WM_ASN_PRE.MANIF_TYPE,
WM_ASN_PRE.WORK_ORD_NBR,
WM_ASN_PRE.CUT_NBR,
WM_ASN_PRE.MFG_PLNT,
WM_ASN_PRE.IS_WHSE_TRANSFER,
WM_ASN_PRE.QUALITY_CHECK_HOLD_UPON_RCPT,
WM_ASN_PRE.QUALITY_AUDIT_PERCENT,
WM_ASN_PRE.SHIPPED_LPN_COUNT,
WM_ASN_PRE.RECEIVED_LPN_COUNT,
WM_ASN_PRE.ACTUAL_SHIPPED_DTTM,
WM_ASN_PRE.LAST_RECEIPT_DTTM,
WM_ASN_PRE.VERIFIED_DTTM,
WM_ASN_PRE.LABEL_PRINT_REQD,
WM_ASN_PRE.INITIATE_FLAG,
WM_ASN_PRE.CREATED_SOURCE_TYPE,
WM_ASN_PRE.CREATED_SOURCE,
WM_ASN_PRE.CREATED_DTTM,
WM_ASN_PRE.LAST_UPDATED_SOURCE_TYPE,
WM_ASN_PRE.LAST_UPDATED_SOURCE,
WM_ASN_PRE.LAST_UPDATED_DTTM,
WM_ASN_PRE.SHIPMENT_ID,
WM_ASN_PRE.TC_SHIPMENT_ID,
WM_ASN_PRE.VERIFICATION_ATTEMPTED,
WM_ASN_PRE.FLOW_THRU_ALLOC_IN_PROG,
WM_ASN_PRE.ALLOCATION_COMPLETED,
WM_ASN_PRE.EQUIPMENT_TYPE,
WM_ASN_PRE.ASN_ORGN_TYPE,
WM_ASN_PRE.DC_ORD_NBR,
WM_ASN_PRE.CONTRAC_LOCN,
WM_ASN_PRE.MHE_SENT,
WM_ASN_PRE.FLOW_THROUGH_ALLOCATION_METHOD,
WM_ASN_PRE.FIRST_RECEIPT_DTTM,
WM_ASN_PRE.MISC_INSTR_CODE_1,
WM_ASN_PRE.MISC_INSTR_CODE_2,
WM_ASN_PRE.DOCK_DOOR_ID,
WM_ASN_PRE.MODE_ID,
WM_ASN_PRE.SHIPPING_COST,
WM_ASN_PRE.SHIPPING_COST_CURRENCY_CODE,
WM_ASN_PRE.FLOWTHROUGH_ALLOCATION_STATUS,
WM_ASN_PRE.HIBERNATE_VERSION,
WM_ASN_PRE.QTY_UOM_ID_BASE,
WM_ASN_PRE.WEIGHT_UOM_ID_BASE,
WM_ASN_PRE.DRIVER_NAME,
WM_ASN_PRE.TRAILER_NUMBER,
WM_ASN_PRE.DESTINATION_TYPE,
WM_ASN_PRE.CONTACT_COUNTY,
WM_ASN_PRE.CONTACT_COUNTRY_CODE,
WM_ASN_PRE.RECEIPT_TYPE,
WM_ASN_PRE.VARIANCE_TYPE,
WM_ASN_PRE.HAS_NOTES,
WM_ASN_PRE.ORIGINAL_ASN_ID,
WM_ASN_PRE.RETURN_REFERENCE_NUMBER,
WM_ASN_PRE.REF_FIELD_4,
WM_ASN_PRE.REF_FIELD_5,
WM_ASN_PRE.REF_FIELD_6,
WM_ASN_PRE.REF_FIELD_7,
WM_ASN_PRE.REF_FIELD_8,
WM_ASN_PRE.REF_FIELD_9,
WM_ASN_PRE.REF_FIELD_10,
WM_ASN_PRE.REF_NUM1,
WM_ASN_PRE.REF_NUM2,
WM_ASN_PRE.REF_NUM3,
WM_ASN_PRE.REF_NUM4,
WM_ASN_PRE.REF_NUM5,
WM_ASN_PRE.INVOICE_DATE,
WM_ASN_PRE.INVOICE_NUMBER,
WM_ASN_PRE.PRE_RECEIPT_STATUS,
WM_ASN_PRE.PRE_ALLOCATION_FIT_PERCENTAGE,
WM_ASN_PRE.TRAILER_CLOSED,
WM_ASN_PRE.IS_GIFT,
WM_ASN_PRE.ORIGINAL_ORDER_NUMBER,
WM_ASN_PRE.ASN_SHPMT_TYPE
FROM {raw_perf_table}""")
).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_ASN, type SOURCE 
# COLUMN COUNT: 5

SQ_Shortcut_to_WM_ASN = (spark.sql("""SELECT
WM_ASN.LOCATION_ID,
WM_ASN.WM_ASN_ID,
WM_ASN.WM_CREATED_TSTMP,
WM_ASN.WM_LAST_UPDATED_TSTMP,
WM_ASN.LOAD_TSTMP
FROM {refined_perf_table}
WHERE WM_ASN_ID IN (SELECT ASN_ID FROM {raw_perf_table})""")
).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_INT_CONVERSION, type EXPRESSION 
# COLUMN COUNT: 142

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_ASN_PRE_temp = SQ_Shortcut_to_WM_ASN_PRE.toDF(*["SQ_Shortcut_to_WM_ASN_PRE___" + col for col in SQ_Shortcut_to_WM_ASN_PRE.columns])

EXP_INT_CONVERSION = SQ_Shortcut_to_WM_ASN_PRE_temp.selectExpr( \
	"SQ_Shortcut_to_WM_ASN_PRE___sys_row_id as sys_row_id", \
	"cast(SQ_Shortcut_to_WM_ASN_PRE___DC_NBR as int) as o_DC_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_ID as ASN_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_COMPANY_ID as TC_COMPANY_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_ASN_ID as TC_ASN_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_ASN_ID_U as TC_ASN_ID_U", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_TYPE as ASN_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_STATUS as ASN_STATUS", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIPT_DTTM as RECEIPT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_1 as REF_FIELD_1", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_2 as REF_FIELD_2", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_3 as REF_FIELD_3", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"SQ_Shortcut_to_WM_ASN_PRE___APPOINTMENT_ID as APPOINTMENT_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"SQ_Shortcut_to_WM_ASN_PRE___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___PRO_NUMBER as PRO_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TOTAL_VOLUME as TOTAL_VOLUME", \
	"SQ_Shortcut_to_WM_ASN_PRE___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"SQ_Shortcut_to_WM_ASN_PRE___FIRM_APPT_IND as FIRM_APPT_IND", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___BUYER_CODE as BUYER_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___REP_NAME as REP_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_CITY as CONTACT_CITY", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_ZIP as CONTACT_ZIP", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_NUMBER as CONTACT_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___REGION_ID as REGION_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_LEVEL as ASN_LEVEL", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_ALERTS as HAS_ALERTS", \
	"SQ_Shortcut_to_WM_ASN_PRE___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_PRIORITY as ASN_PRIORITY", \
	"SQ_Shortcut_to_WM_ASN_PRE___SCHEDULE_APPT as SCHEDULE_APPT", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_CANCELLED as IS_CANCELLED", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_CLOSED as IS_CLOSED", \
	"SQ_Shortcut_to_WM_ASN_PRE___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___MANIF_NBR as MANIF_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___MANIF_TYPE as MANIF_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___WORK_ORD_NBR as WORK_ORD_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___CUT_NBR as CUT_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___MFG_PLNT as MFG_PLNT", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_WHSE_TRANSFER as IS_WHSE_TRANSFER", \
	"SQ_Shortcut_to_WM_ASN_PRE___QUALITY_CHECK_HOLD_UPON_RCPT as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"SQ_Shortcut_to_WM_ASN_PRE___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"SQ_Shortcut_to_WM_ASN_PRE___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___VERIFIED_DTTM as VERIFIED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___LABEL_PRINT_REQD as LABEL_PRINT_REQD", \
	"SQ_Shortcut_to_WM_ASN_PRE___INITIATE_FLAG as INITIATE_FLAG", \
	"SQ_Shortcut_to_WM_ASN_PRE___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___CREATED_SOURCE as CREATED_SOURCE", \
	"SQ_Shortcut_to_WM_ASN_PRE___CREATED_DTTM as CREATED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"SQ_Shortcut_to_WM_ASN_PRE___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPMENT_ID as SHIPMENT_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___VERIFICATION_ATTEMPTED as VERIFICATION_ATTEMPTED", \
	"SQ_Shortcut_to_WM_ASN_PRE___FLOW_THRU_ALLOC_IN_PROG as FLOW_THRU_ALLOC_IN_PROG", \
	"SQ_Shortcut_to_WM_ASN_PRE___ALLOCATION_COMPLETED as ALLOCATION_COMPLETED", \
	"SQ_Shortcut_to_WM_ASN_PRE___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___DC_ORD_NBR as DC_ORD_NBR", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTRAC_LOCN as CONTRAC_LOCN", \
	"SQ_Shortcut_to_WM_ASN_PRE___MHE_SENT as MHE_SENT", \
	"SQ_Shortcut_to_WM_ASN_PRE___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"SQ_Shortcut_to_WM_ASN_PRE___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"SQ_Shortcut_to_WM_ASN_PRE___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"SQ_Shortcut_to_WM_ASN_PRE___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"SQ_Shortcut_to_WM_ASN_PRE___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___MODE_ID as MODE_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPPING_COST as SHIPPING_COST", \
	"SQ_Shortcut_to_WM_ASN_PRE___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"SQ_Shortcut_to_WM_ASN_PRE___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"SQ_Shortcut_to_WM_ASN_PRE___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"SQ_Shortcut_to_WM_ASN_PRE___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"SQ_Shortcut_to_WM_ASN_PRE___DRIVER_NAME as DRIVER_NAME", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRAILER_NUMBER as TRAILER_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___DESTINATION_TYPE as DESTINATION_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_COUNTY as CONTACT_COUNTY", \
	"SQ_Shortcut_to_WM_ASN_PRE___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"SQ_Shortcut_to_WM_ASN_PRE___RECEIPT_TYPE as RECEIPT_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___VARIANCE_TYPE as VARIANCE_TYPE", \
	"SQ_Shortcut_to_WM_ASN_PRE___HAS_NOTES as HAS_NOTES", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"SQ_Shortcut_to_WM_ASN_PRE___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_4 as REF_FIELD_4", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_5 as REF_FIELD_5", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_6 as REF_FIELD_6", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_7 as REF_FIELD_7", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_8 as REF_FIELD_8", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_9 as REF_FIELD_9", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_FIELD_10 as REF_FIELD_10", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM1 as REF_NUM1", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM2 as REF_NUM2", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM3 as REF_NUM3", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM4 as REF_NUM4", \
	"SQ_Shortcut_to_WM_ASN_PRE___REF_NUM5 as REF_NUM5", \
	"SQ_Shortcut_to_WM_ASN_PRE___INVOICE_DATE as INVOICE_DATE", \
	"SQ_Shortcut_to_WM_ASN_PRE___INVOICE_NUMBER as INVOICE_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"SQ_Shortcut_to_WM_ASN_PRE___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"SQ_Shortcut_to_WM_ASN_PRE___TRAILER_CLOSED as TRAILER_CLOSED", \
	"SQ_Shortcut_to_WM_ASN_PRE___IS_GIFT as IS_GIFT", \
	"SQ_Shortcut_to_WM_ASN_PRE___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"SQ_Shortcut_to_WM_ASN_PRE___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE" \
)

# COMMAND ----------
# Processing node SQ_Shortcut_to_SITE_PROFILE, type SOURCE 
# COLUMN COUNT: 2

SQ_Shortcut_to_SITE_PROFILE = (spark.sql("""SELECT
SITE_PROFILE.LOCATION_ID,
SITE_PROFILE.STORE_NBR
FROM {site_profile_table}""")
).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node JNR_SITE_PROFILE, type JOINER 
# COLUMN COUNT: 144

JNR_SITE_PROFILE = SQ_Shortcut_to_SITE_PROFILE.join(EXP_INT_CONVERSION,[SQ_Shortcut_to_SITE_PROFILE.STORE_NBR == EXP_INT_CONVERSION.o_DC_NBR],'inner')

# COMMAND ----------
# Processing node JNR_WM_ASN, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 147

# for each involved DataFrame, append the dataframe name to each column
SQ_Shortcut_to_WM_ASN_temp = SQ_Shortcut_to_WM_ASN.toDF(*["SQ_Shortcut_to_WM_ASN___" + col for col in SQ_Shortcut_to_WM_ASN.columns])
JNR_SITE_PROFILE_temp = JNR_SITE_PROFILE.toDF(*["JNR_SITE_PROFILE___" + col for col in JNR_SITE_PROFILE.columns])

JNR_WM_ASN = SQ_Shortcut_to_WM_ASN_temp.join(JNR_SITE_PROFILE_temp,[SQ_Shortcut_to_WM_ASN_temp.SQ_Shortcut_to_WM_ASN___LOCATION_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___LOCATION_ID, SQ_Shortcut_to_WM_ASN_temp.SQ_Shortcut_to_WM_ASN___WM_ASN_ID == JNR_SITE_PROFILE_temp.JNR_SITE_PROFILE___ASN_ID],'right_outer').selectExpr( \
	"JNR_SITE_PROFILE___LOCATION_ID as LOCATION_ID", \
	"JNR_SITE_PROFILE___ASN_ID as ASN_ID", \
	"JNR_SITE_PROFILE___TC_COMPANY_ID as TC_COMPANY_ID", \
	"JNR_SITE_PROFILE___TC_ASN_ID as TC_ASN_ID", \
	"JNR_SITE_PROFILE___TC_ASN_ID_U as TC_ASN_ID_U", \
	"JNR_SITE_PROFILE___ASN_TYPE as ASN_TYPE", \
	"JNR_SITE_PROFILE___ASN_STATUS as ASN_STATUS", \
	"JNR_SITE_PROFILE___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"JNR_SITE_PROFILE___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"JNR_SITE_PROFILE___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"JNR_SITE_PROFILE___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"JNR_SITE_PROFILE___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"JNR_SITE_PROFILE___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"JNR_SITE_PROFILE___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"JNR_SITE_PROFILE___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"JNR_SITE_PROFILE___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"JNR_SITE_PROFILE___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"JNR_SITE_PROFILE___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"JNR_SITE_PROFILE___RECEIPT_DTTM as RECEIPT_DTTM", \
	"JNR_SITE_PROFILE___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"JNR_SITE_PROFILE___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"JNR_SITE_PROFILE___REF_FIELD_1 as REF_FIELD_1", \
	"JNR_SITE_PROFILE___REF_FIELD_2 as REF_FIELD_2", \
	"JNR_SITE_PROFILE___REF_FIELD_3 as REF_FIELD_3", \
	"JNR_SITE_PROFILE___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"JNR_SITE_PROFILE___APPOINTMENT_ID as APPOINTMENT_ID", \
	"JNR_SITE_PROFILE___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"JNR_SITE_PROFILE___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"JNR_SITE_PROFILE___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"JNR_SITE_PROFILE___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"JNR_SITE_PROFILE___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"JNR_SITE_PROFILE___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"JNR_SITE_PROFILE___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"JNR_SITE_PROFILE___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"JNR_SITE_PROFILE___PRO_NUMBER as PRO_NUMBER", \
	"JNR_SITE_PROFILE___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"JNR_SITE_PROFILE___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"JNR_SITE_PROFILE___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"JNR_SITE_PROFILE___TOTAL_VOLUME as TOTAL_VOLUME", \
	"JNR_SITE_PROFILE___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"JNR_SITE_PROFILE___FIRM_APPT_IND as FIRM_APPT_IND", \
	"JNR_SITE_PROFILE___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"JNR_SITE_PROFILE___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"JNR_SITE_PROFILE___BUYER_CODE as BUYER_CODE", \
	"JNR_SITE_PROFILE___REP_NAME as REP_NAME", \
	"JNR_SITE_PROFILE___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"JNR_SITE_PROFILE___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"JNR_SITE_PROFILE___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"JNR_SITE_PROFILE___CONTACT_CITY as CONTACT_CITY", \
	"JNR_SITE_PROFILE___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"JNR_SITE_PROFILE___CONTACT_ZIP as CONTACT_ZIP", \
	"JNR_SITE_PROFILE___CONTACT_NUMBER as CONTACT_NUMBER", \
	"JNR_SITE_PROFILE___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"JNR_SITE_PROFILE___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"JNR_SITE_PROFILE___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"JNR_SITE_PROFILE___REGION_ID as REGION_ID", \
	"JNR_SITE_PROFILE___ASN_LEVEL as ASN_LEVEL", \
	"JNR_SITE_PROFILE___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"JNR_SITE_PROFILE___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"JNR_SITE_PROFILE___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"JNR_SITE_PROFILE___HAS_ALERTS as HAS_ALERTS", \
	"JNR_SITE_PROFILE___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"JNR_SITE_PROFILE___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"JNR_SITE_PROFILE___ASN_PRIORITY as ASN_PRIORITY", \
	"JNR_SITE_PROFILE___SCHEDULE_APPT as SCHEDULE_APPT", \
	"JNR_SITE_PROFILE___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"JNR_SITE_PROFILE___IS_CANCELLED as IS_CANCELLED", \
	"JNR_SITE_PROFILE___IS_CLOSED as IS_CLOSED", \
	"JNR_SITE_PROFILE___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"JNR_SITE_PROFILE___MANIF_NBR as MANIF_NBR", \
	"JNR_SITE_PROFILE___MANIF_TYPE as MANIF_TYPE", \
	"JNR_SITE_PROFILE___WORK_ORD_NBR as WORK_ORD_NBR", \
	"JNR_SITE_PROFILE___CUT_NBR as CUT_NBR", \
	"JNR_SITE_PROFILE___MFG_PLNT as MFG_PLNT", \
	"JNR_SITE_PROFILE___IS_WHSE_TRANSFER as IS_WHSE_TRANSFER", \
	"JNR_SITE_PROFILE___QUALITY_CHECK_HOLD_UPON_RCPT as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"JNR_SITE_PROFILE___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"JNR_SITE_PROFILE___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"JNR_SITE_PROFILE___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"JNR_SITE_PROFILE___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"JNR_SITE_PROFILE___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"JNR_SITE_PROFILE___VERIFIED_DTTM as VERIFIED_DTTM", \
	"JNR_SITE_PROFILE___LABEL_PRINT_REQD as LABEL_PRINT_REQD", \
	"JNR_SITE_PROFILE___INITIATE_FLAG as INITIATE_FLAG", \
	"JNR_SITE_PROFILE___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___CREATED_SOURCE as CREATED_SOURCE", \
	"JNR_SITE_PROFILE___CREATED_DTTM as CREATED_DTTM", \
	"JNR_SITE_PROFILE___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"JNR_SITE_PROFILE___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"JNR_SITE_PROFILE___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"JNR_SITE_PROFILE___SHIPMENT_ID as SHIPMENT_ID", \
	"JNR_SITE_PROFILE___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"JNR_SITE_PROFILE___VERIFICATION_ATTEMPTED as VERIFICATION_ATTEMPTED", \
	"JNR_SITE_PROFILE___FLOW_THRU_ALLOC_IN_PROG as FLOW_THRU_ALLOC_IN_PROG", \
	"JNR_SITE_PROFILE___ALLOCATION_COMPLETED as ALLOCATION_COMPLETED", \
	"JNR_SITE_PROFILE___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"JNR_SITE_PROFILE___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"JNR_SITE_PROFILE___DC_ORD_NBR as DC_ORD_NBR", \
	"JNR_SITE_PROFILE___CONTRAC_LOCN as CONTRAC_LOCN", \
	"JNR_SITE_PROFILE___MHE_SENT as MHE_SENT", \
	"JNR_SITE_PROFILE___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"JNR_SITE_PROFILE___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"JNR_SITE_PROFILE___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"JNR_SITE_PROFILE___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"JNR_SITE_PROFILE___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"JNR_SITE_PROFILE___MODE_ID as MODE_ID", \
	"JNR_SITE_PROFILE___SHIPPING_COST as SHIPPING_COST", \
	"JNR_SITE_PROFILE___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"JNR_SITE_PROFILE___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"JNR_SITE_PROFILE___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"JNR_SITE_PROFILE___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"JNR_SITE_PROFILE___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"JNR_SITE_PROFILE___DRIVER_NAME as DRIVER_NAME", \
	"JNR_SITE_PROFILE___TRAILER_NUMBER as TRAILER_NUMBER", \
	"JNR_SITE_PROFILE___DESTINATION_TYPE as DESTINATION_TYPE", \
	"JNR_SITE_PROFILE___CONTACT_COUNTY as CONTACT_COUNTY", \
	"JNR_SITE_PROFILE___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"JNR_SITE_PROFILE___RECEIPT_TYPE as RECEIPT_TYPE", \
	"JNR_SITE_PROFILE___VARIANCE_TYPE as VARIANCE_TYPE", \
	"JNR_SITE_PROFILE___HAS_NOTES as HAS_NOTES", \
	"JNR_SITE_PROFILE___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"JNR_SITE_PROFILE___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"JNR_SITE_PROFILE___REF_FIELD_4 as REF_FIELD_4", \
	"JNR_SITE_PROFILE___REF_FIELD_5 as REF_FIELD_5", \
	"JNR_SITE_PROFILE___REF_FIELD_6 as REF_FIELD_6", \
	"JNR_SITE_PROFILE___REF_FIELD_7 as REF_FIELD_7", \
	"JNR_SITE_PROFILE___REF_FIELD_8 as REF_FIELD_8", \
	"JNR_SITE_PROFILE___REF_FIELD_9 as REF_FIELD_9", \
	"JNR_SITE_PROFILE___REF_FIELD_10 as REF_FIELD_10", \
	"JNR_SITE_PROFILE___REF_NUM1 as REF_NUM1", \
	"JNR_SITE_PROFILE___REF_NUM2 as REF_NUM2", \
	"JNR_SITE_PROFILE___REF_NUM3 as REF_NUM3", \
	"JNR_SITE_PROFILE___REF_NUM4 as REF_NUM4", \
	"JNR_SITE_PROFILE___REF_NUM5 as REF_NUM5", \
	"JNR_SITE_PROFILE___INVOICE_DATE as INVOICE_DATE", \
	"JNR_SITE_PROFILE___INVOICE_NUMBER as INVOICE_NUMBER", \
	"JNR_SITE_PROFILE___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"JNR_SITE_PROFILE___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"JNR_SITE_PROFILE___TRAILER_CLOSED as TRAILER_CLOSED", \
	"JNR_SITE_PROFILE___IS_GIFT as IS_GIFT", \
	"JNR_SITE_PROFILE___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"JNR_SITE_PROFILE___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"SQ_Shortcut_to_WM_ASN___LOCATION_ID as i_LOCATION_ID", \
	"SQ_Shortcut_to_WM_ASN___WM_ASN_ID as i_WM_ASN_ID", \
	"SQ_Shortcut_to_WM_ASN___WM_CREATED_TSTMP as i_WM_CREATED_TSTMP", \
	"SQ_Shortcut_to_WM_ASN___WM_LAST_UPDATED_TSTMP as i_WM_LAST_UPDATED_TSTMP", \
	"SQ_Shortcut_to_WM_ASN___LOAD_TSTMP as i_LOAD_TSTMP")

# COMMAND ----------
# Processing node FIL_UNCHANGED_RECORDS, type FILTER 
# COLUMN COUNT: 146

# for each involved DataFrame, append the dataframe name to each column
JNR_WM_ASN_temp = JNR_WM_ASN.toDF(*["JNR_WM_ASN___" + col for col in JNR_WM_ASN.columns])

FIL_UNCHANGED_RECORDS = JNR_WM_ASN_temp.selectExpr( \
	"JNR_WM_ASN___LOCATION_ID as LOCATION_ID", \
	"JNR_WM_ASN___ASN_ID as ASN_ID", \
	"JNR_WM_ASN___TC_COMPANY_ID as TC_COMPANY_ID", \
	"JNR_WM_ASN___TC_ASN_ID as TC_ASN_ID", \
	"JNR_WM_ASN___TC_ASN_ID_U as TC_ASN_ID_U", \
	"JNR_WM_ASN___ASN_TYPE as ASN_TYPE", \
	"JNR_WM_ASN___ASN_STATUS as ASN_STATUS", \
	"JNR_WM_ASN___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"JNR_WM_ASN___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"JNR_WM_ASN___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"JNR_WM_ASN___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"JNR_WM_ASN___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"JNR_WM_ASN___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"JNR_WM_ASN___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"JNR_WM_ASN___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"JNR_WM_ASN___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"JNR_WM_ASN___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"JNR_WM_ASN___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"JNR_WM_ASN___RECEIPT_DTTM as RECEIPT_DTTM", \
	"JNR_WM_ASN___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"JNR_WM_ASN___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"JNR_WM_ASN___REF_FIELD_1 as REF_FIELD_1", \
	"JNR_WM_ASN___REF_FIELD_2 as REF_FIELD_2", \
	"JNR_WM_ASN___REF_FIELD_3 as REF_FIELD_3", \
	"JNR_WM_ASN___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"JNR_WM_ASN___APPOINTMENT_ID as APPOINTMENT_ID", \
	"JNR_WM_ASN___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"JNR_WM_ASN___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"JNR_WM_ASN___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"JNR_WM_ASN___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"JNR_WM_ASN___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"JNR_WM_ASN___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"JNR_WM_ASN___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"JNR_WM_ASN___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"JNR_WM_ASN___PRO_NUMBER as PRO_NUMBER", \
	"JNR_WM_ASN___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"JNR_WM_ASN___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"JNR_WM_ASN___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"JNR_WM_ASN___TOTAL_VOLUME as TOTAL_VOLUME", \
	"JNR_WM_ASN___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"JNR_WM_ASN___FIRM_APPT_IND as FIRM_APPT_IND", \
	"JNR_WM_ASN___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"JNR_WM_ASN___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"JNR_WM_ASN___BUYER_CODE as BUYER_CODE", \
	"JNR_WM_ASN___REP_NAME as REP_NAME", \
	"JNR_WM_ASN___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"JNR_WM_ASN___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"JNR_WM_ASN___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"JNR_WM_ASN___CONTACT_CITY as CONTACT_CITY", \
	"JNR_WM_ASN___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"JNR_WM_ASN___CONTACT_ZIP as CONTACT_ZIP", \
	"JNR_WM_ASN___CONTACT_NUMBER as CONTACT_NUMBER", \
	"JNR_WM_ASN___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"JNR_WM_ASN___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"JNR_WM_ASN___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"JNR_WM_ASN___REGION_ID as REGION_ID", \
	"JNR_WM_ASN___ASN_LEVEL as ASN_LEVEL", \
	"JNR_WM_ASN___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"JNR_WM_ASN___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"JNR_WM_ASN___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"JNR_WM_ASN___HAS_ALERTS as HAS_ALERTS", \
	"JNR_WM_ASN___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"JNR_WM_ASN___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"JNR_WM_ASN___ASN_PRIORITY as ASN_PRIORITY", \
	"JNR_WM_ASN___SCHEDULE_APPT as SCHEDULE_APPT", \
	"JNR_WM_ASN___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"JNR_WM_ASN___IS_CANCELLED as IS_CANCELLED", \
	"JNR_WM_ASN___IS_CLOSED as IS_CLOSED", \
	"JNR_WM_ASN___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"JNR_WM_ASN___MANIF_NBR as MANIF_NBR", \
	"JNR_WM_ASN___MANIF_TYPE as MANIF_TYPE", \
	"JNR_WM_ASN___WORK_ORD_NBR as WORK_ORD_NBR", \
	"JNR_WM_ASN___CUT_NBR as CUT_NBR", \
	"JNR_WM_ASN___MFG_PLNT as MFG_PLNT", \
	"JNR_WM_ASN___IS_WHSE_TRANSFER as IS_WHSE_TRANSFER", \
	"JNR_WM_ASN___QUALITY_CHECK_HOLD_UPON_RCPT as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"JNR_WM_ASN___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"JNR_WM_ASN___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"JNR_WM_ASN___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"JNR_WM_ASN___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"JNR_WM_ASN___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"JNR_WM_ASN___VERIFIED_DTTM as VERIFIED_DTTM", \
	"JNR_WM_ASN___LABEL_PRINT_REQD as LABEL_PRINT_REQD", \
	"JNR_WM_ASN___INITIATE_FLAG as INITIATE_FLAG", \
	"JNR_WM_ASN___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"JNR_WM_ASN___CREATED_SOURCE as CREATED_SOURCE", \
	"JNR_WM_ASN___CREATED_DTTM as CREATED_DTTM", \
	"JNR_WM_ASN___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"JNR_WM_ASN___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"JNR_WM_ASN___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"JNR_WM_ASN___SHIPMENT_ID as SHIPMENT_ID", \
	"JNR_WM_ASN___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"JNR_WM_ASN___VERIFICATION_ATTEMPTED as VERIFICATION_ATTEMPTED", \
	"JNR_WM_ASN___FLOW_THRU_ALLOC_IN_PROG as FLOW_THRU_ALLOC_IN_PROG", \
	"JNR_WM_ASN___ALLOCATION_COMPLETED as ALLOCATION_COMPLETED", \
	"JNR_WM_ASN___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"JNR_WM_ASN___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"JNR_WM_ASN___DC_ORD_NBR as DC_ORD_NBR", \
	"JNR_WM_ASN___CONTRAC_LOCN as CONTRAC_LOCN", \
	"JNR_WM_ASN___MHE_SENT as MHE_SENT", \
	"JNR_WM_ASN___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"JNR_WM_ASN___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"JNR_WM_ASN___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"JNR_WM_ASN___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"JNR_WM_ASN___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"JNR_WM_ASN___MODE_ID as MODE_ID", \
	"JNR_WM_ASN___SHIPPING_COST as SHIPPING_COST", \
	"JNR_WM_ASN___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"JNR_WM_ASN___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"JNR_WM_ASN___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"JNR_WM_ASN___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"JNR_WM_ASN___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"JNR_WM_ASN___DRIVER_NAME as DRIVER_NAME", \
	"JNR_WM_ASN___TRAILER_NUMBER as TRAILER_NUMBER", \
	"JNR_WM_ASN___DESTINATION_TYPE as DESTINATION_TYPE", \
	"JNR_WM_ASN___CONTACT_COUNTY as CONTACT_COUNTY", \
	"JNR_WM_ASN___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"JNR_WM_ASN___RECEIPT_TYPE as RECEIPT_TYPE", \
	"JNR_WM_ASN___VARIANCE_TYPE as VARIANCE_TYPE", \
	"JNR_WM_ASN___HAS_NOTES as HAS_NOTES", \
	"JNR_WM_ASN___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"JNR_WM_ASN___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"JNR_WM_ASN___REF_FIELD_4 as REF_FIELD_4", \
	"JNR_WM_ASN___REF_FIELD_5 as REF_FIELD_5", \
	"JNR_WM_ASN___REF_FIELD_6 as REF_FIELD_6", \
	"JNR_WM_ASN___REF_FIELD_7 as REF_FIELD_7", \
	"JNR_WM_ASN___REF_FIELD_8 as REF_FIELD_8", \
	"JNR_WM_ASN___REF_FIELD_9 as REF_FIELD_9", \
	"JNR_WM_ASN___REF_FIELD_10 as REF_FIELD_10", \
	"JNR_WM_ASN___REF_NUM1 as REF_NUM1", \
	"JNR_WM_ASN___REF_NUM2 as REF_NUM2", \
	"JNR_WM_ASN___REF_NUM3 as REF_NUM3", \
	"JNR_WM_ASN___REF_NUM4 as REF_NUM4", \
	"JNR_WM_ASN___REF_NUM5 as REF_NUM5", \
	"JNR_WM_ASN___INVOICE_DATE as INVOICE_DATE", \
	"JNR_WM_ASN___INVOICE_NUMBER as INVOICE_NUMBER", \
	"JNR_WM_ASN___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"JNR_WM_ASN___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"JNR_WM_ASN___TRAILER_CLOSED as TRAILER_CLOSED", \
	"JNR_WM_ASN___IS_GIFT as IS_GIFT", \
	"JNR_WM_ASN___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"JNR_WM_ASN___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"JNR_WM_ASN___i_WM_ASN_ID as i_WM_ASN_ID", \
	"JNR_WM_ASN___i_WM_CREATED_TSTMP as i_WM_CREATED_TSTMP", \
	"JNR_WM_ASN___i_WM_LAST_UPDATED_TSTMP as i_WM_LAST_UPDATED_TSTMP", \
	"JNR_WM_ASN___i_LOAD_TSTMP as i_LOAD_TSTMP")\
.filter("i_WM_ASN_ID is Null OR ( i_WM_ASN_ID is Not Null AND ( COALESCE(CREATED_DTTM, date'1900-01-01') != COALESCE(i_WM_CREATED_TSTMP, date'1900-01-01') \
        OR COALESCE(LAST_UPDATED_DTTM, date'1900-01-01') != COALESCE(i_WM_LAST_UPDATED_TSTMP, date'1900-01-01') ))").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_UPD_VALIDATOR, type EXPRESSION 
# COLUMN COUNT: 145

# for each involved DataFrame, append the dataframe name to each column
FIL_UNCHANGED_RECORDS_temp = FIL_UNCHANGED_RECORDS.toDF(*["FIL_UNCHANGED_RECORDS___" + col for col in FIL_UNCHANGED_RECORDS.columns])

EXP_UPD_VALIDATOR = FIL_UNCHANGED_RECORDS_temp.selectExpr( \
	"FIL_UNCHANGED_RECORDS___sys_row_id as sys_row_id", \
	"FIL_UNCHANGED_RECORDS___LOCATION_ID as LOCATION_ID", \
	"FIL_UNCHANGED_RECORDS___ASN_ID as ASN_ID", \
	"FIL_UNCHANGED_RECORDS___TC_COMPANY_ID as TC_COMPANY_ID", \
	"FIL_UNCHANGED_RECORDS___TC_ASN_ID as TC_ASN_ID", \
	"FIL_UNCHANGED_RECORDS___TC_ASN_ID_U as TC_ASN_ID_U", \
	"FIL_UNCHANGED_RECORDS___ASN_TYPE as ASN_TYPE", \
	"FIL_UNCHANGED_RECORDS___ASN_STATUS as ASN_STATUS", \
	"FIL_UNCHANGED_RECORDS___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"FIL_UNCHANGED_RECORDS___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"FIL_UNCHANGED_RECORDS___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"FIL_UNCHANGED_RECORDS___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"FIL_UNCHANGED_RECORDS___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"FIL_UNCHANGED_RECORDS___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"FIL_UNCHANGED_RECORDS___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"FIL_UNCHANGED_RECORDS___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"FIL_UNCHANGED_RECORDS___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"FIL_UNCHANGED_RECORDS___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"FIL_UNCHANGED_RECORDS___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"FIL_UNCHANGED_RECORDS___RECEIPT_DTTM as RECEIPT_DTTM", \
	"FIL_UNCHANGED_RECORDS___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"FIL_UNCHANGED_RECORDS___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_1 as REF_FIELD_1", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_2 as REF_FIELD_2", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_3 as REF_FIELD_3", \
	"FIL_UNCHANGED_RECORDS___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"FIL_UNCHANGED_RECORDS___APPOINTMENT_ID as APPOINTMENT_ID", \
	"FIL_UNCHANGED_RECORDS___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"FIL_UNCHANGED_RECORDS___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"FIL_UNCHANGED_RECORDS___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"FIL_UNCHANGED_RECORDS___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"FIL_UNCHANGED_RECORDS___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"FIL_UNCHANGED_RECORDS___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"FIL_UNCHANGED_RECORDS___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"FIL_UNCHANGED_RECORDS___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"FIL_UNCHANGED_RECORDS___PRO_NUMBER as PRO_NUMBER", \
	"FIL_UNCHANGED_RECORDS___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"FIL_UNCHANGED_RECORDS___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"FIL_UNCHANGED_RECORDS___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"FIL_UNCHANGED_RECORDS___TOTAL_VOLUME as TOTAL_VOLUME", \
	"FIL_UNCHANGED_RECORDS___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"FIL_UNCHANGED_RECORDS___FIRM_APPT_IND as FIRM_APPT_IND_EXP", \
	"FIL_UNCHANGED_RECORDS___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"FIL_UNCHANGED_RECORDS___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"FIL_UNCHANGED_RECORDS___BUYER_CODE as BUYER_CODE", \
	"FIL_UNCHANGED_RECORDS___REP_NAME as REP_NAME", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"FIL_UNCHANGED_RECORDS___CONTACT_CITY as CONTACT_CITY", \
	"FIL_UNCHANGED_RECORDS___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"FIL_UNCHANGED_RECORDS___CONTACT_ZIP as CONTACT_ZIP", \
	"FIL_UNCHANGED_RECORDS___CONTACT_NUMBER as CONTACT_NUMBER", \
	"FIL_UNCHANGED_RECORDS___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"FIL_UNCHANGED_RECORDS___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"FIL_UNCHANGED_RECORDS___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"FIL_UNCHANGED_RECORDS___REGION_ID as REGION_ID", \
	"FIL_UNCHANGED_RECORDS___ASN_LEVEL as ASN_LEVEL", \
	"FIL_UNCHANGED_RECORDS___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"FIL_UNCHANGED_RECORDS___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"FIL_UNCHANGED_RECORDS___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"FIL_UNCHANGED_RECORDS___HAS_ALERTS as HAS_ALERTS", \
	"FIL_UNCHANGED_RECORDS___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"FIL_UNCHANGED_RECORDS___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"FIL_UNCHANGED_RECORDS___ASN_PRIORITY as ASN_PRIORITY", \
	"FIL_UNCHANGED_RECORDS___SCHEDULE_APPT as SCHEDULE_APPT", \
	"FIL_UNCHANGED_RECORDS___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"FIL_UNCHANGED_RECORDS___IS_CANCELLED as IS_CANCELLED", \
	"FIL_UNCHANGED_RECORDS___IS_CLOSED as IS_CLOSED", \
	"FIL_UNCHANGED_RECORDS___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"FIL_UNCHANGED_RECORDS___MANIF_NBR as MANIF_NBR", \
	"FIL_UNCHANGED_RECORDS___MANIF_TYPE as MANIF_TYPE", \
	"FIL_UNCHANGED_RECORDS___WORK_ORD_NBR as WORK_ORD_NBR", \
	"FIL_UNCHANGED_RECORDS___CUT_NBR as CUT_NBR", \
	"FIL_UNCHANGED_RECORDS___MFG_PLNT as MFG_PLNT", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_RECORDS___IS_WHSE_TRANSFER ) ) ) , '1','1' , 'Y','1','0' ) as IS_WHSE_TRANSFER_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_RECORDS___QUALITY_CHECK_HOLD_UPON_RCPT ) ) ) , '1','1' , 'Y','1','0' ) as QUALITY_CHECK_HOLD_UPON_RCPT_EXP", \
	"FIL_UNCHANGED_RECORDS___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"FIL_UNCHANGED_RECORDS___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"FIL_UNCHANGED_RECORDS___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"FIL_UNCHANGED_RECORDS___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"FIL_UNCHANGED_RECORDS___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"FIL_UNCHANGED_RECORDS___VERIFIED_DTTM as VERIFIED_DTTM", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_RECORDS___LABEL_PRINT_REQD ) ) ) , '1','1' , 'Y','1','0' ) as LABEL_PRINT_REQD_EXP", \
	"FIL_UNCHANGED_RECORDS___INITIATE_FLAG as INITIATE_FLAG", \
	"FIL_UNCHANGED_RECORDS___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_RECORDS___CREATED_SOURCE as CREATED_SOURCE", \
	"FIL_UNCHANGED_RECORDS___CREATED_DTTM as CREATED_DTTM", \
	"FIL_UNCHANGED_RECORDS___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"FIL_UNCHANGED_RECORDS___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"FIL_UNCHANGED_RECORDS___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"FIL_UNCHANGED_RECORDS___SHIPMENT_ID as SHIPMENT_ID", \
	"FIL_UNCHANGED_RECORDS___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_RECORDS___VERIFICATION_ATTEMPTED ) ) ) , '1','1' , 'Y','1','0' ) as VERIFICATION_ATTEMPTED_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_RECORDS___FLOW_THRU_ALLOC_IN_PROG ) ) ) , '1','1' , 'Y','1','0' ) as FLOW_THRU_ALLOC_IN_PROG_EXP", \
	"decode ( ltrim ( rtrim ( upper ( FIL_UNCHANGED_RECORDS___ALLOCATION_COMPLETED ) ) ) , '1','1' , 'Y','1','0' ) as ALLOCATION_COMPLETED_EXP", \
	"FIL_UNCHANGED_RECORDS___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"FIL_UNCHANGED_RECORDS___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"FIL_UNCHANGED_RECORDS___DC_ORD_NBR as DC_ORD_NBR", \
	"FIL_UNCHANGED_RECORDS___CONTRAC_LOCN as CONTRAC_LOCN", \
	"FIL_UNCHANGED_RECORDS___MHE_SENT as MHE_SENT", \
	"FIL_UNCHANGED_RECORDS___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"FIL_UNCHANGED_RECORDS___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"FIL_UNCHANGED_RECORDS___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"FIL_UNCHANGED_RECORDS___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"FIL_UNCHANGED_RECORDS___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"FIL_UNCHANGED_RECORDS___MODE_ID as MODE_ID", \
	"FIL_UNCHANGED_RECORDS___SHIPPING_COST as SHIPPING_COST", \
	"FIL_UNCHANGED_RECORDS___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"FIL_UNCHANGED_RECORDS___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"FIL_UNCHANGED_RECORDS___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"FIL_UNCHANGED_RECORDS___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"FIL_UNCHANGED_RECORDS___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"FIL_UNCHANGED_RECORDS___DRIVER_NAME as DRIVER_NAME", \
	"FIL_UNCHANGED_RECORDS___TRAILER_NUMBER as TRAILER_NUMBER", \
	"FIL_UNCHANGED_RECORDS___DESTINATION_TYPE as DESTINATION_TYPE", \
	"FIL_UNCHANGED_RECORDS___CONTACT_COUNTY as CONTACT_COUNTY", \
	"FIL_UNCHANGED_RECORDS___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"FIL_UNCHANGED_RECORDS___RECEIPT_TYPE as RECEIPT_TYPE", \
	"FIL_UNCHANGED_RECORDS___VARIANCE_TYPE as VARIANCE_TYPE", \
	"FIL_UNCHANGED_RECORDS___HAS_NOTES as HAS_NOTES", \
	"FIL_UNCHANGED_RECORDS___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"FIL_UNCHANGED_RECORDS___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_4 as REF_FIELD_4", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_5 as REF_FIELD_5", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_6 as REF_FIELD_6", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_7 as REF_FIELD_7", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_8 as REF_FIELD_8", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_9 as REF_FIELD_9", \
	"FIL_UNCHANGED_RECORDS___REF_FIELD_10 as REF_FIELD_10", \
	"FIL_UNCHANGED_RECORDS___REF_NUM1 as REF_NUM1", \
	"FIL_UNCHANGED_RECORDS___REF_NUM2 as REF_NUM2", \
	"FIL_UNCHANGED_RECORDS___REF_NUM3 as REF_NUM3", \
	"FIL_UNCHANGED_RECORDS___REF_NUM4 as REF_NUM4", \
	"FIL_UNCHANGED_RECORDS___REF_NUM5 as REF_NUM5", \
	"FIL_UNCHANGED_RECORDS___INVOICE_DATE as INVOICE_DATE", \
	"FIL_UNCHANGED_RECORDS___INVOICE_NUMBER as INVOICE_NUMBER", \
	"FIL_UNCHANGED_RECORDS___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"FIL_UNCHANGED_RECORDS___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"FIL_UNCHANGED_RECORDS___TRAILER_CLOSED as TRAILER_CLOSED", \
	"FIL_UNCHANGED_RECORDS___IS_GIFT as IS_GIFT", \
	"FIL_UNCHANGED_RECORDS___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"FIL_UNCHANGED_RECORDS___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"CURRENT_TIMESTAMP as UPDATE_TSTMP", \
	"IF (FIL_UNCHANGED_RECORDS___i_LOAD_TSTMP IS NULL, CURRENT_TIMESTAMP, FIL_UNCHANGED_RECORDS___i_LOAD_TSTMP) as LOAD_TSTMP", \
	"IF (FIL_UNCHANGED_RECORDS___i_WM_ASN_ID IS NULL, 1, 2) as o_UPDATE_VALIDATOR" \
)

# COMMAND ----------
# Processing node UPD_INS_UPD, type UPDATE_STRATEGY . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 145

# for each involved DataFrame, append the dataframe name to each column
EXP_UPD_VALIDATOR_temp = EXP_UPD_VALIDATOR.toDF(*["EXP_UPD_VALIDATOR___" + col for col in EXP_UPD_VALIDATOR.columns])

UPD_INS_UPD = EXP_UPD_VALIDATOR_temp.selectExpr( \
	"EXP_UPD_VALIDATOR___LOCATION_ID as LOCATION_ID", \
	"EXP_UPD_VALIDATOR___ASN_ID as ASN_ID", \
	"EXP_UPD_VALIDATOR___TC_COMPANY_ID as TC_COMPANY_ID", \
	"EXP_UPD_VALIDATOR___TC_ASN_ID as TC_ASN_ID", \
	"EXP_UPD_VALIDATOR___TC_ASN_ID_U as TC_ASN_ID_U", \
	"EXP_UPD_VALIDATOR___ASN_TYPE as ASN_TYPE", \
	"EXP_UPD_VALIDATOR___ASN_STATUS as ASN_STATUS", \
	"EXP_UPD_VALIDATOR___TRACTOR_NUMBER as TRACTOR_NUMBER", \
	"EXP_UPD_VALIDATOR___DELIVERY_STOP_SEQ as DELIVERY_STOP_SEQ", \
	"EXP_UPD_VALIDATOR___ORIGIN_FACILITY_ALIAS_ID as ORIGIN_FACILITY_ALIAS_ID", \
	"EXP_UPD_VALIDATOR___ORIGIN_FACILITY_ID as ORIGIN_FACILITY_ID", \
	"EXP_UPD_VALIDATOR___PICKUP_END_DTTM as PICKUP_END_DTTM", \
	"EXP_UPD_VALIDATOR___ACTUAL_DEPARTURE_DTTM as ACTUAL_DEPARTURE_DTTM", \
	"EXP_UPD_VALIDATOR___DESTINATION_FACILITY_ALIAS_ID as DESTINATION_FACILITY_ALIAS_ID", \
	"EXP_UPD_VALIDATOR___DESTINATION_FACILITY_ID as DESTINATION_FACILITY_ID", \
	"EXP_UPD_VALIDATOR___DELIVERY_START_DTTM as DELIVERY_START_DTTM", \
	"EXP_UPD_VALIDATOR___DELIVERY_END_DTTM as DELIVERY_END_DTTM", \
	"EXP_UPD_VALIDATOR___ACTUAL_ARRIVAL_DTTM as ACTUAL_ARRIVAL_DTTM", \
	"EXP_UPD_VALIDATOR___RECEIPT_DTTM as RECEIPT_DTTM", \
	"EXP_UPD_VALIDATOR___INBOUND_REGION_NAME as INBOUND_REGION_NAME", \
	"EXP_UPD_VALIDATOR___OUTBOUND_REGION_NAME as OUTBOUND_REGION_NAME", \
	"EXP_UPD_VALIDATOR___REF_FIELD_1 as REF_FIELD_1", \
	"EXP_UPD_VALIDATOR___REF_FIELD_2 as REF_FIELD_2", \
	"EXP_UPD_VALIDATOR___REF_FIELD_3 as REF_FIELD_3", \
	"EXP_UPD_VALIDATOR___TOTAL_WEIGHT as TOTAL_WEIGHT", \
	"EXP_UPD_VALIDATOR___APPOINTMENT_ID as APPOINTMENT_ID", \
	"EXP_UPD_VALIDATOR___APPOINTMENT_DTTM as APPOINTMENT_DTTM", \
	"EXP_UPD_VALIDATOR___APPOINTMENT_DURATION as APPOINTMENT_DURATION", \
	"EXP_UPD_VALIDATOR___PALLET_FOOTPRINT as PALLET_FOOTPRINT", \
	"EXP_UPD_VALIDATOR___LAST_TRANSMITTED_DTTM as LAST_TRANSMITTED_DTTM", \
	"EXP_UPD_VALIDATOR___TOTAL_SHIPPED_QTY as TOTAL_SHIPPED_QTY", \
	"EXP_UPD_VALIDATOR___TOTAL_RECEIVED_QTY as TOTAL_RECEIVED_QTY", \
	"EXP_UPD_VALIDATOR___ASSIGNED_CARRIER_CODE as ASSIGNED_CARRIER_CODE", \
	"EXP_UPD_VALIDATOR___BILL_OF_LADING_NUMBER as BILL_OF_LADING_NUMBER", \
	"EXP_UPD_VALIDATOR___PRO_NUMBER as PRO_NUMBER", \
	"EXP_UPD_VALIDATOR___EQUIPMENT_CODE as EQUIPMENT_CODE", \
	"EXP_UPD_VALIDATOR___EQUIPMENT_CODE_ID as EQUIPMENT_CODE_ID", \
	"EXP_UPD_VALIDATOR___ASSIGNED_CARRIER_CODE_ID as ASSIGNED_CARRIER_CODE_ID", \
	"EXP_UPD_VALIDATOR___TOTAL_VOLUME as TOTAL_VOLUME", \
	"EXP_UPD_VALIDATOR___VOLUME_UOM_ID_BASE as VOLUME_UOM_ID_BASE", \
	"EXP_UPD_VALIDATOR___FIRM_APPT_IND_EXP as FIRM_APPT_IND", \
	"EXP_UPD_VALIDATOR___TRACTOR_CARRIER_CODE_ID as TRACTOR_CARRIER_CODE_ID", \
	"EXP_UPD_VALIDATOR___TRACTOR_CARRIER_CODE as TRACTOR_CARRIER_CODE", \
	"EXP_UPD_VALIDATOR___BUYER_CODE as BUYER_CODE", \
	"EXP_UPD_VALIDATOR___REP_NAME as REP_NAME", \
	"EXP_UPD_VALIDATOR___CONTACT_ADDRESS_1 as CONTACT_ADDRESS_1", \
	"EXP_UPD_VALIDATOR___CONTACT_ADDRESS_2 as CONTACT_ADDRESS_2", \
	"EXP_UPD_VALIDATOR___CONTACT_ADDRESS_3 as CONTACT_ADDRESS_3", \
	"EXP_UPD_VALIDATOR___CONTACT_CITY as CONTACT_CITY", \
	"EXP_UPD_VALIDATOR___CONTACT_STATE_PROV as CONTACT_STATE_PROV", \
	"EXP_UPD_VALIDATOR___CONTACT_ZIP as CONTACT_ZIP", \
	"EXP_UPD_VALIDATOR___CONTACT_NUMBER as CONTACT_NUMBER", \
	"EXP_UPD_VALIDATOR___EXT_CREATED_DTTM as EXT_CREATED_DTTM", \
	"EXP_UPD_VALIDATOR___INBOUND_REGION_ID as INBOUND_REGION_ID", \
	"EXP_UPD_VALIDATOR___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
	"EXP_UPD_VALIDATOR___REGION_ID as REGION_ID", \
	"EXP_UPD_VALIDATOR___ASN_LEVEL as ASN_LEVEL", \
	"EXP_UPD_VALIDATOR___RECEIPT_VARIANCE as RECEIPT_VARIANCE", \
	"EXP_UPD_VALIDATOR___HAS_IMPORT_ERROR as HAS_IMPORT_ERROR", \
	"EXP_UPD_VALIDATOR___HAS_SOFT_CHECK_ERROR as HAS_SOFT_CHECK_ERROR", \
	"EXP_UPD_VALIDATOR___HAS_ALERTS as HAS_ALERTS", \
	"EXP_UPD_VALIDATOR___SYSTEM_ALLOCATED as SYSTEM_ALLOCATED", \
	"EXP_UPD_VALIDATOR___IS_COGI_GENERATED as IS_COGI_GENERATED", \
	"EXP_UPD_VALIDATOR___ASN_PRIORITY as ASN_PRIORITY", \
	"EXP_UPD_VALIDATOR___SCHEDULE_APPT as SCHEDULE_APPT", \
	"EXP_UPD_VALIDATOR___IS_ASSOCIATED_TO_OUTBOUND as IS_ASSOCIATED_TO_OUTBOUND", \
	"EXP_UPD_VALIDATOR___IS_CANCELLED as IS_CANCELLED", \
	"EXP_UPD_VALIDATOR___IS_CLOSED as IS_CLOSED", \
	"EXP_UPD_VALIDATOR___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
	"EXP_UPD_VALIDATOR___MANIF_NBR as MANIF_NBR", \
	"EXP_UPD_VALIDATOR___MANIF_TYPE as MANIF_TYPE", \
	"EXP_UPD_VALIDATOR___WORK_ORD_NBR as WORK_ORD_NBR", \
	"EXP_UPD_VALIDATOR___CUT_NBR as CUT_NBR", \
	"EXP_UPD_VALIDATOR___MFG_PLNT as MFG_PLNT", \
	"EXP_UPD_VALIDATOR___IS_WHSE_TRANSFER_EXP as IS_WHSE_TRANSFER", \
	"EXP_UPD_VALIDATOR___QUALITY_CHECK_HOLD_UPON_RCPT_EXP as QUALITY_CHECK_HOLD_UPON_RCPT", \
	"EXP_UPD_VALIDATOR___QUALITY_AUDIT_PERCENT as QUALITY_AUDIT_PERCENT", \
	"EXP_UPD_VALIDATOR___SHIPPED_LPN_COUNT as SHIPPED_LPN_COUNT", \
	"EXP_UPD_VALIDATOR___RECEIVED_LPN_COUNT as RECEIVED_LPN_COUNT", \
	"EXP_UPD_VALIDATOR___ACTUAL_SHIPPED_DTTM as ACTUAL_SHIPPED_DTTM", \
	"EXP_UPD_VALIDATOR___LAST_RECEIPT_DTTM as LAST_RECEIPT_DTTM", \
	"EXP_UPD_VALIDATOR___VERIFIED_DTTM as VERIFIED_DTTM", \
	"EXP_UPD_VALIDATOR___LABEL_PRINT_REQD_EXP as LABEL_PRINT_REQD", \
	"EXP_UPD_VALIDATOR___INITIATE_FLAG as INITIATE_FLAG", \
	"EXP_UPD_VALIDATOR___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
	"EXP_UPD_VALIDATOR___CREATED_SOURCE as CREATED_SOURCE", \
	"EXP_UPD_VALIDATOR___CREATED_DTTM as CREATED_DTTM", \
	"EXP_UPD_VALIDATOR___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
	"EXP_UPD_VALIDATOR___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
	"EXP_UPD_VALIDATOR___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
	"EXP_UPD_VALIDATOR___SHIPMENT_ID as SHIPMENT_ID", \
	"EXP_UPD_VALIDATOR___TC_SHIPMENT_ID as TC_SHIPMENT_ID", \
	"EXP_UPD_VALIDATOR___VERIFICATION_ATTEMPTED_EXP as VERIFICATION_ATTEMPTED", \
	"EXP_UPD_VALIDATOR___FLOW_THRU_ALLOC_IN_PROG_EXP as FLOW_THRU_ALLOC_IN_PROG", \
	"EXP_UPD_VALIDATOR___ALLOCATION_COMPLETED_EXP as ALLOCATION_COMPLETED", \
	"EXP_UPD_VALIDATOR___EQUIPMENT_TYPE as EQUIPMENT_TYPE", \
	"EXP_UPD_VALIDATOR___ASN_ORGN_TYPE as ASN_ORGN_TYPE", \
	"EXP_UPD_VALIDATOR___DC_ORD_NBR as DC_ORD_NBR", \
	"EXP_UPD_VALIDATOR___CONTRAC_LOCN as CONTRAC_LOCN", \
	"EXP_UPD_VALIDATOR___MHE_SENT as MHE_SENT", \
	"EXP_UPD_VALIDATOR___FLOW_THROUGH_ALLOCATION_METHOD as FLOW_THROUGH_ALLOCATION_METHOD", \
	"EXP_UPD_VALIDATOR___FIRST_RECEIPT_DTTM as FIRST_RECEIPT_DTTM", \
	"EXP_UPD_VALIDATOR___MISC_INSTR_CODE_1 as MISC_INSTR_CODE_1", \
	"EXP_UPD_VALIDATOR___MISC_INSTR_CODE_2 as MISC_INSTR_CODE_2", \
	"EXP_UPD_VALIDATOR___DOCK_DOOR_ID as DOCK_DOOR_ID", \
	"EXP_UPD_VALIDATOR___MODE_ID as MODE_ID", \
	"EXP_UPD_VALIDATOR___SHIPPING_COST as SHIPPING_COST", \
	"EXP_UPD_VALIDATOR___SHIPPING_COST_CURRENCY_CODE as SHIPPING_COST_CURRENCY_CODE", \
	"EXP_UPD_VALIDATOR___FLOWTHROUGH_ALLOCATION_STATUS as FLOWTHROUGH_ALLOCATION_STATUS", \
	"EXP_UPD_VALIDATOR___HIBERNATE_VERSION as HIBERNATE_VERSION", \
	"EXP_UPD_VALIDATOR___QTY_UOM_ID_BASE as QTY_UOM_ID_BASE", \
	"EXP_UPD_VALIDATOR___WEIGHT_UOM_ID_BASE as WEIGHT_UOM_ID_BASE", \
	"EXP_UPD_VALIDATOR___DRIVER_NAME as DRIVER_NAME", \
	"EXP_UPD_VALIDATOR___TRAILER_NUMBER as TRAILER_NUMBER", \
	"EXP_UPD_VALIDATOR___DESTINATION_TYPE as DESTINATION_TYPE", \
	"EXP_UPD_VALIDATOR___CONTACT_COUNTY as CONTACT_COUNTY", \
	"EXP_UPD_VALIDATOR___CONTACT_COUNTRY_CODE as CONTACT_COUNTRY_CODE", \
	"EXP_UPD_VALIDATOR___RECEIPT_TYPE as RECEIPT_TYPE", \
	"EXP_UPD_VALIDATOR___VARIANCE_TYPE as VARIANCE_TYPE", \
	"EXP_UPD_VALIDATOR___HAS_NOTES as HAS_NOTES", \
	"EXP_UPD_VALIDATOR___ORIGINAL_ASN_ID as ORIGINAL_ASN_ID", \
	"EXP_UPD_VALIDATOR___RETURN_REFERENCE_NUMBER as RETURN_REFERENCE_NUMBER", \
	"EXP_UPD_VALIDATOR___REF_FIELD_4 as REF_FIELD_4", \
	"EXP_UPD_VALIDATOR___REF_FIELD_5 as REF_FIELD_5", \
	"EXP_UPD_VALIDATOR___REF_FIELD_6 as REF_FIELD_6", \
	"EXP_UPD_VALIDATOR___REF_FIELD_7 as REF_FIELD_7", \
	"EXP_UPD_VALIDATOR___REF_FIELD_8 as REF_FIELD_8", \
	"EXP_UPD_VALIDATOR___REF_FIELD_9 as REF_FIELD_9", \
	"EXP_UPD_VALIDATOR___REF_FIELD_10 as REF_FIELD_10", \
	"EXP_UPD_VALIDATOR___REF_NUM1 as REF_NUM1", \
	"EXP_UPD_VALIDATOR___REF_NUM2 as REF_NUM2", \
	"EXP_UPD_VALIDATOR___REF_NUM3 as REF_NUM3", \
	"EXP_UPD_VALIDATOR___REF_NUM4 as REF_NUM4", \
	"EXP_UPD_VALIDATOR___REF_NUM5 as REF_NUM5", \
	"EXP_UPD_VALIDATOR___INVOICE_DATE as INVOICE_DATE", \
	"EXP_UPD_VALIDATOR___INVOICE_NUMBER as INVOICE_NUMBER", \
	"EXP_UPD_VALIDATOR___PRE_RECEIPT_STATUS as PRE_RECEIPT_STATUS", \
	"EXP_UPD_VALIDATOR___PRE_ALLOCATION_FIT_PERCENTAGE as PRE_ALLOCATION_FIT_PERCENTAGE", \
	"EXP_UPD_VALIDATOR___TRAILER_CLOSED as TRAILER_CLOSED", \
	"EXP_UPD_VALIDATOR___IS_GIFT as IS_GIFT", \
	"EXP_UPD_VALIDATOR___ORIGINAL_ORDER_NUMBER as ORIGINAL_ORDER_NUMBER", \
	"EXP_UPD_VALIDATOR___ASN_SHPMT_TYPE as ASN_SHPMT_TYPE", \
	"EXP_UPD_VALIDATOR___UPDATE_TSTMP as UPDATE_TSTMP", \
	"EXP_UPD_VALIDATOR___LOAD_TSTMP as LOAD_TSTMP", \
	"EXP_UPD_VALIDATOR___o_UPDATE_VALIDATOR as o_UPDATE_VALIDATOR") \
	.withColumn('pyspark_data_action', when(EXP_UPD_VALIDATOR.o_UPDATE_VALIDATOR ==(lit(1)) , lit(0)).when(EXP_UPD_VALIDATOR.o_UPDATE_VALIDATOR ==(lit(2)) , lit(1)))

# COMMAND ----------
# Processing node Shortcut_to_WM_ASN1, type TARGET 
# COLUMN COUNT: 144

try:
  primary_key = """source.LOCATION_ID = target.LOCATION_ID AND source.WM_ASN_ID = target.WM_ASN_ID"""
#   refined_perf_table = "WM_ASN"
  executeMerge(UPD_INS_UPD, refined_perf_table, primary_key)
  logger.info(f"Merge with {refined_perf_table} completed]")
  logPrevRunDt("WM_ASN", "WM_ASN", "Completed", "N/A", f"{raw}.log_run_details")
except Exception as e:
  logPrevRunDt("WM_ASN", "WM_ASN","Failed",str(e), f"{raw}.log_run_details", )
  raise e
	