#Code converted on 2023-06-21 15:26:17
import os
import argparse
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from Datalake.utils.genericUtilities import *
from Datalake.utils.configs import *
from Datalake.utils.mergeUtils import *
from logging import getLogger, INFO



def m_WM_Facility_PRE(dcnbr, env):
    from logging import getLogger, INFO
    logger = getLogger()
    logger.info("inside m_WM_Facility_PRE function")

    spark = SparkSession.getActiveSession()
    dbutils = DBUtils(spark)

    if env is None or env == '':
        raise ValueError('env is not set')

    refine = getEnvPrefix(env) + 'refine'
    raw = getEnvPrefix(env) + 'raw'
    tableName = "WM_FACILITY_PRE"

    schemaName = raw
    source_schema = "WMSMIS"


    target_table_name = schemaName + "." + tableName

    refine_table_name = tableName[:-4]


    # Set global variables
    if dcnbr is None or dcnbr == "":
        raise ValueError("DC_NBR is not set")

    starttime = datetime.now() #start timestamp of the script
    
    # Read in relation source variables
    (username, password, connection_string) = getConfig(dcnbr, env)


    # COMMAND ----------
    # Variable_declaration_comment
    dcnbr = dcnbr.strip()[2:]
    Prev_Run_Dt=genPrevRunDt(refine_table_name, refine,raw)

    

    # COMMAND ----------
    # Processing node SQ_Shortcut_to_FACILITY, type SOURCE 
    # COLUMN COUNT: 226

    SQ_Shortcut_to_FACILITY = jdbcOracleConnection(  f"""SELECT
    FACILITY.FACILITY_ID,
    FACILITY.TC_COMPANY_ID,
    FACILITY.BUSINESS_PARTNER_ID,
    FACILITY.NAME,
    FACILITY.DESCRIPTION,
    FACILITY.ADDRESS_1,
    FACILITY.ADDRESS_2,
    FACILITY.ADDRESS_3,
    FACILITY.ADDRESS_KEY_1,
    FACILITY.CITY,
    FACILITY.STATE_PROV,
    FACILITY.POSTAL_CODE,
    FACILITY.COUNTY,
    FACILITY.COUNTRY_CODE,
    FACILITY.LONGITUDE,
    FACILITY.LATITUDE,
    FACILITY.EIN_NBR,
    FACILITY.IATA_CODE,
    FACILITY.GLOBAL_LOCN_NBR,
    FACILITY.TAX_ID,
    FACILITY.DUNS_NBR,
    FACILITY.INBOUNDS_RS_AREA_ID,
    FACILITY.OUTBOUND_RS_AREA_ID,
    FACILITY.INBOUND_REGION_ID,
    FACILITY.OUTBOUND_REGION_ID,
    FACILITY.FACILITY_TZ,
    FACILITY.DROP_INDICATOR,
    FACILITY.HOOK_INDICATOR,
    FACILITY.HANDLER,
    FACILITY.IS_SHIP_APPT_REQD,
    FACILITY.IS_RCV_APPT_REQD,
    FACILITY.TRACK_ONTIME_INDICATOR,
    FACILITY.ONTIME_PERF_METHOD,
    FACILITY.LOAD_FACTOR_SIZE_VALUE,
    FACILITY.MARK_FOR_DELETION,
    FACILITY.CREATED_SOURCE_TYPE,
    FACILITY.CREATED_SOURCE,
    FACILITY.CREATED_DTTM,
    FACILITY.LAST_UPDATED_SOURCE_TYPE,
    FACILITY.LAST_UPDATED_SOURCE,
    FACILITY.LAST_UPDATED_DTTM,
    FACILITY.ALLOW_OVERLAPPING_APPS,
    FACILITY.EARLY_TOLERANCE_POINT,
    FACILITY.LATE_TOLERANCE_POINT,
    FACILITY.EARLY_TOLERANCE_WINDOW,
    FACILITY.LATE_TOLERANCE_WINDOW,
    FACILITY.FACILITY_TYPE_BITS,
    FACILITY.PP_HANDLING_TIME,
    FACILITY.STOP_CONSTRAINT_BITS,
    FACILITY.IS_DOCK_SCHED_FAC,
    FACILITY.ASN_COMMUNICATION_METHOD,
    FACILITY.PICK_TIME,
    FACILITY.DISPATCH_INITIATION_TIME,
    FACILITY.PAPERWORK_TIME,
    FACILITY.VEHICLE_CHECK_TIME,
    FACILITY.VISIT_GAP,
    FACILITY.MIN_HANDLING_TIME,
    FACILITY.IS_CREDIT_AVAILABLE,
    FACILITY.BUSINESS_GROUP_ID_1,
    FACILITY.BUSINESS_GROUP_ID_2,
    FACILITY.IS_OPERATIONAL,
    FACILITY.IS_MAINTENANCE_FACILITY,
    FACILITY.DWELL_TIME,
    FACILITY.DRIVER_CHECK_IN_TIME,
    FACILITY.DISPATCH_DTTM,
    FACILITY.DSP_DR_CONFIGURATION_ID,
    FACILITY.DROP_HOOK_TIME,
    FACILITY.LOADING_END_TIME,
    FACILITY.DRIVER_DEBRIEF_TIME,
    FACILITY.ACCOUNT_CODE_NUMBER,
    FACILITY.LOAD_FACTOR_MOT_ID,
    FACILITY.LOAD_UNLOAD_MOT_ID,
    FACILITY.MIN_TRAIL_FILL,
    FACILITY.TANDEM_DROP_HOOK_TIME,
    FACILITY.STORE_TYPE,
    FACILITY.DRIVEIN_TIME,
    FACILITY.CHECKIN_TIME,
    FACILITY.DRIVEOUT_TIME,
    FACILITY.CHECKOUT_TIME,
    FACILITY.CUTOFF_DTTM,
    FACILITY.MAX_TRAILER_YARD_TIME,
    FACILITY.HAND_OVER_TIME,
    FACILITY.OVER_BOOK_PERCENTAGE,
    FACILITY.RECOMMENDATION_CRITERIA,
    FACILITY.NBR_OF_SLOTS_TO_SHOW,
    FACILITY.RESTRICT_FLEET_ASMT_TIME,
    FACILITY.GROUP_ID,
    FACILITY.IS_VTBP,
    FACILITY.AUTO_CREATE_SHIPMENT,
    FACILITY.LOGO_IMAGE_PATH,
    FACILITY.GEN_LAST_SHIPMENT_LEG,
    FACILITY.DEF_DRIVER_TYPE_ID,
    FACILITY.DEF_TRACTOR_ID,
    FACILITY.DEF_EQUIPMENT_ID,
    FACILITY.DRIVER_AVAIL_HRS,
    FACILITY.WHSE,
    FACILITY.OPEN_DATE,
    FACILITY.CLOSE_DATE,
    FACILITY.HOLD_DATE,
    FACILITY.GRP,
    FACILITY.CHAIN,
    FACILITY.ZONE,
    FACILITY.TERRITORY,
    FACILITY.REGION,
    FACILITY.DISTRICT,
    FACILITY.SHIP_MON,
    FACILITY.SHIP_TUE,
    FACILITY.SHIP_WED,
    FACILITY.SHIP_THU,
    FACILITY.SHIP_FRI,
    FACILITY.SHIP_SAT,
    FACILITY.SHIP_SU,
    FACILITY.ACCEPT_IRREG,
    FACILITY.WAVE_LABEL_TYPE,
    FACILITY.PKG_SLIP_TYPE,
    FACILITY.PRINT_CODE,
    FACILITY.CARTON_CNT_TYPE,
    FACILITY.SHIP_VIA,
    FACILITY.RTE_NBR,
    FACILITY.RTE_ATTR,
    FACILITY.RTE_TO,
    FACILITY.RTE_TYPE_1,
    FACILITY.RTE_TYPE_2,
    FACILITY.RTE_ZIP,
    FACILITY.SPL_INSTR_CODE_1,
    FACILITY.SPL_INSTR_CODE_2,
    FACILITY.SPL_INSTR_CODE_3,
    FACILITY.SPL_INSTR_CODE_4,
    FACILITY.SPL_INSTR_CODE_5,
    FACILITY.SPL_INSTR_CODE_6,
    FACILITY.SPL_INSTR_CODE_7,
    FACILITY.SPL_INSTR_CODE_8,
    FACILITY.SPL_INSTR_CODE_9,
    FACILITY.SPL_INSTR_CODE_10,
    FACILITY.ASSIGN_MERCH_TYPE,
    FACILITY.ASSIGN_MERCH_GROUP,
    FACILITY.ASSIGN_STORE_DEPT,
    FACILITY.CARTON_LABEL_TYPE,
    FACILITY.CARTON_CUBNG_INDIC,
    FACILITY.MAX_CTN,
    FACILITY.MAX_PLT,
    FACILITY.BUSN_UNIT_CODE,
    FACILITY.USE_INBD_LPN_AS_OUTBD_LPN,
    FACILITY.PRINT_COO,
    FACILITY.PRINT_INV,
    FACILITY.PRINT_SED,
    FACILITY.PRINT_CANADIAN_CUST_INVC_FLAG,
    FACILITY.PRINT_DOCK_RCPT_FLAG,
    FACILITY.PRINT_NAFTA_COO_FLAG,
    FACILITY.PRINT_OCEAN_BOL_FLAG,
    FACILITY.PRINT_PKG_LIST_FLAG,
    FACILITY.PRINT_SHPR_LTR_OF_INSTR_FLAG,
    FACILITY.AUDIT_TRANSACTION,
    FACILITY.AUDIT_PARTY_ID,
    FACILITY.CAPTURE_OTHER_MA,
    FACILITY.HIBERNATE_VERSION,
    FACILITY.STORE_TYPE_GROUPING,
    FACILITY.LOAD_RATE,
    FACILITY.UNLOAD_RATE,
    FACILITY.HANDLING_RATE,
    FACILITY.LOAD_UNLOAD_SIZE_UOM_ID,
    FACILITY.LOAD_FACTOR_SIZE_UOM_ID,
    FACILITY.PARCEL_LENGTH_RATIO,
    FACILITY.PARCEL_WIDTH_RATIO,
    FACILITY.PARCEL_HEIGHT_RATIO,
    FACILITY.METER_NUMBER,
    FACILITY.DIRECT_DELIVERY_ALLOWED,
    FACILITY.TRACK_EQUIP_ID_FLAG,
    FACILITY.STAT_CODE,
    FACILITY.HANDLES_NON_MACHINEABLE,
    FACILITY.MAINTAINS_PERPETUAL_INVTY,
    FACILITY.IS_CUST_OWNED_FACILITY,
    FACILITY.FLOWTHRU_ALLOC_SORT_PRTY,
    FACILITY.RLS_HOLD_DATE,
    FACILITY.RE_COMPUTE_FEASIBLE_EQUIPMENT,
    FACILITY.SMARTPOST_DC_NUMBER,
    FACILITY.ADDRESS_TYPE,
    FACILITY.SPLC_CODE,
    FACILITY.ERPC_CODE,
    FACILITY.R260_CODE,
    FACILITY.MAX_WAIT_TIME,
    FACILITY.FREE_WAIT_TIME,
    FACILITY.IATA_SCR_NBR,
    FACILITY.PICKUP_AT_STORE,
    FACILITY.SHIP_TO_STORE,
    FACILITY.SHIP_FROM_FACILITY,
    FACILITY.TRANS_PLAN_FLOW,
    FACILITY.AVG_HNDLG_COST_PER_LN,
    FACILITY.AVG_HNDLG_COST_PER_LN_CURCODE,
    FACILITY.PENALTY_COST,
    FACILITY.PENALTY_COST_CURRENCY_CODE,
    FACILITY.MAINTAIN_DISPOSITION,
    FACILITY.MAINTAIN_SUBLOCATION,
    FACILITY.MAINTAIN_SEGMENT,
    FACILITY.MAINTAIN_CNTRY_OF_ORGN,
    FACILITY.MAINTAIN_BATCH_NBR,
    FACILITY.MAINTAIN_PROD_STAT,
    FACILITY.MAINTAIN_INV_TYPE,
    FACILITY.MAINTAIN_ITEM_ATTR_1,
    FACILITY.MAINTAIN_ITEM_ATTR_2,
    FACILITY.MAINTAIN_ITEM_ATTR_3,
    FACILITY.MAINTAIN_ITEM_ATTR_4,
    FACILITY.MAINTAIN_ITEM_ATTR_5,
    FACILITY.GENERATE_PERPETUAL_EVENT,
    FACILITY.GENERATE_SEGMENT_EVENT,
    FACILITY.MAINTAIN_ON_HAND,
    FACILITY.MAINTAIN_IN_TRANSIT,
    FACILITY.MAINTAIN_ON_ORDER,
    FACILITY.FULFILLMENT_GROUP,
    FACILITY.REF_FIELD_6,
    FACILITY.REF_FIELD_7,
    FACILITY.REF_FIELD_8,
    FACILITY.REF_FIELD_9,
    FACILITY.REF_FIELD_10,
    FACILITY.REF_NUM1,
    FACILITY.REF_NUM2,
    FACILITY.REF_NUM3,
    FACILITY.REF_NUM4,
    FACILITY.REF_NUM5,
    FACILITY.REF_FIELD_1,
    FACILITY.REF_FIELD_2,
    FACILITY.REF_FIELD_3,
    FACILITY.REF_FIELD_4,
    FACILITY.REF_FIELD_5,
    FACILITY.WHSE_REGION,
    FACILITY.GEOFENCE_RADIUS
    FROM {source_schema}.FACILITY
    WHERE (trunc(CREATED_DTTM) >= trunc(to_date('{Prev_Run_Dt}','YYYY-MM-DD'))-1) OR (trunc(LAST_UPDATED_DTTM) >=  trunc(to_date('{Prev_Run_Dt}','YYYY-MM-DD'))-1) AND
    1=1""",username,password,connection_string).withColumn("sys_row_id", monotonically_increasing_id())

    # COMMAND ----------
    # Processing node EXPTRANS, type EXPRESSION 
    # COLUMN COUNT: 228

    # for each involved DataFrame, append the dataframe name to each column
    SQ_Shortcut_to_FACILITY_temp = SQ_Shortcut_to_FACILITY.toDF(*["SQ_Shortcut_to_FACILITY___" + col for col in SQ_Shortcut_to_FACILITY.columns])

    EXPTRANS = SQ_Shortcut_to_FACILITY_temp.selectExpr( \
        "SQ_Shortcut_to_FACILITY___sys_row_id as sys_row_id", \
        f"{dcnbr}  as DC_NBR_EXP", \
        "SQ_Shortcut_to_FACILITY___FACILITY_ID as FACILITY_ID", \
        "SQ_Shortcut_to_FACILITY___TC_COMPANY_ID as TC_COMPANY_ID", \
        "SQ_Shortcut_to_FACILITY___BUSINESS_PARTNER_ID as BUSINESS_PARTNER_ID", \
        "SQ_Shortcut_to_FACILITY___NAME as NAME", \
        "SQ_Shortcut_to_FACILITY___DESCRIPTION as DESCRIPTION", \
        "SQ_Shortcut_to_FACILITY___ADDRESS_1 as ADDRESS_1", \
        "SQ_Shortcut_to_FACILITY___ADDRESS_2 as ADDRESS_2", \
        "SQ_Shortcut_to_FACILITY___ADDRESS_3 as ADDRESS_3", \
        "SQ_Shortcut_to_FACILITY___ADDRESS_KEY_1 as ADDRESS_KEY_1", \
        "SQ_Shortcut_to_FACILITY___CITY as CITY", \
        "SQ_Shortcut_to_FACILITY___STATE_PROV as STATE_PROV", \
        "SQ_Shortcut_to_FACILITY___POSTAL_CODE as POSTAL_CODE", \
        "SQ_Shortcut_to_FACILITY___COUNTY as COUNTY", \
        "SQ_Shortcut_to_FACILITY___COUNTRY_CODE as COUNTRY_CODE", \
        "SQ_Shortcut_to_FACILITY___LONGITUDE as LONGITUDE", \
        "SQ_Shortcut_to_FACILITY___LATITUDE as LATITUDE", \
        "SQ_Shortcut_to_FACILITY___EIN_NBR as EIN_NBR", \
        "SQ_Shortcut_to_FACILITY___IATA_CODE as IATA_CODE", \
        "SQ_Shortcut_to_FACILITY___GLOBAL_LOCN_NBR as GLOBAL_LOCN_NBR", \
        "SQ_Shortcut_to_FACILITY___TAX_ID as TAX_ID", \
        "SQ_Shortcut_to_FACILITY___DUNS_NBR as DUNS_NBR", \
        "SQ_Shortcut_to_FACILITY___INBOUNDS_RS_AREA_ID as INBOUNDS_RS_AREA_ID", \
        "SQ_Shortcut_to_FACILITY___OUTBOUND_RS_AREA_ID as OUTBOUND_RS_AREA_ID", \
        "SQ_Shortcut_to_FACILITY___INBOUND_REGION_ID as INBOUND_REGION_ID", \
        "SQ_Shortcut_to_FACILITY___OUTBOUND_REGION_ID as OUTBOUND_REGION_ID", \
        "SQ_Shortcut_to_FACILITY___FACILITY_TZ as FACILITY_TZ", \
        "SQ_Shortcut_to_FACILITY___DROP_INDICATOR as DROP_INDICATOR", \
        "SQ_Shortcut_to_FACILITY___HOOK_INDICATOR as HOOK_INDICATOR", \
        "SQ_Shortcut_to_FACILITY___HANDLER as HANDLER", \
        "SQ_Shortcut_to_FACILITY___IS_SHIP_APPT_REQD as IS_SHIP_APPT_REQD", \
        "SQ_Shortcut_to_FACILITY___IS_RCV_APPT_REQD as IS_RCV_APPT_REQD", \
        "SQ_Shortcut_to_FACILITY___TRACK_ONTIME_INDICATOR as TRACK_ONTIME_INDICATOR", \
        "SQ_Shortcut_to_FACILITY___ONTIME_PERF_METHOD as ONTIME_PERF_METHOD", \
        "SQ_Shortcut_to_FACILITY___LOAD_FACTOR_SIZE_VALUE as LOAD_FACTOR_SIZE_VALUE", \
        "SQ_Shortcut_to_FACILITY___MARK_FOR_DELETION as MARK_FOR_DELETION", \
        "SQ_Shortcut_to_FACILITY___CREATED_SOURCE_TYPE as CREATED_SOURCE_TYPE", \
        "SQ_Shortcut_to_FACILITY___CREATED_SOURCE as CREATED_SOURCE", \
        "SQ_Shortcut_to_FACILITY___CREATED_DTTM as CREATED_DTTM", \
        "SQ_Shortcut_to_FACILITY___LAST_UPDATED_SOURCE_TYPE as LAST_UPDATED_SOURCE_TYPE", \
        "SQ_Shortcut_to_FACILITY___LAST_UPDATED_SOURCE as LAST_UPDATED_SOURCE", \
        "SQ_Shortcut_to_FACILITY___LAST_UPDATED_DTTM as LAST_UPDATED_DTTM", \
        "SQ_Shortcut_to_FACILITY___ALLOW_OVERLAPPING_APPS as ALLOW_OVERLAPPING_APPS", \
        "SQ_Shortcut_to_FACILITY___EARLY_TOLERANCE_POINT as EARLY_TOLERANCE_POINT", \
        "SQ_Shortcut_to_FACILITY___LATE_TOLERANCE_POINT as LATE_TOLERANCE_POINT", \
        "SQ_Shortcut_to_FACILITY___EARLY_TOLERANCE_WINDOW as EARLY_TOLERANCE_WINDOW", \
        "SQ_Shortcut_to_FACILITY___LATE_TOLERANCE_WINDOW as LATE_TOLERANCE_WINDOW", \
        "SQ_Shortcut_to_FACILITY___FACILITY_TYPE_BITS as FACILITY_TYPE_BITS", \
        "SQ_Shortcut_to_FACILITY___PP_HANDLING_TIME as PP_HANDLING_TIME", \
        "SQ_Shortcut_to_FACILITY___STOP_CONSTRAINT_BITS as STOP_CONSTRAINT_BITS", \
        "SQ_Shortcut_to_FACILITY___IS_DOCK_SCHED_FAC as IS_DOCK_SCHED_FAC", \
        "SQ_Shortcut_to_FACILITY___ASN_COMMUNICATION_METHOD as ASN_COMMUNICATION_METHOD", \
        "SQ_Shortcut_to_FACILITY___PICK_TIME as PICK_TIME", \
        "SQ_Shortcut_to_FACILITY___DISPATCH_INITIATION_TIME as DISPATCH_INITIATION_TIME", \
        "SQ_Shortcut_to_FACILITY___PAPERWORK_TIME as PAPERWORK_TIME", \
        "SQ_Shortcut_to_FACILITY___VEHICLE_CHECK_TIME as VEHICLE_CHECK_TIME", \
        "SQ_Shortcut_to_FACILITY___VISIT_GAP as VISIT_GAP", \
        "SQ_Shortcut_to_FACILITY___MIN_HANDLING_TIME as MIN_HANDLING_TIME", \
        "SQ_Shortcut_to_FACILITY___IS_CREDIT_AVAILABLE as IS_CREDIT_AVAILABLE", \
        "SQ_Shortcut_to_FACILITY___BUSINESS_GROUP_ID_1 as BUSINESS_GROUP_ID_1", \
        "SQ_Shortcut_to_FACILITY___BUSINESS_GROUP_ID_2 as BUSINESS_GROUP_ID_2", \
        "SQ_Shortcut_to_FACILITY___IS_OPERATIONAL as IS_OPERATIONAL", \
        "SQ_Shortcut_to_FACILITY___IS_MAINTENANCE_FACILITY as IS_MAINTENANCE_FACILITY", \
        "SQ_Shortcut_to_FACILITY___DWELL_TIME as DWELL_TIME", \
        "SQ_Shortcut_to_FACILITY___DRIVER_CHECK_IN_TIME as DRIVER_CHECK_IN_TIME", \
        "SQ_Shortcut_to_FACILITY___DISPATCH_DTTM as DISPATCH_DTTM", \
        "SQ_Shortcut_to_FACILITY___DSP_DR_CONFIGURATION_ID as DSP_DR_CONFIGURATION_ID", \
        "SQ_Shortcut_to_FACILITY___DROP_HOOK_TIME as DROP_HOOK_TIME", \
        "SQ_Shortcut_to_FACILITY___LOADING_END_TIME as LOADING_END_TIME", \
        "SQ_Shortcut_to_FACILITY___DRIVER_DEBRIEF_TIME as DRIVER_DEBRIEF_TIME", \
        "SQ_Shortcut_to_FACILITY___ACCOUNT_CODE_NUMBER as ACCOUNT_CODE_NUMBER", \
        "SQ_Shortcut_to_FACILITY___LOAD_FACTOR_MOT_ID as LOAD_FACTOR_MOT_ID", \
        "SQ_Shortcut_to_FACILITY___LOAD_UNLOAD_MOT_ID as LOAD_UNLOAD_MOT_ID", \
        "SQ_Shortcut_to_FACILITY___MIN_TRAIL_FILL as MIN_TRAIL_FILL", \
        "SQ_Shortcut_to_FACILITY___TANDEM_DROP_HOOK_TIME as TANDEM_DROP_HOOK_TIME", \
        "SQ_Shortcut_to_FACILITY___STORE_TYPE as STORE_TYPE", \
        "SQ_Shortcut_to_FACILITY___DRIVEIN_TIME as DRIVEIN_TIME", \
        "SQ_Shortcut_to_FACILITY___CHECKIN_TIME as CHECKIN_TIME", \
        "SQ_Shortcut_to_FACILITY___DRIVEOUT_TIME as DRIVEOUT_TIME", \
        "SQ_Shortcut_to_FACILITY___CHECKOUT_TIME as CHECKOUT_TIME", \
        "SQ_Shortcut_to_FACILITY___CUTOFF_DTTM as CUTOFF_DTTM", \
        "SQ_Shortcut_to_FACILITY___MAX_TRAILER_YARD_TIME as MAX_TRAILER_YARD_TIME", \
        "SQ_Shortcut_to_FACILITY___HAND_OVER_TIME as HAND_OVER_TIME", \
        "SQ_Shortcut_to_FACILITY___OVER_BOOK_PERCENTAGE as OVER_BOOK_PERCENTAGE", \
        "SQ_Shortcut_to_FACILITY___RECOMMENDATION_CRITERIA as RECOMMENDATION_CRITERIA", \
        "SQ_Shortcut_to_FACILITY___NBR_OF_SLOTS_TO_SHOW as NBR_OF_SLOTS_TO_SHOW", \
        "SQ_Shortcut_to_FACILITY___RESTRICT_FLEET_ASMT_TIME as RESTRICT_FLEET_ASMT_TIME", \
        "SQ_Shortcut_to_FACILITY___GROUP_ID as GROUP_ID", \
        "SQ_Shortcut_to_FACILITY___IS_VTBP as IS_VTBP", \
        "SQ_Shortcut_to_FACILITY___AUTO_CREATE_SHIPMENT as AUTO_CREATE_SHIPMENT", \
        "SQ_Shortcut_to_FACILITY___LOGO_IMAGE_PATH as LOGO_IMAGE_PATH", \
        "SQ_Shortcut_to_FACILITY___GEN_LAST_SHIPMENT_LEG as GEN_LAST_SHIPMENT_LEG", \
        "SQ_Shortcut_to_FACILITY___DEF_DRIVER_TYPE_ID as DEF_DRIVER_TYPE_ID", \
        "SQ_Shortcut_to_FACILITY___DEF_TRACTOR_ID as DEF_TRACTOR_ID", \
        "SQ_Shortcut_to_FACILITY___DEF_EQUIPMENT_ID as DEF_EQUIPMENT_ID", \
        "SQ_Shortcut_to_FACILITY___DRIVER_AVAIL_HRS as DRIVER_AVAIL_HRS", \
        "SQ_Shortcut_to_FACILITY___WHSE as WHSE", \
        "SQ_Shortcut_to_FACILITY___OPEN_DATE as OPEN_DATE", \
        "SQ_Shortcut_to_FACILITY___CLOSE_DATE as CLOSE_DATE", \
        "SQ_Shortcut_to_FACILITY___HOLD_DATE as HOLD_DATE", \
        "SQ_Shortcut_to_FACILITY___GRP as GRP", \
        "SQ_Shortcut_to_FACILITY___CHAIN as CHAIN", \
        "SQ_Shortcut_to_FACILITY___ZONE as ZONE", \
        "SQ_Shortcut_to_FACILITY___TERRITORY as TERRITORY", \
        "SQ_Shortcut_to_FACILITY___REGION as REGION", \
        "SQ_Shortcut_to_FACILITY___DISTRICT as DISTRICT", \
        "SQ_Shortcut_to_FACILITY___SHIP_MON as SHIP_MON", \
        "SQ_Shortcut_to_FACILITY___SHIP_TUE as SHIP_TUE", \
        "SQ_Shortcut_to_FACILITY___SHIP_WED as SHIP_WED", \
        "SQ_Shortcut_to_FACILITY___SHIP_THU as SHIP_THU", \
        "SQ_Shortcut_to_FACILITY___SHIP_FRI as SHIP_FRI", \
        "SQ_Shortcut_to_FACILITY___SHIP_SAT as SHIP_SAT", \
        "SQ_Shortcut_to_FACILITY___SHIP_SU as SHIP_SU", \
        "SQ_Shortcut_to_FACILITY___ACCEPT_IRREG as ACCEPT_IRREG", \
        "SQ_Shortcut_to_FACILITY___WAVE_LABEL_TYPE as WAVE_LABEL_TYPE", \
        "SQ_Shortcut_to_FACILITY___PKG_SLIP_TYPE as PKG_SLIP_TYPE", \
        "SQ_Shortcut_to_FACILITY___PRINT_CODE as PRINT_CODE", \
        "SQ_Shortcut_to_FACILITY___CARTON_CNT_TYPE as CARTON_CNT_TYPE", \
        "SQ_Shortcut_to_FACILITY___SHIP_VIA as SHIP_VIA", \
        "SQ_Shortcut_to_FACILITY___RTE_NBR as RTE_NBR", \
        "SQ_Shortcut_to_FACILITY___RTE_ATTR as RTE_ATTR", \
        "SQ_Shortcut_to_FACILITY___RTE_TO as RTE_TO", \
        "SQ_Shortcut_to_FACILITY___RTE_TYPE_1 as RTE_TYPE_1", \
        "SQ_Shortcut_to_FACILITY___RTE_TYPE_2 as RTE_TYPE_2", \
        "SQ_Shortcut_to_FACILITY___RTE_ZIP as RTE_ZIP", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_1 as SPL_INSTR_CODE_1", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_2 as SPL_INSTR_CODE_2", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_3 as SPL_INSTR_CODE_3", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_4 as SPL_INSTR_CODE_4", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_5 as SPL_INSTR_CODE_5", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_6 as SPL_INSTR_CODE_6", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_7 as SPL_INSTR_CODE_7", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_8 as SPL_INSTR_CODE_8", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_9 as SPL_INSTR_CODE_9", \
        "SQ_Shortcut_to_FACILITY___SPL_INSTR_CODE_10 as SPL_INSTR_CODE_10", \
        "SQ_Shortcut_to_FACILITY___ASSIGN_MERCH_TYPE as ASSIGN_MERCH_TYPE", \
        "SQ_Shortcut_to_FACILITY___ASSIGN_MERCH_GROUP as ASSIGN_MERCH_GROUP", \
        "SQ_Shortcut_to_FACILITY___ASSIGN_STORE_DEPT as ASSIGN_STORE_DEPT", \
        "SQ_Shortcut_to_FACILITY___CARTON_LABEL_TYPE as CARTON_LABEL_TYPE", \
        "SQ_Shortcut_to_FACILITY___CARTON_CUBNG_INDIC as CARTON_CUBNG_INDIC", \
        "SQ_Shortcut_to_FACILITY___MAX_CTN as MAX_CTN", \
        "SQ_Shortcut_to_FACILITY___MAX_PLT as MAX_PLT", \
        "SQ_Shortcut_to_FACILITY___BUSN_UNIT_CODE as BUSN_UNIT_CODE", \
        "SQ_Shortcut_to_FACILITY___USE_INBD_LPN_AS_OUTBD_LPN as USE_INBD_LPN_AS_OUTBD_LPN", \
        "SQ_Shortcut_to_FACILITY___PRINT_COO as PRINT_COO", \
        "SQ_Shortcut_to_FACILITY___PRINT_INV as PRINT_INV", \
        "SQ_Shortcut_to_FACILITY___PRINT_SED as PRINT_SED", \
        "SQ_Shortcut_to_FACILITY___PRINT_CANADIAN_CUST_INVC_FLAG as PRINT_CANADIAN_CUST_INVC_FLAG", \
        "SQ_Shortcut_to_FACILITY___PRINT_DOCK_RCPT_FLAG as PRINT_DOCK_RCPT_FLAG", \
        "SQ_Shortcut_to_FACILITY___PRINT_NAFTA_COO_FLAG as PRINT_NAFTA_COO_FLAG", \
        "SQ_Shortcut_to_FACILITY___PRINT_OCEAN_BOL_FLAG as PRINT_OCEAN_BOL_FLAG", \
        "SQ_Shortcut_to_FACILITY___PRINT_PKG_LIST_FLAG as PRINT_PKG_LIST_FLAG", \
        "SQ_Shortcut_to_FACILITY___PRINT_SHPR_LTR_OF_INSTR_FLAG as PRINT_SHPR_LTR_OF_INSTR_FLAG", \
        "SQ_Shortcut_to_FACILITY___AUDIT_TRANSACTION as AUDIT_TRANSACTION", \
        "SQ_Shortcut_to_FACILITY___AUDIT_PARTY_ID as AUDIT_PARTY_ID", \
        "SQ_Shortcut_to_FACILITY___CAPTURE_OTHER_MA as CAPTURE_OTHER_MA", \
        "SQ_Shortcut_to_FACILITY___HIBERNATE_VERSION as HIBERNATE_VERSION", \
        "SQ_Shortcut_to_FACILITY___STORE_TYPE_GROUPING as STORE_TYPE_GROUPING", \
        "SQ_Shortcut_to_FACILITY___LOAD_RATE as LOAD_RATE", \
        "SQ_Shortcut_to_FACILITY___UNLOAD_RATE as UNLOAD_RATE", \
        "SQ_Shortcut_to_FACILITY___HANDLING_RATE as HANDLING_RATE", \
        "SQ_Shortcut_to_FACILITY___LOAD_UNLOAD_SIZE_UOM_ID as LOAD_UNLOAD_SIZE_UOM_ID", \
        "SQ_Shortcut_to_FACILITY___LOAD_FACTOR_SIZE_UOM_ID as LOAD_FACTOR_SIZE_UOM_ID", \
        "SQ_Shortcut_to_FACILITY___PARCEL_LENGTH_RATIO as PARCEL_LENGTH_RATIO", \
        "SQ_Shortcut_to_FACILITY___PARCEL_WIDTH_RATIO as PARCEL_WIDTH_RATIO", \
        "SQ_Shortcut_to_FACILITY___PARCEL_HEIGHT_RATIO as PARCEL_HEIGHT_RATIO", \
        "SQ_Shortcut_to_FACILITY___METER_NUMBER as METER_NUMBER", \
        "SQ_Shortcut_to_FACILITY___DIRECT_DELIVERY_ALLOWED as DIRECT_DELIVERY_ALLOWED", \
        "SQ_Shortcut_to_FACILITY___TRACK_EQUIP_ID_FLAG as TRACK_EQUIP_ID_FLAG", \
        "SQ_Shortcut_to_FACILITY___STAT_CODE as STAT_CODE", \
        "SQ_Shortcut_to_FACILITY___HANDLES_NON_MACHINEABLE as HANDLES_NON_MACHINEABLE", \
        "SQ_Shortcut_to_FACILITY___MAINTAINS_PERPETUAL_INVTY as MAINTAINS_PERPETUAL_INVTY", \
        "SQ_Shortcut_to_FACILITY___IS_CUST_OWNED_FACILITY as IS_CUST_OWNED_FACILITY", \
        "SQ_Shortcut_to_FACILITY___FLOWTHRU_ALLOC_SORT_PRTY as FLOWTHRU_ALLOC_SORT_PRTY", \
        "SQ_Shortcut_to_FACILITY___RLS_HOLD_DATE as RLS_HOLD_DATE", \
        "SQ_Shortcut_to_FACILITY___RE_COMPUTE_FEASIBLE_EQUIPMENT as RE_COMPUTE_FEASIBLE_EQUIPMENT", \
        "SQ_Shortcut_to_FACILITY___SMARTPOST_DC_NUMBER as SMARTPOST_DC_NUMBER", \
        "SQ_Shortcut_to_FACILITY___ADDRESS_TYPE as ADDRESS_TYPE", \
        "SQ_Shortcut_to_FACILITY___SPLC_CODE as SPLC_CODE", \
        "SQ_Shortcut_to_FACILITY___ERPC_CODE as ERPC_CODE", \
        "SQ_Shortcut_to_FACILITY___R260_CODE as R260_CODE", \
        "SQ_Shortcut_to_FACILITY___MAX_WAIT_TIME as MAX_WAIT_TIME", \
        "SQ_Shortcut_to_FACILITY___FREE_WAIT_TIME as FREE_WAIT_TIME", \
        "SQ_Shortcut_to_FACILITY___IATA_SCR_NBR as IATA_SCR_NBR", \
        "SQ_Shortcut_to_FACILITY___PICKUP_AT_STORE as PICKUP_AT_STORE", \
        "SQ_Shortcut_to_FACILITY___SHIP_TO_STORE as SHIP_TO_STORE", \
        "SQ_Shortcut_to_FACILITY___SHIP_FROM_FACILITY as SHIP_FROM_FACILITY", \
        "SQ_Shortcut_to_FACILITY___TRANS_PLAN_FLOW as TRANS_PLAN_FLOW", \
        "SQ_Shortcut_to_FACILITY___AVG_HNDLG_COST_PER_LN as AVG_HNDLG_COST_PER_LN", \
        "SQ_Shortcut_to_FACILITY___AVG_HNDLG_COST_PER_LN_CURCODE as AVG_HNDLG_COST_PER_LN_CURCODE", \
        "SQ_Shortcut_to_FACILITY___PENALTY_COST as PENALTY_COST", \
        "SQ_Shortcut_to_FACILITY___PENALTY_COST_CURRENCY_CODE as PENALTY_COST_CURRENCY_CODE", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_DISPOSITION as MAINTAIN_DISPOSITION", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_SUBLOCATION as MAINTAIN_SUBLOCATION", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_SEGMENT as MAINTAIN_SEGMENT", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_CNTRY_OF_ORGN as MAINTAIN_CNTRY_OF_ORGN", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_BATCH_NBR as MAINTAIN_BATCH_NBR", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_PROD_STAT as MAINTAIN_PROD_STAT", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_INV_TYPE as MAINTAIN_INV_TYPE", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_ITEM_ATTR_1 as MAINTAIN_ITEM_ATTR_1", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_ITEM_ATTR_2 as MAINTAIN_ITEM_ATTR_2", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_ITEM_ATTR_3 as MAINTAIN_ITEM_ATTR_3", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_ITEM_ATTR_4 as MAINTAIN_ITEM_ATTR_4", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_ITEM_ATTR_5 as MAINTAIN_ITEM_ATTR_5", \
        "SQ_Shortcut_to_FACILITY___GENERATE_PERPETUAL_EVENT as GENERATE_PERPETUAL_EVENT", \
        "SQ_Shortcut_to_FACILITY___GENERATE_SEGMENT_EVENT as GENERATE_SEGMENT_EVENT", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_ON_HAND as MAINTAIN_ON_HAND", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_IN_TRANSIT as MAINTAIN_IN_TRANSIT", \
        "SQ_Shortcut_to_FACILITY___MAINTAIN_ON_ORDER as MAINTAIN_ON_ORDER", \
        "SQ_Shortcut_to_FACILITY___FULFILLMENT_GROUP as FULFILLMENT_GROUP", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_6 as REF_FIELD_6", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_7 as REF_FIELD_7", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_8 as REF_FIELD_8", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_9 as REF_FIELD_9", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_10 as REF_FIELD_10", \
        "SQ_Shortcut_to_FACILITY___REF_NUM1 as REF_NUM1", \
        "SQ_Shortcut_to_FACILITY___REF_NUM2 as REF_NUM2", \
        "SQ_Shortcut_to_FACILITY___REF_NUM3 as REF_NUM3", \
        "SQ_Shortcut_to_FACILITY___REF_NUM4 as REF_NUM4", \
        "SQ_Shortcut_to_FACILITY___REF_NUM5 as REF_NUM5", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_1 as REF_FIELD_1", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_2 as REF_FIELD_2", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_3 as REF_FIELD_3", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_4 as REF_FIELD_4", \
        "SQ_Shortcut_to_FACILITY___REF_FIELD_5 as REF_FIELD_5", \
        "SQ_Shortcut_to_FACILITY___WHSE_REGION as WHSE_REGION", \
        "SQ_Shortcut_to_FACILITY___GEOFENCE_RADIUS as GEOFENCE_RADIUS", \
        "CURRENT_TIMESTAMP () as LOAD_TSTMP_EXP" \
    )

    # COMMAND ----------
    # Processing node Shortcut_to_WM_FACILITY_PRE, type TARGET 
    # COLUMN COUNT: 228


    Shortcut_to_WM_FACILITY_PRE = EXPTRANS.selectExpr(
        "CAST(DC_NBR_EXP AS SMALLINT) as DC_NBR",
        "CAST(FACILITY_ID AS INT) as FACILITY_ID",
        "CAST(TC_COMPANY_ID AS INT) as TC_COMPANY_ID",
        "CAST(BUSINESS_PARTNER_ID AS STRING) as BUSINESS_PARTNER_ID",
        "CAST(NAME AS STRING) as NAME",
        "CAST(DESCRIPTION AS STRING) as DESCRIPTION",
        "CAST(ADDRESS_1 AS STRING) as ADDRESS_1",
        "CAST(ADDRESS_2 AS STRING) as ADDRESS_2",
        "CAST(ADDRESS_3 AS STRING) as ADDRESS_3",
        "CAST(ADDRESS_KEY_1 AS STRING) as ADDRESS_KEY_1",
        "CAST(CITY AS STRING) as CITY",
        "CAST(STATE_PROV AS STRING) as STATE_PROV",
        "CAST(POSTAL_CODE AS STRING) as POSTAL_CODE",
        "CAST(COUNTY AS STRING) as COUNTY",
        "CAST(COUNTRY_CODE AS STRING) as COUNTRY_CODE",
        "CAST(LONGITUDE AS DECIMAL(12,6)) as LONGITUDE",
        "CAST(LATITUDE AS DECIMAL(12,6)) as LATITUDE",
        "CAST(EIN_NBR AS STRING) as EIN_NBR",
        "CAST(IATA_CODE AS STRING) as IATA_CODE",
        "CAST(GLOBAL_LOCN_NBR AS STRING) as GLOBAL_LOCN_NBR",
        "CAST(TAX_ID AS STRING) as TAX_ID",
        "CAST(DUNS_NBR AS STRING) as DUNS_NBR",
        "CAST(INBOUNDS_RS_AREA_ID AS INT) as INBOUNDS_RS_AREA_ID",
        "CAST(OUTBOUND_RS_AREA_ID AS INT) as OUTBOUND_RS_AREA_ID",
        "CAST(INBOUND_REGION_ID AS INT) as INBOUND_REGION_ID",
        "CAST(OUTBOUND_REGION_ID AS INT) as OUTBOUND_REGION_ID",
        "CAST(FACILITY_TZ AS SMALLINT) as FACILITY_TZ",
        "CAST(DROP_INDICATOR AS TINYINT) as DROP_INDICATOR",
        "CAST(HOOK_INDICATOR AS TINYINT) as HOOK_INDICATOR",
        "CAST(HANDLER AS TINYINT) as HANDLER",
        "CAST(IS_SHIP_APPT_REQD AS TINYINT) as IS_SHIP_APPT_REQD",
        "CAST(IS_RCV_APPT_REQD AS TINYINT) as IS_RCV_APPT_REQD",
        "CAST(TRACK_ONTIME_INDICATOR AS TINYINT) as TRACK_ONTIME_INDICATOR",
        "CAST(ONTIME_PERF_METHOD AS STRING) as ONTIME_PERF_METHOD",
        "CAST(LOAD_FACTOR_SIZE_VALUE AS DECIMAL(13,2)) as LOAD_FACTOR_SIZE_VALUE",
        "CAST(MARK_FOR_DELETION AS TINYINT) as MARK_FOR_DELETION",
        "CAST(CREATED_SOURCE_TYPE AS TINYINT) as CREATED_SOURCE_TYPE",
        "CAST(CREATED_SOURCE AS STRING) as CREATED_SOURCE",
        "CAST(CREATED_DTTM AS TIMESTAMP) as CREATED_DTTM",
        "CAST(LAST_UPDATED_SOURCE_TYPE AS TINYINT) as LAST_UPDATED_SOURCE_TYPE",
        "CAST(LAST_UPDATED_SOURCE AS STRING) as LAST_UPDATED_SOURCE",
        "CAST(LAST_UPDATED_DTTM AS TIMESTAMP) as LAST_UPDATED_DTTM",
        "CAST(ALLOW_OVERLAPPING_APPS AS TINYINT) as ALLOW_OVERLAPPING_APPS",
        "CAST(EARLY_TOLERANCE_POINT AS INT) as EARLY_TOLERANCE_POINT",
        "CAST(LATE_TOLERANCE_POINT AS INT) as LATE_TOLERANCE_POINT",
        "CAST(EARLY_TOLERANCE_WINDOW AS INT) as EARLY_TOLERANCE_WINDOW",
        "CAST(LATE_TOLERANCE_WINDOW AS INT) as LATE_TOLERANCE_WINDOW",
        "CAST(FACILITY_TYPE_BITS AS SMALLINT) as FACILITY_TYPE_BITS",
        "CAST(PP_HANDLING_TIME AS INT) as PP_HANDLING_TIME",
        "CAST(STOP_CONSTRAINT_BITS AS SMALLINT) as STOP_CONSTRAINT_BITS",
        "CAST(IS_DOCK_SCHED_FAC AS TINYINT) as IS_DOCK_SCHED_FAC",
        "CAST(ASN_COMMUNICATION_METHOD AS SMALLINT) as ASN_COMMUNICATION_METHOD",
        "CAST(PICK_TIME AS INT) as PICK_TIME",
        "CAST(DISPATCH_INITIATION_TIME AS INT) as DISPATCH_INITIATION_TIME",
        "CAST(PAPERWORK_TIME AS INT) as PAPERWORK_TIME",
        "CAST(VEHICLE_CHECK_TIME AS INT) as VEHICLE_CHECK_TIME",
        "CAST(VISIT_GAP AS SMALLINT) as VISIT_GAP",
        "CAST(MIN_HANDLING_TIME AS BIGINT) as MIN_HANDLING_TIME",
        "CAST(IS_CREDIT_AVAILABLE AS TINYINT) as IS_CREDIT_AVAILABLE",
        "CAST(BUSINESS_GROUP_ID_1 AS INTESS_GROUP_ID_1",
        "CAST(BUSINESS_GROUP_ID_2 AS INT) as BUSINESS_GROUP_ID_2",
        "CAST(IS_OPERATIONAL AS TINYINT) as IS_OPERATIONAL",
        "CAST(IS_MAINTENANCE_FACILITY AS TINYINT) as IS_MAINTENANCE_FACILITY",
        "CAST(DWELL_TIME AS INT) as DWELL_TIME",
        "CAST(DRIVER_CHECK_IN_TIME AS INT) as DRIVER_CHECK_IN_TIME",
        "CAST(DISPATCH_DTTM AS TIMESTAMP) as DISPATCH_DTTM",
        "CAST(DSP_DR_CONFIGURATION_ID AS INT) as DSP_DR_CONFIGURATION_ID",
        "CAST(DROP_HOOK_TIME AS INT) as DROP_HOOK_TIME",
        "CAST(LOADING_END_TIME AS INT) as LOADING_END_TIME",
        "CAST(DRIVER_DEBRIEF_TIME AS INT) as DRIVER_DEBRIEF_TIME",
        "CAST(ACCOUNT_CODE_NUMBER AS STRING) as ACCOUNT_CODE_NUMBER",
        "CAST(LOAD_FACTOR_MOT_ID AS INT) as LOAD_FACTOR_MOT_ID",
        "CAST(LOAD_UNLOAD_MOT_ID AS INT) as LOAD_UNLOAD_MOT_ID",
        "CAST(MIN_TRAIL_FILL AS SMALLINT) as MIN_TRAIL_FILL",
        "CAST(TANDEM_DROP_HOOK_TIME AS INT) as TANDEM_DROP_HOOK_TIME",
        "CAST(STORE_TYPE AS TINYINT) as STORE_TYPE",
        "CAST(DRIVEIN_TIME AS INT) as DRIVEIN_TIME",
        "CAST(CHECKIN_TIME AS INT) as CHECKIN_TIME",
        "CAST(DRIVEOUT_TIME AS INT) as DRIVEOUT_TIME",
        "CAST(CHECKOUT_TIME AS INT) as CHECKOUT_TIME",
        "CAST(CUTOFF_DTTM AS TIMESTAMP) as CUTOFF_DTTM",
        "CAST(MAX_TRAILER_YARD_TIME AS INT) as MAX_TRAILER_YARD_TIME",
        "CAST(HAND_OVER_TIME AS INT) as HAND_OVER_TIME",
        "CAST(OVER_BOOK_PERCENTAGE AS SMALLINT) as OVER_BOOK_PERCENTAGE",
        "CAST(RECOMMENDATION_CRITERIA AS STRING) as RECOMMENDATION_CRITERIA",
        "CAST(NBR_OF_SLOTS_TO_SHOW AS SMALLINT) as NBR_OF_SLOTS_TO_SHOW",
        "CAST(RESTRICT_FLEET_ASMT_TIME AS SMALLINT) as RESTRICT_FLEET_ASMT_TIME",
        "CAST(GROUP_ID AS STRING) as GROUP_ID",
        "CAST(IS_VTBP AS INT) as IS_VTBP",
        "CAST(AUTO_CREATE_SHIPMENT AS INT) as AUTO_CREATE_SHIPMENT",
        "CAST(LOGO_IMAGE_PATH AS STRING) as LOGO_IMAGE_PATH",
        "CAST(GEN_LAST_SHIPMENT_LEG AS TINYINT) as GEN_LAST_SHIPMENT_LEG",
        "CAST(DEF_DRIVER_TYPE_ID AS INT) as DEF_DRIVER_TYPE_ID",
        "CAST(DEF_TRACTOR_ID AS INT) as DEF_TRACTOR_ID",
        "CAST(DEF_EQUIPMENT_ID AS INT) as DEF_EQUIPMENT_ID",
        "CAST(DRIVER_AVAIL_HRS AS DECIMAL(5,2)) as DRIVER_AVAIL_HRS",
        "CAST(WHSE AS STRING) as WHSE",
        "CAST(OPEN_DATE AS TIMESTAMP) as OPEN_DATE",
        "CAST(CLOSE_DATE AS TIMESTAMP) as CLOSE_DATE",
        "CAST(HOLD_DATE AS TIMESTAMP) as HOLD_DATE",
        "CAST(GRP AS STRING) as GRP",
        "CAST(CHAIN AS STRING) as CHAIN",
        "CAST(ZONE AS STRING) as ZONE",
        "CAST(TERRITORY AS STRING) as TERRITORY",
        "CAST(REGION AS STRING) as REGION",
        "CAST(DISTRICT AS STRING) as DISTRICT",
        "CAST(SHIP_MON AS STRING) as SHIP_MON",
        "CAST(SHIP_TUE AS STRING) as SHIP_TUE",
        "CAST(SHIP_WED AS STRING) as SHIP_WED",
        "CAST(SHIP_THU AS STRING) as SHIP_THU",
        "CAST(SHIP_FRI AS STRING) as SHIP_FRI",
        "CAST(SHIP_SAT AS STRING) as SHIP_SAT",
        "CAST(SHIP_SU AS STRING) as SHIP_SU",
        "CAST(ACCEPT_IRREG AS STRING) as ACCEPT_IRREG",
        "CAST(WAVE_LABEL_TYPE AS STRING) as WAVE_LABEL_TYPE",
        "CAST(PKG_SLIP_TYPE AS STRING) as PKG_SLIP_TYPE",
        "CAST(PRINT_CODE AS STRING) as PRINT_CODE",
        "CAST(CARTON_CNT_TYPE AS STRING) as CARTON_CNT_TYPE",
        "CAST(SHIP_VIA AS STRING) as SHIP_VIA",
        "CAST(RTE_NBR AS STRING) as RTE_NBR",
        "CAST(RTE_ATTR AS STRING) as RTE_ATTR",
        "CAST(RTE_TO AS STRING) as RTE_TO",
        "CAST(RTE_TYPE_1 AS STRING) as RTE_TYPE_1",
        "CAST(RTE_TYPE_2 AS STRING) as RTE_TYPE_2",
        "CAST(RTE_ZIP AS STRING) as RTE_ZIP",
        "CAST(SPL_INSTR_CODE_1 AS STRING) as SPL_INSTR_CODE_1",
        "CAST(SPL_INSTR_CODE_2 AS STRING) as SPL_INSTR_CODE_2",
        "CAST(SPL_INSTR_CODE_3 AS STRING) as SPL_INSTR_CODE_3",
        "CAST(SPL_INSTR_CODE_4 AS STRING) as SPL_INSTR_CODE_4",
        "CAST(SPL_INSTR_CODE_5 AS STRING) as SPL_INSTR_CODE_5",
        "CAST(SPL_INSTR_CODE_6 AS STRING) as SPL_INSTR_CODE_6",
        "CAST(SPL_INSTR_CODE_7 AS STRING) as SPL_INSTR_CODE_7",
        "CAST(SPL_INSTR_CODE_8 AS STRING) as SPL_INSTR_CODE_8",
        "CAST(SPL_INSTR_CODE_9 AS STRING) as SPL_INSTR_CODE_9",
        "CAST(SPL_INSTR_CODE_10 AS STRING) as SPL_INSTR_CODE_10",
        "CAST(ASSIGN_MERCH_TYPE AS STRING) as ASSIGN_MERCH_TYPE",
        "CAST(ASSIGN_MERCH_GROUP AS STRING) as ASSIGN_MERCH_GROUP",
        "CAST(ASSIGN_STORE_DEPT AS STRING) as ASSIGN_STORE_DEPT",
        "CAST(CARTON_LABEL_TYPE AS STRING) as CARTON_LABEL_TYPE",
        "CAST(CARTON_CUBNG_INDIC AS TINYINT) as CARTON_CUBNG_INDIC",
        "CAST(MAX_CTN AS INT) as MAX_CTN",
        "CAST(MAX_PLT AS INT) as MAX_PLT",
        "CAST(BUSN_UNIT_CODE AS STRING) as BUSN_UNIT_CODE",
        "CAST(USE_INBD_LPN_AS_OUTBD_LPN AS STRING) as USE_INBD_LPN_AS_OUTBD_LPN",
        "CAST(PRINT_COO AS STRING) as PRINT_COO",
        "CAST(PRINT_INV AS STRING) as PRINT_INV",
        "CAST(PRINT_SED AS STRING) as PRINT_SED",
        "CAST(PRINT_CANADIAN_CUST_INVC_FLAG AS STRING) as PRINT_CANADIAN_CUST_INVC_FLAG",
        "CAST(PRINT_DOCK_RCPT_FLAG AS STRING) as PRINT_DOCK_RCPT_FLAG",
        "CAST(PRINT_NAFTA_COO_FLAG AS STRING) as PRINT_NAFTA_COO_FLAG",
        "CAST(PRINT_OCEAN_BOL_FLAG AS STRING) as PRINT_OCEAN_BOL_FLAG",
        "CAST(PRINT_PKG_LIST_FLAG AS STRING) as PRINT_PKG_LIST_FLAG",
        "CAST(PRINT_SHPR_LTR_OF_INSTR_FLAG AS STRING) as PRINT_SHPR_LTR_OF_INSTR_FLAG",
        "CAST(AUDIT_TRANSACTION AS STRING) as AUDIT_TRANSACTION",
        "CAST(AUDIT_PARTY_ID AS INT) as AUDIT_PARTY_ID",
        "CAST(CAPTURE_OTHER_MA AS SMALLINT) as CAPTURE_OTHER_MA",
        "CAST(HIBERNATE_VERSION AS INT) as HIBERNATE_VERSION",
        "CAST(STORE_TYPE_GROUPING AS STRING) as STORE_TYPE_GROUPING",
        "CAST(LOAD_RATE AS DECIMAL(16,4)) as LOAD_RATE",
        "CAST(UNLOAD_RATE AS DECIMAL(16,4)) as UNLOAD_RATE",
        "CAST(HANDLING_RATE AS DECIMAL(16,4)) as HANDLING_RATE",
        "CAST(LOAD_UNLOAD_SIZE_UOM_ID AS INT) as LOAD_UNLOAD_SIZE_UOM_ID",
        "CAST(LOAD_FACTOR_SIZE_UOM_ID AS INT) as LOAD_FACTOR_SIZE_UOM_ID",
        "CAST(PARCEL_LENGTH_RATIO AS DECIMAL(16,4)) as PARCEL_LENGTH_RATIO",
        "CAST(PARCEL_WIDTH_RATIO AS DECIMAL(16,4)) as PARCEL_WIDTH_RATIO",
        "CAST(PARCEL_HEIGHT_RATIO AS DECIMAL(16,4)) as PARCEL_HEIGHT_RATIO",
        "CAST(METER_NUMBER AS BIGINT) as METER_NUMBER",
        "CAST(DIRECT_DELIVERY_ALLOWED AS SMALLINT) as DIRECT_DELIVERY_ALLOWED",
        "CAST(TRACK_EQUIP_ID_FLAG AS TINYINT) as TRACK_EQUIP_ID_FLAG",
        "CAST(STAT_CODE AS TINYINT) as STAT_CODE",
        "CAST(HANDLES_NON_MACHINEABLE AS TINYINT) as HANDLES_NON_MACHINEABLE",
        "CAST(MAINTAINS_PERPETUAL_INVTY AS TINYINT) as MAINTAINS_PERPETUAL_INVTY",
        "CAST(IS_CUST_OWNED_FACILITY AS TINYINT) as IS_CUST_OWNED_FACILITY",
        "CAST(FLOWTHRU_ALLOC_SORT_PRTY AS STRING) as FLOWTHRU_ALLOC_SORT_PRTY",
        "CAST(RLS_HOLD_DATE AS TIMESTAMP) as RLS_HOLD_DATE",
        "CAST(RE_COMPUTE_FEASIBLE_EQUIPMENT AS SMALLINT) as RE_COMPUTE_FEASIBLE_EQUIPMENT",
        "CAST(SMARTPOST_DC_NUMBER AS STRING) as SMARTPOST_DC_NUMBER",
        "CAST(ADDRESS_TYPE AS STRING) as ADDRESS_TYPE",
        "CAST(SPLC_CODE AS STRING) as SPLC_CODE",
        "CAST(ERPC_CODE AS STRING) as ERPC_CODE",
        "CAST(R260_CODE AS STRING) as R260_CODE",
        "CAST(MAX_WAIT_TIME AS INT) as MAX_WAIT_TIME",
        "CAST(FREE_WAIT_TIME AS INT) as FREE_WAIT_TIME",
        "CAST(IATA_SCR_NBR AS STRING) as IATA_SCR_NBR",
        "CAST(PICKUP_AT_STORE AS TINYINT) as PICKUP_AT_STORE",
        "CAST(SHIP_TO_STORE AS TINYINT) as SHIP_TO_STORE",
        "CAST(SHIP_FROM_FACILITY AS TINYINT) as SHIP_FROM_FACILITY",
        "CAST(TRANS_PLAN_FLOW AS SMALLINT) as TRANS_PLAN_FLOW",
        "CAST(AVG_HNDLG_COST_PER_LN AS DECIMAL(16,4)) as AVG_HNDLG_COST_PER_LN",
        "CAST(AVG_HNDLG_COST_PER_LN_CURCODE AS STRING) as AVG_HNDLG_COST_PER_LN_CURCODE",
        "CAST(PENALTY_COST AS DECIMAL(13,4)) as PENALTY_COST",
        "CAST(PENALTY_COST_CURRENCY_CODE AS STRING) as PENALTY_COST_CURRENCY_CODE",
        "CAST(MAINTAIN_DISPOSITION AS SMALLINT) as MAINTAIN_DISPOSITION",
        "CAST(MAINTAIN_SUBLOCATION AS SMALLINT) as MAINTAIN_SUBLOCATION",
        "CAST(MAINTAIN_SEGMENT AS SMALLINT) as MAINTAIN_SEGMENT",
        "CAST(MAINTAIN_CNTRY_OF_ORGN AS SMALLINT) as MAINTAIN_CNTRY_OF_ORGN",
        "CAST(MAINTAIN_BATCH_NBR AS SMALLINT) as MAINTAIN_BATCH_NBR",
        "CAST(MAINTAIN_PROD_STAT AS SMALLINT) as MAINTAIN_PROD_STAT",
        "CAST(MAINTAIN_INV_TYPE AS SMALLINT) as MAINTAIN_INV_TYPE",
        "CAST(MAINTAIN_ITEM_ATTR_1 AS SMALLINT) as MAINTAIN_ITEM_ATTR_1",
        "CAST(MAINTAIN_ITEM_ATTR_2 AS SMALLINT) as MAINTAIN_ITEM_ATTR_2",
        "CAST(MAINTAIN_ITEM_ATTR_3 AS SMALLINT) as MAINTAIN_ITEM_ATTR_3",
        "CAST(MAINTAIN_ITEM_ATTR_4 AS SMALLINT) as MAINTAIN_ITEM_ATTR_4",
        "CAST(MAINTAIN_ITEM_ATTR_5 AS SMALLINT) as MAINTAIN_ITEM_ATTR_5",
        "CAST(GENERATE_PERPETUAL_EVENT AS SMALLINT) as GENERATE_PERPETUAL_EVENT",
        "CAST(GENERATE_SEGMENT_EVENT AS SMALLINT) as GENERATE_SEGMENT_EVENT",
        "CAST(MAINTAIN_ON_HAND AS SMALLINT) as MAINTAIN_ON_HAND",
        "CAST(MAINTAIN_IN_TRANSIT AS SMALLINT) as MAINTAIN_IN_TRANSIT",
        "CAST(MAINTAIN_ON_ORDER AS SMALLINT) as MAINTAIN_ON_ORDER",
        "CAST(FULFILLMENT_GROUP AS STRING) as FULFILLMENT_GROUP",
        "CAST(REF_FIELD_6 AS STRING) as REF_FIELD_6",
        "CAST(REF_FIELD_7 AS STRING) as REF_FIELD_7",
        "CAST(REF_FIELD_8 AS STRING) as REF_FIELD_8",
        "CAST(REF_FIELD_9 AS STRING) as REF_FIELD_9",
        "CAST(REF_FIELD_10 AS STRING) as REF_FIELD_10",
        "CAST(REF_NUM1 AS DECIMAL(13,5)) as REF_NUM1",
        "CAST(REF_NUM2 AS DECIMAL(13,5)) as REF_NUM2",
        "CAST(REF_NUM3 AS DECIMAL(13,5)) as REF_NUM3",
        "CAST(REF_NUM4 AS DECIMAL(13,5)) as REF_NUM4",
        "CAST(REF_NUM5 AS DECIMAL(13,5)) as REF_NUM5",
        "CAST(REF_FIELD_1 AS STRING) as REF_FIELD_1",
        "CAST(REF_FIELD_2 AS STRING) as REF_FIELD_2",
        "CAST(REF_FIELD_3 AS STRING) as REF_FIELD_3",
        "CAST(REF_FIELD_4 AS STRING) as REF_FIELD_4",
        "CAST(REF_FIELD_5 AS STRING) as REF_FIELD_5",
        "CAST(WHSE_REGION AS INT) as WHSE_REGION",
        "CAST(GEOFENCE_RADIUS AS DECIMAL(13,5)) as GEOFENCE_RADIUS",
        "CAST(LOAD_TSTMP_EXP AS TIMESTAMP) as LOAD_TSTMP"
    )

    overwriteDeltaPartition(Shortcut_to_WM_FACILITY_PRE,"DC_NBR",dcnbr,target_table_name)
    logger.info(
        "Shortcut_to_WM_FACILITY_PRE is written to the target table - "
        + target_table_name
    )    