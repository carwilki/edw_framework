#Code converted on 2023-05-16 15:07:11
import os
from pyspark.sql import *
from pyspark.sql.functions import *
from pyspark.sql.window import Window
from pyspark.sql.types import *
from datetime import datetime
from dbruntime import dbutils

# COMMAND ----------

# Set global variables
starttime = datetime.now() #start timestamp of the script

# Read in job variables
# read_infa_paramfile('', 'm_WM_E_Consol_Perf_Smry') ProcessingUtils

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE, type SOURCE 
# COLUMN COUNT: 86

SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE = spark.read.jdbc(os.environ.get('NZ_SCDS_CONNECT_STRING'), f"""SELECT
WM_E_CONSOL_PERF_SMRY_PRE.DC_NBR,
WM_E_CONSOL_PERF_SMRY_PRE.PERF_SMRY_TRAN_ID,
WM_E_CONSOL_PERF_SMRY_PRE.WHSE,
WM_E_CONSOL_PERF_SMRY_PRE.LOGIN_USER_ID,
WM_E_CONSOL_PERF_SMRY_PRE.JOB_FUNCTION_NAME,
WM_E_CONSOL_PERF_SMRY_PRE.SPVSR_LOGIN_USER_ID,
WM_E_CONSOL_PERF_SMRY_PRE.DEPT_CODE,
WM_E_CONSOL_PERF_SMRY_PRE.CLOCK_IN_DATE,
WM_E_CONSOL_PERF_SMRY_PRE.CLOCK_IN_STATUS,
WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_SAM,
WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_PAM,
WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_TIME,
WM_E_CONSOL_PERF_SMRY_PRE.OSDL,
WM_E_CONSOL_PERF_SMRY_PRE.OSIL,
WM_E_CONSOL_PERF_SMRY_PRE.NSDL,
WM_E_CONSOL_PERF_SMRY_PRE.SIL,
WM_E_CONSOL_PERF_SMRY_PRE.UDIL,
WM_E_CONSOL_PERF_SMRY_PRE.UIL,
WM_E_CONSOL_PERF_SMRY_PRE.ADJ_OSDL,
WM_E_CONSOL_PERF_SMRY_PRE.ADJ_OSIL,
WM_E_CONSOL_PERF_SMRY_PRE.ADJ_UDIL,
WM_E_CONSOL_PERF_SMRY_PRE.ADJ_NSDL,
WM_E_CONSOL_PERF_SMRY_PRE.PAID_BRK,
WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_BRK,
WM_E_CONSOL_PERF_SMRY_PRE.REF_OSDL,
WM_E_CONSOL_PERF_SMRY_PRE.REF_OSIL,
WM_E_CONSOL_PERF_SMRY_PRE.REF_UDIL,
WM_E_CONSOL_PERF_SMRY_PRE.REF_NSDL,
WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_OSDL,
WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_OSIL,
WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_UDIL,
WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_NSDL,
WM_E_CONSOL_PERF_SMRY_PRE.MISC_NUMBER_1,
WM_E_CONSOL_PERF_SMRY_PRE.CREATE_DATE_TIME,
WM_E_CONSOL_PERF_SMRY_PRE.MOD_DATE_TIME,
WM_E_CONSOL_PERF_SMRY_PRE.USER_ID,
WM_E_CONSOL_PERF_SMRY_PRE.MISC_1,
WM_E_CONSOL_PERF_SMRY_PRE.MISC_2,
WM_E_CONSOL_PERF_SMRY_PRE.CLOCK_OUT_DATE,
WM_E_CONSOL_PERF_SMRY_PRE.SHIFT_CODE,
WM_E_CONSOL_PERF_SMRY_PRE.EVENT_COUNT,
WM_E_CONSOL_PERF_SMRY_PRE.START_DATE_TIME,
WM_E_CONSOL_PERF_SMRY_PRE.END_DATE_TIME,
WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_1,
WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_2,
WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_3,
WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_4,
WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_5,
WM_E_CONSOL_PERF_SMRY_PRE.WHSE_DATE,
WM_E_CONSOL_PERF_SMRY_PRE.OPS_CODE,
WM_E_CONSOL_PERF_SMRY_PRE.REF_SAM,
WM_E_CONSOL_PERF_SMRY_PRE.REF_PAM,
WM_E_CONSOL_PERF_SMRY_PRE.REPORT_SHIFT,
WM_E_CONSOL_PERF_SMRY_PRE.MISC_TXT_1,
WM_E_CONSOL_PERF_SMRY_PRE.MISC_TXT_2,
WM_E_CONSOL_PERF_SMRY_PRE.MISC_NUM_1,
WM_E_CONSOL_PERF_SMRY_PRE.MISC_NUM_2,
WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_1,
WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_2,
WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_3,
WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_4,
WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_5,
WM_E_CONSOL_PERF_SMRY_PRE.LABOR_COST_RATE,
WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_OSDL,
WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_OSDL,
WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_NSDL,
WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_NSDL,
WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_OSIL,
WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_OSIL,
WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_UDIL,
WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_UDIL,
WM_E_CONSOL_PERF_SMRY_PRE.VERSION_ID,
WM_E_CONSOL_PERF_SMRY_PRE.TEAM_CODE,
WM_E_CONSOL_PERF_SMRY_PRE.DEFAULT_JF_FLAG,
WM_E_CONSOL_PERF_SMRY_PRE.EMP_PERF_SMRY_ID,
WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_QTY,
WM_E_CONSOL_PERF_SMRY_PRE.REF_NBR,
WM_E_CONSOL_PERF_SMRY_PRE.TEAM_BEGIN_TIME,
WM_E_CONSOL_PERF_SMRY_PRE.THRUPUT_MIN,
WM_E_CONSOL_PERF_SMRY_PRE.DISPLAY_UOM_QTY,
WM_E_CONSOL_PERF_SMRY_PRE.DISPLAY_UOM,
WM_E_CONSOL_PERF_SMRY_PRE.LOCN_GRP_ATTR,
WM_E_CONSOL_PERF_SMRY_PRE.RESOURCE_GROUP_ID,
WM_E_CONSOL_PERF_SMRY_PRE.COMP_ASSIGNMENT_ID,
WM_E_CONSOL_PERF_SMRY_PRE.REFLECTIVE_CODE,
WM_E_CONSOL_PERF_SMRY_PRE.LOAD_TSTMP
FROM WM_E_CONSOL_PERF_SMRY_PRE""", 
properties={
'user': os.environ.get('NZ_SCDS_LOGIN'),
'password': os.environ.get('NZ_SCDS_PASSWORD'),
'driver': os.environ.get('_DRIVER')}).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY, type SOURCE 
# COLUMN COUNT: 5

SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY = spark.read.jdbc(os.environ.get('NZ_SCDS_CONNECT_STRING'), f"""SELECT
WM_E_CONSOL_PERF_SMRY.LOCATION_ID,
WM_E_CONSOL_PERF_SMRY.WM_PERF_SMRY_TRAN_ID,
WM_E_CONSOL_PERF_SMRY.WM_CREATE_TSTMP,
WM_E_CONSOL_PERF_SMRY.WM_MOD_TSTMP,
WM_E_CONSOL_PERF_SMRY.LOAD_TSTMP
FROM WM_E_CONSOL_PERF_SMRY
WHERE WM_PERF_SMRY_TRAN_ID IN (SELECT PERF_SMRY_TRAN_ID FROM WM_E_CONSOL_PERF_SMRY_PRE)""", 
properties={
'user': os.environ.get('NZ_SCDS_LOGIN'),
'password': os.environ.get('NZ_SCDS_PASSWORD'),
'driver': os.environ.get('_DRIVER')}).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_INT_CONV, type EXPRESSION . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 86

EXP_INT_CONV = SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.selectExpr(
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.DC_NBR as in_DC_NBR",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.PERF_SMRY_TRAN_ID as PERF_SMRY_TRAN_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.WHSE as WHSE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LOGIN_USER_ID as LOGIN_USER_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.JOB_FUNCTION_NAME as JOB_FUNCTION_NAME",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.SPVSR_LOGIN_USER_ID as SPVSR_LOGIN_USER_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.DEPT_CODE as DEPT_CODE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.CLOCK_IN_DATE as CLOCK_IN_DATE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.CLOCK_IN_STATUS as CLOCK_IN_STATUS",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_SAM as TOTAL_SAM",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_PAM as TOTAL_PAM",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_TIME as TOTAL_TIME",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.OSDL as OSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.OSIL as OSIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.NSDL as NSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.SIL as SIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.UDIL as UDIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.UIL as UIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.ADJ_OSDL as ADJ_OSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.ADJ_OSIL as ADJ_OSIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.ADJ_UDIL as ADJ_UDIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.ADJ_NSDL as ADJ_NSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.PAID_BRK as PAID_BRK",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_BRK as UNPAID_BRK",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_OSDL as REF_OSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_OSIL as REF_OSIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_UDIL as REF_UDIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_NSDL as REF_NSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_OSDL as REF_ADJ_OSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_OSIL as REF_ADJ_OSIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_UDIL as REF_ADJ_UDIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_ADJ_NSDL as REF_ADJ_NSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MISC_NUMBER_1 as MISC_NUMBER_1",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.CREATE_DATE_TIME as CREATE_DATE_TIME",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MOD_DATE_TIME as MOD_DATE_TIME",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.USER_ID as USER_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MISC_1 as MISC_1",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MISC_2 as MISC_2",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.CLOCK_OUT_DATE as CLOCK_OUT_DATE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.SHIFT_CODE as SHIFT_CODE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.EVENT_COUNT as EVENT_COUNT",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.START_DATE_TIME as START_DATE_TIME",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.END_DATE_TIME as END_DATE_TIME",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_1 as LEVEL_1",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_2 as LEVEL_2",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_3 as LEVEL_3",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_4 as LEVEL_4",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LEVEL_5 as LEVEL_5",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.WHSE_DATE as WHSE_DATE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.OPS_CODE as OPS_CODE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_SAM as REF_SAM",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_PAM as REF_PAM",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REPORT_SHIFT as REPORT_SHIFT",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MISC_TXT_1 as MISC_TXT_1",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MISC_TXT_2 as MISC_TXT_2",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MISC_NUM_1 as MISC_NUM_1",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.MISC_NUM_2 as MISC_NUM_2",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_1 as EVNT_CTGRY_1",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_2 as EVNT_CTGRY_2",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_3 as EVNT_CTGRY_3",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_4 as EVNT_CTGRY_4",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.EVNT_CTGRY_5 as EVNT_CTGRY_5",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LABOR_COST_RATE as LABOR_COST_RATE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_OSDL as PAID_OVERLAP_OSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_OSDL as UNPAID_OVERLAP_OSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_NSDL as PAID_OVERLAP_NSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_NSDL as UNPAID_OVERLAP_NSDL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_OSIL as PAID_OVERLAP_OSIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_OSIL as UNPAID_OVERLAP_OSIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.PAID_OVERLAP_UDIL as PAID_OVERLAP_UDIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.UNPAID_OVERLAP_UDIL as UNPAID_OVERLAP_UDIL",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.VERSION_ID as VERSION_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.TEAM_CODE as TEAM_CODE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.DEFAULT_JF_FLAG as DEFAULT_JF_FLAG",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.EMP_PERF_SMRY_ID as EMP_PERF_SMRY_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.TOTAL_QTY as TOTAL_QTY",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REF_NBR as REF_NBR",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.TEAM_BEGIN_TIME as TEAM_BEGIN_TIME",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.THRUPUT_MIN as THRUPUT_MIN",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.DISPLAY_UOM_QTY as DISPLAY_UOM_QTY",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.DISPLAY_UOM as DISPLAY_UOM",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LOCN_GRP_ATTR as LOCN_GRP_ATTR",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.RESOURCE_GROUP_ID as RESOURCE_GROUP_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.COMP_ASSIGNMENT_ID as COMP_ASSIGNMENT_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.REFLECTIVE_CODE as REFLECTIVE_CODE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY_PRE.LOAD_TSTMP as LOAD_TSTMP").selectExpr(
	"sys_row_id as sys_row_id",
	"in_DC_NBR.cast(IntegerType()) as DC_NBR",
	"PERF_SMRY_TRAN_ID as PERF_SMRY_TRAN_ID",
	"WHSE as WHSE",
	"LOGIN_USER_ID as LOGIN_USER_ID",
	"JOB_FUNCTION_NAME as JOB_FUNCTION_NAME",
	"SPVSR_LOGIN_USER_ID as SPVSR_LOGIN_USER_ID",
	"DEPT_CODE as DEPT_CODE",
	"CLOCK_IN_DATE as CLOCK_IN_DATE",
	"CLOCK_IN_STATUS as CLOCK_IN_STATUS",
	"TOTAL_SAM as TOTAL_SAM",
	"TOTAL_PAM as TOTAL_PAM",
	"TOTAL_TIME as TOTAL_TIME",
	"OSDL as OSDL",
	"OSIL as OSIL",
	"NSDL as NSDL",
	"SIL as SIL",
	"UDIL as UDIL",
	"UIL as UIL",
	"ADJ_OSDL as ADJ_OSDL",
	"ADJ_OSIL as ADJ_OSIL",
	"ADJ_UDIL as ADJ_UDIL",
	"ADJ_NSDL as ADJ_NSDL",
	"PAID_BRK as PAID_BRK",
	"UNPAID_BRK as UNPAID_BRK",
	"REF_OSDL as REF_OSDL",
	"REF_OSIL as REF_OSIL",
	"REF_UDIL as REF_UDIL",
	"REF_NSDL as REF_NSDL",
	"REF_ADJ_OSDL as REF_ADJ_OSDL",
	"REF_ADJ_OSIL as REF_ADJ_OSIL",
	"REF_ADJ_UDIL as REF_ADJ_UDIL",
	"REF_ADJ_NSDL as REF_ADJ_NSDL",
	"MISC_NUMBER_1 as MISC_NUMBER_1",
	"CREATE_DATE_TIME as CREATE_DATE_TIME",
	"MOD_DATE_TIME as MOD_DATE_TIME",
	"USER_ID as USER_ID",
	"MISC_1 as MISC_1",
	"MISC_2 as MISC_2",
	"CLOCK_OUT_DATE as CLOCK_OUT_DATE",
	"SHIFT_CODE as SHIFT_CODE",
	"EVENT_COUNT as EVENT_COUNT",
	"START_DATE_TIME as START_DATE_TIME",
	"END_DATE_TIME as END_DATE_TIME",
	"LEVEL_1 as LEVEL_1",
	"LEVEL_2 as LEVEL_2",
	"LEVEL_3 as LEVEL_3",
	"LEVEL_4 as LEVEL_4",
	"LEVEL_5 as LEVEL_5",
	"WHSE_DATE as WHSE_DATE",
	"OPS_CODE as OPS_CODE",
	"REF_SAM as REF_SAM",
	"REF_PAM as REF_PAM",
	"REPORT_SHIFT as REPORT_SHIFT",
	"MISC_TXT_1 as MISC_TXT_1",
	"MISC_TXT_2 as MISC_TXT_2",
	"MISC_NUM_1 as MISC_NUM_1",
	"MISC_NUM_2 as MISC_NUM_2",
	"EVNT_CTGRY_1 as EVNT_CTGRY_1",
	"EVNT_CTGRY_2 as EVNT_CTGRY_2",
	"EVNT_CTGRY_3 as EVNT_CTGRY_3",
	"EVNT_CTGRY_4 as EVNT_CTGRY_4",
	"EVNT_CTGRY_5 as EVNT_CTGRY_5",
	"LABOR_COST_RATE as LABOR_COST_RATE",
	"PAID_OVERLAP_OSDL as PAID_OVERLAP_OSDL",
	"UNPAID_OVERLAP_OSDL as UNPAID_OVERLAP_OSDL",
	"PAID_OVERLAP_NSDL as PAID_OVERLAP_NSDL",
	"UNPAID_OVERLAP_NSDL as UNPAID_OVERLAP_NSDL",
	"PAID_OVERLAP_OSIL as PAID_OVERLAP_OSIL",
	"UNPAID_OVERLAP_OSIL as UNPAID_OVERLAP_OSIL",
	"PAID_OVERLAP_UDIL as PAID_OVERLAP_UDIL",
	"UNPAID_OVERLAP_UDIL as UNPAID_OVERLAP_UDIL",
	"VERSION_ID as VERSION_ID",
	"TEAM_CODE as TEAM_CODE",
	"DEFAULT_JF_FLAG as DEFAULT_JF_FLAG",
	"EMP_PERF_SMRY_ID as EMP_PERF_SMRY_ID",
	"TOTAL_QTY as TOTAL_QTY",
	"REF_NBR as REF_NBR",
	"TEAM_BEGIN_TIME as TEAM_BEGIN_TIME",
	"THRUPUT_MIN as THRUPUT_MIN",
	"DISPLAY_UOM_QTY as DISPLAY_UOM_QTY",
	"DISPLAY_UOM as DISPLAY_UOM",
	"LOCN_GRP_ATTR as LOCN_GRP_ATTR",
	"RESOURCE_GROUP_ID as RESOURCE_GROUP_ID",
	"COMP_ASSIGNMENT_ID as COMP_ASSIGNMENT_ID",
	"REFLECTIVE_CODE as REFLECTIVE_CODE",
	"LOAD_TSTMP as LOAD_TSTMP"
)

# COMMAND ----------
# Processing node SQ_Shortcut_to_SITE_PROFILE, type SOURCE 
# COLUMN COUNT: 2

SQ_Shortcut_to_SITE_PROFILE = spark.read.jdbc(os.environ.get('NZ_SCDS_CONNECT_STRING'), f"""SELECT
SITE_PROFILE.LOCATION_ID,
SITE_PROFILE.STORE_NBR
FROM SITE_PROFILE""", 
properties={
'user': os.environ.get('NZ_SCDS_LOGIN'),
'password': os.environ.get('NZ_SCDS_PASSWORD'),
'driver': os.environ.get('_DRIVER')}).withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node JNR_SITE_PROFILE, type JOINER 
# COLUMN COUNT: 88

JNR_SITE_PROFILE = SQ_Shortcut_to_SITE_PROFILE.join(EXP_INT_CONV,[SQ_Shortcut_to_SITE_PROFILE.STORE_NBR == EXP_INT_CONV.DC_NBR],'inner')

# COMMAND ----------
# Processing node JNR_WM_E_CON_PERF_SMRY, type JOINER . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 90

JNR_WM_E_CON_PERF_SMRY = SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.join(JNR_SITE_PROFILE,[SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.LOCATION_ID == JNR_SITE_PROFILE.LOCATION_ID, SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.WM_PERF_SMRY_TRAN_ID == JNR_SITE_PROFILE.PERF_SMRY_TRAN_ID],'right_outer').selectExpr(
	"JNR_SITE_PROFILE.LOCATION_ID as LOCATION_ID",
	"JNR_SITE_PROFILE.PERF_SMRY_TRAN_ID as PERF_SMRY_TRAN_ID",
	"JNR_SITE_PROFILE.WHSE as WHSE",
	"JNR_SITE_PROFILE.LOGIN_USER_ID as LOGIN_USER_ID",
	"JNR_SITE_PROFILE.JOB_FUNCTION_NAME as JOB_FUNCTION_NAME",
	"JNR_SITE_PROFILE.SPVSR_LOGIN_USER_ID as SPVSR_LOGIN_USER_ID",
	"JNR_SITE_PROFILE.DEPT_CODE as DEPT_CODE",
	"JNR_SITE_PROFILE.CLOCK_IN_DATE as CLOCK_IN_DATE",
	"JNR_SITE_PROFILE.CLOCK_IN_STATUS as CLOCK_IN_STATUS",
	"JNR_SITE_PROFILE.TOTAL_SAM as TOTAL_SAM",
	"JNR_SITE_PROFILE.TOTAL_PAM as TOTAL_PAM",
	"JNR_SITE_PROFILE.TOTAL_TIME as TOTAL_TIME",
	"JNR_SITE_PROFILE.OSDL as OSDL",
	"JNR_SITE_PROFILE.OSIL as OSIL",
	"JNR_SITE_PROFILE.NSDL as NSDL",
	"JNR_SITE_PROFILE.SIL as SIL",
	"JNR_SITE_PROFILE.UDIL as UDIL",
	"JNR_SITE_PROFILE.UIL as UIL",
	"JNR_SITE_PROFILE.ADJ_OSDL as ADJ_OSDL",
	"JNR_SITE_PROFILE.ADJ_OSIL as ADJ_OSIL",
	"JNR_SITE_PROFILE.ADJ_UDIL as ADJ_UDIL",
	"JNR_SITE_PROFILE.ADJ_NSDL as ADJ_NSDL",
	"JNR_SITE_PROFILE.PAID_BRK as PAID_BRK",
	"JNR_SITE_PROFILE.UNPAID_BRK as UNPAID_BRK",
	"JNR_SITE_PROFILE.REF_OSDL as REF_OSDL",
	"JNR_SITE_PROFILE.REF_OSIL as REF_OSIL",
	"JNR_SITE_PROFILE.REF_UDIL as REF_UDIL",
	"JNR_SITE_PROFILE.REF_NSDL as REF_NSDL",
	"JNR_SITE_PROFILE.REF_ADJ_OSDL as REF_ADJ_OSDL",
	"JNR_SITE_PROFILE.REF_ADJ_OSIL as REF_ADJ_OSIL",
	"JNR_SITE_PROFILE.REF_ADJ_UDIL as REF_ADJ_UDIL",
	"JNR_SITE_PROFILE.REF_ADJ_NSDL as REF_ADJ_NSDL",
	"JNR_SITE_PROFILE.MISC_NUMBER_1 as MISC_NUMBER_1",
	"JNR_SITE_PROFILE.CREATE_DATE_TIME as CREATE_DATE_TIME",
	"JNR_SITE_PROFILE.MOD_DATE_TIME as MOD_DATE_TIME",
	"JNR_SITE_PROFILE.USER_ID as USER_ID",
	"JNR_SITE_PROFILE.MISC_1 as MISC_1",
	"JNR_SITE_PROFILE.MISC_2 as MISC_2",
	"JNR_SITE_PROFILE.CLOCK_OUT_DATE as CLOCK_OUT_DATE",
	"JNR_SITE_PROFILE.SHIFT_CODE as SHIFT_CODE",
	"JNR_SITE_PROFILE.EVENT_COUNT as EVENT_COUNT",
	"JNR_SITE_PROFILE.START_DATE_TIME as START_DATE_TIME",
	"JNR_SITE_PROFILE.END_DATE_TIME as END_DATE_TIME",
	"JNR_SITE_PROFILE.LEVEL_1 as LEVEL_1",
	"JNR_SITE_PROFILE.LEVEL_2 as LEVEL_2",
	"JNR_SITE_PROFILE.LEVEL_3 as LEVEL_3",
	"JNR_SITE_PROFILE.LEVEL_4 as LEVEL_4",
	"JNR_SITE_PROFILE.LEVEL_5 as LEVEL_5",
	"JNR_SITE_PROFILE.WHSE_DATE as WHSE_DATE",
	"JNR_SITE_PROFILE.OPS_CODE as OPS_CODE",
	"JNR_SITE_PROFILE.REF_SAM as REF_SAM",
	"JNR_SITE_PROFILE.REF_PAM as REF_PAM",
	"JNR_SITE_PROFILE.REPORT_SHIFT as REPORT_SHIFT",
	"JNR_SITE_PROFILE.MISC_TXT_1 as MISC_TXT_1",
	"JNR_SITE_PROFILE.MISC_TXT_2 as MISC_TXT_2",
	"JNR_SITE_PROFILE.MISC_NUM_1 as MISC_NUM_1",
	"JNR_SITE_PROFILE.MISC_NUM_2 as MISC_NUM_2",
	"JNR_SITE_PROFILE.EVNT_CTGRY_1 as EVNT_CTGRY_1",
	"JNR_SITE_PROFILE.EVNT_CTGRY_2 as EVNT_CTGRY_2",
	"JNR_SITE_PROFILE.EVNT_CTGRY_3 as EVNT_CTGRY_3",
	"JNR_SITE_PROFILE.EVNT_CTGRY_4 as EVNT_CTGRY_4",
	"JNR_SITE_PROFILE.EVNT_CTGRY_5 as EVNT_CTGRY_5",
	"JNR_SITE_PROFILE.LABOR_COST_RATE as LABOR_COST_RATE",
	"JNR_SITE_PROFILE.PAID_OVERLAP_OSDL as PAID_OVERLAP_OSDL",
	"JNR_SITE_PROFILE.UNPAID_OVERLAP_OSDL as UNPAID_OVERLAP_OSDL",
	"JNR_SITE_PROFILE.PAID_OVERLAP_NSDL as PAID_OVERLAP_NSDL",
	"JNR_SITE_PROFILE.UNPAID_OVERLAP_NSDL as UNPAID_OVERLAP_NSDL",
	"JNR_SITE_PROFILE.PAID_OVERLAP_OSIL as PAID_OVERLAP_OSIL",
	"JNR_SITE_PROFILE.UNPAID_OVERLAP_OSIL as UNPAID_OVERLAP_OSIL",
	"JNR_SITE_PROFILE.PAID_OVERLAP_UDIL as PAID_OVERLAP_UDIL",
	"JNR_SITE_PROFILE.UNPAID_OVERLAP_UDIL as UNPAID_OVERLAP_UDIL",
	"JNR_SITE_PROFILE.VERSION_ID as VERSION_ID",
	"JNR_SITE_PROFILE.TEAM_CODE as TEAM_CODE",
	"JNR_SITE_PROFILE.DEFAULT_JF_FLAG as DEFAULT_JF_FLAG",
	"JNR_SITE_PROFILE.EMP_PERF_SMRY_ID as EMP_PERF_SMRY_ID",
	"JNR_SITE_PROFILE.TOTAL_QTY as TOTAL_QTY",
	"JNR_SITE_PROFILE.REF_NBR as REF_NBR",
	"JNR_SITE_PROFILE.TEAM_BEGIN_TIME as TEAM_BEGIN_TIME",
	"JNR_SITE_PROFILE.THRUPUT_MIN as THRUPUT_MIN",
	"JNR_SITE_PROFILE.DISPLAY_UOM_QTY as DISPLAY_UOM_QTY",
	"JNR_SITE_PROFILE.DISPLAY_UOM as DISPLAY_UOM",
	"JNR_SITE_PROFILE.LOCN_GRP_ATTR as LOCN_GRP_ATTR",
	"JNR_SITE_PROFILE.RESOURCE_GROUP_ID as RESOURCE_GROUP_ID",
	"JNR_SITE_PROFILE.COMP_ASSIGNMENT_ID as COMP_ASSIGNMENT_ID",
	"JNR_SITE_PROFILE.REFLECTIVE_CODE as REFLECTIVE_CODE",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.LOCATION_ID as in_LOCATION_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.WM_PERF_SMRY_TRAN_ID as in_WM_PERF_SMRY_TRAN_ID",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.LOAD_TSTMP as in_LOAD_TSTMP",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.WM_CREATE_TSTMP as in_WM_CREATE_TSTMP",
	"SQ_Shortcut_to_WM_E_CONSOL_PERF_SMRY.WM_MOD_TSTMP as in_WM_MOD_TSTMP")

# COMMAND ----------
# Processing node FIL_NO_CHANGE_REC, type FILTER 
# COLUMN COUNT: 90

FIL_NO_CHANGE_REC = JNR_WM_E_CON_PERF_SMRY.select(
	"JNR_WM_E_CON_PERF_SMRY.LOCATION_ID as LOCATION_ID",
	"JNR_WM_E_CON_PERF_SMRY.PERF_SMRY_TRAN_ID as PERF_SMRY_TRAN_ID",
	"JNR_WM_E_CON_PERF_SMRY.WHSE as WHSE",
	"JNR_WM_E_CON_PERF_SMRY.LOGIN_USER_ID as LOGIN_USER_ID",
	"JNR_WM_E_CON_PERF_SMRY.JOB_FUNCTION_NAME as JOB_FUNCTION_NAME",
	"JNR_WM_E_CON_PERF_SMRY.SPVSR_LOGIN_USER_ID as SPVSR_LOGIN_USER_ID",
	"JNR_WM_E_CON_PERF_SMRY.DEPT_CODE as DEPT_CODE",
	"JNR_WM_E_CON_PERF_SMRY.CLOCK_IN_DATE as CLOCK_IN_DATE",
	"JNR_WM_E_CON_PERF_SMRY.CLOCK_IN_STATUS as CLOCK_IN_STATUS",
	"JNR_WM_E_CON_PERF_SMRY.TOTAL_SAM as TOTAL_SAM",
	"JNR_WM_E_CON_PERF_SMRY.TOTAL_PAM as TOTAL_PAM",
	"JNR_WM_E_CON_PERF_SMRY.TOTAL_TIME as TOTAL_TIME",
	"JNR_WM_E_CON_PERF_SMRY.OSDL as OSDL",
	"JNR_WM_E_CON_PERF_SMRY.OSIL as OSIL",
	"JNR_WM_E_CON_PERF_SMRY.NSDL as NSDL",
	"JNR_WM_E_CON_PERF_SMRY.SIL as SIL",
	"JNR_WM_E_CON_PERF_SMRY.UDIL as UDIL",
	"JNR_WM_E_CON_PERF_SMRY.UIL as UIL",
	"JNR_WM_E_CON_PERF_SMRY.ADJ_OSDL as ADJ_OSDL",
	"JNR_WM_E_CON_PERF_SMRY.ADJ_OSIL as ADJ_OSIL",
	"JNR_WM_E_CON_PERF_SMRY.ADJ_UDIL as ADJ_UDIL",
	"JNR_WM_E_CON_PERF_SMRY.ADJ_NSDL as ADJ_NSDL",
	"JNR_WM_E_CON_PERF_SMRY.PAID_BRK as PAID_BRK",
	"JNR_WM_E_CON_PERF_SMRY.UNPAID_BRK as UNPAID_BRK",
	"JNR_WM_E_CON_PERF_SMRY.REF_OSDL as REF_OSDL",
	"JNR_WM_E_CON_PERF_SMRY.REF_OSIL as REF_OSIL",
	"JNR_WM_E_CON_PERF_SMRY.REF_UDIL as REF_UDIL",
	"JNR_WM_E_CON_PERF_SMRY.REF_NSDL as REF_NSDL",
	"JNR_WM_E_CON_PERF_SMRY.REF_ADJ_OSDL as REF_ADJ_OSDL",
	"JNR_WM_E_CON_PERF_SMRY.REF_ADJ_OSIL as REF_ADJ_OSIL",
	"JNR_WM_E_CON_PERF_SMRY.REF_ADJ_UDIL as REF_ADJ_UDIL",
	"JNR_WM_E_CON_PERF_SMRY.REF_ADJ_NSDL as REF_ADJ_NSDL",
	"JNR_WM_E_CON_PERF_SMRY.MISC_NUMBER_1 as MISC_NUMBER_1",
	"JNR_WM_E_CON_PERF_SMRY.CREATE_DATE_TIME as CREATE_DATE_TIME",
	"JNR_WM_E_CON_PERF_SMRY.MOD_DATE_TIME as MOD_DATE_TIME",
	"JNR_WM_E_CON_PERF_SMRY.USER_ID as USER_ID",
	"JNR_WM_E_CON_PERF_SMRY.MISC_1 as MISC_1",
	"JNR_WM_E_CON_PERF_SMRY.MISC_2 as MISC_2",
	"JNR_WM_E_CON_PERF_SMRY.CLOCK_OUT_DATE as CLOCK_OUT_DATE",
	"JNR_WM_E_CON_PERF_SMRY.SHIFT_CODE as SHIFT_CODE",
	"JNR_WM_E_CON_PERF_SMRY.EVENT_COUNT as EVENT_COUNT",
	"JNR_WM_E_CON_PERF_SMRY.START_DATE_TIME as START_DATE_TIME",
	"JNR_WM_E_CON_PERF_SMRY.END_DATE_TIME as END_DATE_TIME",
	"JNR_WM_E_CON_PERF_SMRY.LEVEL_1 as LEVEL_1",
	"JNR_WM_E_CON_PERF_SMRY.LEVEL_2 as LEVEL_2",
	"JNR_WM_E_CON_PERF_SMRY.LEVEL_3 as LEVEL_3",
	"JNR_WM_E_CON_PERF_SMRY.LEVEL_4 as LEVEL_4",
	"JNR_WM_E_CON_PERF_SMRY.LEVEL_5 as LEVEL_5",
	"JNR_WM_E_CON_PERF_SMRY.WHSE_DATE as WHSE_DATE",
	"JNR_WM_E_CON_PERF_SMRY.OPS_CODE as OPS_CODE",
	"JNR_WM_E_CON_PERF_SMRY.REF_SAM as REF_SAM",
	"JNR_WM_E_CON_PERF_SMRY.REF_PAM as REF_PAM",
	"JNR_WM_E_CON_PERF_SMRY.REPORT_SHIFT as REPORT_SHIFT",
	"JNR_WM_E_CON_PERF_SMRY.MISC_TXT_1 as MISC_TXT_1",
	"JNR_WM_E_CON_PERF_SMRY.MISC_TXT_2 as MISC_TXT_2",
	"JNR_WM_E_CON_PERF_SMRY.MISC_NUM_1 as MISC_NUM_1",
	"JNR_WM_E_CON_PERF_SMRY.MISC_NUM_2 as MISC_NUM_2",
	"JNR_WM_E_CON_PERF_SMRY.EVNT_CTGRY_1 as EVNT_CTGRY_1",
	"JNR_WM_E_CON_PERF_SMRY.EVNT_CTGRY_2 as EVNT_CTGRY_2",
	"JNR_WM_E_CON_PERF_SMRY.EVNT_CTGRY_3 as EVNT_CTGRY_3",
	"JNR_WM_E_CON_PERF_SMRY.EVNT_CTGRY_4 as EVNT_CTGRY_4",
	"JNR_WM_E_CON_PERF_SMRY.EVNT_CTGRY_5 as EVNT_CTGRY_5",
	"JNR_WM_E_CON_PERF_SMRY.LABOR_COST_RATE as LABOR_COST_RATE",
	"JNR_WM_E_CON_PERF_SMRY.PAID_OVERLAP_OSDL as PAID_OVERLAP_OSDL",
	"JNR_WM_E_CON_PERF_SMRY.UNPAID_OVERLAP_OSDL as UNPAID_OVERLAP_OSDL",
	"JNR_WM_E_CON_PERF_SMRY.PAID_OVERLAP_NSDL as PAID_OVERLAP_NSDL",
	"JNR_WM_E_CON_PERF_SMRY.UNPAID_OVERLAP_NSDL as UNPAID_OVERLAP_NSDL",
	"JNR_WM_E_CON_PERF_SMRY.PAID_OVERLAP_OSIL as PAID_OVERLAP_OSIL",
	"JNR_WM_E_CON_PERF_SMRY.UNPAID_OVERLAP_OSIL as UNPAID_OVERLAP_OSIL",
	"JNR_WM_E_CON_PERF_SMRY.PAID_OVERLAP_UDIL as PAID_OVERLAP_UDIL",
	"JNR_WM_E_CON_PERF_SMRY.UNPAID_OVERLAP_UDIL as UNPAID_OVERLAP_UDIL",
	"JNR_WM_E_CON_PERF_SMRY.VERSION_ID as VERSION_ID",
	"JNR_WM_E_CON_PERF_SMRY.TEAM_CODE as TEAM_CODE",
	"JNR_WM_E_CON_PERF_SMRY.DEFAULT_JF_FLAG as DEFAULT_JF_FLAG",
	"JNR_WM_E_CON_PERF_SMRY.EMP_PERF_SMRY_ID as EMP_PERF_SMRY_ID",
	"JNR_WM_E_CON_PERF_SMRY.TOTAL_QTY as TOTAL_QTY",
	"JNR_WM_E_CON_PERF_SMRY.REF_NBR as REF_NBR",
	"JNR_WM_E_CON_PERF_SMRY.TEAM_BEGIN_TIME as TEAM_BEGIN_TIME",
	"JNR_WM_E_CON_PERF_SMRY.THRUPUT_MIN as THRUPUT_MIN",
	"JNR_WM_E_CON_PERF_SMRY.DISPLAY_UOM_QTY as DISPLAY_UOM_QTY",
	"JNR_WM_E_CON_PERF_SMRY.DISPLAY_UOM as DISPLAY_UOM",
	"JNR_WM_E_CON_PERF_SMRY.LOCN_GRP_ATTR as LOCN_GRP_ATTR",
	"JNR_WM_E_CON_PERF_SMRY.RESOURCE_GROUP_ID as RESOURCE_GROUP_ID",
	"JNR_WM_E_CON_PERF_SMRY.COMP_ASSIGNMENT_ID as COMP_ASSIGNMENT_ID",
	"JNR_WM_E_CON_PERF_SMRY.REFLECTIVE_CODE as REFLECTIVE_CODE",
	"JNR_WM_E_CON_PERF_SMRY.in_LOCATION_ID as in_LOCATION_ID",
	"JNR_WM_E_CON_PERF_SMRY.in_WM_PERF_SMRY_TRAN_ID as in_WM_PERF_SMRY_TRAN_ID",
	"JNR_WM_E_CON_PERF_SMRY.in_LOAD_TSTMP as in_LOAD_TSTMP",
	"JNR_WM_E_CON_PERF_SMRY.in_WM_CREATE_TSTMP as in_WM_CREATE_TSTMP",
	"JNR_WM_E_CON_PERF_SMRY.in_WM_MOD_TSTMP as in_WM_MOD_TSTMP").filter(f"in_WM_PERF_SMRY_TRAN_ID.isNull() OR ( in_WM_PERF_SMRY_TRAN_ID.isNotNull()  &  ( when((CREATE_DATE_TIME.isNull()),(to_date ( '01/01/1900' , 'MM/DD/YYYY' ))).otherwise(CREATE_DATE_TIME) != when((in_WM_CREATE_TSTMP.isNull()),(to_date ( '01/01/1900' , 'MM/DD/YYYY' ))).otherwise(in_WM_CREATE_TSTMP) OR when((MOD_DATE_TIME.isNull()),(to_date ( '01/01/1900' , 'MM/DD/YYYY' ))).otherwise(MOD_DATE_TIME) != when((in_WM_MOD_TSTMP.isNull()),(to_date ( '01/01/1900' , 'MM/DD/YYYY' ))).otherwise(in_WM_MOD_TSTMP) ) )").withColumn("sys_row_id", monotonically_increasing_id())

# COMMAND ----------
# Processing node EXP_EVAL_VALUES, type EXPRESSION . Note: using additional SELECT to rename incoming columns
# COLUMN COUNT: 90

EXP_EVAL_VALUES = FIL_NO_CHANGE_REC.selectExpr(
	"FIL_NO_CHANGE_REC.LOCATION_ID as LOCATION_ID",
	"FIL_NO_CHANGE_REC.PERF_SMRY_TRAN_ID as PERF_SMRY_TRAN_ID",
	"FIL_NO_CHANGE_REC.WHSE as WHSE",
	"FIL_NO_CHANGE_REC.LOGIN_USER_ID as LOGIN_USER_ID",
	"FIL_NO_CHANGE_REC.JOB_FUNCTION_NAME as JOB_FUNCTION_NAME",
	"FIL_NO_CHANGE_REC.SPVSR_LOGIN_USER_ID as SPVSR_LOGIN_USER_ID",
	"FIL_NO_CHANGE_REC.DEPT_CODE as DEPT_CODE",
	"FIL_NO_CHANGE_REC.CLOCK_IN_DATE as CLOCK_IN_DATE",
	"FIL_NO_CHANGE_REC.CLOCK_IN_STATUS as CLOCK_IN_STATUS",
	"FIL_NO_CHANGE_REC.TOTAL_SAM as TOTAL_SAM",
	"FIL_NO_CHANGE_REC.TOTAL_PAM as TOTAL_PAM",
	"FIL_NO_CHANGE_REC.TOTAL_TIME as TOTAL_TIME",
	"FIL_NO_CHANGE_REC.OSDL as OSDL",
	"FIL_NO_CHANGE_REC.OSIL as OSIL",
	"FIL_NO_CHANGE_REC.NSDL as NSDL",
	"FIL_NO_CHANGE_REC.SIL as SIL",
	"FIL_NO_CHANGE_REC.UDIL as UDIL",
	"FIL_NO_CHANGE_REC.UIL as UIL",
	"FIL_NO_CHANGE_REC.ADJ_OSDL as ADJ_OSDL",
	"FIL_NO_CHANGE_REC.ADJ_OSIL as ADJ_OSIL",
	"FIL_NO_CHANGE_REC.ADJ_UDIL as ADJ_UDIL",
	"FIL_NO_CHANGE_REC.ADJ_NSDL as ADJ_NSDL",
	"FIL_NO_CHANGE_REC.PAID_BRK as PAID_BRK",
	"FIL_NO_CHANGE_REC.UNPAID_BRK as UNPAID_BRK",
	"FIL_NO_CHANGE_REC.REF_OSDL as REF_OSDL",
	"FIL_NO_CHANGE_REC.REF_OSIL as REF_OSIL",
	"FIL_NO_CHANGE_REC.REF_UDIL as REF_UDIL",
	"FIL_NO_CHANGE_REC.REF_NSDL as REF_NSDL",
	"FIL_NO_CHANGE_REC.REF_ADJ_OSDL as REF_ADJ_OSDL",
	"FIL_NO_CHANGE_REC.REF_ADJ_OSIL as REF_ADJ_OSIL",
	"FIL_NO_CHANGE_REC.REF_ADJ_UDIL as REF_ADJ_UDIL",
	"FIL_NO_CHANGE_REC.REF_ADJ_NSDL as REF_ADJ_NSDL",
	"FIL_NO_CHANGE_REC.MISC_NUMBER_1 as MISC_NUMBER_1",
	"FIL_NO_CHANGE_REC.CREATE_DATE_TIME as CREATE_DATE_TIME",
	"FIL_NO_CHANGE_REC.MOD_DATE_TIME as MOD_DATE_TIME",
	"FIL_NO_CHANGE_REC.USER_ID as USER_ID",
	"FIL_NO_CHANGE_REC.MISC_1 as MISC_1",
	"FIL_NO_CHANGE_REC.MISC_2 as MISC_2",
	"FIL_NO_CHANGE_REC.CLOCK_OUT_DATE as CLOCK_OUT_DATE",
	"FIL_NO_CHANGE_REC.SHIFT_CODE as SHIFT_CODE",
	"FIL_NO_CHANGE_REC.EVENT_COUNT as EVENT_COUNT",
	"FIL_NO_CHANGE_REC.START_DATE_TIME as START_DATE_TIME",
	"FIL_NO_CHANGE_REC.END_DATE_TIME as END_DATE_TIME",
	"FIL_NO_CHANGE_REC.LEVEL_1 as LEVEL_1",
	"FIL_NO_CHANGE_REC.LEVEL_2 as LEVEL_2",
	"FIL_NO_CHANGE_REC.LEVEL_3 as LEVEL_3",
	"FIL_NO_CHANGE_REC.LEVEL_4 as LEVEL_4",
	"FIL_NO_CHANGE_REC.LEVEL_5 as LEVEL_5",
	"FIL_NO_CHANGE_REC.WHSE_DATE as WHSE_DATE",
	"FIL_NO_CHANGE_REC.OPS_CODE as OPS_CODE",
	"FIL_NO_CHANGE_REC.REF_SAM as REF_SAM",
	"FIL_NO_CHANGE_REC.REF_PAM as REF_PAM",
	"FIL_NO_CHANGE_REC.REPORT_SHIFT as REPORT_SHIFT",
	"FIL_NO_CHANGE_REC.MISC_TXT_1 as MISC_TXT_1",
	"FIL_NO_CHANGE_REC.MISC_TXT_2 as MISC_TXT_2",
	"FIL_NO_CHANGE_REC.MISC_NUM_1 as MISC_NUM_1",
	"FIL_NO_CHANGE_REC.MISC_NUM_2 as MISC_NUM_2",
	"FIL_NO_CHANGE_REC.EVNT_CTGRY_1 as EVNT_CTGRY_1",
	"FIL_NO_CHANGE_REC.EVNT_CTGRY_2 as EVNT_CTGRY_2",
	"FIL_NO_CHANGE_REC.EVNT_CTGRY_3 as EVNT_CTGRY_3",
	"FIL_NO_CHANGE_REC.EVNT_CTGRY_4 as EVNT_CTGRY_4",
	"FIL_NO_CHANGE_REC.EVNT_CTGRY_5 as EVNT_CTGRY_5",
	"FIL_NO_CHANGE_REC.LABOR_COST_RATE as LABOR_COST_RATE",
	"FIL_NO_CHANGE_REC.PAID_OVERLAP_OSDL as PAID_OVERLAP_OSDL",
	"FIL_NO_CHANGE_REC.UNPAID_OVERLAP_OSDL as UNPAID_OVERLAP_OSDL",
	"FIL_NO_CHANGE_REC.PAID_OVERLAP_NSDL as PAID_OVERLAP_NSDL",
	"FIL_NO_CHANGE_REC.UNPAID_OVERLAP_NSDL as UNPAID_OVERLAP_NSDL",
	"FIL_NO_CHANGE_REC.PAID_OVERLAP_OSIL as PAID_OVERLAP_OSIL",
	"FIL_NO_CHANGE_REC.UNPAID_OVERLAP_OSIL as UNPAID_OVERLAP_OSIL",
	"FIL_NO_CHANGE_REC.PAID_OVERLAP_UDIL as PAID_OVERLAP_UDIL",
	"FIL_NO_CHANGE_REC.UNPAID_OVERLAP_UDIL as UNPAID_OVERLAP_UDIL",
	"FIL_NO_CHANGE_REC.VERSION_ID as VERSION_ID",
	"FIL_NO_CHANGE_REC.TEAM_CODE as TEAM_CODE",
	"FIL_NO_CHANGE_REC.DEFAULT_JF_FLAG as DEFAULT_JF_FLAG",
	"FIL_NO_CHANGE_REC.EMP_PERF_SMRY_ID as EMP_PERF_SMRY_ID",
	"FIL_NO_CHANGE_REC.TOTAL_QTY as TOTAL_QTY",
	"FIL_NO_CHANGE_REC.REF_NBR as REF_NBR",
	"FIL_NO_CHANGE_REC.TEAM_BEGIN_TIME as TEAM_BEGIN_TIME",
	"FIL_NO_CHANGE_REC.THRUPUT_MIN as THRUPUT_MIN",
	"FIL_NO_CHANGE_REC.DISPLAY_UOM_QTY as DISPLAY_UOM_QTY",
	"FIL_NO_CHANGE_REC.DISPLAY_UOM as DISPLAY_UOM",
	"FIL_NO_CHANGE_REC.LOCN_GRP_ATTR as LOCN_GRP_ATTR",
	"FIL_NO_CHANGE_REC.RESOURCE_GROUP_ID as RESOURCE_GROUP_ID",
	"FIL_NO_CHANGE_REC.COMP_ASSIGNMENT_ID as COMP_ASSIGNMENT_ID",
	"FIL_NO_CHANGE_REC.REFLECTIVE_CODE as REFLECTIVE_CODE",
	"FIL_NO_CHANGE_REC.in_LOAD_TSTMP as in_LOAD_TSTMP",
	"FIL_NO_CHANGE_REC.in_WM_PERF_SMRY_TRAN_ID as in_WM_PERF_SMRY_TRAN_ID",
	"FIL_NO_CHANGE_REC.in_WM_CREATE_TSTMP as WM_CREATE_TSTMP",
	"FIL_NO_CHANGE_REC.in_WM_MOD_TSTMP as WM_MOD_TSTMP").selectExpr(
	"sys_row_id as sys_row_id",
	"LOCATION_ID as LOCATION_ID",
	"PERF_SMRY_TRAN_ID as PERF_SMRY_TRAN_ID",
	"WHSE as WHSE",
	"LOGIN_USER_ID as LOGIN_USER_ID",
	"JOB_FUNCTION_NAME as JOB_FUNCTION_NAME",
	"SPVSR_LOGIN_USER_ID as SPVSR_LOGIN_USER_ID",
	"DEPT_CODE as DEPT_CODE",
	"CLOCK_IN_DATE as CLOCK_IN_DATE",
	"CLOCK_IN_STATUS as CLOCK_IN_STATUS",
	"TOTAL_SAM as TOTAL_SAM",
	"TOTAL_PAM as TOTAL_PAM",
	"TOTAL_TIME as TOTAL_TIME",
	"OSDL as OSDL",
	"OSIL as OSIL",
	"NSDL as NSDL",
	"SIL as SIL",
	"UDIL as UDIL",
	"UIL as UIL",
	"ADJ_OSDL as ADJ_OSDL",
	"ADJ_OSIL as ADJ_OSIL",
	"ADJ_UDIL as ADJ_UDIL",
	"ADJ_NSDL as ADJ_NSDL",
	"PAID_BRK as PAID_BRK",
	"UNPAID_BRK as UNPAID_BRK",
	"REF_OSDL as REF_OSDL",
	"REF_OSIL as REF_OSIL",
	"REF_UDIL as REF_UDIL",
	"REF_NSDL as REF_NSDL",
	"REF_ADJ_OSDL as REF_ADJ_OSDL",
	"REF_ADJ_OSIL as REF_ADJ_OSIL",
	"REF_ADJ_UDIL as REF_ADJ_UDIL",
	"REF_ADJ_NSDL as REF_ADJ_NSDL",
	"MISC_NUMBER_1 as MISC_NUMBER_1",
	"CREATE_DATE_TIME as CREATE_DATE_TIME",
	"MOD_DATE_TIME as MOD_DATE_TIME",
	"USER_ID as USER_ID",
	"MISC_1 as MISC_1",
	"MISC_2 as MISC_2",
	"CLOCK_OUT_DATE as CLOCK_OUT_DATE",
	"SHIFT_CODE as SHIFT_CODE",
	"EVENT_COUNT as EVENT_COUNT",
	"START_DATE_TIME as START_DATE_TIME",
	"END_DATE_TIME as END_DATE_TIME",
	"LEVEL_1 as LEVEL_1",
	"LEVEL_2 as LEVEL_2",
	"LEVEL_3 as LEVEL_3",
	"LEVEL_4 as LEVEL_4",
	"LEVEL_5 as LEVEL_5",
	"WHSE_DATE as WHSE_DATE",
	"OPS_CODE as OPS_CODE",
	"REF_SAM as REF_SAM",
	"REF_PAM as REF_PAM",
	"REPORT_SHIFT as REPORT_SHIFT",
	"MISC_TXT_1 as MISC_TXT_1",
	"MISC_TXT_2 as MISC_TXT_2",
	"MISC_NUM_1 as MISC_NUM_1",
	"MISC_NUM_2 as MISC_NUM_2",
	"EVNT_CTGRY_1 as EVNT_CTGRY_1",
	"EVNT_CTGRY_2 as EVNT_CTGRY_2",
	"EVNT_CTGRY_3 as EVNT_CTGRY_3",
	"EVNT_CTGRY_4 as EVNT_CTGRY_4",
	"EVNT_CTGRY_5 as EVNT_CTGRY_5",
	"LABOR_COST_RATE as LABOR_COST_RATE",
	"PAID_OVERLAP_OSDL as PAID_OVERLAP_OSDL",
	"UNPAID_OVERLAP_OSDL as UNPAID_OVERLAP_OSDL",
	"PAID_OVERLAP_NSDL as PAID_OVERLAP_NSDL",
	"UNPAID_OVERLAP_NSDL as UNPAID_OVERLAP_NSDL",
	"PAID_OVERLAP_OSIL as PAID_OVERLAP_OSIL",
	"UNPAID_OVERLAP_OSIL as UNPAID_OVERLAP_OSIL",
	"PAID_OVERLAP_UDIL as PAID_OVERLAP_UDIL",
	"UNPAID_OVERLAP_UDIL as UNPAID_OVERLAP_UDIL",
	"VERSION_ID as VERSION_ID",
	"TEAM_CODE as TEAM_CODE",
	"DEFAULT_JF_FLAG as DEFAULT_JF_FLAG",
	"EMP_PERF_SMRY_ID as EMP_PERF_SMRY_ID",
	"TOTAL_QTY as TOTAL_QTY",
	"REF_NBR as REF_NBR",
	"TEAM_BEGIN_TIME as TEAM_BEGIN_TIME",
	"THRUPUT_MIN as THRUPUT_MIN",
	"DISPLAY_UOM_QTY as DISPLAY_UOM_QTY",
	"DISPLAY_UOM as DISPLAY_UOM",
	"LOCN_GRP_ATTR as LOCN_GRP_ATTR",
	"RESOURCE_GROUP_ID as RESOURCE_GROUP_ID",
	"COMP_ASSIGNMENT_ID as COMP_ASSIGNMENT_ID",
	"REFLECTIVE_CODE as REFLECTIVE_CODE",
	"when((ISNULL ( in_LOAD_TSTMP )),(current_date())).otherwise(in_LOAD_TSTMP) as LOAD_TSTMP",
	"current_date() as UPDATE_TSTMP",
	"in_WM_PERF_SMRY_TRAN_ID as in_WM_PERF_SMRY_TRAN_ID",
	"WM_CREATE_TSTMP as WM_CREATE_TSTMP",
	"WM_MOD_TSTMP as WM_MOD_TSTMP"
)

# COMMAND ----------
# Processing node UPD_VALIDATE, type UPDATE_STRATEGY 
# COLUMN COUNT: 88

UPD_VALIDATE = EXP_EVAL_VALUES.selectExpr(
	"EXP_EVAL_VALUES.LOCATION_ID as LOCATION_ID",
	"EXP_EVAL_VALUES.PERF_SMRY_TRAN_ID as PERF_SMRY_TRAN_ID",
	"EXP_EVAL_VALUES.WHSE as WHSE",
	"EXP_EVAL_VALUES.LOGIN_USER_ID as LOGIN_USER_ID",
	"EXP_EVAL_VALUES.JOB_FUNCTION_NAME as JOB_FUNCTION_NAME",
	"EXP_EVAL_VALUES.SPVSR_LOGIN_USER_ID as SPVSR_LOGIN_USER_ID",
	"EXP_EVAL_VALUES.DEPT_CODE as DEPT_CODE",
	"EXP_EVAL_VALUES.CLOCK_IN_DATE as CLOCK_IN_DATE",
	"EXP_EVAL_VALUES.CLOCK_IN_STATUS as CLOCK_IN_STATUS",
	"EXP_EVAL_VALUES.TOTAL_SAM as TOTAL_SAM",
	"EXP_EVAL_VALUES.TOTAL_PAM as TOTAL_PAM",
	"EXP_EVAL_VALUES.TOTAL_TIME as TOTAL_TIME",
	"EXP_EVAL_VALUES.OSDL as OSDL",
	"EXP_EVAL_VALUES.OSIL as OSIL",
	"EXP_EVAL_VALUES.NSDL as NSDL",
	"EXP_EVAL_VALUES.SIL as SIL",
	"EXP_EVAL_VALUES.UDIL as UDIL",
	"EXP_EVAL_VALUES.UIL as UIL",
	"EXP_EVAL_VALUES.ADJ_OSDL as ADJ_OSDL",
	"EXP_EVAL_VALUES.ADJ_OSIL as ADJ_OSIL",
	"EXP_EVAL_VALUES.ADJ_UDIL as ADJ_UDIL",
	"EXP_EVAL_VALUES.ADJ_NSDL as ADJ_NSDL",
	"EXP_EVAL_VALUES.PAID_BRK as PAID_BRK",
	"EXP_EVAL_VALUES.UNPAID_BRK as UNPAID_BRK",
	"EXP_EVAL_VALUES.REF_OSDL as REF_OSDL",
	"EXP_EVAL_VALUES.REF_OSIL as REF_OSIL",
	"EXP_EVAL_VALUES.REF_UDIL as REF_UDIL",
	"EXP_EVAL_VALUES.REF_NSDL as REF_NSDL",
	"EXP_EVAL_VALUES.REF_ADJ_OSDL as REF_ADJ_OSDL",
	"EXP_EVAL_VALUES.REF_ADJ_OSIL as REF_ADJ_OSIL",
	"EXP_EVAL_VALUES.REF_ADJ_UDIL as REF_ADJ_UDIL",
	"EXP_EVAL_VALUES.REF_ADJ_NSDL as REF_ADJ_NSDL",
	"EXP_EVAL_VALUES.MISC_NUMBER_1 as MISC_NUMBER_1",
	"EXP_EVAL_VALUES.CREATE_DATE_TIME as CREATE_DATE_TIME",
	"EXP_EVAL_VALUES.MOD_DATE_TIME as MOD_DATE_TIME",
	"EXP_EVAL_VALUES.USER_ID as USER_ID",
	"EXP_EVAL_VALUES.MISC_1 as MISC_1",
	"EXP_EVAL_VALUES.MISC_2 as MISC_2",
	"EXP_EVAL_VALUES.CLOCK_OUT_DATE as CLOCK_OUT_DATE",
	"EXP_EVAL_VALUES.SHIFT_CODE as SHIFT_CODE",
	"EXP_EVAL_VALUES.EVENT_COUNT as EVENT_COUNT",
	"EXP_EVAL_VALUES.START_DATE_TIME as START_DATE_TIME",
	"EXP_EVAL_VALUES.END_DATE_TIME as END_DATE_TIME",
	"EXP_EVAL_VALUES.LEVEL_1 as LEVEL_1",
	"EXP_EVAL_VALUES.LEVEL_2 as LEVEL_2",
	"EXP_EVAL_VALUES.LEVEL_3 as LEVEL_3",
	"EXP_EVAL_VALUES.LEVEL_4 as LEVEL_4",
	"EXP_EVAL_VALUES.LEVEL_5 as LEVEL_5",
	"EXP_EVAL_VALUES.WHSE_DATE as WHSE_DATE",
	"EXP_EVAL_VALUES.OPS_CODE as OPS_CODE",
	"EXP_EVAL_VALUES.REF_SAM as REF_SAM",
	"EXP_EVAL_VALUES.REF_PAM as REF_PAM",
	"EXP_EVAL_VALUES.REPORT_SHIFT as REPORT_SHIFT",
	"EXP_EVAL_VALUES.MISC_TXT_1 as MISC_TXT_1",
	"EXP_EVAL_VALUES.MISC_TXT_2 as MISC_TXT_2",
	"EXP_EVAL_VALUES.MISC_NUM_1 as MISC_NUM_1",
	"EXP_EVAL_VALUES.MISC_NUM_2 as MISC_NUM_2",
	"EXP_EVAL_VALUES.EVNT_CTGRY_1 as EVNT_CTGRY_1",
	"EXP_EVAL_VALUES.EVNT_CTGRY_2 as EVNT_CTGRY_2",
	"EXP_EVAL_VALUES.EVNT_CTGRY_3 as EVNT_CTGRY_3",
	"EXP_EVAL_VALUES.EVNT_CTGRY_4 as EVNT_CTGRY_4",
	"EXP_EVAL_VALUES.EVNT_CTGRY_5 as EVNT_CTGRY_5",
	"EXP_EVAL_VALUES.LABOR_COST_RATE as LABOR_COST_RATE",
	"EXP_EVAL_VALUES.PAID_OVERLAP_OSDL as PAID_OVERLAP_OSDL",
	"EXP_EVAL_VALUES.UNPAID_OVERLAP_OSDL as UNPAID_OVERLAP_OSDL",
	"EXP_EVAL_VALUES.PAID_OVERLAP_NSDL as PAID_OVERLAP_NSDL",
	"EXP_EVAL_VALUES.UNPAID_OVERLAP_NSDL as UNPAID_OVERLAP_NSDL",
	"EXP_EVAL_VALUES.PAID_OVERLAP_OSIL as PAID_OVERLAP_OSIL",
	"EXP_EVAL_VALUES.UNPAID_OVERLAP_OSIL as UNPAID_OVERLAP_OSIL",
	"EXP_EVAL_VALUES.PAID_OVERLAP_UDIL as PAID_OVERLAP_UDIL",
	"EXP_EVAL_VALUES.UNPAID_OVERLAP_UDIL as UNPAID_OVERLAP_UDIL",
	"EXP_EVAL_VALUES.VERSION_ID as VERSION_ID",
	"EXP_EVAL_VALUES.TEAM_CODE as TEAM_CODE",
	"EXP_EVAL_VALUES.DEFAULT_JF_FLAG as DEFAULT_JF_FLAG",
	"EXP_EVAL_VALUES.EMP_PERF_SMRY_ID as EMP_PERF_SMRY_ID",
	"EXP_EVAL_VALUES.TOTAL_QTY as TOTAL_QTY",
	"EXP_EVAL_VALUES.REF_NBR as REF_NBR",
	"EXP_EVAL_VALUES.TEAM_BEGIN_TIME as TEAM_BEGIN_TIME",
	"EXP_EVAL_VALUES.THRUPUT_MIN as THRUPUT_MIN",
	"EXP_EVAL_VALUES.DISPLAY_UOM_QTY as DISPLAY_UOM_QTY",
	"EXP_EVAL_VALUES.DISPLAY_UOM as DISPLAY_UOM",
	"EXP_EVAL_VALUES.LOCN_GRP_ATTR as LOCN_GRP_ATTR",
	"EXP_EVAL_VALUES.RESOURCE_GROUP_ID as RESOURCE_GROUP_ID",
	"EXP_EVAL_VALUES.COMP_ASSIGNMENT_ID as COMP_ASSIGNMENT_ID",
	"EXP_EVAL_VALUES.REFLECTIVE_CODE as REFLECTIVE_CODE",
	"EXP_EVAL_VALUES.LOAD_TSTMP as LOAD_TSTMP",
	"EXP_EVAL_VALUES.UPDATE_TSTMP as UPDATE_TSTMP",
	"EXP_EVAL_VALUES.in_WM_PERF_SMRY_TRAN_ID as in_WM_PERF_SMRY_TRAN_ID")
	.withColumn('pyspark_data_action', when((EXP_EVAL_VALUES.in_WM_PERF_SMRY_TRAN_ID.isNull()) ,(lit(0))) .otherwise(lit(1)))

# COMMAND ----------
# Processing node Shortcut_to_WM_E_CONSOL_PERF_SMRY, type TARGET 
# COLUMN COUNT: 87

Shortcut_to_WM_E_CONSOL_PERF_SMRY = DeltaTable.forPath(spark, '/tmp/delta/WM_E_CONSOL_PERF_SMRY')
Shortcut_to_WM_E_CONSOL_PERF_SMRY.alias('WM_E_CONSOL_PERF_SMRY').merge(UPD_VALIDATE.alias('UPD_VALIDATE'),
'WM_E_CONSOL_PERF_SMRY.LOCATION_ID = UPD_VALIDATE.LOCATION_ID and WM_E_CONSOL_PERF_SMRY.WM_PERF_SMRY_TRAN_ID = UPD_VALIDATE.PERF_SMRY_TRAN_ID')
.whenMatchedUpdate(set = {
	'LOCATION_ID' : 'UPD_VALIDATE.LOCATION_ID',
	'WM_PERF_SMRY_TRAN_ID' : 'UPD_VALIDATE.PERF_SMRY_TRAN_ID',
	'WM_WHSE' : 'UPD_VALIDATE.WHSE',
	'WM_LOGIN_USER_ID' : 'UPD_VALIDATE.LOGIN_USER_ID',
	'WM_JOB_FUNCTION_NAME' : 'UPD_VALIDATE.JOB_FUNCTION_NAME',
	'CLOCK_IN_TSTMP' : 'UPD_VALIDATE.CLOCK_IN_DATE',
	'CLOCK_OUT_TSTMP' : 'UPD_VALIDATE.CLOCK_OUT_DATE',
	'CLOCK_IN_STATUS' : 'UPD_VALIDATE.CLOCK_IN_STATUS',
	'START_TSTMP' : 'UPD_VALIDATE.START_DATE_TIME',
	'END_TSTMP' : 'UPD_VALIDATE.END_DATE_TIME',
	'WHSE_TSTMP' : 'UPD_VALIDATE.WHSE_DATE',
	'TEAM_BEGIN_TSTMP' : 'UPD_VALIDATE.TEAM_BEGIN_TIME',
	'WM_SHIFT_CD' : 'UPD_VALIDATE.SHIFT_CODE',
	'WM_REPORT_SHIFT_CD' : 'UPD_VALIDATE.REPORT_SHIFT',
	'WM_USER_ID' : 'UPD_VALIDATE.USER_ID',
	'WM_SPVSR_LOGIN_USER_ID' : 'UPD_VALIDATE.SPVSR_LOGIN_USER_ID',
	'WM_DEPT_CD' : 'UPD_VALIDATE.DEPT_CODE',
	'WM_RESOURCE_GROUP_ID' : 'UPD_VALIDATE.RESOURCE_GROUP_ID',
	'WM_COMP_ASSIGNMENT_ID' : 'UPD_VALIDATE.COMP_ASSIGNMENT_ID',
	'WM_REFLECTIVE_CD' : 'UPD_VALIDATE.REFLECTIVE_CODE',
	'WM_EMP_PERF_SMRY_ID' : 'UPD_VALIDATE.EMP_PERF_SMRY_ID',
	'WM_LOCN_GRP_ATTR' : 'UPD_VALIDATE.LOCN_GRP_ATTR',
	'WM_VERSION_ID' : 'UPD_VALIDATE.VERSION_ID',
	'WM_OPS_CD' : 'UPD_VALIDATE.OPS_CODE',
	'WM_TEAM_CD' : 'UPD_VALIDATE.TEAM_CODE',
	'WM_REF_NBR' : 'UPD_VALIDATE.REF_NBR',
	'DEFAULT_JF_FLAG' : 'UPD_VALIDATE.DEFAULT_JF_FLAG',
	'EVENT_CNT' : 'UPD_VALIDATE.EVENT_COUNT',
	'TOTAL_SAM' : 'UPD_VALIDATE.TOTAL_SAM',
	'TOTAL_PAM' : 'UPD_VALIDATE.TOTAL_PAM',
	'TOTAL_TIME' : 'UPD_VALIDATE.TOTAL_TIME',
	'TOTAL_QTY' : 'UPD_VALIDATE.TOTAL_QTY',
	'OSDL' : 'UPD_VALIDATE.OSDL',
	'OSIL' : 'UPD_VALIDATE.OSIL',
	'NSDL' : 'UPD_VALIDATE.NSDL',
	'SIL' : 'UPD_VALIDATE.SIL',
	'UDIL' : 'UPD_VALIDATE.UDIL',
	'UIL' : 'UPD_VALIDATE.UIL',
	'ADJ_OSDL' : 'UPD_VALIDATE.ADJ_OSDL',
	'ADJ_OSIL' : 'UPD_VALIDATE.ADJ_OSIL',
	'ADJ_UDIL' : 'UPD_VALIDATE.ADJ_UDIL',
	'ADJ_NSDL' : 'UPD_VALIDATE.ADJ_NSDL',
	'PAID_BRK' : 'UPD_VALIDATE.PAID_BRK',
	'UNPAID_BRK' : 'UPD_VALIDATE.UNPAID_BRK',
	'REF_OSDL' : 'UPD_VALIDATE.REF_OSDL',
	'REF_OSIL' : 'UPD_VALIDATE.REF_OSIL',
	'REF_UDIL' : 'UPD_VALIDATE.REF_UDIL',
	'REF_NSDL' : 'UPD_VALIDATE.REF_NSDL',
	'REF_ADJ_OSDL' : 'UPD_VALIDATE.REF_ADJ_OSDL',
	'REF_ADJ_OSIL' : 'UPD_VALIDATE.REF_ADJ_OSIL',
	'REF_ADJ_UDIL' : 'UPD_VALIDATE.REF_ADJ_UDIL',
	'REF_ADJ_NSDL' : 'UPD_VALIDATE.REF_ADJ_NSDL',
	'REF_SAM' : 'UPD_VALIDATE.REF_SAM',
	'REF_PAM' : 'UPD_VALIDATE.REF_PAM',
	'LABOR_COST_RATE' : 'UPD_VALIDATE.LABOR_COST_RATE',
	'THRUPUT_MIN' : 'UPD_VALIDATE.THRUPUT_MIN',
	'PAID_OVERLAP_OSDL' : 'UPD_VALIDATE.PAID_OVERLAP_OSDL',
	'UNPAID_OVERLAP_OSDL' : 'UPD_VALIDATE.UNPAID_OVERLAP_OSDL',
	'PAID_OVERLAP_NSDL' : 'UPD_VALIDATE.PAID_OVERLAP_NSDL',
	'UNPAID_OVERLAP_NSDL' : 'UPD_VALIDATE.UNPAID_OVERLAP_NSDL',
	'PAID_OVERLAP_OSIL' : 'UPD_VALIDATE.PAID_OVERLAP_OSIL',
	'UNPAID_OVERLAP_OSIL' : 'UPD_VALIDATE.UNPAID_OVERLAP_OSIL',
	'PAID_OVERLAP_UDIL' : 'UPD_VALIDATE.PAID_OVERLAP_UDIL',
	'UNPAID_OVERLAP_UDIL' : 'UPD_VALIDATE.UNPAID_OVERLAP_UDIL',
	'DISPLAY_UOM_QTY' : 'UPD_VALIDATE.DISPLAY_UOM_QTY',
	'DISPLAY_UOM' : 'UPD_VALIDATE.DISPLAY_UOM',
	'MISC_1' : 'UPD_VALIDATE.MISC_1',
	'MISC_2' : 'UPD_VALIDATE.MISC_2',
	'MISC_TXT_1' : 'UPD_VALIDATE.MISC_TXT_1',
	'MISC_TXT_2' : 'UPD_VALIDATE.MISC_TXT_2',
	'MISC_NBR_1' : 'UPD_VALIDATE.MISC_NUMBER_1',
	'MISC_NUM_1' : 'UPD_VALIDATE.MISC_NUM_1',
	'MISC_NUM_2' : 'UPD_VALIDATE.MISC_NUM_2',
	'LEVEL_1' : 'UPD_VALIDATE.LEVEL_1',
	'LEVEL_2' : 'UPD_VALIDATE.LEVEL_2',
	'LEVEL_3' : 'UPD_VALIDATE.LEVEL_3',
	'LEVEL_4' : 'UPD_VALIDATE.LEVEL_4',
	'LEVEL_5' : 'UPD_VALIDATE.LEVEL_5',
	'WM_EVNT_CTGRY_1' : 'UPD_VALIDATE.EVNT_CTGRY_1',
	'WM_EVNT_CTGRY_2' : 'UPD_VALIDATE.EVNT_CTGRY_2',
	'WM_EVNT_CTGRY_3' : 'UPD_VALIDATE.EVNT_CTGRY_3',
	'WM_EVNT_CTGRY_4' : 'UPD_VALIDATE.EVNT_CTGRY_4',
	'WM_EVNT_CTGRY_5' : 'UPD_VALIDATE.EVNT_CTGRY_5',
	'WM_CREATE_TSTMP' : 'UPD_VALIDATE.CREATE_DATE_TIME',
	'WM_MOD_TSTMP' : 'UPD_VALIDATE.MOD_DATE_TIME',
	'UPDATE_TSTMP' : 'UPD_VALIDATE.UPDATE_TSTMP',
	'LOAD_TSTMP' : 'UPD_VALIDATE.LOAD_TSTMP'} )
.whenNotMatchedInsert(values = {
	'LOCATION_ID' : 'UPD_VALIDATE.LOCATION_ID',
	'WM_PERF_SMRY_TRAN_ID' : 'UPD_VALIDATE.PERF_SMRY_TRAN_ID',
	'WM_WHSE' : 'UPD_VALIDATE.WHSE',
	'WM_LOGIN_USER_ID' : 'UPD_VALIDATE.LOGIN_USER_ID',
	'WM_JOB_FUNCTION_NAME' : 'UPD_VALIDATE.JOB_FUNCTION_NAME',
	'CLOCK_IN_TSTMP' : 'UPD_VALIDATE.CLOCK_IN_DATE',
	'CLOCK_OUT_TSTMP' : 'UPD_VALIDATE.CLOCK_OUT_DATE',
	'CLOCK_IN_STATUS' : 'UPD_VALIDATE.CLOCK_IN_STATUS',
	'START_TSTMP' : 'UPD_VALIDATE.START_DATE_TIME',
	'END_TSTMP' : 'UPD_VALIDATE.END_DATE_TIME',
	'WHSE_TSTMP' : 'UPD_VALIDATE.WHSE_DATE',
	'TEAM_BEGIN_TSTMP' : 'UPD_VALIDATE.TEAM_BEGIN_TIME',
	'WM_SHIFT_CD' : 'UPD_VALIDATE.SHIFT_CODE',
	'WM_REPORT_SHIFT_CD' : 'UPD_VALIDATE.REPORT_SHIFT',
	'WM_USER_ID' : 'UPD_VALIDATE.USER_ID',
	'WM_SPVSR_LOGIN_USER_ID' : 'UPD_VALIDATE.SPVSR_LOGIN_USER_ID',
	'WM_DEPT_CD' : 'UPD_VALIDATE.DEPT_CODE',
	'WM_RESOURCE_GROUP_ID' : 'UPD_VALIDATE.RESOURCE_GROUP_ID',
	'WM_COMP_ASSIGNMENT_ID' : 'UPD_VALIDATE.COMP_ASSIGNMENT_ID',
	'WM_REFLECTIVE_CD' : 'UPD_VALIDATE.REFLECTIVE_CODE',
	'WM_EMP_PERF_SMRY_ID' : 'UPD_VALIDATE.EMP_PERF_SMRY_ID',
	'WM_LOCN_GRP_ATTR' : 'UPD_VALIDATE.LOCN_GRP_ATTR',
	'WM_VERSION_ID' : 'UPD_VALIDATE.VERSION_ID',
	'WM_OPS_CD' : 'UPD_VALIDATE.OPS_CODE',
	'WM_TEAM_CD' : 'UPD_VALIDATE.TEAM_CODE',
	'WM_REF_NBR' : 'UPD_VALIDATE.REF_NBR',
	'DEFAULT_JF_FLAG' : 'UPD_VALIDATE.DEFAULT_JF_FLAG',
	'EVENT_CNT' : 'UPD_VALIDATE.EVENT_COUNT',
	'TOTAL_SAM' : 'UPD_VALIDATE.TOTAL_SAM',
	'TOTAL_PAM' : 'UPD_VALIDATE.TOTAL_PAM',
	'TOTAL_TIME' : 'UPD_VALIDATE.TOTAL_TIME',
	'TOTAL_QTY' : 'UPD_VALIDATE.TOTAL_QTY',
	'OSDL' : 'UPD_VALIDATE.OSDL',
	'OSIL' : 'UPD_VALIDATE.OSIL',
	'NSDL' : 'UPD_VALIDATE.NSDL',
	'SIL' : 'UPD_VALIDATE.SIL',
	'UDIL' : 'UPD_VALIDATE.UDIL',
	'UIL' : 'UPD_VALIDATE.UIL',
	'ADJ_OSDL' : 'UPD_VALIDATE.ADJ_OSDL',
	'ADJ_OSIL' : 'UPD_VALIDATE.ADJ_OSIL',
	'ADJ_UDIL' : 'UPD_VALIDATE.ADJ_UDIL',
	'ADJ_NSDL' : 'UPD_VALIDATE.ADJ_NSDL',
	'PAID_BRK' : 'UPD_VALIDATE.PAID_BRK',
	'UNPAID_BRK' : 'UPD_VALIDATE.UNPAID_BRK',
	'REF_OSDL' : 'UPD_VALIDATE.REF_OSDL',
	'REF_OSIL' : 'UPD_VALIDATE.REF_OSIL',
	'REF_UDIL' : 'UPD_VALIDATE.REF_UDIL',
	'REF_NSDL' : 'UPD_VALIDATE.REF_NSDL',
	'REF_ADJ_OSDL' : 'UPD_VALIDATE.REF_ADJ_OSDL',
	'REF_ADJ_OSIL' : 'UPD_VALIDATE.REF_ADJ_OSIL',
	'REF_ADJ_UDIL' : 'UPD_VALIDATE.REF_ADJ_UDIL',
	'REF_ADJ_NSDL' : 'UPD_VALIDATE.REF_ADJ_NSDL',
	'REF_SAM' : 'UPD_VALIDATE.REF_SAM',
	'REF_PAM' : 'UPD_VALIDATE.REF_PAM',
	'LABOR_COST_RATE' : 'UPD_VALIDATE.LABOR_COST_RATE',
	'THRUPUT_MIN' : 'UPD_VALIDATE.THRUPUT_MIN',
	'PAID_OVERLAP_OSDL' : 'UPD_VALIDATE.PAID_OVERLAP_OSDL',
	'UNPAID_OVERLAP_OSDL' : 'UPD_VALIDATE.UNPAID_OVERLAP_OSDL',
	'PAID_OVERLAP_NSDL' : 'UPD_VALIDATE.PAID_OVERLAP_NSDL',
	'UNPAID_OVERLAP_NSDL' : 'UPD_VALIDATE.UNPAID_OVERLAP_NSDL',
	'PAID_OVERLAP_OSIL' : 'UPD_VALIDATE.PAID_OVERLAP_OSIL',
	'UNPAID_OVERLAP_OSIL' : 'UPD_VALIDATE.UNPAID_OVERLAP_OSIL',
	'PAID_OVERLAP_UDIL' : 'UPD_VALIDATE.PAID_OVERLAP_UDIL',
	'UNPAID_OVERLAP_UDIL' : 'UPD_VALIDATE.UNPAID_OVERLAP_UDIL',
	'DISPLAY_UOM_QTY' : 'UPD_VALIDATE.DISPLAY_UOM_QTY',
	'DISPLAY_UOM' : 'UPD_VALIDATE.DISPLAY_UOM',
	'MISC_1' : 'UPD_VALIDATE.MISC_1',
	'MISC_2' : 'UPD_VALIDATE.MISC_2',
	'MISC_TXT_1' : 'UPD_VALIDATE.MISC_TXT_1',
	'MISC_TXT_2' : 'UPD_VALIDATE.MISC_TXT_2',
	'MISC_NBR_1' : 'UPD_VALIDATE.MISC_NUMBER_1',
	'MISC_NUM_1' : 'UPD_VALIDATE.MISC_NUM_1',
	'MISC_NUM_2' : 'UPD_VALIDATE.MISC_NUM_2',
	'LEVEL_1' : 'UPD_VALIDATE.LEVEL_1',
	'LEVEL_2' : 'UPD_VALIDATE.LEVEL_2',
	'LEVEL_3' : 'UPD_VALIDATE.LEVEL_3',
	'LEVEL_4' : 'UPD_VALIDATE.LEVEL_4',
	'LEVEL_5' : 'UPD_VALIDATE.LEVEL_5',
	'WM_EVNT_CTGRY_1' : 'UPD_VALIDATE.EVNT_CTGRY_1',
	'WM_EVNT_CTGRY_2' : 'UPD_VALIDATE.EVNT_CTGRY_2',
	'WM_EVNT_CTGRY_3' : 'UPD_VALIDATE.EVNT_CTGRY_3',
	'WM_EVNT_CTGRY_4' : 'UPD_VALIDATE.EVNT_CTGRY_4',
	'WM_EVNT_CTGRY_5' : 'UPD_VALIDATE.EVNT_CTGRY_5',
	'WM_CREATE_TSTMP' : 'UPD_VALIDATE.CREATE_DATE_TIME',
	'WM_MOD_TSTMP' : 'UPD_VALIDATE.MOD_DATE_TIME',
	'UPDATE_TSTMP' : 'UPD_VALIDATE.UPDATE_TSTMP',
	'LOAD_TSTMP' : 'UPD_VALIDATE.LOAD_TSTMP'}).execute()

quit()